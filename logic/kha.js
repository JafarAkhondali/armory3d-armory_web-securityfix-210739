!function(t,e){"use strict";t.kha=t.kha||{},t.kha.input=t.kha.input||{},t.kha._Color=t.kha._Color||{};var S,n={},i=function(){return zt.__string_rec(this,"")},b=b||{};function s(t,e){var n=Object.create(t);for(var i in e)n[i]=e[i];return e.toString!==Object.prototype.toString&&(n.toString=e.toString),n}var r=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};(n.EReg=r).__name__=!0,r.prototype={r:null,match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},matched:function(t){if(null!=this.r.m&&0<=t&&t<this.r.m.length)return this.r.m[t];throw new Xt("EReg::matched")},__class__:r};var ht=function(){};(n.HxOverrides=ht).__name__=!0,ht.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(e[0]),n.setUTCMinutes(e[1]),n.setUTCSeconds(e[2]),n;case 10:var i=t.split("-");return new Date(i[0],i[1]-1,i[2],0,0,0);case 19:var s=t.split(" "),r=s[0].split("-"),a=s[1].split(":");return new Date(r[0],r[1]-1,r[2],a[0],a[1],a[2]);default:throw new Xt("Invalid date format : "+t)}},ht.cca=function(t,e){var n=t.charCodeAt(e);return n!=n?Yt.get_undefined():n},ht.substr=function(t,e,n){if(null==n)n=t.length;else if(n<0){if(0!=e)return"";n=t.length+n}return t.substr(e,n)},ht.remove=function(t,e){var n=t.indexOf(e);return-1!=n&&(t.splice(n,1),!0)},ht.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var a=function(){};(n.Main=a).__name__=!0,a.main=function(){x.main("Scene",1,!0,!0,!0,1600,900,2,!0,m.get)},Math.__name__=!0;var pt=function(){};(n.Reflect=pt).__name__=!0,pt.hasField=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},pt.field=function(t,e){try{return t[e]}catch(t){t instanceof Xt&&t.val;return null}},pt.setField=function(t,e,n){t[e]=n},pt.setProperty=function(t,e,n){var i;!!t.__properties__&&(i=t.__properties__["set_"+e])?t[i](n):t[e]=n},pt.callMethod=function(t,e,n){return e.apply(t,n)},pt.isFunction=function(t){return"function"==typeof t&&!(zt.isClass(t)||zt.isEnum(t))};var gt=function(){};(n.Std=gt).__name__=!0,gt.string=function(t){return zt.__string_rec(t,"")},gt.int=function(t){return 0|t},gt.parseInt=function(t){var e=parseInt(t,!t||"0"!=t[0]||"x"!=t[1]&&"X"!=t[1]?10:16);return isNaN(e)?null:e},gt.parseFloat=function(t){return parseFloat(t)};var J=function(){};(n.StringTools=J).__name__=!0,J.urlDecode=function(t){return decodeURIComponent(t.split("+").join(" "))},J.endsWith=function(t,e){var n=e.length,i=t.length;return n<=i&&ht.substr(t,i-n,n)==e},J.replace=function(t,e,n){return t.split(e).join(n)},J.fastCodeAt=function(t,e){return t.charCodeAt(e)},J.isEof=function(t){return t!=t};var q=function(){};(n.Type=q).__name__=!0,q.getClass=function(t){return null==t?null:zt.getClass(t)},q.resolveClass=function(t){return n[t]},q.resolveEnum=function(t){return b[t]},q.createInstance=function(t,e){return new(Function.prototype.bind.apply(t,[null].concat(e)))},q.createEmptyInstance=function(t){return Object.create(t.prototype)},q.createEnum=function(t,e,n){var i=pt.field(t,e);if(null==i)throw new Xt("No such constructor "+e);if(pt.isFunction(i)){if(null==n)throw new Xt("Constructor "+e+" need parameters");return pt.callMethod(t,i,n)}if(null!=n&&0!=n.length)throw new Xt("Constructor "+e+" does not need parameters");return i},q.getInstanceFields=function(t){var e=[];for(var n in t.prototype)e.push(n);return ht.remove(e,"__class__"),ht.remove(e,"__properties__"),e},q.getEnumConstructs=function(t){return t.__constructs__.slice()};var l=function(){this._render2D=null,this._render=null,this._lateUpdate=null,this._update=null,this._remove=null,this._init=null,this._add=null};(n["iron.Trait"]=l).__name__=!0,l.prototype={object:null,_add:null,_init:null,_remove:null,_update:null,_lateUpdate:null,_render:null,_render2D:null,remove:function(){this.object.removeTrait(this)},notifyOnAdd:function(t){null==this._add&&(this._add=[]),this._add.push(t)},notifyOnInit:function(t){null==this._init&&(this._init=[]),this._init.push(t),X.notifyOnInit(t)},notifyOnUpdate:function(t){null==this._update&&(this._update=[]),this._update.push(t),X.notifyOnUpdate(t)},notifyOnRender2D:function(t){null==this._render2D&&(this._render2D=[]),this._render2D.push(t),X.notifyOnRender2D(t)},__class__:l};var o=function(){l.call(this),st.getFont("font_default.ttf",function(t){o.font=t,U.active.root.addTrait(new I)})};(n["arm.App"]=o).__name__=!0,o.w=function(){var t=gt.int(be.windowWidth()/3);return 0<t?t:1},o.h=function(){var t;return 0<(t=be.windowHeight())?t:1},o.x=function(){return 0},o.y=function(){return 0},o.realw=function(){return be.windowWidth()},o.realh=function(){return be.windowHeight()},o.resize=function(){U.active.camera.buildProjection(),null!=I.inst.grid&&(I.inst.grid.unload(),I.inst.grid=null)},o.render=function(t){0<=o.lastW&&0<o.realw()&&(o.lastW!=o.realw()||o.lastH!=o.realh())&&o.resize(),o.lastW=o.realw(),o.lastH=o.realh()},o.__super__=l,o.prototype=s(l.prototype,{__class__:o});var C=function(){};(n["arm.NodeCreatorLogic"]=C).__name__=!0,C.nodeColor=function(t){switch(t){case"Action":case"Animation":case"Event":case"Input":case"Logic":case"Native":case"Navmesh":case"Physics":case"Sound":case"Value":case"Variable":return-5025958}return-5025958},C.socketColor=function(t){switch(t){case"ACTION":return-3388340;case"BOOL":case"INTEGER":return-10238109;case"OBJECT":return-14250817;case"RGBA":return-10238109;case"SHADER":return-11959648;case"STRING":return-1;case"VALUE":case"VECTOR":return-10238109}return-5025958},C.socketDefault=function(t){switch(t){case"ACTION":return 0;case"BOOL":return!1;case"INTEGER":case"OBJECT":return 0;case"RGBA":return[0,0,0,0];case"SHADER":return 0;case"STRING":return"";case"VALUE":return 0;case"VECTOR":return[0,0,0]}return 0},C.draw=function(t){for(var e=I.inst.ui,n=ci(S=I.inst,S.getNodeX),i=ci(S=I.inst,S.getNodeY),s=I.inst.nodes,r=I.inst.canvasLogic,a=0,l=C.list.categories[t].nodes;a<l.length;){var o=l[a];if(++a,e.button(o.name)){for(var h=s.getNodeId(r.nodes),u={id:h,name:o.name,type:o.type,x:n(),y:i(),color:C.nodeColor(o.type),inputs:[],outputs:[],buttons:[]},_=0,c=o.inputs;_<c.length;){var d=c[_];++_;var g={id:s.getSocketId(r.nodes),node_id:h,name:d.name,type:d.type,color:C.socketColor(d.type),default_value:C.socketDefault(d.type)};u.inputs.push(g)}for(var f=0,p=o.outputs;f<p.length;){var m=p[f];++f;var v={id:s.getSocketId(r.nodes),node_id:h,name:m.name,type:m.type,color:C.socketColor(m.type),default_value:C.socketDefault(m.type)};u.outputs.push(v)}for(var w=0,b=o.buttons;w<b.length;){var x=b[w];++w;var y={name:x.name,type:x.type,output:0,default_value:x.default_value,data:x.data};u.buttons.push(y)}r.nodes.push(u),s.nodeDrag=u,s.nodeSelected=u}}};var I=function(){this.lastT=null,this.hwnd=ri.global.nest(0,null),this.grid=null,this.changed=!1,this.canvasLogic=null,this.nodes=new oi,this.popupY=0,this.popupX=0,this.addNodeButton=!1,this.menuCategory=0,this.hideMenu=!1,this.showMenu=!1,this.drawMenu=!1;var r=this;l.call(this),I.inst=this,st.getBlob("logic_nodes.json",function(t){var e='{"nodes":[],"links":[]}',n=J.urlDecode(window.location.href);0<n.indexOf("?")&&(e=n.split("?")[1]),r.canvasLogic=JSON.parse(e),(C.list=JSON.parse(t.toString())).categories.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0});var i=hi.dark;i.ELEMENT_H=18,i.BUTTON_H=16;var s=d.raw.window_scale;r.ui=new ui({font:o.font,color_wheel:o.color_wheel,scaleFactor:s}),r.ui.scrollEnabled=!1,r.notifyOnRender2D(ci(r,r.render2D)),r.notifyOnUpdate(ci(r,r.update)),r.notifyOnInit(ci(r,r.parseLogic))})};(n["arm.UINodes"]=I).__name__=!0,I.__super__=l,I.prototype=s(l.prototype,{wx:null,wy:null,ww:null,ui:null,drawMenu:null,showMenu:null,hideMenu:null,menuCategory:null,addNodeButton:null,popupX:null,popupY:null,nodes:null,canvasLogic:null,changed:null,grid:null,hwnd:null,update:function(){var t=Ot.getMouse(),e=Ot.getKeyboard();(this.ui.changed||this.changed)&&(this.parseLogic(),this.changed=!1),this.wx=gt.int(X.w()),this.wy=0;var n=t.x+o.x(),i=t.y+o.y();if(!(n<this.wx||i<this.wy)&&!this.ui.isTyping&&(this.addNodeButton?(this.showMenu=!0,this.addNodeButton=!1):t.released()&&(this.hideMenu=!0),(e.started("x")||e.started("backspace"))&&null!=this.nodes.nodeSelected)){var s=this.canvasLogic;this.nodes.removeNode(this.nodes.nodeSelected,s),this.changed=!0}},getNodeX:function(){var t=Ot.getMouse();return gt.int((t.x+o.x()-this.wx-this.nodes.PAN_X())/this.nodes.SCALE)},getNodeY:function(){var t=Ot.getMouse();return gt.int((t.y+o.y()-this.wy-this.nodes.PAN_Y())/this.nodes.SCALE)},drawGrid:function(){var t=o.realw()-X.w()+80,e=X.h()+80;this.grid=ne.createRenderTarget(t,e),this.grid.get_g2().begin(!0,-14408668);for(var n=0,i=gt.int(e/40)+1;n<i;){var s=n++;this.grid.get_g2().set_color(-14145496),this.grid.get_g2().drawLine(0,40*s,t,40*s),this.grid.get_g2().set_color(-13487566),this.grid.get_g2().drawLine(0,40*s+20,t,40*s+20)}for(var r=0,a=gt.int(t/40)+1;r<a;){var l=r++;this.grid.get_g2().set_color(-14145496),this.grid.get_g2().drawLine(40*l,0,40*l,e),this.grid.get_g2().set_color(-13487566),this.grid.get_g2().drawLine(40*l+20,0,40*l+20,e)}this.grid.get_g2().end()},render2D:function(t){t.end(),null==this.grid&&this.drawGrid(),this.ui.begin(t),this.ww=gt.int(o.realw()-X.w());this.wx=gt.int(X.w()),this.wy=0;var e=gt.int(this.ui.ELEMENT_W());if(this.ui.window(this.hwnd,this.wx,this.wy,this.ww,X.h())){this.ui.g.set_color(-1),this.ui.g.drawImage(this.grid,this.nodes.panX*this.nodes.SCALE%40-40,this.nodes.panY*this.nodes.SCALE%40-40),this.ui.g.set_font(o.font),this.ui.g.set_fontSize(22);this.ui.g.get_font().width(22,"Logic"),this.ui.g.get_font().height(22);var n=this.canvasLogic;this.nodes.nodeCanvas(this.ui,n),this.ui.g.set_color(this.ui.t.WINDOW_BG_COL),this.ui.g.set_color(-1),this.ui._x=3,this.ui._y=3,this.ui._w=e}if(this.ui.endWindow(),this.drawMenu){var i=20*C.list.categories[this.menuCategory].nodes.length,s=this.popupY;t.set_color(-14540254),t.fillRect(this.popupX,s,e,i),this.ui.beginLayout(t,gt.int(this.popupX),gt.int(s),e),C.draw(this.menuCategory),this.ui.endLayout()}this.ui.end(),t.begin(!1),this.showMenu&&(this.showMenu=!1,this.drawMenu=!0),this.hideMenu&&(this.hideMenu=!1,this.drawMenu=!1)},lastT:null,parseLogic:function(){null!=this.lastT&&U.active.getChild("Cube").removeTrait(this.lastT),V.packageName="armory.logicnode";var t=V.parse(this.canvasLogic);this.lastT=t,U.active.getChild("Cube").addTrait(t)},__class__:I});var d=function(){};(n["armory.data.Config"]=d).__name__=!0;var h=function(t){this.outputs=[],this.inputs=[],this.tree=t};(n["armory.logicnode.LogicNode"]=h).__name__=!0,h.prototype={tree:null,inputs:null,outputs:null,addInput:function(t,e){this.inputs.push(new u(t,e))},addOutputs:function(t){this.outputs.push(t)},__class__:h};var u=function(t,e){this.node=t,this.from=e};(n["armory.logicnode.LogicNodeInput"]=u).__name__=!0,u.prototype={node:null,from:null,__class__:u};var _=function(){l.call(this)};(n["armory.logicnode.LogicTree"]=_).__name__=!0,_.__super__=l,_.prototype=s(l.prototype,{__class__:_});var p=function(t,e,n,i,s,r,a,l,o,h,u,_,c,d,g,f){this._00=t,this._10=e,this._20=n,this._30=i,this._01=s,this._11=r,this._21=a,this._31=l,this._02=o,this._12=h,this._22=u,this._32=_,this._03=c,this._13=d,this._23=g,this._33=f};(n["kha.math.FastMatrix4"]=p).__name__=!0,p.orthogonalProjection=function(t,e,n,i,s,r){return new p(2/(e-t),0,0,-(e+t)/(e-t),0,2/(i-n),0,-(i+n)/(i-n),0,0,-2/(r-s),-(r+s)/(r-s),0,0,0,1)},p.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:p};var E=function(t,e,n,i){null==i&&(i=1),null==n&&(n=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=n,this.w=i};(n["iron.math.Vec4"]=E).__name__=!0,E.distance=function(t,e){return E.distancef(t.x,t.y,t.z,e.x,e.y,e.z)},E.distancef=function(t,e,n,i,s,r){var a=t-i,l=e-s,o=n-r;return wt.sqrt(a*a+l*l+o*o)},E.prototype={x:null,y:null,z:null,w:null,set:function(t,e,n,i){return null==i&&(i=1),this.x=t,this.y=e,this.z=n,this.w=i,this},addf:function(t,e,n){return this.x+=t,this.y+=e,this.z+=n,this},addvecs:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},mult:function(t){return this.x*=t,this.y*=t,this.z*=t,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},setFrom:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},lerp:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this},applymat:function(t){var e=this.x,n=this.y,i=this.z;return this.x=t.get__00()*e+t.get__10()*n+t.get__20()*i+t.get__30(),this.y=t.get__01()*e+t.get__11()*n+t.get__21()*i+t.get__31(),this.z=t.get__02()*e+t.get__12()*n+t.get__22()*i+t.get__32(),this},applymat4:function(t){var e=this.x,n=this.y,i=this.z,s=this.w;return this.x=t.get__00()*e+t.get__10()*n+t.get__20()*i+t.get__30()*s,this.y=t.get__01()*e+t.get__11()*n+t.get__21()*i+t.get__31()*s,this.z=t.get__02()*e+t.get__12()*n+t.get__22()*i+t.get__32()*s,this.w=t.get__03()*e+t.get__13()*n+t.get__23()*i+t.get__33()*s,this},length:function(){return wt.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},__class__:E};var W=function(t,e,n,i,s,r,a,l,o,h,u,_,c,d,g,f){this.self=new p(t,e,n,i,s,r,a,l,o,h,u,_,c,d,g,f)};(n["iron.math.Mat4"]=W).__name__=!0,W.fromFloat32Array=function(t,e){return null==e&&(e=0),new W(t[e],t[1+e],t[2+e],t[3+e],t[4+e],t[5+e],t[6+e],t[7+e],t[8+e],t[9+e],t[10+e],t[11+e],t[12+e],t[13+e],t[14+e],t[15+e])},W.identity=function(){return new W(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},W.persp=function(t,e,n,i){var s=1/wt.tan(t/2);return new W(s/e,0,0,0,0,s,0,0,0,0,(i+n)/(n-i),2*i*n/(n-i),0,0,-1,0)},W.ortho=function(t,e,n,i,s,r){var a=e-t,l=i-n,o=r-s;return new W(2/a,0,0,-(e+t)/a,0,2/l,0,-(i+n)/l,0,0,-2/o,-(r+s)/o,0,0,0,1)},W.prototype={self:null,compose:function(t,e,n){return this.fromQuat(e),this.scale(n),this.setLoc(t),this},decompose:function(t,e,n){t.x=this.get__30(),t.y=this.get__31(),t.z=this.get__32(),n.x=W.helpVec.set(this.get__00(),this.get__01(),this.get__02()).length(),n.y=W.helpVec.set(this.get__10(),this.get__11(),this.get__12()).length(),n.z=W.helpVec.set(this.get__20(),this.get__21(),this.get__22()).length();var i=this.self,s=i._12,r=i._22,a=i._32,l=i._13,o=i._23,h=i._33,u=i._11*(r*h-a*o)-i._21*(s*h-a*l)+i._31*(s*o-r*l),_=i._12,c=i._22,d=i._32,g=i._13,f=i._23,p=i._33,m=i._10*(c*p-d*f)-i._20*(_*p-d*g)+i._30*(_*f-c*g),v=i._11,w=i._21,b=i._31,x=i._13,y=i._23,S=i._33,C=i._10*(w*S-b*y)-i._20*(v*S-b*x)+i._30*(v*y-w*x),I=i._11,T=i._21,k=i._31,B=i._12,E=i._22,M=i._32,L=i._10*(T*M-k*E)-i._20*(I*M-k*B)+i._30*(I*E-T*B);i._00*u-i._01*m+i._02*C-i._03*L<0&&(n.x=-n.x);var A=1/n.x;return W.helpMat.set__00(this.get__00()*A),W.helpMat.set__01(this.get__01()*A),W.helpMat.set__02(this.get__02()*A),A=1/n.y,W.helpMat.set__10(this.get__10()*A),W.helpMat.set__11(this.get__11()*A),W.helpMat.set__12(this.get__12()*A),A=1/n.z,W.helpMat.set__20(this.get__20()*A),W.helpMat.set__21(this.get__21()*A),W.helpMat.set__22(this.get__22()*A),e.fromRotationMat(W.helpMat),this},setLoc:function(t){return this.set__30(t.x),this.set__31(t.y),this.set__32(t.z),this},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,s=t.w,r=e+e,a=n+n,l=i+i,o=e*r,h=e*a,u=e*l,_=n*a,c=n*l,d=i*l,g=s*r,f=s*a,p=s*l;return this.set__00(1-(_+d)),this.set__10(h-p),this.set__20(u+f),this.set__01(h+p),this.set__11(1-(o+d)),this.set__21(c-g),this.set__02(u-f),this.set__12(c+g),this.set__22(1-(o+_)),this.set__03(0),this.set__13(0),this.set__23(0),this.set__30(0),this.set__31(0),this.set__32(0),this.set__33(1),this},setIdentity:function(){return this.set__00(1),this.set__01(0),this.set__02(0),this.set__03(0),this.set__10(0),this.set__11(1),this.set__12(0),this.set__13(0),this.set__20(0),this.set__21(0),this.set__22(1),this.set__23(0),this.set__30(0),this.set__31(0),this.set__32(0),this.set__33(1),this},scale:function(t){var e=t.x,n=t.y,i=t.z;this.set__00(this.get__00()*e);this.set__01(this.get__01()*e);this.set__02(this.get__02()*e);this.set__03(this.get__03()*e);this.set__10(this.get__10()*n);this.set__11(this.get__11()*n);this.set__12(this.get__12()*n);this.set__13(this.get__13()*n);this.set__20(this.get__20()*i);this.set__21(this.get__21()*i);this.set__22(this.get__22()*i);return this.set__23(this.get__23()*i),this},multmats3x4:function(t,e){var n=t.get__00(),i=t.get__01(),s=t.get__02(),r=t.get__03(),a=t.get__10(),l=t.get__11(),o=t.get__12(),h=t.get__13(),u=t.get__20(),_=t.get__21(),c=t.get__22(),d=t.get__23(),g=t.get__30(),f=t.get__31(),p=t.get__32(),m=t.get__33(),v=e.get__00(),w=e.get__10(),b=e.get__20(),x=e.get__30();return this.set__00(n*v+i*w+s*b+r*x),this.set__10(a*v+l*w+o*b+h*x),this.set__20(u*v+_*w+c*b+d*x),this.set__30(g*v+f*w+p*b+m*x),v=e.get__01(),w=e.get__11(),b=e.get__21(),x=e.get__31(),this.set__01(n*v+i*w+s*b+r*x),this.set__11(a*v+l*w+o*b+h*x),this.set__21(u*v+_*w+c*b+d*x),this.set__31(g*v+f*w+p*b+m*x),v=e.get__02(),w=e.get__12(),b=e.get__22(),x=e.get__32(),this.set__02(n*v+i*w+s*b+r*x),this.set__12(a*v+l*w+o*b+h*x),this.set__22(u*v+_*w+c*b+d*x),this.set__32(g*v+f*w+p*b+m*x),this.set__03(0),this.set__13(0),this.set__23(0),this.set__33(1),this},multmats:function(t,e){var n=e.get__00(),i=e.get__01(),s=e.get__02(),r=e.get__03(),a=e.get__10(),l=e.get__11(),o=e.get__12(),h=e.get__13(),u=e.get__20(),_=e.get__21(),c=e.get__22(),d=e.get__23(),g=e.get__30(),f=e.get__31(),p=e.get__32(),m=e.get__33(),v=t.get__00(),w=t.get__10(),b=t.get__20(),x=t.get__30();return this.set__00(n*v+i*w+s*b+r*x),this.set__10(a*v+l*w+o*b+h*x),this.set__20(u*v+_*w+c*b+d*x),this.set__30(g*v+f*w+p*b+m*x),v=t.get__01(),w=t.get__11(),b=t.get__21(),x=t.get__31(),this.set__01(n*v+i*w+s*b+r*x),this.set__11(a*v+l*w+o*b+h*x),this.set__21(u*v+_*w+c*b+d*x),this.set__31(g*v+f*w+p*b+m*x),v=t.get__02(),w=t.get__12(),b=t.get__22(),x=t.get__32(),this.set__02(n*v+i*w+s*b+r*x),this.set__12(a*v+l*w+o*b+h*x),this.set__22(u*v+_*w+c*b+d*x),this.set__32(g*v+f*w+p*b+m*x),v=t.get__03(),w=t.get__13(),b=t.get__23(),x=t.get__33(),this.set__03(n*v+i*w+s*b+r*x),this.set__13(a*v+l*w+o*b+h*x),this.set__23(u*v+_*w+c*b+d*x),this.set__33(g*v+f*w+p*b+m*x),this},multmat:function(t){var e=this.get__00(),n=this.get__01(),i=this.get__02(),s=this.get__03(),r=this.get__10(),a=this.get__11(),l=this.get__12(),o=this.get__13(),h=this.get__20(),u=this.get__21(),_=this.get__22(),c=this.get__23(),d=this.get__30(),g=this.get__31(),f=this.get__32(),p=this.get__33(),m=t.get__00(),v=t.get__10(),w=t.get__20(),b=t.get__30();return this.set__00(e*m+n*v+i*w+s*b),this.set__10(r*m+a*v+l*w+o*b),this.set__20(h*m+u*v+_*w+c*b),this.set__30(d*m+g*v+f*w+p*b),m=t.get__01(),v=t.get__11(),w=t.get__21(),b=t.get__31(),this.set__01(e*m+n*v+i*w+s*b),this.set__11(r*m+a*v+l*w+o*b),this.set__21(h*m+u*v+_*w+c*b),this.set__31(d*m+g*v+f*w+p*b),m=t.get__02(),v=t.get__12(),w=t.get__22(),b=t.get__32(),this.set__02(e*m+n*v+i*w+s*b),this.set__12(r*m+a*v+l*w+o*b),this.set__22(h*m+u*v+_*w+c*b),this.set__32(d*m+g*v+f*w+p*b),m=t.get__03(),v=t.get__13(),w=t.get__23(),b=t.get__33(),this.set__03(e*m+n*v+i*w+s*b),this.set__13(r*m+a*v+l*w+o*b),this.set__23(h*m+u*v+_*w+c*b),this.set__33(d*m+g*v+f*w+p*b),this},getInverse:function(t){var e=t.get__00(),n=t.get__01(),i=t.get__02(),s=t.get__03(),r=t.get__10(),a=t.get__11(),l=t.get__12(),o=t.get__13(),h=t.get__20(),u=t.get__21(),_=t.get__22(),c=t.get__23(),d=t.get__30(),g=t.get__31(),f=t.get__32(),p=t.get__33(),m=e*a-n*r,v=e*l-i*r,w=e*o-s*r,b=n*l-i*a,x=n*o-s*a,y=i*o-s*l,S=h*g-u*d,C=h*f-_*d,I=h*p-c*d,T=u*f-_*g,k=u*p-c*g,B=_*p-c*f,E=m*B-v*k+w*T+b*I-x*C+y*S;return 0==E?this.setIdentity():(E=1/E,this.set__00((a*B-l*k+o*T)*E),this.set__01((i*k-n*B-s*T)*E),this.set__02((g*y-f*x+p*b)*E),this.set__03((_*x-u*y-c*b)*E),this.set__10((l*I-r*B-o*C)*E),this.set__11((e*B-i*I+s*C)*E),this.set__12((f*w-d*y-p*v)*E),this.set__13((h*y-_*w+c*v)*E),this.set__20((r*k-a*I+o*S)*E),this.set__21((n*I-e*k-s*S)*E),this.set__22((d*x-g*w+p*m)*E),this.set__23((u*w-h*x-c*m)*E),this.set__30((a*C-r*T-l*S)*E),this.set__31((e*T-n*C+i*S)*E),this.set__32((g*v-d*b-f*m)*E),this.set__33((h*b-u*v+_*m)*E),this)},transpose:function(){var t=this.get__01();return this.set__01(this.get__10()),this.set__10(t),t=this.get__02(),this.set__02(this.get__20()),this.set__20(t),t=this.get__03(),this.set__03(this.get__30()),this.set__30(t),t=this.get__12(),this.set__12(this.get__21()),this.set__21(t),t=this.get__13(),this.set__13(this.get__31()),this.set__31(t),t=this.get__23(),this.set__23(this.get__32()),this.set__32(t),this},transpose3x3:function(){var t=this.get__01();return this.set__01(this.get__10()),this.set__10(t),t=this.get__02(),this.set__02(this.get__20()),this.set__20(t),t=this.get__12(),this.set__12(this.get__21()),this.set__21(t),this},setF32:function(t,e){return null==e&&(e=0),this.set__00(t[e]),this.set__10(t[1+e]),this.set__20(t[2+e]),this.set__30(t[3+e]),this.set__01(t[4+e]),this.set__11(t[5+e]),this.set__21(t[6+e]),this.set__31(t[7+e]),this.set__02(t[8+e]),this.set__12(t[9+e]),this.set__22(t[10+e]),this.set__32(t[11+e]),this.set__03(t[12+e]),this.set__13(t[13+e]),this.set__23(t[14+e]),this.set__33(t[15+e]),this},setFrom:function(t){return this.set__00(t.get__00()),this.set__01(t.get__01()),this.set__02(t.get__02()),this.set__03(t.get__03()),this.set__10(t.get__10()),this.set__11(t.get__11()),this.set__12(t.get__12()),this.set__13(t.get__13()),this.set__20(t.get__20()),this.set__21(t.get__21()),this.set__22(t.get__22()),this.set__23(t.get__23()),this.set__30(t.get__30()),this.set__31(t.get__31()),this.set__32(t.get__32()),this.set__33(t.get__33()),this},getLoc:function(){return new E(this.get__30(),this.get__31(),this.get__32(),this.get__33())},getScale:function(){return new E(wt.sqrt(this.get__00()*this.get__00()+this.get__10()*this.get__10()+this.get__20()*this.get__20()),wt.sqrt(this.get__01()*this.get__01()+this.get__11()*this.get__11()+this.get__21()*this.get__21()),wt.sqrt(this.get__02()*this.get__02()+this.get__12()*this.get__12()+this.get__22()*this.get__22()))},toRotation:function(){var t=1/W.helpVec.set(this.get__00(),this.get__01(),this.get__02()).length();return this.set__00(this.get__00()*t),this.set__01(this.get__01()*t),this.set__02(this.get__02()*t),t=1/W.helpVec.set(this.get__10(),this.get__11(),this.get__12()).length(),this.set__10(this.get__10()*t),this.set__11(this.get__11()*t),this.set__12(this.get__12()*t),t=1/W.helpVec.set(this.get__20(),this.get__21(),this.get__22()).length(),this.set__20(this.get__20()*t),this.set__21(this.get__21()*t),this.set__22(this.get__22()*t),this.set__03(0),this.set__13(0),this.set__23(0),this.set__30(0),this.set__31(0),this.set__32(0),this.set__33(1),this},setLookAt:function(t,e,n){var i=e.x-t.x,s=e.y-t.y,r=e.z-t.z,a=1/wt.sqrt(i*i+s*s+r*r);i*=a,r*=a;var l=(s*=a)*n.z-r*n.y,o=r*n.x-i*n.z,h=i*n.y-s*n.x,u=(o*=a=1/wt.sqrt(l*l+o*o+h*h))*r-(h*=a)*s,_=h*i-(l*=a)*r,c=l*s-o*i,d=-t.x*l-t.y*o-t.z*h,g=-t.x*u-t.y*_-t.z*c,f=t.x*i+t.y*s+t.z*r;return this.set__00(l),this.set__10(o),this.set__20(h),this.set__30(d),this.set__01(u),this.set__11(_),this.set__21(c),this.set__31(g),this.set__02(-i),this.set__12(-s),this.set__22(-r),this.set__32(f),this.set__03(0),this.set__13(0),this.set__23(0),this.set__33(1),this},get__00:function(){return this.self._00},set__00:function(t){return this.self._00=t},get__01:function(){return this.self._01},set__01:function(t){return this.self._01=t},get__02:function(){return this.self._02},set__02:function(t){return this.self._02=t},get__03:function(){return this.self._03},set__03:function(t){return this.self._03=t},get__10:function(){return this.self._10},set__10:function(t){return this.self._10=t},get__11:function(){return this.self._11},set__11:function(t){return this.self._11=t},get__12:function(){return this.self._12},set__12:function(t){return this.self._12=t},get__13:function(){return this.self._13},set__13:function(t){return this.self._13=t},get__20:function(){return this.self._20},set__20:function(t){return this.self._20=t},get__21:function(){return this.self._21},set__21:function(t){return this.self._21=t},get__22:function(){return this.self._22},set__22:function(t){return this.self._22=t},get__23:function(){return this.self._23},set__23:function(t){return this.self._23=t},get__30:function(){return this.self._30},set__30:function(t){return this.self._30=t},get__31:function(){return this.self._31},set__31:function(t){return this.self._31=t},get__32:function(){return this.self._32},set__32:function(t){return this.self._32=t},get__33:function(){return this.self._33},set__33:function(t){return this.self._33=t},__class__:W,__properties__:{set__33:"set__33",get__33:"get__33",set__32:"set__32",get__32:"get__32",set__31:"set__31",get__31:"get__31",set__30:"set__30",get__30:"get__30",set__23:"set__23",get__23:"get__23",set__22:"set__22",get__22:"get__22",set__21:"set__21",get__21:"get__21",set__20:"set__20",get__20:"get__20",set__13:"set__13",get__13:"get__13",set__12:"set__12",get__12:"get__12",set__11:"set__11",get__11:"get__11",set__10:"set__10",get__10:"get__10",set__03:"set__03",get__03:"get__03",set__02:"set__02",get__02:"get__02",set__01:"set__01",get__01:"get__01",set__00:"set__00",get__00:"get__00"}};var w=function(t,e,n,i){null==i&&(i=1),null==n&&(n=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=n,this.w=i};(n["iron.math.Quat"]=w).__name__=!0,w.prototype={x:null,y:null,z:null,w:null,fromRotationMat:function(t){var e=t.get__00(),n=t.get__10(),i=t.get__20(),s=t.get__01(),r=t.get__11(),a=t.get__21(),l=t.get__02(),o=t.get__12(),h=t.get__22(),u=e+r+h,_=0;return 0<u?(_=.5/wt.sqrt(u+1),this.w=.25/_,this.x=(o-a)*_,this.y=(i-l)*_,this.z=(s-n)*_):r<e&&h<e?(_=2*wt.sqrt(1+e-r-h),this.w=(o-a)/_,this.x=.25*_,this.y=(n+s)/_,this.z=(i+l)/_):h<r?(_=2*wt.sqrt(1+r-e-h),this.w=(i-l)/_,this.x=(n+s)/_,this.y=.25*_,this.z=(a+o)/_):(_=2*wt.sqrt(1+h-e-r),this.w=(s-n)/_,this.x=(i+l)/_,this.y=(a+o)/_,this.z=.25*_),this},multquats:function(t,e){var n=t.x,i=t.y,s=t.z,r=t.w,a=e.x,l=e.y,o=e.z,h=e.w;return this.x=n*h+r*a+i*o-s*l,this.y=r*l-n*o+i*h+s*a,this.z=r*o+n*l-i*a+s*h,this.w=r*h-n*a-i*l-s*o,this},normalize:function(){var t=wt.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0==t?(this.x=0,this.y=0,this.z=0,this.w=0):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},fromEuler:function(t,e,n){var i=t/2,s=wt.cos(i),r=wt.sin(i);i=e/2;var a=wt.cos(i),l=wt.sin(i);i=n/2;var o=wt.cos(i),h=wt.sin(i);return this.x=r*a*o+s*l*h,this.y=s*l*o+r*a*h,this.z=s*a*h-r*l*o,this.w=s*a*o-r*l*h,this},lerp:function(t,e,n){var i=t.x,s=t.y,r=t.z,a=t.w;return t.dot(e)<0&&(i=-i,s=-s,r=-r,a=-a),this.x=i+(e.x-i)*n,this.y=s+(e.y-s)*n,this.z=r+(e.z-r)*n,this.w=a+(e.w-a)*n,this.normalize()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},__class__:w};var g=function(){};(n["armory.object.Uniforms"]=g).__name__=!0,g.register=function(){At.externalTextureLinks=[g.textureLink],At.externalVec3Links=[g.vec3Link],At.externalFloatLinks=[g.floatLink]},g.textureLink=function(t,e,n){return"_smaaSearch"==n?U.active.embedded.get("smaa_search.png"):"_smaaArea"==n?U.active.embedded.get("smaa_area.png"):"_lensTexture"==n?U.active.embedded.get("lenstexture.jpg"):"_lutTexture"==n?U.active.embedded.get("luttexture.jpg"):"_cloudsTexture"==n?U.active.embedded.get("cloudstexture.png"):null},g.vec3Link=function(t,e,n){return null},g.floatLink=function(t,e,n){return null};var c=function(){};(n["armory.renderpath.Inc"]=c).__name__=!0,c.init=function(t){c.path=t};var f=function(){};(n["armory.renderpath.RenderPathForward"]=f).__name__=!0,f.drawMeshes=function(){f.path.drawMeshes("mesh")},f.init=function(t){f.path=t},f.commands=function(){U.active.lights.length;f.path.setTarget(""),f.path.clearTarget(-1,1),m.drawMeshes()};var m=function(){};(n["armory.renderpath.RenderPathCreator"]=m).__name__=!0,m.get=function(){return m.path=new z,c.init(m.path),f.init(m.path),m.path.commands=f.commands,m.path};var v=function(){};(n["armory.system.Event"]=v).__name__=!0,v.get=function(t){return v.events.get(t)};var V=function(){};(n["armory.system.Logic"]=V).__name__=!0,V.getNode=function(t){for(var e=0,n=V.nodes;e<n.length;){var i=n[e];if(++e,i.id==t)return i}return null},V.getInputLink=function(t){for(var e=0,n=V.links;e<n.length;){var i=n[e];if(++e,i.to_id==t.node_id){var s=V.getNode(t.node_id);if(s.inputs.length<=i.to_socket)return null;if(s.inputs[i.to_socket]==t)return i}}return null},V.getOutputLinks=function(t){for(var e=[],n=0,i=V.links;n<i.length;){var s=i[n];if(++n,s.from_id==t.node_id){var r=V.getNode(t.node_id);if(r.outputs.length<=s.from_socket)continue;r.outputs[s.from_socket]==t&&e.push(s)}}return e},V.safesrc=function(t){return J.replace(t," ","")},V.node_name=function(t){return V.safesrc(t.name)+t.id},V.parse=function(t,e){null==e&&(e=!0),V.nodes=t.nodes,V.links=t.links,V.parsed_nodes=[],V.parsed_labels=new it,V.nodeMap=new it;var n=V.get_root_nodes(t);if(V.tree=new _,e)V.tree.notifyOnAdd(function(){for(var t=0;t<n.length;){var e=n[t];++t,V.build_node(e)}});else for(var i=0;i<n.length;){var s=n[i];++i,V.build_node(s)}return V.tree},V.build_node=function(t){var e=V.node_name(t);if(-1!=V.parsed_nodes.indexOf(e))return e;V.parsed_nodes.push(e);var n=V.createClassInstance(t.type,[V.tree]);V.nodeMap.set(e,n);for(var i=0,s=t.buttons;i<s.length;){var r=s[i];++i,"property0"==r.name&&pt.setProperty(n,r.name,r.data[r.default_value])}for(var a=0,l=t.buttons;a<l.length;){var o=l[a];++a,"property1"==o.name&&pt.setProperty(n,o.name,o.data[o.default_value])}for(var h=0,u=t.buttons;h<u.length;){var _=u[h];++h,"property2"==_.name&&pt.setProperty(n,_.name,_.data[_.default_value])}for(var c=0,d=t.buttons;c<d.length;){var g=d[c];++c,"property3"==g.name&&pt.setProperty(n,g.name,g.data[g.default_value])}for(var f=0,p=t.buttons;f<p.length;){var m=p[f];++f,"property4"==m.name&&pt.setProperty(n,m.name,m.data[m.default_value])}for(var v=null,w=0,b=0,x=t.inputs.length;b<x;){var y=b++,S=t.inputs[y],C=V.getInputLink(S);if(null!=C){var I=V.getNode(C.from_id),T=I.outputs[C.from_socket];v=V.nodeMap.get(V.build_node(I));for(var k=0,B=I.outputs.length;k<B;){var E=k++;if(I.outputs[E]==T){w=E;break}}}else v=V.build_default_node(S),w=0;n.addInput(v,w)}for(var M=0,L=t.outputs;M<L.length;){var A=L[M];++M;var W=[],F=V.getOutputLinks(A);if(null!=F&&0<F.length)for(var O=0;O<F.length;){var R=F[O];++O;var D=V.getNode(R.to_id),N=V.build_node(D);W.push(V.nodeMap.get(N))}else W.push(V.build_default_node(A));n.addOutputs(W)}return e},V.get_root_nodes=function(t){for(var e=[],n=0,i=t.nodes;n<i.length;){var s=i[n];++n;for(var r=!1,a=0,l=s.outputs;a<l.length;){var o=l[a];++a;var h=V.getOutputLinks(o);if(null!=h&&0<h.length){r=!0;break}}r||e.push(s)}return e},V.build_default_node=function(t){var e=null;return"ACTION"==t.type?e=V.createClassInstance("NullNode",[V.tree]):"OBJECT"==t.type?e=V.createClassInstance("ObjectNode",[V.tree,t.default_value]):"ANIMACTION"==t.type?e=V.createClassInstance("StringNode",[V.tree,t.default_value]):"VECTOR"==t.type?(null==t.default_value&&(t.default_value=[0,0,0]),e=V.createClassInstance("VectorNode",[V.tree,t.default_value[0],t.default_value[1],t.default_value[2]])):"RGBA"==t.type?(null==t.default_value&&(t.default_value=[0,0,0]),e=V.createClassInstance("ColorNode",[V.tree,t.default_value[0],t.default_value[1],t.default_value[2],t.default_value[3]])):"RGB"==t.type?(null==t.default_value&&(t.default_value=[0,0,0]),e=V.createClassInstance("ColorNode",[V.tree,t.default_value[0],t.default_value[1],t.default_value[2]])):"VALUE"==t.type?e=V.createClassInstance("FloatNode",[V.tree,t.default_value]):"INT"==t.type?e=V.createClassInstance("IntegerNode",[V.tree,t.default_value]):"BOOLEAN"==t.type?e=V.createClassInstance("BooleanNode",[V.tree,t.default_value]):"STRING"==t.type&&(e=V.createClassInstance("StringNode",[V.tree,t.default_value])),e},V.createClassInstance=function(t,e){var n=q.resolveClass(V.packageName+"."+t);return null==n?null:q.createInstance(n,e)};var x=function(){};(n["armory.system.Starter"]=x).__name__=!0,x.main=function(i,s,r,a,l,o,h,u,_,c){x.tasks=1,x.tasks--,function(){if(!(0<x.tasks)){null==d.raw&&(d.raw={});var t=d.raw;null==t.window_mode&&(t.window_mode=s),null==t.window_resizable&&(t.window_resizable=r),null==t.window_minimizable&&(t.window_minimizable=a),null==t.window_maximizable&&(t.window_maximizable=l),null==t.window_w&&(t.window_w=o),null==t.window_h&&(t.window_h=h),null==t.window_msaa&&(t.window_msaa=u),null==t.window_vsync&&(t.window_vsync=_),g.register();var e=0==t.window_mode?0:1,n=0;t.window_resizable&&(n|=1),t.window_maximizable&&(n|=4),t.window_minimizable&&(n|=2),be.start(new we("ArmorLogic",t.window_w,t.window_h,new Te(null,null,null,null,null,null,null,n,e),new he(null,t.window_vsync,null,null,null,t.window_msaa)),function(t){X.init(function(){U.setActive(i,function(t){z.setActive(c())})})})}}()};var y=function(t){this.onReady=null,this.canvas=null;var o=this;l.call(this),st.getBlob(t+".json",function(l){st.getFont("font_default.ttf",function(t){o.cui=new ui({font:t,theme:hi.light});var n=JSON.parse(l.toString());if(null==n.assets||0==n.assets.length)o.canvas=n;else for(var i=0,e=0,s=n.assets;e<s.length;){var r=[s[e]];++e;var a=r[0].name;st.getImage(a,function(e){return function(t){ai.assetMap.set(e[0].id,t),(i+=1)>=n.assets.length&&(o.canvas=n)}}(r))}})}),this.notifyOnRender2D(function(t){if(null!=o.canvas){for(var e=ai.draw(o.cui,o.canvas,t),n=0;n<e.length;){var i=e[n];++n;var s=v.get(i);if(null!=s)for(var r=0;r<s.length;){var a=s[r];++r,a.onEvent()}}null!=o.onReady&&(o.onReady(),o.onReady=null)}})};(n["armory.trait.internal.CanvasScript"]=y).__name__=!0,y.__super__=l,y.prototype=s(l.prototype,{cui:null,canvas:null,onReady:null,__class__:y});var T=function(){l.call(this)};(n["armory.trait.navigation.Navigation"]=T).__name__=!0,T.__super__=l,T.prototype=s(l.prototype,{__class__:T});var k=function(){l.call(this)};(n["armory.trait.physics.PhysicsWorld"]=k).__name__=!0,k.__super__=l,k.prototype=s(l.prototype,{__class__:k});var B=function(){l.call(this)};(n["armory.trait.physics.RigidBody"]=B).__name__=!0,B.__super__=l,B.prototype=s(l.prototype,{__class__:B});var M=function(){};(n["haxe.IMap"]=M).__name__=!0;var L=function(){};(n["haxe.Log"]=L).__name__=!0,L.formatOutput=function(t,e){var n=gt.string(t);if(null==e)return n;var i=e.fileName+":"+e.lineNumber;if(null!=e&&null!=e.customParams)for(var s=0,r=e.customParams;s<r.length;){var a=r[s];++s,n+=", "+gt.string(a)}return i+": "+n},L.trace=function(t,e){var n=L.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(n)};var A=function(){};(n["haxe._Unserializer.DefaultResolver"]=A).__name__=!0,A.prototype={resolveClass:function(t){return q.resolveClass(t)},resolveEnum:function(t){return q.resolveEnum(t)},__class__:A};var mt=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=mt.DEFAULT_RESOLVER;null==e&&(e=new A,mt.DEFAULT_RESOLVER=e),this.resolver=e};(n["haxe.Unserializer"]=mt).__name__=!0,mt.initCodes=function(){for(var t=[],e=0,n=mt.BASE64.length;e<n;){var i=e++;t[J.fastCodeAt(mt.BASE64,i)]=i}return t},mt.run=function(t){return new mt(t).unserialize()},mt.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,get:function(t){return J.fastCodeAt(this.buf,t)},readDigits:function(){for(var t=0,e=!1,n=this.pos;;){var i=this.get(this.pos);if(J.isEof(i))break;if(45!=i){if(i<48||57<i)break;t=10*t+(i-48),this.pos++}else{if(this.pos!=n)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.get(this.pos);if(J.isEof(e))break;if(!(43<=e&&e<58||101==e||69==e))break;this.pos++}return gt.parseFloat(ht.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new Xt("Invalid object");if(103==this.get(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new Xt("Invalid object key");var n=this.unserialize();pt.setField(t,e,n)}this.pos++},unserializeEnum:function(t,e){if(58!=this.get(this.pos++))throw new Xt("Invalid enum format");var n=this.readDigits();if(0==n)return q.createEnum(t,e);for(var i=[];0<n--;)i.push(this.unserialize());return q.createEnum(t,e,i)},unserialize:function(){switch(this.get(this.pos++)){case 65:var t=this.unserialize(),e=this.resolver.resolveClass(t);if(null==e)throw new Xt("Class not found "+t);return e;case 66:var n=this.unserialize(),i=this.resolver.resolveEnum(n);if(null==i)throw new Xt("Enum not found "+n);return i;case 67:var s=this.unserialize(),r=this.resolver.resolveClass(s);if(null==r)throw new Xt("Class not found "+s);var a=q.createEmptyInstance(r);if(this.cache.push(a),a.hxUnserialize(this),103!=this.get(this.pos++))throw new Xt("Invalid custom data");return a;case 77:var l=new nt;this.cache.push(l);for(this.buf;104!=this.get(this.pos);){var o=this.unserialize();l.set(o,this.unserialize())}return this.pos++,l;case 82:var h=this.readDigits();if(h<0||h>=this.scache.length)throw new Xt("Invalid string reference");return this.scache[h];case 97:this.buf;var u=[];for(this.cache.push(u);;){var _=this.get(this.pos);if(104==_){this.pos++;break}if(117==_){this.pos++;var c=this.readDigits();u[u.length+c-1]=null}else u.push(this.unserialize())}return u;case 98:var d=new it;this.cache.push(d);for(this.buf;104!=this.get(this.pos);){var g=this.unserialize();d.set(g,this.unserialize())}return this.pos++,d;case 99:var f=this.unserialize(),p=this.resolver.resolveClass(f);if(null==p)throw new Xt("Class not found "+f);var m=q.createEmptyInstance(p);return this.cache.push(m),this.unserializeObject(m),m;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var v=this.unserialize(),w=this.resolver.resolveEnum(v);if(null==w)throw new Xt("Enum not found "+v);this.pos++;var b=this.readDigits(),x=q.getEnumConstructs(w)[b];if(null==x)throw new Xt("Unknown enum index "+v+"@"+b);var y=this.unserializeEnum(w,x);return this.cache.push(y),y;case 107:return NaN;case 108:var S=new et;this.cache.push(S);for(this.buf;104!=this.get(this.pos);)S.add(this.unserialize());return this.pos++,S;case 109:return-1/0;case 110:return null;case 111:var C={};return this.cache.push(C),this.unserializeObject(C),C;case 112:return 1/0;case 113:var I=new tt;this.cache.push(I);this.buf;for(var T=this.get(this.pos++);58==T;){var k=this.readDigits();I.set(k,this.unserialize()),T=this.get(this.pos++)}if(104!=T)throw new Xt("Invalid IntMap format");return I;case 114:var B=this.readDigits();if(B<0||B>=this.cache.length)throw new Xt("Invalid reference");return this.cache[B];case 115:var E=this.readDigits(),M=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<E)throw new Xt("Invalid bytes length");var L=mt.CODES;null==L&&(L=mt.initCodes(),mt.CODES=L);for(var A=this.pos,W=3&E,F=3*(E>>2)+(2<=W?W-1:0),O=A+(E-W),R=$.alloc(F),D=0;A<O;){var N=L[J.fastCodeAt(M,A++)],V=L[J.fastCodeAt(M,A++)];R.set(D++,N<<2|V>>4);var H=L[J.fastCodeAt(M,A++)];R.set(D++,V<<4|H>>2);var G=L[J.fastCodeAt(M,A++)];R.set(D++,H<<6|G)}if(2<=W){var P=L[J.fastCodeAt(M,A++)],Z=L[J.fastCodeAt(M,A++)];if(R.set(D++,P<<2|Z>>4),3==W){var X=L[J.fastCodeAt(M,A++)];R.set(D++,Z<<4|X>>2)}}return this.pos+=E,this.cache.push(R),R;case 116:return!0;case 118:var z;return 48<=this.get(this.pos)&&this.get(this.pos)<=57&&48<=this.get(this.pos+1)&&this.get(this.pos+1)<=57&&48<=this.get(this.pos+2)&&this.get(this.pos+2)<=57&&48<=this.get(this.pos+3)&&this.get(this.pos+3)<=57&&45==this.get(this.pos+4)?(z=ht.strDate(ht.substr(this.buf,this.pos,19)),this.pos+=19):z=new Date(this.readFloat()),this.cache.push(z),z;case 119:var Y=this.unserialize(),j=this.resolver.resolveEnum(Y);if(null==j)throw new Xt("Enum not found "+Y);var U=this.unserializeEnum(j,this.unserialize());return this.cache.push(U),U;case 120:throw Xt.wrap(this.unserialize());case 121:var K=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<K)throw new Xt("Invalid string length");var Q=ht.substr(this.buf,this.pos,K);return this.pos+=K,Q=J.urlDecode(Q),this.scache.push(Q),Q;case 122:return 0}throw this.pos--,new Xt("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:mt};var $=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),(this.b.bufferValue=t).hxBytes=this,t.bytes=this.b};(n["haxe.io.Bytes"]=$).__name__=!0,$.alloc=function(t){return new $(new ArrayBuffer(t))},$.ofData=function(t){var e=t.hxBytes;return null!=e?e:new $(t)},$.prototype={length:null,b:null,data:null,get:function(t){return this.b[t]},set:function(t,e){this.b[t]=e},blit:function(t,e,n,i){if(t<0||n<0||i<0||t+i>this.length||n+i>e.length)throw new Xt(G.OutsideBounds);0==n&&i==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(n,n+i),t)},sub:function(t,e){if(t<0||e<0||t+e>this.length)throw new Xt(G.OutsideBounds);return new $(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},initData:function(){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength))},setInt32:function(t,e){this.initData(),this.data.setInt32(t,e,!0)},getString:function(t,e,n){if(t<0||e<0||t+e>this.length)throw new Xt(G.OutsideBounds);null==n&&(n=F.UTF8);var i="",s=this.b,r=t,a=t+e;switch(n._hx_index){case 0:for(;r<a;){var l=s[r++];if(l<128){if(0==l)break;i+=String.fromCodePoint(l)}else if(l<224){var o=(63&l)<<6|127&s[r++];i+=String.fromCodePoint(o)}else if(l<240){var h=(31&l)<<12|(127&s[r++])<<6|127&s[r++];i+=String.fromCodePoint(h)}else{var u=(15&l)<<18|(127&s[r++])<<12|(127&s[r++])<<6|127&s[r++];i+=String.fromCodePoint(u)}}break;case 1:for(;r<a;){var _=s[r++]|s[r++]<<8;i+=String.fromCodePoint(_)}}return i},toString:function(){return this.getString(0,this.length)},getData:function(){return this.b.bufferValue},__class__:$};var F=b["haxe.io.Encoding"]={__ename__:!0,__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:i},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:i}},tt=function(){this.h={}};(n["haxe.ds.IntMap"]=tt).__name__=!0,tt.__interfaces__=[M],tt.prototype={h:null,set:function(t,e){this.h[t]=e},get:function(t){return this.h[t]},exists:function(t){return this.h.hasOwnProperty(t)},__class__:tt};var et=function(){this.length=0};(n["haxe.ds.List"]=et).__name__=!0,et.prototype={h:null,q:null,length:null,add:function(t){var e=new O(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},__class__:et};var O=function(t,e){this.item=t,this.next=e};(n["haxe.ds._List.ListNode"]=O).__name__=!0,O.prototype={item:null,next:null,__class__:O};var nt=function(){this.h={__keys__:{}}};(n["haxe.ds.ObjectMap"]=nt).__name__=!0,nt.__interfaces__=[M],nt.assignId=function(t){return t.__id__=++nt.count},nt.getId=function(t){return t.__id__},nt.prototype={h:null,set:function(t,e){var n=nt.getId(t)||nt.assignId(t);this.h[n]=e,this.h.__keys__[n]=t},__class__:nt};var R=function(t,e){this.map=t,this.keys=e,this.index=0,this.count=e.length};(n["haxe.ds._StringMap.StringMapIterator"]=R).__name__=!0,R.prototype={map:null,keys:null,index:null,count:null,hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:R};var it=function(){this.h={}};(n["haxe.ds.StringMap"]=it).__name__=!0,it.__interfaces__=[M],it.prototype={h:null,rh:null,isReserved:function(t){return null!=wi[t]},set:function(t,e){this.isReserved(t)?this.setReserved(t,e):this.h[t]=e},get:function(t){return this.isReserved(t)?this.getReserved(t):this.h[t]},setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},remove:function(t){return this.isReserved(t)?(t="$"+t,!(null==this.rh||!this.rh.hasOwnProperty(t))&&(delete this.rh[t],!0)):!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},arrayKeys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(e);if(null!=this.rh)for(var e in this.rh)36==e.charCodeAt(0)&&t.push(e.substr(1));return t},iterator:function(){return new R(this,this.arrayKeys())},__class__:it};var D=function(){};(n["haxe.io.Input"]=D).__name__=!0,D.prototype={bigEndian:null,readByte:function(){throw new Xt("Not implemented")},readBytes:function(t,e,n){var i=n,s=t.b;if(e<0||n<0||e+n>t.length)throw new Xt(G.OutsideBounds);try{for(;0<i;)s[e]=this.readByte(),++e,--i}catch(t){var r=t instanceof Xt?t.val:t;if(!(r instanceof H))throw t}return n-i},set_bigEndian:function(t){return this.bigEndian=t},readFullBytes:function(t,e,n){for(;0<n;){var i=this.readBytes(t,e,n);if(0==i)throw new Xt(G.Blocked);e+=i,n-=i}},read:function(t){for(var e=$.alloc(t),n=0;0<t;){var i=this.readBytes(e,n,t);if(0==i)throw new Xt(G.Blocked);n+=i,t-=i}return e},readFloat:function(){return P.i32ToFloat(this.readInt32())},readInt8:function(){var t=this.readByte();return 128<=t?t-256:t},readInt16:function(){var t=this.readByte(),e=this.readByte(),n=this.bigEndian?e|t<<8:t|e<<8;return 0!=(32768&n)?n-65536:n},readUInt16:function(){var t=this.readByte(),e=this.readByte();return this.bigEndian?e|t<<8:t|e<<8},readInt32:function(){var t=this.readByte(),e=this.readByte(),n=this.readByte(),i=this.readByte();return this.bigEndian?i|n<<8|e<<16|t<<24:t|e<<8|n<<16|i<<24},readString:function(t,e){var n=$.alloc(t);return this.readFullBytes(n,0,t),n.getString(0,t,e)},__class__:D,__properties__:{set_bigEndian:"set_bigEndian"}};var N=function(t,e,n){if(null==e&&(e=0),null==n&&(n=t.length-e),e<0||n<0||e+n>t.length)throw new Xt(G.OutsideBounds);this.b=t.b,this.pos=e,this.len=n,this.totlen=n};(n["haxe.io.BytesInput"]=N).__name__=!0,N.__super__=D,N.prototype=s(D.prototype,{b:null,pos:null,len:null,totlen:null,get_position:function(){return this.pos},get_length:function(){return this.totlen},set_position:function(t){return t<0?t=0:t>this.get_length()&&(t=this.get_length()),this.len=this.totlen-t,this.pos=t},readByte:function(){if(0==this.len)throw new Xt(new H);return this.len--,this.b[this.pos++]},readBytes:function(t,e,n){if(e<0||n<0||e+n>t.length)throw new Xt(G.OutsideBounds);if(0==this.len&&0<n)throw new Xt(new H);this.len<n&&(n=this.len);for(var i=this.b,s=t.b,r=0,a=n;r<a;){var l=r++;s[e+l]=i[this.pos+l]}return this.pos+=n,this.len-=n,n},__class__:N,__properties__:s(D.prototype.__properties__,{get_length:"get_length",set_position:"set_position",get_position:"get_position"})});var H=function(){};(n["haxe.io.Eof"]=H).__name__=!0,H.prototype={toString:function(){return"Eof"},__class__:H};var G=b["haxe.io.Error"]={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:i},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:i},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:i},Custom:(S=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:i}},S.__params__=["e"],S)},P=function(){};(n["haxe.io.FPHelper"]=P).__name__=!0,P.i32ToFloat=function(t){return P.helper.setInt32(0,t,!0),P.helper.getFloat32(0,!0)};var Z={};(n["haxe.io._UInt8Array.UInt8Array_Impl_"]=Z).__name__=!0,Z.fromBytes=function(t,e,n){return null==e&&(e=0),null==n&&(n=t.length-e),new Uint8Array(t.getData(),e,n)};var X=function(t){t(),be.notifyOnFrames(X.render),pe.addTimeTask(X.update,0,Zt.get_delta())};(n["iron.App"]=X).__name__=!0,X.w=function(){return o.w()},X.h=function(){return o.h()},X.x=function(){return o.x()},X.y=function(){return o.y()},X.init=function(t){new X(t)},X.update=function(){if(null!=U.active&&U.active.ready&&!X.pauseUpdates){Zt.update(),U.active.updateFrame();for(var t=0,e=X.traitUpdates.length;t<e;){if(0<X.traitInits.length){for(var n=0,i=X.traitInits;n<i.length;){var s=i[n];if(++n,!(0<X.traitInits.length))break;s()}X.traitInits.splice(0,X.traitInits.length)}X.traitUpdates[t](),e<=X.traitUpdates.length?++t:e=X.traitUpdates.length}for(t=0,e=X.traitLateUpdates.length;t<e;)X.traitLateUpdates[t](),e<=X.traitLateUpdates.length?++t:e=X.traitLateUpdates.length;if(null!=X.onEndFrames)for(var r=0,a=X.onEndFrames;r<a.length;){var l=a[r];++r,l()}-1==X.lastw&&(X.lastw=X.w(),X.lasth=X.h()),X.lastw==X.w()&&X.lasth==X.h()||null!=U.active&&null!=U.active.camera&&U.active.camera.buildProjection(),X.lastw=X.w(),X.lasth=X.h()}},X.render=function(t){var e=t[0];if(X.framebuffer=e,null!=U.active&&U.active.ready){if(0<X.traitInits.length){for(var n=0,i=X.traitInits;n<i.length;){var s=i[n];if(++n,!(0<X.traitInits.length))break;s()}X.traitInits.splice(0,X.traitInits.length)}U.active.renderFrame(e.get_g4());for(var r=0,a=X.traitRenders;r<a.length;){var l=a[r];if(++r,!(0<X.traitRenders.length))break;l(e.get_g4())}X.render2D(e)}else X.render2D(e)},X.render2D=function(t){if(0<X.traitRenders2D.length){t.get_g2().begin(!1);for(var e=0,n=X.traitRenders2D;e<n.length;){var i=n[e];if(++e,!(0<X.traitRenders2D.length))break;i(t.get_g2())}t.get_g2().end()}},X.notifyOnInit=function(t){X.traitInits.push(t)},X.removeInit=function(t){ht.remove(X.traitInits,t)},X.notifyOnUpdate=function(t){X.traitUpdates.push(t)},X.removeUpdate=function(t){ht.remove(X.traitUpdates,t)},X.removeLateUpdate=function(t){ht.remove(X.traitLateUpdates,t)},X.removeRender=function(t){ht.remove(X.traitRenders,t)},X.notifyOnRender2D=function(t){X.traitRenders2D.push(t)},X.removeRender2D=function(t){ht.remove(X.traitRenders2D,t)},X.notifyOnReset=function(t){null==X.onResets&&(X.onResets=[]),X.onResets.push(t)},X.notifyOnEndFrame=function(t){null==X.onEndFrames&&(X.onEndFrames=[]),X.onEndFrames.push(t)},X.prototype={__class__:X};var z=function(){this.depthToRenderTarget=new it,this.renderTargets=new it,this.commands=null,this.loading=0,this.paused=!1,this.drawOrder=1,this.lastFrameTime=0,this.viewportScaled=!1,this.scissorSet=!1,this.lastH=0,this.lastW=0,this.isProbe=!1,this.isProbeCube=!1,this.isProbePlanar=!1,this.currentLightIndex=0,this.currentTarget=null,this.frameTime=0,this.frameScissorH=0,this.frameScissorW=0,this.frameScissorY=0,this.frameScissorX=0,this.frameScissor=!1};(n["iron.RenderPath"]=z).__name__=!0,z.setActive=function(t){z.active=t},z.sortMeshesDistance=function(t){t.sort(function(t,e){return t.cameraDistance>=e.cameraDistance?1:-1})},z.sortMeshesShader=function(t){t.sort(function(t,e){return t.materials[0].name>=e.materials[0].name?1:-1})},z.prototype={frameScissor:null,frameScissorX:null,frameScissorY:null,frameScissorW:null,frameScissorH:null,frameTime:null,currentTarget:null,currentFace:null,currentLightIndex:null,isProbePlanar:null,isProbeCube:null,isProbe:null,currentW:null,currentH:null,currentD:null,lastW:null,lastH:null,bindParams:null,meshesSorted:null,scissorSet:null,viewportScaled:null,currentG:null,frameG:null,lastFrameTime:null,drawOrder:null,paused:null,get_ready:function(){return 0==this.loading},loading:null,commands:null,renderTargets:null,depthToRenderTarget:null,getLight:function(t){return 0<U.active.lights.length?U.active.lights[t]:null},renderFrame:function(t){if(this.get_ready()&&!this.paused&&0!=X.w()&&0!=X.h()){0<this.lastW&&(this.lastW!=X.w()||this.lastH!=X.h())&&this.resize(),this.lastW=X.w(),this.lastH=X.h(),this.frameTime=Zt.time()-this.lastFrameTime,this.lastFrameTime=Zt.time();var e=U.active.camera;this.isProbePlanar=null!=e&&null!=e.renderTarget,this.isProbeCube=null!=e&&null!=e.renderTargetCube,this.isProbe=this.isProbePlanar||this.isProbeCube,this.isProbePlanar?this.frameG=e.renderTarget.get_g4():this.isProbeCube?this.frameG=e.renderTargetCube.get_g4():this.frameG=t,this.currentG=this.frameG,this.currentW=X.w(),this.currentH=X.h(),this.currentD=1,this.currentFace=-1,this.meshesSorted=!1;for(var n=this.currentLightIndex=0,i=U.active.lights;n<i.length;){var s=i[n];++n,s.visible&&s.buildMatrix(U.active.camera)}this.commands()}},setTarget:function(t,e,n){if(null==n&&(n=1),""==t)this.currentG=this.frameG,this.currentD=1,this.currentTarget=null,this.currentFace=-1,this.isProbeCube?(this.currentW=U.active.camera.renderTargetCube.get_width(),this.currentH=U.active.camera.renderTargetCube.get_width(),this.begin(this.currentG,null,U.active.camera.currentFace)):(this.currentW=X.w(),this.currentH=X.h(),this.frameScissor&&this.setFrameScissor(),this.begin(this.currentG),this.isProbe||(this.setCurrentViewport(X.w(),X.h()),this.setCurrentScissor(X.w(),X.h())));else{var i=this.renderTargets.get(t);this.currentTarget=i;var s=null;if(null!=e){s=[];for(var r=0;r<e.length;){var a=e[r];++r;var l=this.renderTargets.get(a);s.push(l.image)}}this.currentG=i.isCubeMap?i.cubeMap.get_g4():i.image.get_g4(),this.currentW=i.isCubeMap?i.cubeMap.get_width():i.image.get_width(),this.currentH=i.isCubeMap?i.cubeMap.get_height():i.image.get_height(),i.is3D&&(this.currentD=i.image.get_depth()),this.begin(this.currentG,s,this.currentFace)}if(1!=n){this.viewportScaled=!0;var o=gt.int(this.currentW*n),h=gt.int(this.currentH*n);this.currentG.viewport(0,h,o,h),this.currentG.scissor(0,h,o,h)}else this.viewportScaled&&(this.viewportScaled=!1,this.setCurrentViewport(this.currentW,this.currentH),this.setCurrentScissor(this.currentW,this.currentH));this.bindParams=null},begin:function(t,e,n){null==n&&(n=-1),0<=n?t.beginFace(5-n):t.begin(e)},end:function(t){t.end(),this.scissorSet&&(t.disableScissor(),this.scissorSet=!1),this.bindParams=null},setCurrentViewport:function(t,e){this.currentG.viewport(X.x(),this.currentH-e-X.y(),t,e)},setCurrentScissor:function(t,e){this.currentG.scissor(X.x(),this.currentH-e-X.y(),t,e),this.scissorSet=!0},setFrameScissor:function(){this.frameG.scissor(this.frameScissorX,this.currentH-(this.frameScissorH-this.frameScissorY),this.frameScissorW,this.frameScissorH)},clearTarget:function(t,e){if(-1==t)if(null!=U.active.world)t=U.active.world.raw.background_color;else if(null!=U.active.camera){var n=U.active.camera.data.raw.clear_color;null!=n&&(t=se.fromFloats(n[0],n[1],n[2]))}this.currentG.clear(t,e,null)},drawMeshes:function(t){var e=this.getLight(this.currentLightIndex);if((null==e||e.visible||!(0<this.currentLightIndex))&&(!("shadowmap"==t)||null!=e&&e.data.raw.cast_shadow&&0!=e.data.raw.strength)){0<=this.currentFace&&null!=e&&e.setCubeFace(5-this.currentFace,U.active.camera);var n=this.currentG;this.submitDraw(t),this.end(n)}},submitDraw:function(t){var e=this.getLight(this.currentLightIndex),n=U.active.camera,i=U.active.meshes,s=this.currentG;if(Tt.lastPipeline=null,!this.meshesSorted&&null!=n){for(var r=n.transform.worldx(),a=n.transform.worldy(),l=n.transform.worldz(),o=0;o<i.length;){var h=i[o];++o,h.computeCameraDistance(r,a,l)}1==this.drawOrder?z.sortMeshesShader(i):z.sortMeshesDistance(i),this.meshesSorted=!0}for(var u=0;u<i.length;){var _=i[u];++u,_.render(s,t,n,e,this.bindParams)}},resize:function(){for(var t=this.renderTargets.iterator();t.hasNext();){var e=t.next();0==e.raw.width&&(e.image.unload(),e.image=this.createImage(e.raw,e.depthStencil),""!=e.depthStencilFrom&&e.image.setDepthStencilFrom(this.depthToRenderTarget.get(e.depthStencilFrom).image))}},createImage:function(t,e){var n=0==t.width?X.w():t.width,i=0==t.height?X.h():t.height,s=null!=t.depth?t.depth:0;if(null!=t.displayp&&(i<n?(n=gt.int(n*(t.displayp/i)),i=t.displayp):(i=gt.int(i*(t.displayp/n)),n=t.displayp)),null!=t.scale&&(n=gt.int(n*t.scale),i=gt.int(i*t.scale),s=gt.int(s*t.scale)),null!=t.depth&&1<t.depth){var r=ne.create3D(n,i,s,null!=t.format?this.getTextureFormat(t.format):xn.RGBA32);return t.mipmaps&&r.generateMipmaps(1e3),r}return null!=t.is_image&&t.is_image?ne.create(n,i,null!=t.format?this.getTextureFormat(t.format):xn.RGBA32):ne.createRenderTarget(n,i,null!=t.format?this.getTextureFormat(t.format):xn.RGBA32,e)},getTextureFormat:function(t){switch(t){case"A16":return xn.A16;case"A32":return xn.A32;case"A8":return xn.L8;case"DEPTH16":return xn.DEPTH16;case"R16":return xn.A16;case"R32":return xn.A32;case"R8":return xn.L8;case"RGBA128":return xn.RGBA128;case"RGBA32":return xn.RGBA32;case"RGBA64":return xn.RGBA64;default:return xn.RGBA32}},__class__:z,__properties__:{get_ready:"get_ready"}};var Y=function(){this.is_image=null,this.depth=null,this.mipmaps=null,this.displayp=null,this.scale=null,this.format=null};(n["iron.RenderTargetRaw"]=Y).__name__=!0,Y.prototype={width:null,height:null,format:null,scale:null,displayp:null,mipmaps:null,depth:null,is_image:null,__class__:Y};var j=function(t){this.isCubeMap=!1,this.is3D=!1,this.cubeMap=null,this.image=null,this.depthStencilFrom="",this.raw=t};(n["iron.RenderTarget"]=j).__name__=!0,j.prototype={raw:null,depthStencil:null,depthStencilFrom:null,image:null,cubeMap:null,is3D:null,isCubeMap:null,__class__:j};var U=function(){this.traitRemoves=[],this.traitInits=[],this.groups=null,this.uid=U.uidCounter++,this.meshes=[],this.lights=[],this.cameras=[],this.speakers=[],this.empties=[],this.animations=[],this.armatures=[],this.embedded=new it,this.root=new xt,this.root.name="Root",this.traitInits=[],this.traitRemoves=[],null==U.global&&(U.global=new xt)};(n["iron.Scene"]=U).__name__=!0,U.create=function(s,r){U.active=new U,U.active.ready=!1,U.active.raw=s,st.getWorld(s.name,s.world_ref,function(t){U.active.world=t,U.active.addScene(s.name,null,function(t){0==U.active.cameras.length&&L.trace('No camera found for scene "'+s.name+'"',{fileName:"Sources/iron/Scene.hx",lineNumber:91,className:"iron.Scene",methodName:"create"}),U.active.camera=U.active.getCamera(s.camera_ref),U.active.ready=!0;for(var e=0,n=U.active.traitInits;e<n.length;){var i=n[e];++e,i()}U.active.traitInits=[],U.active.sceneParent=t,r(t)})})},U.setActive=function(t,e){U.framePassed&&(U.framePassed=!1,null!=U.active&&U.active.remove(),st.getSceneRaw(t,function(t){U.create(t,function(t){null!=e&&e(t)})}))},U.generateTransform=function(t,e){e.world=null!=t.transform?W.fromFloat32Array(t.transform.values):W.identity(),e.world.decompose(e.loc,e.rot,e.scale),null!=t.local_only&&(e.localOnly=t.local_only),null!=e.object.parent&&e.update()},U.createTraits=function(t,e){if(null!=t)for(var n=0;n<t.length;){var i=t[n];if(++n,"Script"==i.type){var s=[];if(null!=i.parameters)for(var r=0,a=i.parameters;r<a.length;){var l=a[r];++r,s.push(U.parseArg(l))}var o=U.createTraitClassInstance(i.class_name,s);if(null==o){L.trace("Error: Trait '"+i.class_name+"' referenced in object '"+e.name+"' not found",{fileName:"Sources/iron/Scene.hx",lineNumber:617,className:"iron.Scene",methodName:"createTraits"});continue}if(null!=i.props)for(var h=0,u=gt.int(i.props.length/2);h<u;){var _=h++,c=i.props[2*_],d=i.props[2*_+1];""!=d&&pt.setProperty(o,c,U.parseArg(d))}e.addTrait(o)}}},U.parseArg=function(t){if("true"==t)return!0;if("false"==t)return!1;if("null"==t)return null;if("'"==t.charAt(0))return J.replace(t,"'","");if('"'==t.charAt(0))return J.replace(t,'"',"");if("["==t.charAt(0)){t=J.replace(t,"[",""),t=J.replace(t,"]","");for(var e=[],n=(t=J.replace(t," ","")).split(","),i=0;i<n.length;){var s=n[i];++i,e.push(U.parseArg(s))}return e}var r=gt.parseFloat(t),a=gt.parseInt(t);return r==a?a:r},U.createConstraints=function(t,e){if(null!=t){e.constraints=[];for(var n=0;n<t.length;){var i=t[n];++n;var s=new Ct(i);e.constraints.push(s)}}},U.createTraitClassInstance=function(t,e){var n=q.resolveClass(t);return null==n?null:q.createInstance(n,e)},U.prototype={uid:null,raw:null,root:null,sceneParent:null,camera:null,world:null,meshes:null,lights:null,cameras:null,speakers:null,empties:null,animations:null,armatures:null,groups:null,embedded:null,ready:null,traitInits:null,traitRemoves:null,remove:function(){for(var t=0,e=this.traitRemoves;t<e.length;){var n=e[t];++t,n()}for(var i=0,s=this.meshes;i<s.length;){var r=s[i];++i,r.remove()}for(var a=0,l=this.lights;a<l.length;){var o=l[a];++a,o.remove()}for(var h=0,u=this.cameras;h<u.length;){var _=u[h];++h,_.remove()}for(var c=0,d=this.speakers;c<d.length;){var g=d[c];++c,g.remove()}for(var f=0,p=this.empties;f<p.length;){var m=p[f];++f,m.remove()}this.groups=null,this.root.remove()},updateFrame:function(){if(this.ready){for(var t=0,e=this.animations;t<e.length;){var n=e[t];++t,n.update(Zt.get_delta())}for(var i=0,s=this.empties;i<s.length;){var r=s[i];++i,null!=r&&null!=r.parent&&r.transform.update()}}},renderFrame:function(t){this.ready&&null!=z.active&&(U.framePassed=!0,null!=this.camera?this.camera.renderFrame(t):z.active.renderFrame(t))},addObject:function(t){var e=new xt;return null!=t?t.addChild(e):this.root.addChild(e),e},getChild:function(t){return this.root.getChild(t)},getCamera:function(t){for(var e=0,n=this.cameras;e<n.length;){var i=n[e];if(++e,i.name==t)return i}return null},addMeshObject:function(t,e,n){var i=new Tt(t,e);return null!=n?n.addChild(i):this.root.addChild(i),i},addLightObject:function(t,e){var n=new It(t);return null!=e?e.addChild(n):this.root.addChild(n),n},addCameraObject:function(t,e){var n=new yt(t);return null!=e?e.addChild(n):this.root.addChild(n),n},addSpeakerObject:function(t,e){var n=new Bt(t);return null!=e?e.addChild(n):this.root.addChild(n),n},addScene:function(t,e,n){var d=this;null==e&&((e=this.addObject()).name=t),st.getSceneRaw(t,function(c){U.createTraits(c.traits,e),d.loadEmbeddedData(c.embedded_datas,function(){var h=0,u=d.getObjectsCount(c.objects),_=null;_=function(t,e,n,i){if(null!=e)for(var s=0,r=e.length;s<r;){var a=[e[s++]];if(null==a[0].spawn||0!=a[0].spawn){var l=a[0],o=function(e){return function(t){null!=t&&_(t,e[0].children,e[0],i),(h+=1)==u&&i()}}(a);d.createObject(l,c,t,n,o)}else(h+=1)==u&&i()}},null==c.objects||0==c.objects.length?n(e):_(e,c.objects,null,function(){n(e)})})})},getObjectsCount:function(t,e){if(null==e&&(e=!0),null==t)return 0;for(var n=t.length,i=0;i<t.length;){var s=t[i];++i,e&&null!=s.spawn&&0==s.spawn||null!=s.children&&(n+=this.getObjectsCount(s.children))}return n},spawnObject:function(t,e,n,a){null==a&&(a=!0);var i=this,l=0,s=this.getObj(this.raw,t),o=a?this.getObjectsCount([s],!1):1,h=null;(h=function(s,t,e,r){i.createObject(s,i.raw,t,e,function(t){if(a&&null!=s.children)for(var e=0,n=s.children;e<n.length;){var i=n[e];++e,h(i,t,s,r)}(l+=1)==o&&null!=r&&r(t)})})(s,e,null,n)},getObj:function(t,e){return this.traverseObjs(t.objects,e)},traverseObjs:function(t,e){for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i;if(null!=i.children){var s=this.traverseObjs(i.children,e);if(null!=s)return s}}return null},createObject:function(_,t,c,d,g){var f=this,p=t.name;if("camera_object"==_.type)st.getCamera(p,_.data_ref,function(t){var e=f.addCameraObject(t,c);f.returnObject(e,_,g)});else if("light_object"==_.type)st.getLight(p,_.data_ref,function(t){var e=f.addLightObject(t,c);f.returnObject(e,_,g)});else if("mesh_object"==_.type)if(null==_.material_refs||0==_.material_refs.length){var e=this.addObject(c);this.returnObject(e,_,g)}else for(var m=new Array(_.material_refs.length),a=0,n=0,i=_.material_refs.length;n<i;){var s=[n++],r=_.material_refs[s[0]],l=function(r){return function(t){if(m[r[0]]=t,(a+=1)==_.material_refs.length){var e=_.data_ref.split("/"),o="",h="";if(2==e.length?(o=e[0],h=e[1]):(o=p,h=_.data_ref),null!=d&&null!=d.bone_actions)for(var u=[],n=0,i=d.bone_actions;n<i.length;){var s=i[n];++n,st.getSceneRaw(s,function(t){if(u.push(t),u.length==d.bone_actions.length){for(var e=null,n=0,i=f.armatures;n<i.length;){var s=i[n];if(++n,s.uid==c.uid){e=s;break}}if(null==e){for(var r=0,a=f.armatures;r<a.length;){var l=a[r];if(++r,l.name==c.name){c.name+="."+c.uid;break}}e=new K(c.uid,c.name,u),f.armatures.push(e)}f.returnMeshObject(o,h,p,e,m,c,_,g)}})}else f.returnMeshObject(o,h,p,null,m,c,_,g)}}}(s);st.getMaterial(p,r,l)}else if("speaker_object"==_.type){var o=this.addSpeakerObject(st.getSpeakerRawByName(t.speaker_datas,_.data_ref),c);this.returnObject(o,_,g)}else if("object"==_.type){var h=this.addObject(c);this.returnObject(h,_,function(e){if(null!=_.group_ref){var n=0,i=f.getGroupObjectRefs(_.group_ref);if(0==i.length)g(e);else for(var t=0;t<i.length;){var s=i[t];++t,f.spawnObject(s,e,function(t){(n+=1)==i.length&&g(e)})}}else g(e)})}else g(null)},getGroupObjectRefs:function(t){for(var e=0,n=this.raw.groups;e<n.length;){var i=n[e];if(++e,i.name==t)return i.object_refs}return null},returnMeshObject:function(t,e,i,s,r,a,l,o){var h=this;st.getMesh(t,e,function(t){if(t.isSkinned){var e=t.geom;null!=s?e.addArmature(s):e.addAction(t.format.objects,"none")}var n=h.addMeshObject(t,r,a);null!=l.tilesheet_ref&&zt.__cast(n,Tt).setupTilesheet(i,l.tilesheet_ref,l.tilesheet_action_ref),h.returnObject(n,l,o)})},returnObject:function(n,i,s){var r=this;if(null!=n&&null!=i.object_actions){for(var a=[];a.length<i.object_actions.length;)a.push(null);for(var l=0,t=0,e=i.object_actions.length;t<e;){var o=[t++],h=i.object_actions[o[0]];"null"!=h?st.getSceneRaw(h,function(e){return function(t){a[e[0]]=t,(l+=1)==i.object_actions.length&&r.returnObjectLoaded(n,i,a,s)}}(o)):l+=1}}else this.returnObjectLoaded(n,i,null,s)},returnObjectLoaded:function(t,e,n,i){if(null!=t){if(t.raw=e,t.name=e.name,null!=e.visible&&(t.visible=e.visible),null!=e.visible_mesh&&(t.visibleMesh=e.visible_mesh),null!=e.visible_shadow&&(t.visibleShadow=e.visible_shadow),U.createConstraints(e.constraints,t),U.generateTransform(e,t.transform),t.setupAnimation(n),null!=e.groups){null==this.groups&&(this.groups=new it);for(var s=0,r=e.groups;s<r.length;){var a=r[s];++s;var l=this.groups.get(a);null==l&&(l=[],this.groups.set(a,l)),l.push(t)}}U.createTraits(e.traits,t)}i(t)},loadEmbeddedData:function(n,i){var s=this;if(null!=n)for(var r=0,t=0;t<n.length;){var e=[n[t]];++t,st.getImage(e[0],function(e){return function(t){s.embedded.set(e[0],t),(r+=1)==n.length&&i()}}(e))}else i()},__class__:U};var K=function(t,e,n){this.actions=[],this.uid=t,this.name=e;for(var i=0;i<n.length;){var s=n[i];++i;for(var r=0,a=s.objects;r<a.length;){var l=a[r];++r,K.setParents(l)}var o=[[]];K.traverseBones(s.objects,function(e){return function(t){e[0].push(t)}}(o)),this.actions.push({name:s.name,bones:o[0],mats:null})}};(n["iron.data.Armature"]=K).__name__=!0,K.setParents=function(t){if(null!=t.children)for(var e=0,n=t.children;e<n.length;){var i=n[e];++e,i.parent=t,K.setParents(i)}},K.traverseBones=function(t,e){for(var n=0,i=t.length;n<i;){var s=n++;K.traverseBonesStep(t[s],e)}},K.traverseBonesStep=function(t,e){if("bone_object"==t.type&&e(t),null!=t.children)for(var n=0,i=t.children.length;n<i;){var s=n++;K.traverseBonesStep(t.children[s],e)}},K.prototype={uid:null,name:null,actions:null,__class__:K};var Q=function(t,e){this.raw=t,this.name=t.name,e(this)};(n["iron.data.CameraData"]=Q).__name__=!0,Q.parse=function(t,n,i){st.getSceneRaw(t,function(t){var e=st.getCameraRawByName(t.camera_datas,n);null==e&&(L.trace('Camera data "'+n+'" not found!',{fileName:"Sources/iron/data/CameraData.hx",lineNumber:20,className:"iron.data.CameraData",methodName:"parse"}),i(null)),new Q(e,i)})},Q.prototype={name:null,raw:null,__class__:Q};var st=function(){};(n["iron.data.Data"]=st).__name__=!0,st.getMesh=function(t,e,n){var s=t+e,i=st.cachedMeshes.get(s);if(null==i){var r=st.loadingMeshes.get(s);null==r?(st.loadingMeshes.set(s,[n]),ut.parse(t,e,function(t){st.cachedMeshes.set(s,t),t.handle=s;for(var e=0,n=st.loadingMeshes.get(s);e<n.length;){var i=n[e];++e,i(t)}st.loadingMeshes.remove(s)})):r.push(n)}else n(i)},st.getLight=function(t,e,n){var s=t+e,i=st.cachedLights.get(s);if(null==i){var r=st.loadingLights.get(s);null==r?(st.loadingLights.set(s,[n]),at.parse(t,e,function(t){st.cachedLights.set(s,t);for(var e=0,n=st.loadingLights.get(s);e<n.length;){var i=n[e];++e,i(t)}st.loadingLights.remove(s)})):r.push(n)}else n(i)},st.getCamera=function(t,e,n){var s=t+e,i=st.cachedCameras.get(s);if(null==i){var r=st.loadingCameras.get(s);null==r?(st.loadingCameras.set(s,[n]),Q.parse(t,e,function(t){st.cachedCameras.set(s,t);for(var e=0,n=st.loadingCameras.get(s);e<n.length;){var i=n[e];++e,i(t)}st.loadingCameras.remove(s)})):r.push(n)}else n(i)},st.getMaterial=function(t,e,n){var s=t+e,i=st.cachedMaterials.get(s);if(null==i){var r=st.loadingMaterials.get(s);null==r?(st.loadingMaterials.set(s,[n]),lt.parse(t,e,function(t){st.cachedMaterials.set(s,t);for(var e=0,n=st.loadingMaterials.get(s);e<n.length;){var i=n[e];++e,i(t)}st.loadingMaterials.remove(s)})):r.push(n)}else n(i)},st.getWorld=function(t,e,n){if(null!=e){var s=t+e,i=st.cachedWorlds.get(s);if(null==i){var r=st.loadingWorlds.get(s);null==r?(st.loadingWorlds.set(s,[n]),dt.parse(t,e,function(t){st.cachedWorlds.set(s,t);for(var e=0,n=st.loadingWorlds.get(s);e<n.length;){var i=n[e];++e,i(t)}st.loadingWorlds.remove(s)})):r.push(n)}else n(i)}else n(null)},st.getShader=function(t,e,n,i){var s=e;null!=i&&(s+="2");var r=st.cachedShaders.get(s);if(null==r){var a=st.loadingShaders.get(s);null==a?(st.loadingShaders.set(s,[n]),_t.parse(t,e,function(t){st.cachedShaders.set(s,t);for(var e=0,n=st.loadingShaders.get(s);e<n.length;){var i=n[e];++e,i(t)}st.loadingShaders.remove(s)},i)):a.push(n)}else n(r)},st.getSceneRaw=function(i,t){var e=st.cachedSceneRaws.get(i);if(null==e){var n=st.loadingSceneRaws.get(i);if(null==n){st.loadingSceneRaws.set(i,[t]);var s=J.endsWith(i,".zip"),r=J.endsWith(i,".json"),a=s||r||J.endsWith(i,".arm")?"":".arm";st.getBlob(i+a,function(t){var e=null;if(r){var n=t.toString();e="{"==n.charAt(0)?JSON.parse(n):Wt.decode(t.toBytes())}else e=Wt.decode(t.toBytes());st.returnSceneRaw(i,e)})}else n.push(t)}else t(e)},st.returnSceneRaw=function(t,e){st.cachedSceneRaws.set(t,e);for(var n=0,i=st.loadingSceneRaws.get(t);n<i.length;){var s=i[n];++n,s(e)}st.loadingSceneRaws.remove(t)},st.getMeshRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},st.getLightRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},st.getCameraRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},st.getMaterialRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},st.getWorldRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},st.getShaderRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},st.getSpeakerRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},st.getBlob=function(s,t){var e=st.cachedBlobs.get(s);if(null==e){var n=st.loadingBlobs.get(s);if(null==n){st.loadingBlobs.set(s,[t]);var i="/"==s.charAt(0)||":"==s.charAt(1)?s:st.dataPath+s;$t.loadBlobFromPath(i,function(t){st.cachedBlobs.set(s,t);for(var e=0,n=st.loadingBlobs.get(s);e<n.length;){var i=n[e];++e,i(t)}st.loadingBlobs.remove(s),st.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:430,className:"iron.data.Data",methodName:"getBlob"})}else n.push(t)}else t(e)},st.getImage=function(s,t,e,n){null==n&&(n="RGBA32"),null==e&&(e=!1);var i=st.cachedImages.get(s);if(null==i){var r=st.loadingImages.get(s);if(null==r){st.loadingImages.set(s,[t]);var a="/"==s.charAt(0)||":"==s.charAt(1)?s:st.dataPath+s;$t.loadImageFromPath(a,e,function(t){st.cachedImages.set(s,t);for(var e=0,n=st.loadingImages.get(s);e<n.length;){var i=n[e];++e,i(t)}st.loadingImages.remove(s),st.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:455,className:"iron.data.Data",methodName:"getImage"})}else r.push(t)}else t(i)},st.getSound=function(t,e){e(null)},st.getFont=function(s,t){var e=st.cachedFonts.get(s);if(null==e){var n=st.loadingFonts.get(s);if(null==n){st.loadingFonts.set(s,[t]);var i="/"==s.charAt(0)||":"==s.charAt(1)?s:st.dataPath+s;$t.loadFontFromPath(i,function(t){st.cachedFonts.set(s,t);for(var e=0,n=st.loadingFonts.get(s);e<n.length;){var i=n[e];++e,i(t)}st.loadingFonts.remove(s),st.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:546,className:"iron.data.Data",methodName:"getFont"})}else n.push(t)}else t(e)};var rt=function(t,e,n,i,s,r,a,l,o,h,u,_,c){this.mats=null,this.actions=null,this.skeletonBoneLens=null,this.skeletonBoneRefs=null,this.skeletonTransformsI=null,this.skinBoneWeights=null,this.skinBoneIndices=null,this.skinBoneCounts=null,this.instanceCount=0,this.instanced=!1,this.instancedVB=null,this.numTris=0,this.ready=!1,this.name="",this.count=-1,this.start=0,this.vertexBufferMap=new it,null==u&&(u=Sn.StaticUsage),this.indices=t,this.materialIndices=e,this.usage=u,this.positions=n,this.normals=i,this.uvs=s,this.uvs1=r,this.cols=a,this.tangents=l,this.bones=o,this.weights=h,this.instancedData=_,this.instancedType=c,this.struct=rt.getVertexStructure(null!=n,null!=i,null!=s,null!=r,null!=a,null!=l,null!=o,null!=h),this.structLength=gt.int(this.struct.byteSize()/4),this.structStr="";for(var d=0,g=this.struct.elements;d<g.length;){var f=g[d];++d,this.structStr+=f.name}};(n["iron.data.Geometry"]=rt).__name__=!0,rt.getVertexStructure=function(t,e,n,i,s,r,a,l){null==l&&(l=!1),null==a&&(a=!1),null==r&&(r=!1),null==s&&(s=!1),null==i&&(i=!1),null==n&&(n=!1),null==e&&(e=!1),null==t&&(t=!1);var o=new kn;return t&&o.add("pos",2),e&&o.add("nor",2),n&&o.add("tex",1),i&&o.add("tex1",1),s&&o.add("col",2),r&&o.add("tang",2),a&&o.add("bone",3),l&&o.add("weight",3),o},rt.buildVertices=function(t,e,n,i,s,r,a,l,o,h,u){null==u&&(u=!1),null==h&&(h=0);for(var _=-1+h,c=0,d=gt.int(e.length/3);c<d;){var g=c++;t[++_]=e[3*g],t[++_]=e[3*g+1],t[++_]=e[3*g+2],null!=n&&(t[++_]=n[3*g],t[++_]=n[3*g+1],t[++_]=n[3*g+2]),null!=i?(t[++_]=i[2*g],t[++_]=i[2*g+1]):u&&(t[++_]=0,t[++_]=0),null!=s&&(t[++_]=s[2*g],t[++_]=s[2*g+1]),null!=r&&(t[++_]=r[3*g],t[++_]=r[3*g+1],t[++_]=r[3*g+2]),null!=a&&(t[++_]=a[3*g],t[++_]=a[3*g+1],t[++_]=a[3*g+2]),null!=l&&(t[++_]=l[4*g],t[++_]=l[4*g+1],t[++_]=l[4*g+2],t[++_]=l[4*g+3]),null!=o&&(t[++_]=o[4*g],t[++_]=o[4*g+1],t[++_]=o[4*g+2],t[++_]=o[4*g+3])}},rt.prototype={vertexBuffer:null,vertexBufferMap:null,indexBuffers:null,start:null,count:null,name:null,ready:null,vertices:null,indices:null,numTris:null,materialIndices:null,struct:null,structLength:null,structStr:null,usage:null,instancedVB:null,instanced:null,instanceCount:null,positions:null,normals:null,uvs:null,uvs1:null,cols:null,tangents:null,bones:null,weights:null,instancedData:null,instancedType:null,skinBoneCounts:null,skinBoneIndices:null,skinBoneWeights:null,skeletonTransformsI:null,skeletonBoneRefs:null,skeletonBoneLens:null,actions:null,mats:null,setupInstanced:function(t,e,n){this.instanced=!0,this.instanceCount=gt.int(t.length/3);var i=new kn;i.instanced=!0,i.add("ipos",2),2!=e&&4!=e||i.add("irot",2),3!=e&&4!=e||i.add("iscl",2),this.instancedVB=new Cn(this.instanceCount,i,n,1);for(var s=this.instancedVB.lock(),r=0,a=s.length;r<a;){var l=r++;s[l]=t[l]}this.instancedVB.unlock()},hasAttrib:function(t,e){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return!0}return!1},get:function(t){for(var e="",n=0;n<t.length;){var i=t[n];++n,e+=i.name}var s=this.vertexBufferMap.get(e);if(null==s){var r=this.hasAttrib("pos",t),a=this.hasAttrib("nor",t),l=this.hasAttrib("tex",t),o=this.hasAttrib("tex1",t),h=this.hasAttrib("col",t),u=this.hasAttrib("tang",t),_=this.hasAttrib("bone",t),c=this.hasAttrib("weight",t),d=rt.getVertexStructure(r,a,l,o,h,u,_,c);s=new Cn(gt.int(this.positions.length/3),d,this.usage),this.vertices=s.lock(),rt.buildVertices(this.vertices,r?this.positions:null,a?this.normals:null,l?this.uvs:null,o?this.uvs1:null,h?this.cols:null,u?this.tangents:null,_?this.bones:null,c?this.weights:null,0,l&&null==this.uvs),s.unlock(),this.vertexBufferMap.set(e,s),l&&null==this.uvs&&L.trace("Armory Warning: Geometry "+this.name+" is missing UV map",{fileName:"Sources/iron/data/Geometry.hx",lineNumber:322,className:"iron.data.Geometry",methodName:"get"}),h&&null==this.cols&&L.trace("Armory Warning: Geometry "+this.name+" is missing vertex colors",{fileName:"Sources/iron/data/Geometry.hx",lineNumber:323,className:"iron.data.Geometry",methodName:"get"})}return s},build:function(){if(!this.ready){this.vertexBuffer=new Cn(gt.int(this.positions.length/3),this.struct,this.usage),this.vertices=this.vertexBuffer.lock(),rt.buildVertices(this.vertices,this.positions,this.normals,this.uvs,this.uvs1,this.cols,this.tangents,this.bones,this.weights),this.vertexBuffer.unlock(),this.vertexBufferMap.set(this.structStr,this.vertexBuffer),this.indexBuffers=[];for(var t=0,e=this.indices;t<e.length;){var n=e[t];if(++t,0!=n.length){var i=new _n(n.length,this.usage);this.numTris+=gt.int(n.length/3),i._data=n,i.unlock(),this.indexBuffers.push(i)}}null!=this.instancedData&&this.setupInstanced(this.instancedData,this.instancedType,this.usage),this.ready=!0}},addArmature:function(t){for(var e=0,n=t.actions;e<n.length;){var i=n[e];++e,this.addAction(i.bones,i.name)}},addAction:function(t,e){if(null!=t&&(null==this.actions&&(this.actions=new it,this.mats=new it),null==this.actions.get(e))){for(var n=[],i=0,s=this.skeletonBoneRefs;i<s.length;){var r=s[i];++i;for(var a=0;a<t.length;){var l=t[a];++a,l.name==r&&n.push(l)}}this.actions.set(e,n);for(var o=[],h=0;h<n.length;){var u=n[h];++h,o.push(W.fromFloat32Array(u.transform.values))}this.mats.set(e,o)}},initSkeletonTransforms:function(t){this.skeletonTransformsI=[];for(var e=0;e<t.length;){var n=t[e];++e;var i=W.fromFloat32Array(n);this.skeletonTransformsI.push(i)}},__class__:rt};var at=function(t,e){this.colorTexture=null;var n=this;this.raw=t,this.name=t.name,null!=t.color_texture?st.getImage(t.color_texture,function(t){n.colorTexture=t,e(n)}):e(this)};(n["iron.data.LightData"]=at).__name__=!0,at.typeToInt=function(t){switch(t){case"area":return 3;case"point":return 1;case"spot":return 2;case"sun":default:return 0}},at.parse=function(t,n,i){st.getSceneRaw(t,function(t){var e=st.getLightRawByName(t.light_datas,n);null==e&&(L.trace('Light data "'+n+'" not found!',{fileName:"Sources/iron/data/LightData.hx",lineNumber:40,className:"iron.data.LightData",methodName:"parse"}),i(null)),new at(e,i)})},at.prototype={name:null,raw:null,colorTexture:null,__class__:at};var lt=function(a,l,t){null==t&&(t=""),this.contexts=null;var o=this;this.uid=++lt.uidCounter,this.raw=a,this.name=a.name;var e=a.shader.split("/"),n="",i="";2==e.length?(n=e[0],i=e[1]):(n=t,i=a.shader),st.getShader(n,i,function(t){for(o.shader=t,o.contexts=[];o.contexts.length<a.contexts.length;)o.contexts.push(null);for(var n=0,e=0,i=a.contexts.length;e<i;){var s=[e++],r=a.contexts[s[0]];new ot(r,function(e){return function(t){o.contexts[e[0]]=t,(n+=1)==a.contexts.length&&l(o)}}(s))}},a.override_context)};(n["iron.data.MaterialData"]=lt).__name__=!0,lt.parse=function(n,i,s){st.getSceneRaw(n,function(t){var e=st.getMaterialRawByName(t.material_datas,i);null==e&&(L.trace('Material data "'+i+'" not found!',{fileName:"Sources/iron/data/MaterialData.hx",lineNumber:58,className:"iron.data.MaterialData",methodName:"parse"}),s(null)),new lt(e,s,n)})},lt.prototype={uid:null,name:null,raw:null,shader:null,contexts:null,getContext:function(t){for(var e=0,n=this.contexts;e<n.length;){var i=n[e];if(++e,ht.substr(i.raw.name,0,t.length)==t)return i}return null},__class__:lt};var ot=function(h,u){this.id=0,this.textures=null;var _=this;if(this.raw=h,this.id=ot.num++,null!=h.bind_textures&&0<h.bind_textures.length){var t=new Array(h.bind_textures.length);this.textures=t;for(var c=0,e=0,n=h.bind_textures.length;e<n;){var i=[e++],s=[h.bind_textures[i[0]]];""!=s[0].file?st.getImage(s[0].file,function(l,o){return function(i){if(_.textures[o[0]]=i,c+=1,null!=l[0].mipmaps){for(var s=[];s.length<l[0].mipmaps.length;)s.push(null);for(var r=0,t=0,e=l[0].mipmaps.length;t<e;){var n=[t++],a=l[0].mipmaps[n[0]];st.getImage(a,function(e,n){return function(t){s[e[0]]=t,(r+=1)==n[0].mipmaps.length&&(i.setMipmaps(s),n[0].mipmaps=null,n[0].generate_mipmaps=!1,c==h.bind_textures.length&&u(_))}}(n,l))}}else 1==l[0].generate_mipmaps&&null!=i&&(i.generateMipmaps(1e3),l[0].mipmaps=null,l[0].generate_mipmaps=!1),c==h.bind_textures.length&&u(_)}}(s,i),!1,null!=s[0].format?s[0].format:"RGBA32"):(c+=1)==h.bind_textures.length&&u(this)}}else u(this)};(n["iron.data.MaterialContext"]=ot).__name__=!0,ot.prototype={raw:null,textures:null,id:null,setTextureParameters:function(t,e,n,i){n.setTextureParameters(t,i,this.raw.bind_textures[e])},__class__:ot};var ut=function(t,e){this.refcount=0,this.raw=t,this.name=t.name;for(var n=[],i=[],s=0,r=t.index_arrays;s<r.length;){var a=r[s];++s,n.push(a.values),i.push(a.material)}var l=this.getVertexArrayValues("pos"),o=this.getVertexArrayValues("nor"),h=this.getVertexArrayValues("tex"),u=this.getVertexArrayValues("tex1"),_=this.getVertexArrayValues("col"),c=this.getVertexArrayValues("tang");this.isSkinned=null!=t.skin;var d=Sn.StaticUsage;null!=t.dynamic_usage&&1==t.dynamic_usage&&(d=Sn.DynamicUsage);var g=d,f=null,p=null;if(this.isSkinned){var m=4*gt.int(l.length/3);f=new Float32Array(m),p=new Float32Array(m);for(var v=0,w=0,b=0,x=gt.int(l.length/3);b<x;){for(var y=b++,S=t.skin.bone_count_array[y],C=v,I=v+S;C<I;){var T=C++;f[w]=t.skin.bone_index_array[T],p[w]=t.skin.bone_weight_array[T],++w}for(var k=S;k<4;){k++;f[w]=0,p[w]=0,++w}v+=S}}this.geom=new rt(n,i,l,o,h,u,_,c,f,p,g,t.instanced_data,t.instanced_type),this.geom.name=this.name,e(this)};(n["iron.data.MeshData"]=ut).__name__=!0,ut.parse=function(t,i,s){st.getSceneRaw(t,function(e){var n=st.getMeshRawByName(e.mesh_datas,i);null==n&&(L.trace('Mesh data "'+i+'" not found!',{fileName:"Sources/iron/data/MeshData.hx",lineNumber:102,className:"iron.data.MeshData",methodName:"parse"}),s(null)),new ut(n,function(t){t.format=e,null!=n.skin&&(t.geom.skinBoneCounts=n.skin.bone_count_array,t.geom.skinBoneIndices=n.skin.bone_index_array,t.geom.skinBoneWeights=n.skin.bone_weight_array,t.geom.skeletonBoneRefs=n.skin.bone_ref_array,t.geom.skeletonBoneLens=n.skin.bone_len_array,t.geom.initSkeletonTransforms(n.skin.transformsI)),s(t)})})},ut.prototype={name:null,raw:null,format:null,geom:null,refcount:null,handle:null,isSkinned:null,getVertexArrayValues:function(t){for(var e=0,n=this.raw.vertex_arrays;e<n.length;){var i=n[e];if(++e,i.attrib==t)return i.values}return null},__class__:ut};var _t=function(n,i,t){this.contexts=[];var s=this;this.raw=n,this.name=n.name;for(var e=0,r=n.contexts;e<r.length;){r[e];++e,this.contexts.push(null)}for(var a=0,l=0,o=n.contexts.length;l<o;){var h=[l++],u=n.contexts[h[0]];new ct(u,function(e){return function(t){s.contexts[e[0]]=t,(a+=1)==n.contexts.length&&i(s)}}(h),t)}};(n["iron.data.ShaderData"]=_t).__name__=!0,_t.parse=function(t,n,i,s){st.getSceneRaw(t,function(t){var e=st.getShaderRawByName(t.shader_datas,n);null==e&&(L.trace('Shader data "'+n+'" not found!',{fileName:"Sources/iron/data/ShaderData.hx",lineNumber:47,className:"iron.data.ShaderData",methodName:"parse"}),i(null)),new _t(e,i,s)})},_t.prototype={name:null,raw:null,contexts:null,getContext:function(t){for(var e=0,n=this.contexts;e<n.length;){var i=n[e];if(++e,i.raw.name==t)return i}return null},__class__:_t};var ct=function(t,e,n){this.instancingType=0,this.raw=t,this.overrideContext=n,"rect"==t.name?(this.structure=ct.getStructureRect(),this.instancingType=0):this.parseVertexStructure(),this.compile(e)};(n["iron.data.ShaderContext"]=ct).__name__=!0,ct.getStructureRect=function(){return null==ct.structureRect&&(ct.structureRect=new kn,ct.structureRect.add("pos",1)),ct.structureRect},ct.prototype={raw:null,pipeState:null,constants:null,textureUnits:null,paramsSet:null,structure:null,instancingType:null,overrideContext:null,compile:function(t){if(null!=this.pipeState&&this.pipeState.delete(),this.pipeState=new gn,this.constants=[],this.textureUnits=[],this.paramsSet=[],0<this.instancingType){var e=new kn;e.add("ipos",2),2!=this.instancingType&&4!=this.instancingType||e.add("irot",2),3!=this.instancingType&&4!=this.instancingType||e.add("iscl",2),e.instanced=!0,this.pipeState.inputLayout=[this.structure,e]}else this.pipeState.inputLayout=[this.structure];if(this.pipeState.depthWrite=this.raw.depth_write,this.pipeState.depthMode=this.getCompareMode(this.raw.compare_mode),null!=this.raw.stencil_mode&&("always"==this.raw.stencil_mode?this.pipeState.stencilMode=$e.Always:"equal"==this.raw.stencil_mode?this.pipeState.stencilMode=$e.Equal:"not_equal"==this.raw.stencil_mode&&(this.pipeState.stencilMode=$e.NotEqual)),null!=this.raw.stencil_pass&&("replace"==this.raw.stencil_pass?this.pipeState.stencilBothPass=fn.Replace:"keep"==this.raw.stencil_pass&&(this.pipeState.stencilBothPass=fn.Keep)),null!=this.raw.stencil_fail&&"keep"==this.raw.stencil_fail&&(this.pipeState.stencilDepthFail=fn.Keep,this.pipeState.stencilFail=fn.Keep),null!=this.raw.stencil_reference_value&&(this.pipeState.stencilReferenceValue=pn.Static(this.raw.stencil_reference_value)),this.pipeState.cullMode=this.getCullMode(this.raw.cull_mode),null!=this.raw.blend_source&&(this.pipeState.blendSource=this.getBlendingFactor(this.raw.blend_source)),null!=this.raw.blend_destination&&(this.pipeState.blendDestination=this.getBlendingFactor(this.raw.blend_destination)),null!=this.raw.blend_operation&&(this.pipeState.blendOperation=this.getBlendingOperation(this.raw.blend_operation)),null!=this.raw.alpha_blend_source&&(this.pipeState.alphaBlendSource=this.getBlendingFactor(this.raw.alpha_blend_source)),null!=this.raw.alpha_blend_destination&&(this.pipeState.alphaBlendDestination=this.getBlendingFactor(this.raw.alpha_blend_destination)),null!=this.raw.alpha_blend_operation&&(this.pipeState.alphaBlendOperation=this.getBlendingOperation(this.raw.alpha_blend_operation)),null!=this.raw.color_write_red&&this.pipeState.set_colorWriteMaskRed(this.raw.color_write_red),null!=this.raw.color_write_green&&this.pipeState.set_colorWriteMaskGreen(this.raw.color_write_green),null!=this.raw.color_write_blue&&this.pipeState.set_colorWriteMaskBlue(this.raw.color_write_blue),null!=this.raw.color_write_alpha&&this.pipeState.set_colorWriteMaskAlpha(this.raw.color_write_alpha),null!=this.raw.color_writes_red)for(var n=0,i=this.raw.color_writes_red.length;n<i;){var s=n++;this.pipeState.colorWriteMasksRed[s]=this.raw.color_writes_red[s]}if(null!=this.raw.color_writes_green)for(var r=0,a=this.raw.color_writes_green.length;r<a;){var l=r++;this.pipeState.colorWriteMasksGreen[l]=this.raw.color_writes_green[l]}if(null!=this.raw.color_writes_blue)for(var o=0,h=this.raw.color_writes_blue.length;o<h;){var u=o++;this.pipeState.colorWriteMasksBlue[u]=this.raw.color_writes_blue[u]}if(null!=this.raw.color_writes_alpha)for(var _=0,c=this.raw.color_writes_alpha.length;_<c;){var d=_++;this.pipeState.colorWriteMasksAlpha[d]=this.raw.color_writes_alpha[d]}if(null!=this.raw.conservative_raster&&(this.pipeState.conservativeRasterization=this.raw.conservative_raster),this.raw.shader_from_source)this.pipeState.fragmentShader=sn.fromSource(this.raw.fragment_shader),this.pipeState.vertexShader=Tn.fromSource(this.raw.vertex_shader),this.finishCompile(t);else{var g=J.replace(this.raw.fragment_shader,".","_");this.pipeState.fragmentShader=pt.field(me,g);var f=J.replace(this.raw.vertex_shader,".","_");if(this.pipeState.vertexShader=pt.field(me,f),null!=this.raw.geometry_shader){var p=J.replace(this.raw.geometry_shader,".","_");this.pipeState.geometryShader=pt.field(me,p)}if(null!=this.raw.tesscontrol_shader){var m=J.replace(this.raw.tesscontrol_shader,".","_");this.pipeState.tessellationControlShader=pt.field(me,m)}if(null!=this.raw.tesseval_shader){var v=J.replace(this.raw.tesseval_shader,".","_");this.pipeState.tessellationEvaluationShader=pt.field(me,v)}this.finishCompile(t)}},finishCompile:function(t){if(null!=this.overrideContext&&null!=this.overrideContext.cull_mode&&(this.pipeState.cullMode=this.getCullMode(this.overrideContext.cull_mode)),this.pipeState.compile(),null!=this.raw.constants)for(var e=0,n=this.raw.constants;e<n.length;){var i=n[e];++e,this.addConstant(i)}if(null!=this.raw.texture_units)for(var s=0,r=this.raw.texture_units;s<r.length;){var a=r[s];++s,this.addTexture(a)}t(this)},sizeToVD:function(t){return 1==t?0:2==t?1:3==t?2:4==t?3:0},parseVertexStructure:function(){this.structure=new kn;for(var t=!1,e=!1,n=!1,i=0,s=this.raw.vertex_structure;i<s.length;){var r=s[i];++i,"ipos"!=r.name?"irot"!=r.name?"iscl"!=r.name?this.structure.add(r.name,this.sizeToVD(r.size)):n=!0:e=!0:t=!0}!t||e||n?t&&e&&!n?this.instancingType=2:t&&!e&&n?this.instancingType=3:t&&e&&n&&(this.instancingType=4):this.instancingType=1},getCompareMode:function(t){switch(t){case"always":return $e.Always;case"equal":return $e.Equal;case"greater":return $e.Greater;case"greater_equal":return $e.GreaterEqual;case"less":return $e.Less;case"less_equal":return $e.LessEqual;case"never":return $e.Never;case"not_equal":return $e.NotEqual;default:return $e.Less}},getCullMode:function(t){switch(t){case"clockwise":return nn.Clockwise;case"none":return nn.None;default:return nn.CounterClockwise}},getBlendingOperation:function(t){switch(t){case"add":return qe.Add;case"max":return qe.Max;case"min":return qe.Min;case"reverse_subtract":return qe.ReverseSubtract;case"subtract":return qe.Subtract;default:return qe.Add}},getBlendingFactor:function(t){switch(t){case"blend_one":return Je.BlendOne;case"blend_zero":return Je.BlendZero;case"destination_alpha":return Je.DestinationAlpha;case"destination_color":return Je.DestinationColor;case"inverse_destination_alpha":return Je.InverseDestinationAlpha;case"inverse_destination_color":return Je.InverseDestinationColor;case"inverse_source_alpha":return Je.InverseSourceAlpha;case"inverse_source_color":return Je.InverseSourceColor;case"source_alpha":return Je.SourceAlpha;case"source_color":return Je.SourceColor;default:return Je.Undefined}},getTextureAddresing:function(t){switch(t){case"mirror":return wn.Mirror;case"repeat":return wn.Repeat;default:return wn.Clamp}},getTextureFilter:function(t){switch(t){case"linear":return bn.LinearFilter;case"point":return bn.PointFilter;default:return bn.AnisotropicFilter}},getMipmapFilter:function(t){switch(t){case"no":return cn.NoMipFilter;case"point":return cn.PointMipFilter;default:return cn.LinearMipFilter}},addConstant:function(t){this.constants.push(this.pipeState.getConstantLocation(t.name))},addTexture:function(t){var e=this.pipeState.getTextureUnit(t.name);this.textureUnits.push(e),this.paramsSet.push(!1)},setTextureParameters:function(t,e,n){var i=this.textureUnits[e];t.setTextureParameters(i,null==n.u_addressing?wn.Repeat:this.getTextureAddresing(n.u_addressing),null==n.v_addressing?wn.Repeat:this.getTextureAddresing(n.v_addressing),null==n.min_filter?bn.LinearFilter:this.getTextureFilter(n.min_filter),null==n.mag_filter?bn.LinearFilter:this.getTextureFilter(n.mag_filter),null==n.mipmap_filter?cn.NoMipFilter:this.getMipmapFilter(n.mipmap_filter))},__class__:ct};var dt=function(t,e){var n=this;this.raw=t,this.name=t.name,null!=t.probe?new ft(t.probe,function(t){n.probe=t,n.loadEnvmap(e)}):this.loadEnvmap(e)};(n["iron.data.WorldData"]=dt).__name__=!0,dt.parse=function(t,n,i){st.getSceneRaw(t,function(t){var e=st.getWorldRawByName(t.world_datas,n);null==e&&(L.trace('World data "'+n+'" not found!',{fileName:"Sources/iron/data/WorldData.hx",lineNumber:49,className:"iron.data.WorldData",methodName:"parse"}),i(null)),new dt(e,i)})},dt.getEmptyIrradiance=function(){if(null==dt.emptyIrr){var t=new Float32Array(28);dt.emptyIrr=t;for(var e=0,n=dt.emptyIrr.length;e<n;){var i=e++;dt.emptyIrr[i]=0}}return dt.emptyIrr},dt.prototype={name:null,raw:null,envmap:null,probe:null,loadEnvmap:function(e){var n=this;null!=this.raw.envmap?st.getImage(this.raw.envmap,function(t){n.envmap=t,e(n)}):e(this)},__class__:dt};var ft=function(l,o){this.radianceMipmaps=[];var h=this;this.raw=l,this.setIrradiance(function(t){h.irradiance=t,null!=l.radiance?st.getImage(l.radiance,function(t){for(h.radiance=t;h.radianceMipmaps.length<l.radiance_mipmaps;)h.radianceMipmaps.push(null);for(var e=l.radiance.substring(l.radiance.length-4),n=l.radiance.substring(0,l.radiance.length-4),i=0,s=0,r=l.radiance_mipmaps;s<r;){var a=[s++];st.getImage(n+"_"+a[0]+e,function(e){return function(t){h.radianceMipmaps[e[0]]=t,(i+=1)==l.radiance_mipmaps&&(h.radiance.setMipmaps(h.radianceMipmaps),o(h))}}(a),!0)}}):o(h)})};(n["iron.data.Probe"]=ft).__name__=!0,ft.prototype={raw:null,radiance:null,radianceMipmaps:null,irradiance:null,setIrradiance:function(i){if(null==this.raw.irradiance){for(var t=[.775966,1.16761,1.498638,.133694,.215281,.056659,-.022268,-.019376,-.010651,279e-6,185e-6,0,0,-393e-6,-775e-6,.010973,.027268,.043918,.085267,.07367,.038877,0,0,0,.135177,.115614,.060794],e=new Float32Array(t.length),n=0,s=e.length;n<s;){var r=n++;e[r]=t[r]}i(e)}else{var a=J.endsWith(this.raw.irradiance,".json")?"":".arm";st.getBlob(this.raw.irradiance+a,function(t){var e=""==a?JSON.parse(t.toString()):Wt.decode(t.toBytes()),n=new Float32Array(28);n[0]=e.irradiance[0],n[1]=e.irradiance[1],n[2]=e.irradiance[2],n[3]=e.irradiance[3],n[4]=e.irradiance[4],n[5]=e.irradiance[5],n[6]=e.irradiance[6],n[7]=e.irradiance[7],n[8]=e.irradiance[8],n[9]=e.irradiance[9],n[10]=e.irradiance[10],n[11]=e.irradiance[11],n[12]=e.irradiance[12],n[13]=e.irradiance[13],n[14]=e.irradiance[14],n[15]=e.irradiance[15],n[16]=e.irradiance[16],n[17]=e.irradiance[17],n[18]=e.irradiance[18],n[19]=e.irradiance[19],n[20]=e.irradiance[20],n[21]=e.irradiance[21],n[22]=e.irradiance[22],n[23]=e.irradiance[23],n[24]=e.irradiance[24],n[25]=e.irradiance[25],n[26]=e.irradiance[26],n[27]=0,i(n)})}},__class__:ft};var vt=function(t,e,n,i,s,r,a,l,o){this.self=new Lt(t,e,n,i,s,r,a,l,o)};(n["iron.math.Mat3"]=vt).__name__=!0,vt.identity=function(){return new vt(1,0,0,0,1,0,0,0,1)},vt.prototype={self:null,setFrom4:function(t){this.set__00(t.get__00()),this.set__01(t.get__01()),this.set__02(t.get__02()),this.set__10(t.get__10()),this.set__11(t.get__11()),this.set__12(t.get__12()),this.set__20(t.get__20()),this.set__21(t.get__21()),this.set__22(t.get__22())},set__00:function(t){return this.self._00=t},set__01:function(t){return this.self._01=t},set__02:function(t){return this.self._02=t},set__10:function(t){return this.self._10=t},set__11:function(t){return this.self._11=t},set__12:function(t){return this.self._12=t},set__20:function(t){return this.self._20=t},set__21:function(t){return this.self._21=t},set__22:function(t){return this.self._22=t},__class__:vt,__properties__:{set__22:"set__22",set__21:"set__21",set__20:"set__20",set__12:"set__12",set__11:"set__11",set__10:"set__10",set__02:"set__02",set__01:"set__01",set__00:"set__00"}};var wt=function(){};(n["iron.math.Math"]=wt).__name__=!0,wt.cos=function(t){return Math.cos(t)},wt.sin=function(t){return Math.sin(t)},wt.sqrt=function(t){return Math.sqrt(t)},wt.tan=function(t){return Math.tan(t)};var bt=function(){this.markerEvents=null,this.lastFrameIndex=-1,this.blendFactor=0,this.blendAction="",this.blendCurrent=0,this.blendTime=0,this.paused=!1,this.onComplete=null,this.frameIndex=0,this.loop=!0,this.speed=1,this.time=0,this.action="",U.active.animations.push(this),this.frameTime=U.active.raw.frame_time,this.play()};(n["iron.object.Animation"]=bt).__name__=!0,bt.prototype={isSkinned:null,isSampled:null,action:null,time:null,speed:null,loop:null,frameIndex:null,onComplete:null,paused:null,frameTime:null,blendTime:null,blendCurrent:null,blendAction:null,blendFactor:null,lastFrameIndex:null,markerEvents:null,play:function(t,e,n,i,s){null==s&&(s=!0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=""),0<n?(this.blendTime=n,this.blendCurrent=0,this.blendAction=this.action):this.frameIndex=-1,this.action=t,this.onComplete=e,this.speed=i,this.loop=s,this.paused=!1},remove:function(){ht.remove(U.active.animations,this)},update:function(t){this.paused||0==this.speed||(this.time+=t*this.speed,0<this.blendTime&&0==this.blendFactor&&(this.blendCurrent+=t,this.blendCurrent>=this.blendTime&&(this.blendTime=0)))},isTrackEnd:function(t){return 0<this.speed?this.frameIndex>=t.frames.length-1:this.frameIndex<=0},checkFrameIndex:function(t){return 0<this.speed?this.frameIndex+1<t.length&&this.time>t[this.frameIndex+1]*this.frameTime:-1<this.frameIndex-1&&this.time<t[this.frameIndex-1]*this.frameTime},rewind:function(t){this.frameIndex=0<this.speed?0:t.frames.length-1,this.time=t.frames[this.frameIndex]*this.frameTime},updateTrack:function(t){if(null!=t){var e=t.tracks[0];-1==this.frameIndex&&this.rewind(e);for(var n=0<this.speed?1:-1;this.checkFrameIndex(e.frames);)this.frameIndex+=n;if(null!=this.markerEvents&&null!=t.marker_names&&this.frameIndex!=this.lastFrameIndex){for(var i=0,s=t.marker_frames.length;i<s;){var r=i++;if(this.frameIndex==t.marker_frames[r])for(var a=this.markerEvents.get(t.marker_names[r]),l=0;l<a.length;){var o=a[l];++l,o()}}this.lastFrameIndex=this.frameIndex}this.isTrackEnd(e)&&(this.loop||0<this.blendTime?this.rewind(e):(this.frameIndex-=n,this.paused=!0),null!=this.onComplete&&0==this.blendTime&&this.onComplete())}},updateAnimSampled:function(t,e){if(null!=t){var n=t.tracks[0],i=0<this.speed?1:-1,s=this.time,r=this.frameIndex,a=n.frames[r]*this.frameTime,l=(s-a)/(n.frames[r+i]*this.frameTime-a);bt.m1.setF32(n.values,16*r),bt.m2.setF32(n.values,16*(r+i)),bt.m1.decompose(bt.vpos,bt.q1,bt.vscl),bt.m2.decompose(bt.vpos2,bt.q2,bt.vscl2),bt.vp.lerp(bt.vpos,bt.vpos2,l),bt.vs.lerp(bt.vscl,bt.vscl2,l),bt.q3.lerp(bt.q1,bt.q2,l),e.fromQuat(bt.q3),e.scale(bt.vs),e.set__30(bt.vp.x),e.set__31(bt.vp.y),e.set__32(bt.vp.z)}},__class__:bt};var xt=function(){this.isEmpty=!1,this.culledShadow=!1,this.culledMesh=!1,this.culled=!1,this.visibleShadow=!0,this.visibleMesh=!0,this.visible=!0,this.animation=null,this.lods=null,this.children=[],this.parent=null,this.traits=[],this.constraints=null,this.name="",this.raw=null,this.uid=xt.uidCounter++,this.urandom=xt.seededRandom(),this.transform=new Mt(this),this.isEmpty=q.getClass(this)==xt,this.isEmpty&&null!=U.active&&U.active.empties.push(this)};(n["iron.object.Object"]=xt).__name__=!0,xt.seededRandom=function(){return xt.seed=(9301*xt.seed+49297)%233280,xt.seed/233280},xt.prototype={uid:null,urandom:null,raw:null,name:null,transform:null,constraints:null,traits:null,parent:null,children:null,lods:null,animation:null,visible:null,visibleMesh:null,visibleShadow:null,culled:null,culledMesh:null,culledShadow:null,isEmpty:null,addChild:function(t,e){null==e&&(e=!1),t.parent!=this&&(this.children.push(t),t.parent=this,e&&t.transform.applyParentInverse())},remove:function(){for(this.isEmpty&&null!=U.active&&ht.remove(U.active.empties,this),null!=this.animation&&this.animation.remove();0<this.children.length;)this.children[0].remove();for(;0<this.traits.length;)this.traits[0].remove();null!=this.parent&&(ht.remove(this.parent.children,this),this.parent=null)},getChild:function(t){if(this.name==t)return this;for(var e=0,n=this.children;e<n.length;){var i=n[e];++e;var s=i.getChild(t);if(null!=s)return s}return null},addTrait:function(t){if(this.traits.push(t),t.object=this,null!=t._add){for(var e=0,n=t._add;e<n.length;){var i=n[e];++e,i()}t._add=null}},removeTrait:function(t){if(null!=t._init){for(var e=0,n=t._init;e<n.length;){var i=n[e];++e,X.removeInit(i)}t._init=null}if(null!=t._update){for(var s=0,r=t._update;s<r.length;){var a=r[s];++s,X.removeUpdate(a)}t._update=null}if(null!=t._lateUpdate){for(var l=0,o=t._lateUpdate;l<o.length;){var h=o[l];++l,X.removeLateUpdate(h)}t._lateUpdate=null}if(null!=t._render){for(var u=0,_=t._render;u<_.length;){var c=_[u];++u,X.removeRender(c)}t._render=null}if(null!=t._render2D){for(var d=0,g=t._render2D;d<g.length;){var f=g[d];++d,X.removeRender2D(f)}t._render2D=null}if(null!=t._remove){for(var p=0,m=t._remove;p<m.length;){var v=m[p];++p,v()}t._remove=null}ht.remove(this.traits,t)},setupAnimation:function(t){null!=t&&(this.animation=new kt(this,t))},__class__:xt};var yt=function(t){this.currentFace=0,this.renderTargetCube=null,this.renderTarget=null,this.frustumPlanes=null,this.prevV=null,xt.call(this),this.data=t,this.buildProjection(),this.V=W.identity(),this.VP=W.identity(),t.raw.frustum_culling&&(this.frustumPlanes=[],this.frustumPlanes.push(new St),this.frustumPlanes.push(new St),this.frustumPlanes.push(new St),this.frustumPlanes.push(new St),this.frustumPlanes.push(new St),this.frustumPlanes.push(new St)),U.active.cameras.push(this)};(n["iron.object.CameraObject"]=yt).__name__=!0,yt.buildViewFrustum=function(t,e){var n=t.get__03()+t.get__00(),i=t.get__13()+t.get__10(),s=t.get__23()+t.get__20(),r=t.get__33()+t.get__30();e[0].setComponents(n,i,s,r);var a=t.get__03()-t.get__00(),l=t.get__13()-t.get__10(),o=t.get__23()-t.get__20(),h=t.get__33()-t.get__30();e[1].setComponents(a,l,o,h);var u=t.get__03()-t.get__01(),_=t.get__13()-t.get__11(),c=t.get__23()-t.get__21(),d=t.get__33()-t.get__31();e[2].setComponents(u,_,c,d);var g=t.get__03()+t.get__01(),f=t.get__13()+t.get__11(),p=t.get__23()+t.get__21(),m=t.get__33()+t.get__31();e[3].setComponents(g,f,p,m);var v=t.get__02(),w=t.get__12(),b=t.get__22(),x=t.get__32();e[4].setComponents(v,w,b,x);var y=t.get__03()-t.get__02(),S=t.get__13()-t.get__12(),C=t.get__23()-t.get__22(),I=t.get__33()-t.get__32();e[5].setComponents(y,S,C,I);for(var T=0;T<e.length;){var k=e[T];++T,k.normalize()}},yt.sphereInFrustum=function(t,e,n,i,s,r){null==r&&(r=0),null==s&&(s=0),null==i&&(i=0),null==n&&(n=1);for(var a=e.radius*n,l=0;l<t.length;){var o=t[l];if(++l,yt.sphereCenter.set(e.worldx()+i,e.worldy()+s,e.worldz()+r),o.distanceToSphere(yt.sphereCenter,a)+2*a<0)return!1}return!0},yt.setCubeFace=function(t,e,n){switch(yt.vcenter.setFrom(e),n){case 0:yt.vcenter.addf(1,0,0),yt.vup.set(0,-1,0);break;case 1:yt.vcenter.addf(-1,0,0),yt.vup.set(0,-1,0);break;case 2:yt.vcenter.addf(0,1,0),yt.vup.set(0,0,1);break;case 3:yt.vcenter.addf(0,-1,0),yt.vup.set(0,0,-1);break;case 4:yt.vcenter.addf(0,0,1),yt.vup.set(0,-1,0);break;case 5:yt.vcenter.addf(0,0,-1),yt.vup.set(0,-1,0)}t.setLookAt(e,yt.vcenter,yt.vup)},yt.__super__=xt,yt.prototype=s(xt.prototype,{data:null,P:null,V:null,prevV:null,VP:null,frustumPlanes:null,renderTarget:null,renderTargetCube:null,currentFace:null,buildProjection:function(t){if(null!=this.data.raw.ortho)this.P=W.ortho(this.data.raw.ortho[0],this.data.raw.ortho[1],this.data.raw.ortho[2],this.data.raw.ortho[3],this.data.raw.near_plane,this.data.raw.far_plane);else{null==t&&(t=X.w()/X.h());var e=null!=this.data.raw.aspect?this.data.raw.aspect:t;this.P=W.persp(this.data.raw.fov,e,this.data.raw.near_plane,this.data.raw.far_plane)}},remove:function(){ht.remove(U.active.cameras,this),xt.prototype.remove.call(this)},renderFrame:function(t){this.buildMatrix(),null==this.prevV&&(this.prevV=W.identity(),this.prevV.setFrom(this.V)),z.active.renderFrame(t),this.prevV.setFrom(this.V)},buildMatrix:function(){this.transform.buildMatrix();var t=this.transform.world.getScale();1==t.x&&1==t.y&&1==t.z||(yt.temp.set(1/t.x,1/t.y,1/t.z),this.transform.world.scale(yt.temp)),this.V.getInverse(this.transform.world),this.VP.multmats(this.P,this.V),this.data.raw.frustum_culling&&yt.buildViewFrustum(this.VP,this.frustumPlanes)},rightWorld:function(){return new E(this.transform.world.get__00(),this.transform.world.get__01(),this.transform.world.get__02())},upWorld:function(){return new E(this.transform.world.get__10(),this.transform.world.get__11(),this.transform.world.get__12())},lookWorld:function(){return new E(-this.transform.world.get__20(),-this.transform.world.get__21(),-this.transform.world.get__22())},__class__:yt});var St=function(){this.constant=0,this.normal=new E(1,0,0)};(n["iron.object.FrustumPlane"]=St).__name__=!0,St.prototype={normal:null,constant:null,normalize:function(){var t=1/this.normal.length();this.normal.mult(t),this.constant*=t},distanceToSphere:function(t,e){return this.normal.dot(t)+this.constant-e},setComponents:function(t,e,n,i){this.normal.set(t,e,n),this.constant=i},__class__:St};var Ct=function(t){this.target=null,this.raw=t};(n["iron.object.Constraint"]=Ct).__name__=!0,Ct.prototype={raw:null,target:null,apply:function(t){if(null==this.target&&null!=this.raw.target&&(this.target=U.active.getChild(this.raw.target).transform),"COPY_LOCATION"==this.raw.type){if(this.raw.use_x&&(t.world.set__30(this.target.loc.x),this.raw.use_offset)){var e=t.world;e.set__30(e.get__30()+t.loc.x)}if(this.raw.use_y&&(t.world.set__31(this.target.loc.y),this.raw.use_offset)){var n=t.world;n.set__31(n.get__31()+t.loc.y)}if(this.raw.use_z&&(t.world.set__32(this.target.loc.z),this.raw.use_offset)){var i=t.world;i.set__32(i.get__32()+t.loc.z)}}},__class__:Ct};var It=function(t){this.frustumPlanes=null,this.VP=W.identity(),this.P=null,this.V=W.identity(),this.camSlicedP=null,xt.call(this);var e=(this.data=t).raw.type,n=t.raw.fov;"sun"==e?(null==It.corners&&(It.corners=[],It.corners.push(new E),It.corners.push(new E),It.corners.push(new E),It.corners.push(new E),It.corners.push(new E),It.corners.push(new E),It.corners.push(new E),It.corners.push(new E)),this.P=W.identity()):"point"==e||"area"==e?this.P=W.persp(n,1,t.raw.near_plane,t.raw.far_plane):"spot"==e&&(this.P=W.persp(n,1,t.raw.near_plane,t.raw.far_plane)),U.active.lights.push(this)};(n["iron.object.LightObject"]=It).__name__=!0,It.setCorners=function(){It.corners[0].set(-1,-1,1),It.corners[1].set(-1,-1,-1),It.corners[2].set(-1,1,1),It.corners[3].set(-1,1,-1),It.corners[4].set(1,-1,1),It.corners[5].set(1,-1,-1),It.corners[6].set(1,1,1),It.corners[7].set(1,1,-1)},It.__super__=xt,It.prototype=s(xt.prototype,{camSlicedP:null,data:null,V:null,P:null,VP:null,frustumPlanes:null,remove:function(){null!=U.active&&ht.remove(U.active.lights,this),xt.prototype.remove.call(this)},buildMatrix:function(t){this.transform.buildMatrix(),"sun"==this.data.raw.type?this.setCascade(t,0):(this.V.getInverse(this.transform.world),this.updateViewFrustum(t))},setCascade:function(t,e){if(It.m.setFrom(t.V),null==this.camSlicedP){var n=t.data.raw.ortho;if(null==n){var i=t.data.raw.fov,s=this.data.raw.near_plane,r=this.data.raw.far_plane,a=null!=t.data.raw.aspect?t.data.raw.aspect:X.w()/X.h();this.camSlicedP=W.persp(i,a,s,r)}else this.camSlicedP=W.ortho(n[0],n[1],n[2],n[3],this.data.raw.near_plane,this.data.raw.far_plane)}It.m.multmat(this.camSlicedP),It.m.getInverse(It.m),this.V.getInverse(this.transform.world),this.V.toRotation(),It.m.multmat(this.V),It.setCorners();for(var l=0,o=It.corners;l<o.length;){var h=o[l];++l,h.applymat4(It.m),h.set(h.x/h.w,h.y/h.w,h.z/h.w)}for(var u=It.corners[0].x,_=It.corners[0].y,c=It.corners[0].z,d=It.corners[0].x,g=It.corners[0].y,f=It.corners[0].z,p=0,m=It.corners;p<m.length;){var v=m[p];++p,v.x<u&&(u=v.x),v.x>d&&(d=v.x),v.y<_&&(_=v.y),v.y>g&&(g=v.y),v.z<c&&(c=v.z),v.z>f&&(f=v.z)}var w=E.distance(It.corners[0],It.corners[7]),b=.5*(w-(d-u)),x=.5*(w-(g-_));u-=b,d+=b,_-=x,g+=x;var y=this.data.raw.shadowmap_size,S=(d-u)/y,C=(g-_)/y,I=(f-c)/y;u=Math.floor(u/S)*S,_=Math.floor(_/C)*C,c=Math.floor(c/I)*I,d=Math.floor(d/S)*S,g=Math.floor(g/C)*C,f=Math.floor(f/I)*I;var T=(d-u)/2*It.cascadeBounds,k=(g-_)/2*It.cascadeBounds,B=(f-c)/2*It.cascadeBounds;this.V.set__30(-(u+T)),this.V.set__31(-(_+k)),this.V.set__32(-(c+B)),It.m=W.ortho(-T,T,-k,k,4*-B,B),this.P.setFrom(It.m),this.updateViewFrustum(t)},updateViewFrustum:function(t){this.VP.multmats(this.P,this.V),t.data.raw.frustum_culling&&(null==this.frustumPlanes&&(this.frustumPlanes=[],this.frustumPlanes.push(new St),this.frustumPlanes.push(new St),this.frustumPlanes.push(new St),this.frustumPlanes.push(new St),this.frustumPlanes.push(new St),this.frustumPlanes.push(new St)),yt.buildViewFrustum(this.VP,this.frustumPlanes))},setCubeFace:function(t,e){It.eye.set(this.transform.worldx(),this.transform.worldy(),this.transform.worldz()),yt.setCubeFace(this.V,It.eye,t),this.updateViewFrustum(e)},look:function(){return new E(this.V.get__02(),this.V.get__12(),this.V.get__22())},__class__:It});var Tt=function(t,e){this.force_context=null,this.skip_context=null,this.tilesheet=null,this.frustumCulling=!0,this.screenSize=0,this.data=null,xt.call(this),this.materials=e,this.setData(t),U.active.meshes.push(this)};(n["iron.object.MeshObject"]=Tt).__name__=!0,Tt.__super__=xt,Tt.prototype=s(xt.prototype,{data:null,materials:null,cameraDistance:null,screenSize:null,frustumCulling:null,tilesheet:null,skip_context:null,force_context:null,setData:function(t){(this.data=t).refcount++,t.geom.build()},remove:function(){null!=this.tilesheet&&this.tilesheet.remove(),null!=U.active&&ht.remove(U.active.meshes,this),this.data.refcount--,xt.prototype.remove.call(this)},setupAnimation:function(t){xt.prototype.setupAnimation.call(this,t)},setupTilesheet:function(t,e,n){this.tilesheet=new Et(t,e,n)},isLodMaterial:function(){return null!=this.raw&&null!=this.raw.lod_material&&1==this.raw.lod_material},setCulled:function(t,e){return t?this.culledShadow=e:this.culledMesh=e,this.culled=this.culledMesh&&this.culledShadow,e},cullMaterial:function(t){var e=this.materials;if(!this.isLodMaterial()&&!this.validContext(e[0],t))return!0;var n="shadowmap"==t;return this.visibleMesh||n?!this.visibleShadow&&n?this.setCulled(n,!0):this.skipContext(t)?this.setCulled(n,!0):this.setCulled(n,!1):this.setCulled(n,!0)},cullMesh:function(t,e,n){if(null==e)return!1;if(e.data.raw.frustum_culling&&this.frustumCulling){var i=this.data.isSkinned?2:1;"voxel"==t&&(i*=100);var s="shadowmap"==t,r=s?n.frustumPlanes:e.frustumPlanes;if(s&&"sun"!=n.data.raw.type&&(n.transform.radius=n.data.raw.far_plane,!yt.sphereInFrustum(e.frustumPlanes,n.transform)))return this.setCulled(s,!0);if(!this.data.geom.instanced&&!yt.sphereInFrustum(r,this.transform,i))return this.setCulled(s,!0)}return this.culled=!1,this.culled},skipContext:function(t){if(this.skip_context==t)return!0;if(null!=this.force_context&&this.force_context!=t)return!0;for(var e=0,n=this.materials;e<n.length;){var i=n[e];if(++e,null!=i.raw.skip_context&&i.raw.skip_context==t)return!0}return"voxel"==t&&1==this.raw.mobile},getContexts:function(t,e,n,i){for(var s=0;s<e.length;){var r=e[s];++s;for(var a=0,l=r.raw.contexts.length;a<l;){var o=a++;if(ht.substr(r.raw.contexts[o].name,0,t.length)==t){n.push(r.contexts[o]),i.push(r.shader.getContext(t));break}}}},render:function(t,e,n,i,s){if(null!=this.data&&this.data.geom.ready&&this.visible&&!this.cullMesh(e,n,i)){this.raw;if(null!=this.tilesheet&&this.tilesheet.update(),!this.cullMaterial(e)){var r=this.materials,a=this;if(null!=this.raw&&null!=this.raw.lods&&0<this.raw.lods.length){if(this.computeScreenSize(n),this.initLods(),"voxel"==e)a=this.lods[this.lods.length-1];else for(var l=0,o=this.raw.lods.length;l<o;){var h=l++;if(this.screenSize>this.raw.lods[h].screen_size)break;a=this.lods[h],this.isLodMaterial()&&(r=a.materials)}if(null==a)return}if(!this.isLodMaterial()||this.validContext(r[0],e)){var u=[],_=[];this.getContexts(e,r,u,_),this.transform.update();for(var c=a.data,d=0,g=c.geom.indexBuffers.length;d<g;){var f=d++,p=c.geom.materialIndices[f];if(!(_.length<=p)){var m=_[p],v=m.raw.vertex_structure;m.pipeState!=Tt.lastPipeline&&(t.setPipeline(m.pipeState),Tt.lastPipeline=m.pipeState,At.setContextConstants(t,m,n,i,s)),At.setObjectConstants(t,m,this,n,i),p<u.length&&At.setMaterialConstants(t,m,u[p]),c.geom.instanced?t.setVertexBuffers([c.geom.get(v),c.geom.instancedVB]):t.setVertexBuffer(c.geom.get(v)),t.setIndexBuffer(c.geom.indexBuffers[f]),c.geom.instanced?t.drawIndexedVerticesInstanced(c.geom.instanceCount,c.geom.start,c.geom.count):t.drawIndexedVertices(c.geom.start,c.geom.count)}}}}}},validContext:function(t,e){return null!=t.getContext(e)},computeCameraDistance:function(t,e,n){this.cameraDistance=E.distancef(t,e,n,this.transform.worldx(),this.transform.worldy(),this.transform.worldz())},computeScreenSize:function(t){var e=this.transform,n=e.dim.x*e.dim.y*e.dim.z;this.screenSize=n*(1/this.cameraDistance),this.screenSize=1<this.screenSize?1:this.screenSize},initLods:function(){if(null==this.lods){this.lods=[];for(var t=0,e=this.raw.lods;t<e.length;){var n=e[t];++t,""==n.object_ref?this.lods.push(null):this.lods.push(U.active.getChild(n.object_ref))}}},__class__:Tt});var kt=function(t,e){this.bezierFrameIndex=-1,this.s0=0,this.object=t,this.oactions=e,this.isSkinned=!1,bt.call(this)};(n["iron.object.ObjectAnimation"]=kt).__name__=!0,kt.__super__=bt,kt.prototype=s(bt.prototype,{object:null,oactions:null,oaction:null,getAction:function(t){for(var e=0,n=this.oactions;e<n.length;){var i=n[e];if(++e,null!=i&&i.objects[0].name==t)return i.objects[0]}return null},play:function(t,e,n,i,s){null==s&&(s=!0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=""),bt.prototype.play.call(this,t,e,n,i,s),""==this.action&&null!=this.oactions[0]&&(this.action=this.oactions[0].objects[0].name),this.oaction=this.getAction(this.action),null!=this.oaction&&(this.isSampled=null!=this.oaction.sampled&&this.oaction.sampled)},update:function(t){this.object.visible&&!this.object.culled&&null!=this.oaction&&(bt.prototype.update.call(this,t),this.paused||this.isSkinned||this.updateObjectAnim())},updateObjectAnim:function(){if(this.isSampled){this.updateTrack(this.oaction.anim),this.updateAnimSampled(this.oaction.anim,this.object.transform.world),this.object.transform.world.decompose(this.object.transform.loc,this.object.transform.rot,this.object.transform.scale);for(var t=0,e=this.object.children;t<e.length;){var n=e[t];++t,n.transform.buildMatrix()}}else this.updateAnimNonSampled(this.oaction.anim,this.object.transform),this.object.transform.buildMatrix()},interpolateLinear:function(t,e,n,i,s){var r=(t-e)/(n-e);return(1-r)*i+r*s},s0:null,bezierFrameIndex:null,interpolateBezier:function(t,e,n,i,s,r,a,l,o){this.frameIndex!=this.bezierFrameIndex&&(this.bezierFrameIndex=this.frameIndex,this.s0=(t-e)/(n-e));var h=(n-3*a+3*r-e)*(this.s0*this.s0*this.s0)+3*(a-2*r+e)*(this.s0*this.s0)+3*(r-e)*this.s0+e-t,u=3*(n-3*a+3*r-e)*(this.s0*this.s0)+6*(a-2*r+e)*this.s0+3*(r-e),_=this.s0-h/u;return(1-(this.s0=_))*(1-_)*(1-_)*i+3*_*(1-_)*(1-_)*l+_*_*3*(1-_)*o+_*_*_*s},isTrackEnd:function(t){return 0<this.speed?this.frameIndex>=t.frames.length-2:this.frameIndex<=0},checkFrameIndexT:function(t,e){return 0<this.speed?this.frameIndex<t.length-2&&e>t[this.frameIndex+1]*this.frameTime:1<this.frameIndex&&e>t[this.frameIndex-1]*this.frameTime},updateAnimNonSampled:function(t,e){if(null!=t){var n=t.end*this.frameTime-t.begin*this.frameTime;if(t.has_delta){var i=e;null==i.dloc&&(i.dloc=new E,i.drot=new w,i.dscale=new E),i.dloc.set(0,0,0),i.dscale.set(0,0,0),i._deulerX=i._deulerY=i._deulerZ=0}for(var s=0,r=t.tracks;s<r.length;){var a=r[s];++s,-1==this.frameIndex&&this.rewind(a);for(var l=0<this.speed?1:-1,o=this.time+t.begin*this.frameTime;this.checkFrameIndexT(a.frames,o);)this.frameIndex+=l;if(!(this.frameIndex>=a.frames.length)){if(this.time>n)return null!=this.onComplete&&this.onComplete(),void this.rewind(a);var h=this.frameIndex,u=a.frames[h]*this.frameTime,_=a.frames[h+l]*this.frameTime,c=a.values[h],d=a.values[h+l],g=0;switch(a.curve){case"bezier":var f=a.frames_control_plus[h]*this.frameTime,p=a.frames_control_minus[h+l]*this.frameTime,m=a.values_control_plus[h],v=a.values_control_minus[h+l];g=this.interpolateBezier(o,u,_,c,d,f,p,m,v);break;case"linear":g=this.interpolateLinear(o,u,_,c,d)}switch(a.target){case"dxloc":e.dloc.x=g;break;case"dxrot":e._deulerX=g;break;case"dxscl":e.dscale.x=g;break;case"dyloc":e.dloc.y=g;break;case"dyrot":e._deulerY=g;break;case"dyscl":e.dscale.y=g;break;case"dzloc":e.dloc.z=g;break;case"dzrot":e._deulerZ=g;break;case"dzscl":e.dscale.z=g;break;case"xloc":e.loc.x=g;break;case"xrot":e.setRotation(g,e._eulerY,e._eulerZ);break;case"xscl":e.scale.x=g;break;case"yloc":e.loc.y=g;break;case"yrot":e.setRotation(e._eulerX,g,e._eulerZ);break;case"yscl":e.scale.y=g;break;case"zloc":e.loc.z=g;break;case"zrot":e.setRotation(e._eulerX,e._eulerY,g);break;case"zscl":e.scale.z=g}}}}},__class__:kt});var Bt=function(t){this.paused=!1,this.channels=[],this.sound=null;var e=this;xt.call(this),this.data=t,U.active.speakers.push(this),""!=t.sound&&st.getSound(t.sound,function(t){e.sound=t,X.notifyOnInit(ci(e,e.init))})};(n["iron.object.SpeakerObject"]=Bt).__name__=!0,Bt.__super__=xt,Bt.prototype=s(xt.prototype,{data:null,sound:null,channels:null,paused:null,init:function(){this.visible&&this.data.play_on_start&&this.play()},play:function(){if(null!=this.sound&&!this.data.muted)if(this.paused){for(var t=0,e=this.channels;t<e.length;){var n=e[t];++t,n.play()}this.paused=!1}else{var i=Ft.play(this.sound,this.data.loop,this.data.stream);this.channels.push(i),0<this.data.attenuation&&1==this.channels.length&&X.notifyOnUpdate(ci(this,this.update))}},update:function(){if(!this.paused){for(var t=0,e=this.channels;t<e.length;){var n=e[t];++t,n.get_finished()&&ht.remove(this.channels,n)}if(0!=this.channels.length){var i=U.active.camera.transform.world.getLoc(),s=this.transform.world.getLoc(),r=E.distance(i,s);r*=this.data.attenuation;for(var a=1-Math.min(r/100,1),l=0,o=this.channels;l<o.length;){var h=o[l];++l,h.set_volume(a*this.data.volume)}}else X.removeUpdate(ci(this,this.update))}},remove:function(){null!=U.active&&ht.remove(U.active.speakers,this),xt.prototype.remove.call(this)},__class__:Bt});var Et=function(t,s,r){this.onActionComplete=null,this.time=0,this.frame=0,this.paused=!1,this.action=null,this.tileY=0,this.tileX=0;var a=this;this.ready=!1,st.getSceneRaw(t,function(t){for(var e=0,n=t.tilesheet_datas;e<n.length;){var i=n[e];if(++e,i.name==s){a.raw=i,a.play(r),a.ready=!0;break}}})};(n["iron.object.Tilesheet"]=Et).__name__=!0,Et.prototype={tileX:null,tileY:null,raw:null,action:null,ready:null,paused:null,frame:null,time:null,onActionComplete:null,play:function(t,e){this.onActionComplete=e;for(var n=0,i=this.raw.actions;n<i.length;){var s=i[n];if(++n,s.name==t){this.action=s;break}}this.setFrame(this.action.start),this.paused=!1},remove:function(){},update:function(){!this.ready||this.paused||this.action.start>=this.action.end||(this.time+=Zt.get_delta(),this.time>=1/this.raw.framerate&&this.setFrame(this.frame+1))},setFrame:function(t){this.frame=t,this.time=0;var e=this.frame%this.raw.tilesx,n=gt.int(this.frame/this.raw.tilesx);this.tileX=e*(1/this.raw.tilesx),this.tileY=n*(1/this.raw.tilesy),this.frame>=this.action.end&&this.action.start<this.action.end&&(null!=this.onActionComplete&&this.onActionComplete(),this.action.loop?this.setFrame(this.action.start):this.paused=!0)},__class__:Et};var Mt=function(t){this.dscale=null,this.drot=null,this.dloc=null,this.boneParent=null,this.appendMats=null,this.prependMats=null,this.localOnly=!1,this.object=t,this.reset()};(n["iron.object.Transform"]=Mt).__name__=!0,Mt.prototype={world:null,localOnly:null,local:null,loc:null,rot:null,scale:null,dirty:null,object:null,dim:null,radius:null,prependMats:null,appendMats:null,boneParent:null,reset:function(){this.world=W.identity(),this.local=W.identity(),this.loc=new E,this.rot=new w,this.scale=new E(1,1,1),this.dim=new E(2,2,2),this.radius=1,this.dirty=!0},update:function(){this.dirty&&this.buildMatrix()},composeDelta:function(){this.dloc.addvecs(this.loc,this.dloc),this.dscale.addvecs(this.dscale,this.scale),this.drot.fromEuler(this._deulerX,this._deulerY,this._deulerZ),this.drot.multquats(this.rot,this.drot),this.local.compose(this.dloc,this.drot,this.dscale)},buildMatrix:function(){if(null==this.dloc?this.local.compose(this.loc,this.rot,this.scale):this.composeDelta(),null!=this.prependMats){Mt.temp.setIdentity();for(var t=0,e=this.prependMats;t<e.length;){var n=e[t];++t,Mt.temp.multmat(n)}Mt.temp.multmat(this.local),this.local.setFrom(Mt.temp)}if(null!=this.appendMats)for(var i=0,s=this.appendMats;i<s.length;){var r=s[i];++i,this.local.multmat(r)}if(null!=this.boneParent&&this.local.multmats(this.boneParent,this.local),null==this.object.parent||this.localOnly?this.world.setFrom(this.local):this.world.multmats3x4(this.local,this.object.parent.transform.world),null!=this.object.constraints)for(var a=0,l=this.object.constraints;a<l.length;){var o=l[a];++a,o.apply(this)}this.computeDim();for(var h=0,u=this.object.children;h<u.length;){var _=u[h];++h,_.transform.buildMatrix()}this.dirty=!1},decompose:function(){this.local.decompose(this.loc,this.rot,this.scale)},setRotation:function(t,e,n){this.rot.fromEuler(t,e,n),this._eulerX=t,this._eulerY=e,this._eulerZ=n,this.dirty=!0},computeRadius:function(){this.radius=Math.sqrt(this.dim.x*this.dim.x+this.dim.y*this.dim.y+this.dim.z*this.dim.z)},computeDim:function(){if(null!=this.object.raw){var t=this.object.raw.dimensions;null==t?this.dim.set(2*this.scale.x,2*this.scale.y,2*this.scale.z):this.dim.set(t[0]*this.scale.x,t[1]*this.scale.y,t[2]*this.scale.z),this.computeRadius()}else this.computeRadius()},applyParentInverse:function(){var t=this.object.parent.transform;t.buildMatrix(),Mt.temp.getInverse(t.world),this.local.multmat(Mt.temp),this.decompose(),this.buildMatrix()},_eulerX:null,_eulerY:null,_eulerZ:null,worldx:function(){return this.world.get__30()},worldy:function(){return this.world.get__31()},worldz:function(){return this.world.get__32()},dloc:null,drot:null,dscale:null,_deulerX:null,_deulerY:null,_deulerZ:null,__class__:Mt};var Lt=function(t,e,n,i,s,r,a,l,o){this._00=t,this._10=e,this._20=n,this._01=i,this._11=s,this._21=r,this._02=a,this._12=l,this._22=o};(n["kha.math.FastMatrix3"]=Lt).__name__=!0,Lt.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:Lt};var At=function(){};(n["iron.object.Uniforms"]=At).__name__=!0,At.setContextConstants=function(t,e,n,i,s){if(null!=e.raw.constants)for(var r=0,a=e.raw.constants.length;r<a;){var l=r++,o=e.raw.constants[l];At.setContextConstant(t,n,i,e.constants[l],o)}if(null!=s)for(var h=0,u=gt.int(s.length/2);h<u;){var _=2*h++,c=s[_],d=s[_+1],g=!1;"_"==c.charAt(0)&&(g=!0,c=ht.substr(c,1,null));var f=g?z.active.depthToRenderTarget.get(c):z.active.renderTargets.get(c);At.bindRenderTarget(t,f,e,d,g)}if(null!=e.raw.texture_units)for(var p=0,m=e.raw.texture_units.length;p<m;){var v=p++,w=e.raw.texture_units[v].link;if(null!=w)if("_envmapRadiance"==w){var b=U.active.world;null!=b&&(t.setTexture(e.textureUnits[v],b.probe.radiance),t.setTextureParameters(e.textureUnits[v],wn.Repeat,wn.Repeat,bn.LinearFilter,bn.LinearFilter,cn.LinearMipFilter))}else if("_envmap"==w){var x=U.active.world;null!=x&&t.setTexture(e.textureUnits[v],x.envmap)}else if("_envmapBrdf"==w)t.setTexture(e.textureUnits[v],U.active.embedded.get("brdf.png"));else if("_noise8"==w)t.setTexture(e.textureUnits[v],U.active.embedded.get("noise8.png")),t.setTextureParameters(e.textureUnits[v],wn.Repeat,wn.Repeat,bn.LinearFilter,bn.LinearFilter,cn.NoMipFilter);else if("_noise64"==w)t.setTexture(e.textureUnits[v],U.active.embedded.get("noise64.png")),t.setTextureParameters(e.textureUnits[v],wn.Repeat,wn.Repeat,bn.LinearFilter,bn.LinearFilter,cn.NoMipFilter);else if("_blueNoise64"==w)t.setTexture(e.textureUnits[v],U.active.embedded.get("blue_noise64.png")),t.setTextureParameters(e.textureUnits[v],wn.Repeat,wn.Repeat,bn.LinearFilter,bn.LinearFilter,cn.NoMipFilter);else if("_noise256"==w)t.setTexture(e.textureUnits[v],U.active.embedded.get("noise256.png")),t.setTextureParameters(e.textureUnits[v],wn.Repeat,wn.Repeat,bn.LinearFilter,bn.LinearFilter,cn.NoMipFilter);else if("_lightColorTexture"==w)null!=i&&(t.setTexture(e.textureUnits[v],i.data.colorTexture),t.setTextureParameters(e.textureUnits[v],wn.Repeat,wn.Repeat,bn.LinearFilter,bn.LinearFilter,cn.NoMipFilter));else if("_iesTexture"==w)t.setTexture(e.textureUnits[v],U.active.embedded.get("iestexture.png")),t.setTextureParameters(e.textureUnits[v],wn.Repeat,wn.Repeat,bn.LinearFilter,bn.LinearFilter,cn.NoMipFilter);else;}},At.setObjectConstants=function(t,e,n,i,s){if(null!=e.raw.constants)for(var r=0,a=e.raw.constants.length;r<a;){var l=r++,o=e.raw.constants[l];At.setObjectConstant(t,n,i,s,e.constants[l],o)}if(null!=At.externalTextureLinks&&null!=e.raw.texture_units)for(var h=0,u=e.raw.texture_units.length;h<u;){var _=h++,c=e.raw.texture_units[_].link;if(null!=c)for(var d=0,g=At.externalTextureLinks;d<g.length;){var f=g[d];++d;var p=f(n,At.currentMat(n),c);if(null!=p){t.setTexture(e.textureUnits[_],p);break}}}},At.bindRenderTarget=function(t,e,n,i,s){if(null!=e)for(var r=n.raw.texture_units,a=0,l=r.length;a<l;){var o=a++;if(i==r[o].name){var h=null!=r[o].is_image&&r[o].is_image;1<e.raw.depth&&(t.setTexture3DParameters(n.textureUnits[o],wn.Clamp,wn.Clamp,wn.Clamp,bn.LinearFilter,bn.PointFilter,cn.LinearMipFilter),n.paramsSet[o]=!0),h?(t.setImageTexture(n.textureUnits[o],e.image),t.setTexture3DParameters(n.textureUnits[o],wn.Clamp,wn.Clamp,wn.Clamp,bn.LinearFilter,bn.PointFilter,cn.LinearMipFilter),n.paramsSet[o]=!0):e.isCubeMap?s?t.setCubeMapDepth(n.textureUnits[o],e.cubeMap):t.setCubeMap(n.textureUnits[o],e.cubeMap):s?t.setTextureDepth(n.textureUnits[o],e.image):t.setTexture(n.textureUnits[o],e.image),n.paramsSet[o]||null==e.raw.mipmaps||1!=e.raw.mipmaps||h||(t.setTextureParameters(n.textureUnits[o],wn.Clamp,wn.Clamp,bn.LinearFilter,bn.LinearFilter,cn.LinearMipFilter),n.paramsSet[o]=!0),n.paramsSet[o]||(("shadowMap"==i||s)&&(t.setTextureParameters(n.textureUnits[o],wn.Clamp,wn.Clamp,bn.PointFilter,bn.PointFilter,cn.NoMipFilter),n.paramsSet[o]=!0),"shadowMapCube"==i&&(n.paramsSet[o]=!0)),n.paramsSet[o]||(t.setTextureParameters(n.textureUnits[o],wn.Clamp,wn.Clamp,bn.LinearFilter,bn.LinearFilter,cn.NoMipFilter),n.paramsSet[o]=!0)}}},At.setContextConstant=function(t,e,n,i,s){if(null==s.link)return!0;if("mat4"==s.type){var r=null;if("_viewMatrix"==s.link)r=e.V;else if("_transposeInverseViewMatrix"==s.link)At.helpMat.setFrom(e.V),At.helpMat.getInverse(At.helpMat),At.helpMat.transpose(),r=At.helpMat;else if("_inverseViewMatrix"==s.link)At.helpMat.getInverse(e.V),r=At.helpMat;else if("_transposeViewMatrix"==s.link)At.helpMat.setFrom(e.V),At.helpMat.transpose3x3(),r=At.helpMat;else if("_projectionMatrix"==s.link)r=e.P;else if("_inverseProjectionMatrix"==s.link)At.helpMat.getInverse(e.P),r=At.helpMat;else if("_inverseViewProjectionMatrix"==s.link)At.helpMat.setFrom(e.V),At.helpMat.multmat(e.P),At.helpMat.getInverse(At.helpMat),r=At.helpMat;else if("_viewProjectionMatrix"==s.link)r=e.VP;else if("_prevViewProjectionMatrix"==s.link)At.helpMat.setFrom(e.prevV),At.helpMat.multmat(e.P),r=At.helpMat;else if("_lightViewProjectionMatrix"==s.link)null!=n&&(r=n.VP);else if("_biasLightViewProjectionMatrix"==s.link)null!=n&&(At.helpMat.setFrom(n.VP),At.helpMat.multmat(At.biasMat),r=At.helpMat);else if("_lightVolumeWorldViewProjectionMatrix"==s.link){if(null!=n){var a=n.transform,l=n.data.raw.type;if("spot"==l){At.helpVec.set(a.worldx(),a.worldy(),a.worldz());At.helpVec2.set(n.data.raw.far_plane,2*n.data.raw.far_plane,2*n.data.raw.far_plane),At.helpMat.compose(At.helpVec,At.helpQuat,At.helpVec2)}else if("point"==l||"area"==l){At.helpVec.set(a.worldx(),a.worldy(),a.worldz());At.helpVec2.set(n.data.raw.far_plane,2*n.data.raw.far_plane,2*n.data.raw.far_plane),At.helpMat.compose(At.helpVec,At.helpQuat,At.helpVec2)}At.helpMat.multmat(e.V),At.helpMat.multmat(e.P),r=At.helpMat}}else if("_skydomeMatrix"==s.link){var o=e.transform;At.helpVec.set(o.worldx(),o.worldy(),o.worldz()-3.5);var h=.95*e.data.raw.far_plane;At.helpVec2.set(h,h,h),At.helpMat.compose(At.helpVec,At.helpQuat,At.helpVec2),At.helpMat.multmat(e.V),At.helpMat.multmat(e.P),r=At.helpMat}else"_lightViewMatrix"==s.link?null!=n&&(r=n.V):"_lightProjectionMatrix"==s.link&&null!=n&&(r=n.P);if(null!=r)return t.setMatrix(i,r.self),!0}else if("vec4"==s.type){At.helpVec.set(0,0,0)}else if("vec3"==s.type){var u=null;if(At.helpVec.set(0,0,0),"_lightPosition"==s.link)null!=n&&(At.helpVec.set(n.transform.worldx(),n.transform.worldy(),n.transform.worldz()),u=At.helpVec);else if("_lightDirection"==s.link)null!=n&&(At.helpVec=n.look(),u=At.helpVec);else if("_lightColor"==s.link){if(null!=n){var _=n.data.raw.strength;At.helpVec.set(n.data.raw.color[0]*_,n.data.raw.color[1]*_,n.data.raw.color[2]*_),u=At.helpVec}}else if("_lightArea0"==s.link){if(null!=n&&null!=n.data.raw.size){var c=.5*n.data.raw.size,d=.5*n.data.raw.size_y;At.helpVec.set(-c,d,0),At.helpVec.applymat(n.transform.world),u=At.helpVec}}else if("_lightArea1"==s.link){if(null!=n&&null!=n.data.raw.size){var g=.5*n.data.raw.size,f=.5*n.data.raw.size_y;At.helpVec.set(g,f,0),At.helpVec.applymat(n.transform.world),u=At.helpVec}}else if("_lightArea2"==s.link){if(null!=n&&null!=n.data.raw.size){var p=.5*n.data.raw.size,m=.5*n.data.raw.size_y;At.helpVec.set(p,-m,0),At.helpVec.applymat(n.transform.world),u=At.helpVec}}else if("_lightArea3"==s.link){if(null!=n&&null!=n.data.raw.size){var v=.5*n.data.raw.size,w=.5*n.data.raw.size_y;At.helpVec.set(-v,-w,0),At.helpVec.applymat(n.transform.world),u=At.helpVec}}else if("_cameraPosition"==s.link)At.helpVec.set(e.transform.worldx(),e.transform.worldy(),e.transform.worldz()),u=At.helpVec;else if("_cameraLook"==s.link)At.helpVec=e.lookWorld(),u=At.helpVec;else if("_cameraUp"==s.link)At.helpVec=e.upWorld(),u=At.helpVec;else if("_cameraRight"==s.link)At.helpVec=e.rightWorld(),u=At.helpVec;else if("_backgroundCol"==s.link)null!=e.data.raw.clear_color&&At.helpVec.set(e.data.raw.clear_color[0],e.data.raw.clear_color[1],e.data.raw.clear_color[2]),u=At.helpVec;else if("_sunDirection"==s.link){var b=U.active.world;null!=b&&(At.helpVec.set(b.raw.sun_direction[0],b.raw.sun_direction[1],b.raw.sun_direction[2]),u=At.helpVec)}if(null!=u)return t.setFloat3(i,u.x,u.y,u.z),!0}else if("vec2"==s.type){var x=null;if(At.helpVec.set(0,0,0),"_vec2x"==s.link)(x=At.helpVec).x=1,x.y=0;else if("_vec2xInv"==s.link)(x=At.helpVec).x=1/z.active.currentW,x.y=0;else if("_vec2x2"==s.link)(x=At.helpVec).x=2,x.y=0;else if("_vec2x2Inv"==s.link)(x=At.helpVec).x=2/z.active.currentW,x.y=0;else if("_vec2y"==s.link)(x=At.helpVec).x=0,x.y=1;else if("_vec2yInv"==s.link)(x=At.helpVec).x=0,x.y=1/z.active.currentH;else if("_vec2y2"==s.link)(x=At.helpVec).x=0,x.y=2;else if("_vec2y2Inv"==s.link)(x=At.helpVec).x=0,x.y=2/z.active.currentH;else if("_vec2y3"==s.link)(x=At.helpVec).x=0,x.y=3;else if("_vec2y3Inv"==s.link)(x=At.helpVec).x=0,x.y=3/z.active.currentH;else if("_windowSize"==s.link)(x=At.helpVec).x=X.w(),x.y=X.h();else if("_windowSizeInv"==s.link)(x=At.helpVec).x=1/X.w(),x.y=1/X.h();else if("_screenSize"==s.link)(x=At.helpVec).x=z.active.currentW,x.y=z.active.currentH;else if("_screenSizeInv"==s.link)(x=At.helpVec).x=1/z.active.currentW,x.y=1/z.active.currentH;else if("_aspectRatio"==s.link)(x=At.helpVec).x=z.active.currentH/z.active.currentW,x.y=z.active.currentW/z.active.currentH,x.x=1<x.x?1:x.x,x.y=1<x.y?1:x.y;else if("_cameraPlane"==s.link)(x=At.helpVec).x=e.data.raw.near_plane,x.y=e.data.raw.far_plane;else if("_cameraPlaneProj"==s.link){var y=e.data.raw.near_plane,S=e.data.raw.far_plane;(x=At.helpVec).x=S/(S-y),x.y=-S*y/(S-y)}else if("_lightPlane"==s.link)null!=n&&((x=At.helpVec).x=n.data.raw.near_plane,x.y=n.data.raw.far_plane);else if("_lightPlaneProj"==s.link){if(null!=n){var C=n.data.raw.near_plane,I=n.data.raw.far_plane,T=I+C,k=I-C,B=2*I*C;(x=At.helpVec).x=T/k,x.y=B/k}}else"_spotlightData"==s.link?null!=n&&((x=At.helpVec).x=n.data.raw.spot_size,x.y=x.x-n.data.raw.spot_blend):"_shadowMapSize"==s.link&&null!=n&&n.data.raw.cast_shadow&&((x=At.helpVec).x=x.y=n.data.raw.shadowmap_size);if(null!=x)return t.setFloat2(i,x.x,x.y),!0}else if("float"==s.type){var E=null;if("_time"==s.link?E=Zt.time():"_deltaTime"==s.link?E=Zt.get_delta():"_lightRadius"==s.link?E=null==n?0:n.data.raw.far_plane:"_lightShadowsBias"==s.link?E=null==n?0:n.data.raw.shadows_bias:"_lightSize"==s.link?null!=n&&null!=n.data.raw.light_size&&(E=n.data.raw.light_size):"_envmapStrength"==s.link?E=null==U.active.world?0:U.active.world.probe.raw.strength:"_aspectRatioF"==s.link?E=z.active.currentW/z.active.currentH:"_aspectRatioWindowF"==s.link?E=X.w()/X.h():"_frameScale"==s.link&&(E=z.active.frameTime/Zt.get_delta()),null!=E)return t.setFloat(i,E),!0}else if("floats"==s.type){var M=null;if("_envmapIrradiance"==s.link&&(M=null==U.active.world?dt.getEmptyIrradiance():U.active.world.probe.irradiance),null!=M)return t.setFloats(i,M),!0}else if("int"==s.type){var L=null;if("_lightType"==s.link)L=null==n?0:at.typeToInt(n.data.raw.type);else if("_lightIndex"==s.link)L=z.active.currentLightIndex;else if("_lightCastShadow"==s.link)L=null!=n&&n.data.raw.cast_shadow?n.data.raw.shadowmap_cube?2:1:0;else if("_envmapNumMipmaps"==s.link){var A=U.active.world;L=null!=A?A.probe.raw.radiance_mipmaps+1-2:1}if(null!=L)return t.setInt(i,L),!0}return!1},At.setObjectConstant=function(t,e,n,i,s,r){if(null!=r.link)if("mat4"==r.type){var a=null;if("_worldMatrix"==r.link)a=e.transform.world;else if("_inverseWorldMatrix"==r.link)At.helpMat.getInverse(e.transform.world),a=At.helpMat;else if("_worldViewProjectionMatrix"==r.link)At.helpMat.setFrom(e.transform.world),At.helpMat.multmat(n.V),At.helpMat.multmat(n.P),a=At.helpMat;else if("_worldViewProjectionMatrixSphere"==r.link)At.helpMat.setFrom(e.transform.world),At.helpMat.multmat(n.V),At.helpMat.set__00(1),At.helpMat.set__10(0),At.helpMat.set__20(0),At.helpMat.set__01(0),At.helpMat.set__11(1),At.helpMat.set__21(0),At.helpMat.set__02(0),At.helpMat.set__12(0),At.helpMat.set__22(1),At.helpMat.multmat(n.P),a=At.helpMat;else if("_worldViewProjectionMatrixCylinder"==r.link)At.helpMat.setFrom(e.transform.world),At.helpMat.multmat(n.V),At.helpMat.set__00(1),At.helpMat.set__20(0),At.helpMat.set__01(0),At.helpMat.set__21(0),At.helpMat.set__02(0),At.helpMat.set__22(1),At.helpMat.multmat(n.P),a=At.helpMat;else if("_worldViewMatrix"==r.link)At.helpMat.setFrom(e.transform.world),At.helpMat.multmat(n.V),a=At.helpMat;else if("_lightWorldViewProjectionMatrix"==r.link)null!=i&&(null==e?At.helpMat.setIdentity():At.helpMat.setFrom(e.transform.world),At.helpMat.multmat(i.VP),a=At.helpMat);else if("_lightWorldViewProjectionMatrixSphere"==r.link)null!=i&&(At.helpMat.setFrom(e.transform.world),At.helpMat.multmat(n.V),At.helpMat.set__00(1),At.helpMat.set__10(0),At.helpMat.set__20(0),At.helpMat.set__01(0),At.helpMat.set__11(1),At.helpMat.set__21(0),At.helpMat.set__02(0),At.helpMat.set__12(0),At.helpMat.set__22(1),At.helpMat2.getInverse(n.V),At.helpMat.multmat(At.helpMat2),At.helpMat.multmat(i.VP),a=At.helpMat);else if("_lightWorldViewProjectionMatrixCylinder"==r.link)null!=i&&(At.helpMat.setFrom(e.transform.world),At.helpMat.multmat(n.V),At.helpMat.set__00(1),At.helpMat.set__20(0),At.helpMat.set__01(0),At.helpMat.set__21(0),At.helpMat.set__02(0),At.helpMat.set__22(1),At.helpMat2.getInverse(n.V),At.helpMat.multmat(At.helpMat2),At.helpMat.multmat(i.VP),a=At.helpMat);else if("_biasLightWorldViewProjectionMatrix"==r.link)null!=i&&(null==e?At.helpMat.setIdentity():At.helpMat.setFrom(e.transform.world),At.helpMat.multmat(i.VP),At.helpMat.multmat(At.biasMat),a=At.helpMat);else if(null!=At.externalMat4Links)for(var l=0,o=At.externalMat4Links;l<o.length;){var h=o[l];if(++l,null!=(a=h(e,At.currentMat(e),r.link)))break}if(null==a)return;t.setMatrix(s,a.self)}else if("mat3"==r.type){var u=null;if("_normalMatrix"==r.link&&(At.helpMat.setFrom(e.transform.world),At.helpMat.getInverse(At.helpMat),At.helpMat.transpose3x3(),At.helpMat3.setFrom4(At.helpMat),u=At.helpMat3),null==u)return;t.setMatrix3(s,u.self)}else if("vec4"==r.type){var _=null;if(At.helpVec.set(0,0,0),null!=At.externalVec4Links)for(var c=0,d=At.externalVec4Links;c<d.length;){var g=d[c];if(++c,null!=(_=g(e,At.currentMat(e),r.link)))break}if(null==_)return;t.setFloat4(s,_.x,_.y,_.z,_.w)}else if("vec3"==r.type){var f=null;if(At.helpVec.set(0,0,0),"_dim"==r.link){var p=e.transform.dim,m=e.transform.scale;At.helpVec.set(p.x/m.x,p.y/m.y,p.z/m.z),f=At.helpVec}else if("_halfDim"==r.link){var v=e.transform.dim,w=e.transform.scale;At.helpVec.set(v.x/w.x/2,v.y/w.y/2,v.z/w.z/2),f=At.helpVec}else if(null!=At.externalVec3Links)for(var b=0,x=At.externalVec3Links;b<x.length;){var y=x[b];if(++b,null!=(f=y(e,At.currentMat(e),r.link)))break}if(null==f)return;t.setFloat3(s,f.x,f.y,f.z)}else if("vec2"==r.type){var S=null,C=0;if("_tilesheetOffset"==r.link){var I=zt.__cast(e,Tt).tilesheet;S=I.tileX,C=I.tileY}else if(null!=At.externalVec2Links)for(var T=0,k=At.externalVec2Links;T<k.length;){var B=k[T];++T;var E=B(e,At.currentMat(e),r.link);if(null!=E){S=E.x,C=E.y;break}}if(null==S)return;t.setFloat2(s,S,C)}else if("float"==r.type){var M=null;if("_objectInfoIndex"==r.link)M=e.uid;else if("_objectInfoMaterialIndex"==r.link)M=At.currentMat(e).uid;else if("_objectInfoRandom"==r.link)M=e.urandom;else if(null!=At.externalFloatLinks)for(var L=0,A=At.externalFloatLinks;L<A.length;){var W=A[L];++L;var F=W(e,At.currentMat(e),r.link);if(null!=F){M=F;break}}if(null==M)return;t.setFloat(s,M)}else if("floats"==r.type){var O=null;if(null==O&&null!=At.externalFloatsLinks)for(var R=0,D=At.externalFloatsLinks;R<D.length;){var N=D[R];if(++R,null!=(O=N(e,At.currentMat(e),r.link)))break}if(null==O)return;t.setFloats(s,O)}else if("int"==r.type){var V=null;if("_uid"==r.link)V=e.uid;else if(null!=At.externalIntLinks)for(var H=0,G=At.externalIntLinks;H<G.length;){var P=G[H];++H;var Z=P(e,At.currentMat(e),r.link);if(null!=Z){V=Z;break}}if(null==V)return;t.setInt(s,V)}},At.setMaterialConstants=function(t,e,n){if(null!=n.raw.bind_constants)for(var i=0,s=n.raw.bind_constants.length;i<s;){for(var r=i++,a=n.raw.bind_constants[r],l=-1,o=0,h=e.raw.constants.length;o<h;){var u=o++;if(e.raw.constants[u].name==a.name){l=u;break}}if(-1!=l){var _=e.raw.constants[l];At.setMaterialConstant(t,e.constants[l],_,a)}}if(null!=n.textures)for(var c=0,d=n.textures.length;c<d;)for(var g=c++,f=n.raw.bind_textures[g].name,p=0,m=e.textureUnits.length;p<m;){var v=p++;if(f==e.raw.texture_units[v].name){t.setTexture(e.textureUnits[v],n.textures[g]),n.setTextureParameters(t,g,e,v);break}}},At.currentMat=function(t){return null!=t&&t instanceof Tt?zt.__cast(t,Tt).materials[0]:null},At.setMaterialConstant=function(t,e,n,i){switch(n.type){case"bool":t.setBool(e,i.bool);break;case"float":t.setFloat(e,i.float);break;case"int":t.setInt(e,i.int);break;case"vec2":t.setFloat2(e,i.vec2[0],i.vec2[1]);break;case"vec3":t.setFloat3(e,i.vec3[0],i.vec3[1],i.vec3[2]);break;case"vec4":t.setFloat4(e,i.vec4[0],i.vec4[1],i.vec4[2],i.vec4[3])}};var Wt=function(){};(n["iron.system.ArmPack"]=Wt).__name__=!0,Wt.decode=function(t){var e=new N(t);return e.set_bigEndian(!0),Wt.read(e)},Wt.read=function(t,e,n){null==n&&(n=""),null==e&&(e="");try{var i=t.readByte();switch(i){case 192:return null;case 194:return!1;case 195:return!0;case 196:return t.read(t.readByte());case 197:return t.read(t.readUInt16());case 198:return t.read(t.readInt32());case 202:return t.readFloat();case 204:return t.readByte();case 205:return t.readUInt16();case 206:return t.readInt32();case 208:return t.readInt8();case 209:return t.readInt16();case 210:return t.readInt32();case 217:return t.readString(t.readByte());case 218:return t.readString(t.readUInt16());case 219:return t.readString(t.readInt32());case 220:return Wt.readArray(t,t.readUInt16(),e,n);case 221:return Wt.readArray(t,t.readInt32(),e,n);case 222:return Wt.readMap(t,t.readUInt16(),e,n);case 223:return Wt.readMap(t,t.readInt32(),e,n);default:if(i<128)return i;if(i<144)return Wt.readMap(t,15&i,e,n);if(i<160)return Wt.readArray(t,15&i,e,n);if(i<192)return t.readString(31&i);if(223<i)return-256|i}}catch(t){var s=t instanceof Xt?t.val:t;if(!(s instanceof H))throw t}return null},Wt.readArray=function(t,e,n,i){null==i&&(i=""),null==n&&(n="");var s=t.readByte(),r=t;if(r.set_position(r.get_position()-1),202==s){var a=t;a.set_position(a.get_position()+1);for(var l=new Float32Array(e),o=0,h=e;o<h;){l[o++]=t.readFloat()}return l}if(210==s){var u=t;u.set_position(u.get_position()+1);for(var _=new Uint32Array(e),c=0,d=e;c<d;){_[c++]=t.readInt32()}return _}for(var g=[],f=0,p=e;f<p;){f++;g.push(Wt.read(t,n,i))}return g},Wt.readMap=function(t,e,n,i){null==i&&(i=""),null==n&&(n="");for(var s={},r=0,a=e;r<a;){r++;var l=gt.string(Wt.read(t)),o=Wt.read(t,l,n);pt.setField(s,l,o)}return s};var Ft=function(){};(n["iron.system.Audio"]=Ft).__name__=!0,Ft.play=function(t,e,n){return null==n&&(n=!1),null==e&&(e=!1),null};var Ot=function(){};(n["iron.system.Input"]=Ot).__name__=!0,Ot.reset=function(){Ot.occupied=!1,null!=Ot.mouse&&Ot.mouse.reset(),null!=Ot.pen&&Ot.pen.reset(),null!=Ot.keyboard&&Ot.keyboard.reset();for(var t=0,e=Ot.gamepads;t<e.length;){var n=e[t];++t,n.reset()}},Ot.endFrame=function(){null!=Ot.mouse&&Ot.mouse.endFrame(),null!=Ot.pen&&Ot.pen.endFrame(),null!=Ot.keyboard&&Ot.keyboard.endFrame();for(var t=0,e=Ot.gamepads;t<e.length;){var n=e[t];++t,n.endFrame()}if(null!=Ot.virtualButtons)for(var i=Ot.virtualButtons.iterator();i.hasNext();){var s=i.next();s.started=s.released=!1}},Ot.getMouse=function(){return Ot.registered||Ot.register(),null==Ot.mouse&&(Ot.mouse=new Nt),Ot.mouse},Ot.getKeyboard=function(){return Ot.registered||Ot.register(),null==Ot.keyboard&&(Ot.keyboard=new Ht),Ot.keyboard},Ot.register=function(){Ot.registered=!0,X.notifyOnEndFrame(Ot.endFrame),X.notifyOnReset(Ot.reset)};var Rt=function(){this.down=!1,this.released=!1,this.started=!1};(n["iron.system.VirtualButton"]=Rt).__name__=!0,Rt.prototype={started:null,released:null,down:null,__class__:Rt};var Dt=function(){this.virtualButtons=null};(n["iron.system.VirtualInput"]=Dt).__name__=!0,Dt.prototype={virtualButtons:null,downVirtual:function(t){if(null!=this.virtualButtons){var e=this.virtualButtons.get(t);null!=e&&(e.down=!0,e.started=!0)}},upVirtual:function(t){if(null!=this.virtualButtons){var e=this.virtualButtons.get(t);null!=e&&(e.down=!1,e.released=!0)}},__class__:Dt};var Nt=function(){this.lastY=-1,this.lastX=-1,this.locked=!1,this.wheelDelta=0,this.movementY=0,this.movementX=0,this.moved=!1,this.y=0,this.x=0,this.buttonsReleased=[!1,!1,!1],this.buttonsStarted=[!1,!1,!1],this.buttonsDown=[!1,!1,!1],Dt.call(this),An.get().notify(ci(this,this.downListener),ci(this,this.upListener),ci(this,this.moveListener),ci(this,this.wheelListener))};(n["iron.system.Mouse"]=Nt).__name__=!0,Nt.__super__=Dt,Nt.prototype=s(Dt.prototype,{buttonsDown:null,buttonsStarted:null,buttonsReleased:null,x:null,y:null,moved:null,movementX:null,movementY:null,wheelDelta:null,locked:null,lastX:null,lastY:null,endFrame:function(){var t=this.buttonsStarted[1]=this.buttonsStarted[2]=!1;this.buttonsStarted[0]=t;var e=this.buttonsReleased[1]=this.buttonsReleased[2]=!1;this.buttonsReleased[0]=e,this.moved=!1,this.movementX=0,this.movementY=0,this.wheelDelta=0},reset:function(){var t=this.buttonsDown[1]=this.buttonsDown[2]=!1;this.buttonsDown[0]=t,this.endFrame()},buttonIndex:function(t){return"left"==t?0:"right"==t?1:2},released:function(t){return null==t&&(t="left"),this.buttonsReleased[this.buttonIndex(t)]},downListener:function(t,e,n){this.buttonsDown[t]=!0,this.buttonsStarted[t]=!0,this.x=e-X.x(),this.y=n-X.y(),0==t&&(this.lastX=e,this.lastY=n),this.downVirtual(Nt.buttons[t])},upListener:function(t,e,n){this.buttonsDown[t]=!1,this.buttonsReleased[t]=!0,this.x=e-X.x(),this.y=n-X.y(),this.upVirtual(Nt.buttons[t])},moveListener:function(t,e,n,i){-1==this.lastX&&-1==this.lastY&&(this.lastX=t,this.lastY=e),this.locked?(this.movementX=n,this.movementY=i):(this.movementX=t-this.lastX,this.movementY=e-this.lastY),this.lastX=t,this.lastY=e,this.x=t-X.x(),this.y=e-X.y(),this.moved=!0},wheelListener:function(t){this.wheelDelta=t},__class__:Nt});var Vt=function(){this.lastY=-1,this.lastX=-1,this.pressure=0,this.movementY=0,this.movementX=0,this.moved=!1,this.y=0,this.x=0,this.buttonsReleased=[!1],this.buttonsStarted=[!1],this.buttonsDown=[!1],Dt.call(this),Fn.get().notify(ci(this,this.downListener),ci(this,this.upListener),ci(this,this.moveListener))};(n["iron.system.Pen"]=Vt).__name__=!0,Vt.__super__=Dt,Vt.prototype=s(Dt.prototype,{buttonsDown:null,buttonsStarted:null,buttonsReleased:null,x:null,y:null,moved:null,movementX:null,movementY:null,pressure:null,lastX:null,lastY:null,endFrame:function(){this.buttonsStarted[0]=!1,this.buttonsReleased[0]=!1,this.moved=!1,this.movementX=0,this.movementY=0},reset:function(){this.buttonsDown[0]=!1,this.endFrame()},downListener:function(t,e,n){this.buttonsDown[0]=!0,this.buttonsStarted[0]=!0,this.x=t-X.x(),this.y=e-X.y(),this.pressure=n},upListener:function(t,e,n){this.buttonsDown[0]=!1,this.buttonsReleased[0]=!0,this.x=t-X.x(),this.y=e-X.y(),this.pressure=n},moveListener:function(t,e,n){-1==this.lastX&&-1==this.lastY&&(this.lastX=t,this.lastY=e),this.movementX=t-this.lastX,this.movementY=e-this.lastY,this.lastX=t,this.lastY=e,this.x=t-X.x(),this.y=e-X.y(),this.moved=!0,this.pressure=n},__class__:Vt});var Ht=function(){this.keysFrame=[],this.keysReleased=new it,this.keysStarted=new it,this.keysDown=new it,Dt.call(this),this.reset(),Ln.get().notify(ci(this,this.downListener),ci(this,this.upListener),ci(this,this.pressListener))};(n["iron.system.Keyboard"]=Ht).__name__=!0,Ht.keyCode=function(t){return 32==t?"space":8==t?"backspace":9==t?"tab":13==t?"enter":16==t?"shift":17==t?"control":18==t?"alt":27==t?"escape":46==t?"delete":38==t?"up":40==t?"down":37==t?"left":39==t?"right":1==t?"back":48==t?"0":49==t?"1":50==t?"2":51==t?"3":52==t?"4":53==t?"5":54==t?"6":55==t?"7":56==t?"8":57==t?"9":112==t?"f1":113==t?"f2":114==t?"f3":115==t?"f4":116==t?"f5":117==t?"f6":118==t?"f7":119==t?"f8":120==t?"f9":121==t?"f10":122==t?"f11":123==t?"f12":String.fromCodePoint(t).toLowerCase()},Ht.__super__=Dt,Ht.prototype=s(Dt.prototype,{keysDown:null,keysStarted:null,keysReleased:null,keysFrame:null,endFrame:function(){if(0<this.keysFrame.length){for(var t=0,e=this.keysFrame;t<e.length;){var n=e[t];++t,this.keysStarted.set(n,!1),this.keysReleased.set(n,!1)}this.keysFrame.splice(0,this.keysFrame.length)}},reset:function(){for(var t=0,e=Ht.keys;t<e.length;){var n=e[t];++t,this.keysDown.set(n,!1),this.keysStarted.set(n,!1),this.keysReleased.set(n,!1)}this.endFrame()},started:function(t){return this.keysStarted.get(t)},downListener:function(t){var e=Ht.keyCode(t);this.keysFrame.push(e),this.keysStarted.set(e,!0),this.keysDown.set(e,!0),this.downVirtual(e)},upListener:function(t){var e=Ht.keyCode(t);this.keysFrame.push(e),this.keysReleased.set(e,!0),this.keysDown.set(e,!1),this.upVirtual(e)},pressListener:function(t){},__class__:Ht});var Gt=function(){this.movementY=0,this.movementX=0,this.moved=!1,this.lastY=0,this.lastX=0,this.y=0,this.x=0};(n["iron.system.GamepadStick"]=Gt).__name__=!0,Gt.prototype={x:null,y:null,lastX:null,lastY:null,moved:null,movementX:null,movementY:null,__class__:Gt};var Pt=function(t,e){null==e&&(e=!1),this.num=0,this.connected=!1,this.rightStick=new Gt,this.leftStick=new Gt,this.buttonsFrame=[],this.buttonsReleased=[],this.buttonsStarted=[],this.buttonsDown=[],Dt.call(this);for(var n=0,i=Pt.buttons;n<i.length;){i[n];++n,this.buttonsDown.push(0),this.buttonsStarted.push(!1),this.buttonsReleased.push(!1)}this.num=t,this.reset(),e?this.connected=!0:this.connect()};(n["iron.system.Gamepad"]=Pt).__name__=!0,Pt.__super__=Dt,Pt.prototype=s(Dt.prototype,{buttonsDown:null,buttonsStarted:null,buttonsReleased:null,buttonsFrame:null,leftStick:null,rightStick:null,connected:null,num:null,connect:function(){var t=En.get(this.num);null!=t&&(this.connected=!0,t.notify(ci(this,this.axisListener),ci(this,this.buttonListener)))},endFrame:function(){if(0<this.buttonsFrame.length){for(var t=0,e=this.buttonsFrame;t<e.length;){var n=e[t];++t,this.buttonsStarted[n]=!1,this.buttonsReleased[n]=!1}this.buttonsFrame.splice(0,this.buttonsFrame.length)}this.leftStick.moved=!1,this.leftStick.movementX=0,this.leftStick.movementY=0,this.rightStick.moved=!1,this.rightStick.movementX=0,this.rightStick.movementY=0},reset:function(){for(var t=0,e=this.buttonsDown.length;t<e;){var n=t++;this.buttonsDown[n]=0,this.buttonsStarted[n]=!1,this.buttonsReleased[n]=!1}this.endFrame()},axisListener:function(t,e){var n=t<=1?this.leftStick:this.rightStick;0==t||2==t?(n.lastX=n.x,n.x=e,n.movementX=n.x-n.lastX):1!=t&&3!=t||(n.lastY=n.y,n.y=e,n.movementY=n.y-n.lastY),n.moved=!0},buttonListener:function(t,e){this.buttonsFrame.push(t),0<(this.buttonsDown[t]=e)?this.buttonsStarted[t]=!0:this.buttonsReleased[t]=!0,0==e?this.upVirtual(Pt.buttons[t]):1==e&&this.downVirtual(Pt.buttons[t])},__class__:Pt});var Zt=function(){};(n["iron.system.Time"]=Zt).__name__=!0,Zt.__properties__={get_delta:"get_delta"},Zt.get_delta=function(){return.016666666666666666*Zt.scale},Zt.time=function(){return pe.time()},Zt.realTime=function(){return pe.realTime()},Zt.update=function(){Zt.realDelta=Zt.realTime()-Zt.last,Zt.last=Zt.realTime()};var Xt=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,Xt)};(n["js._Boot.HaxeError"]=Xt).__name__=!0,Xt.wrap=function(t){return t instanceof Error?t:new Xt(t)},Xt.__super__=Error,Xt.prototype=s(Error.prototype,{val:null,__class__:Xt});var zt=function(){};(n["js.Boot"]=zt).__name__=!0,zt.isClass=function(t){return t.__name__},zt.isEnum=function(t){return t.__ename__},zt.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var n=zt.__nativeClassName(t);return null!=n?zt.__resolveNativeClass(n):null},zt.__string_rec=function(t,e){if(null==t)return"null";if(5<=e.length)return"<...>";var n=typeof t;switch("function"==n&&(zt.isClass(t)||zt.isEnum(t))&&(n="object"),n){case"function":return"<function>";case"object":if(t.__enum__){var i=b[t.__enum__],s=i.__constructs__[t._hx_index],r=i[s];if(r.__params__){e+="\t";for(var a=s+"(",l=[],o=0,h=r.__params__;o<h.length;){var u=h[o];++o,l.push(zt.__string_rec(t[u],e))}return a+l.join(",")+")"}return s}if(t instanceof Array){var _="[";e+="\t";for(var c=0,d=t.length;c<d;){var g=c++;_+=(0<g?",":"")+zt.__string_rec(t[g],e)}return _+="]"}var f;try{f=t.toString}catch(t){t instanceof Xt&&t.val;return"???"}if(null!=f&&f!=Object.toString&&"function"==typeof f){var p=t.toString();if("[object Object]"!=p)return p}var m=null,v="{\n";e+="\t";var w=null!=t.hasOwnProperty;for(var m in t)w&&!t.hasOwnProperty(m)||"prototype"!=m&&"__class__"!=m&&"__super__"!=m&&"__interfaces__"!=m&&"__properties__"!=m&&(2!=v.length&&(v+=", \n"),v+=e+m+" : "+zt.__string_rec(t[m],e));return v+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},zt.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var n=t.__interfaces__;if(null!=n)for(var i=0,s=n.length;i<s;){var r=n[i++];if(r==e||zt.__interfLoop(r,e))return!0}return zt.__interfLoop(t.__super__,e)},zt.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case pi:return"boolean"==typeof t;case gi:return!0;case fi:return"number"==typeof t;case di:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(zt.__interfLoop(zt.getClass(t),e))return!0}else if("object"==typeof e&&zt.__isNativeObj(e)&&t instanceof e)return!0;return e==mi&&null!=t.__name__||(e==vi&&null!=t.__ename__||b[t.__enum__]==e)}},zt.__cast=function(t,e){if(zt.__instanceof(t,e))return t;throw new Xt("Cannot cast "+gt.string(t)+" to "+gt.string(e))},zt.__nativeClassName=function(t){var e=zt.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},zt.__isNativeObj=function(t){return null!=zt.__nativeClassName(t)},zt.__resolveNativeClass=function(t){return e[t]};var Yt=function(){};(n["js.Lib"]=Yt).__name__=!0,Yt.__properties__={get_undefined:"get_undefined"},Yt.get_undefined=function(){};var jt=function(){};(n["js.html._ArrayBuffer.ArrayBufferCompat"]=jt).__name__=!0,jt.sliceImpl=function(t,e){var n=new Uint8Array(this,t,null==e?null:e-t),i=new Uint8Array(n.byteLength);return i.set(n),i.buffer};var Ut=function(){this.names=[]};(n["kha._Assets.ImageList"]=Ut).__name__=!0,Ut.prototype={get:function(t){return pt.field(this,t)},names:null,__class__:Ut};var Kt=function(){this.names=[]};(n["kha._Assets.SoundList"]=Kt).__name__=!0,Kt.prototype={get:function(t){return pt.field(this,t)},names:null,__class__:Kt};var Qt=function(){this.names=[]};(n["kha._Assets.BlobList"]=Qt).__name__=!0,Qt.prototype={get:function(t){return pt.field(this,t)},names:null,__class__:Qt};var Jt=function(){this.names=["font_default"],this.font_defaultDescription={name:"font_default",files:["font_default.ttf"],type:"font"},this.font_defaultName="font_default",this.font_default=null};(n["kha._Assets.FontList"]=Jt).__name__=!0,Jt.prototype={get:function(t){return pt.field(this,t)},font_default:null,font_defaultName:null,font_defaultDescription:null,font_defaultLoad:function(e,t){$t.loadFont("font_default",function(t){e()},$t.reporter(t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:142,className:"kha._Assets.FontList",methodName:"font_defaultLoad"}),{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:142,className:"kha._Assets.FontList",methodName:"font_defaultLoad"})},font_defaultUnload:function(){this.font_default.unload(),this.font_default=null},names:null,__class__:Jt};var qt=function(){this.names=[]};(n["kha._Assets.VideoList"]=qt).__name__=!0,qt.prototype={get:function(t){return pt.field(this,t)},names:null,__class__:qt};var $t=function(){};(n["kha.Assets"]=$t).__name__=!0,$t.__properties__={get_videoFormats:"get_videoFormats",get_fontFormats:"get_fontFormats",get_soundFormats:"get_soundFormats",get_imageFormats:"get_imageFormats"},$t.loadEverything=function(t,e,n,i){for(var s=0,r=0,a=q.getInstanceFields(Qt);r<a.length;){var l=a[r];++r,J.endsWith(l,"Load")&&(s+=1)}for(var o=0,h=q.getInstanceFields(Ut);o<h.length;){var u=h[o];++o,J.endsWith(u,"Load")&&(s+=1)}for(var _=0,c=q.getInstanceFields(Kt);_<c.length;){var d=c[_];++_,J.endsWith(d,"Load")&&(s+=1)}for(var g=0,f=q.getInstanceFields(Jt);g<f.length;){var p=f[g];++g,J.endsWith(p,"Load")&&(s+=1)}for(var m=0,v=q.getInstanceFields(qt);m<v.length;){var w=v[m];++m,J.endsWith(w,"Load")&&(s+=1)}if(0!=s){for(var b=s,x=function(){b-=1,$t.progress=1-b/s,0==b&&t()},y=0,S=q.getInstanceFields(Qt);y<S.length;){var C=S[y];if(++y,J.endsWith(C,"Load")){var I=ht.substr(C,0,C.length-4),T=pt.field($t.blobs,I+"Description");null==e||e(T)?pt.field($t.blobs,C)(x,function(t){$t.reporter(i,{fileName:"kha/Assets.hx",lineNumber:134,className:"kha.Assets",methodName:"loadEverything"}),x()}):x()}}for(var k=0,B=q.getInstanceFields(Ut);k<B.length;){var E=B[k];if(++k,J.endsWith(E,"Load")){var M=ht.substr(E,0,E.length-4),L=pt.field($t.images,M+"Description");null==e||e(L)?pt.field($t.images,E)(x,function(t){$t.reporter(i,{fileName:"kha/Assets.hx",lineNumber:150,className:"kha.Assets",methodName:"loadEverything"}),x()}):x()}}for(var A=0,W=q.getInstanceFields(Kt);A<W.length;){var F=[W[A]];if(++A,J.endsWith(F[0],"Load")){var O=ht.substr(F[0],0,F[0].length-4),R=[pt.field($t.sounds,O+"Description")];null==e||e(R[0])?pt.field($t.sounds,F[0])(function(t,e){return function(){null==n||n(t[0])?pt.field($t.sounds,e[0].substring(0,e[0].length-4)).uncompress(x):x()}}(R,F),$t.reporter(i,{fileName:"kha/Assets.hx",lineNumber:172,className:"kha.Assets",methodName:"loadEverything"})):x()}}for(var D=0,N=q.getInstanceFields(Jt);D<N.length;){var V=N[D];if(++D,J.endsWith(V,"Load")){var H=ht.substr(V,0,V.length-4),G=pt.field($t.fonts,H+"Description");null==e||e(G)?pt.field($t.fonts,V)(x,function(t){$t.reporter(i,{fileName:"kha/Assets.hx",lineNumber:185,className:"kha.Assets",methodName:"loadEverything"}),x()}):x()}}for(var P=0,Z=q.getInstanceFields(qt);P<Z.length;){var X=Z[P];if(++P,J.endsWith(X,"Load")){var z=ht.substr(X,0,X.length-4),Y=pt.field($t.videos,z+"Description");null==e||e(Y)?pt.field($t.videos,X)(x,function(t){$t.reporter(i,{fileName:"kha/Assets.hx",lineNumber:200,className:"kha.Assets",methodName:"loadEverything"}),x()}):x()}}}else t()},$t.loadImage=function(e,n,t,i){var s=pt.field($t.images,e+"Description");de.loadImageFromDescription(s,function(t){pt.setField($t.images,e,t),n(t)},$t.reporter(t,i))},$t.loadImageFromPath=function(t,e,n,i,s){var r={files:[t],readable:e};de.loadImageFromDescription(r,n,$t.reporter(i,s))},$t.get_imageFormats=function(){return de.getImageFormats()},$t.loadBlob=function(e,n,t,i){var s=pt.field($t.blobs,e+"Description");de.loadBlobFromDescription(s,function(t){pt.setField($t.blobs,e,t),n(t)},$t.reporter(t,i))},$t.loadBlobFromPath=function(t,e,n,i){var s={files:[t]};de.loadBlobFromDescription(s,e,$t.reporter(n,i))},$t.loadSound=function(e,n,t,i){var s=pt.field($t.sounds,e+"Description");de.loadSoundFromDescription(s,function(t){pt.setField($t.sounds,e,t),n(t)},$t.reporter(t,i))},$t.loadSoundFromPath=function(t,e,n,i){var s={files:[t]};de.loadSoundFromDescription(s,e,$t.reporter(n,i))},$t.get_soundFormats=function(){return de.getSoundFormats()},$t.loadFont=function(e,n,t,i){var s=pt.field($t.fonts,e+"Description");de.loadFontFromDescription(s,function(t){pt.setField($t.fonts,e,t),n(t)},$t.reporter(t,i))},$t.loadFontFromPath=function(t,e,n,i){var s={files:[t]};de.loadFontFromDescription(s,e,$t.reporter(n,i))},$t.get_fontFormats=function(){return["ttf"]},$t.loadVideo=function(e,n,t,i){var s=pt.field($t.videos,e+"Description");de.loadVideoFromDescription(s,function(t){pt.setField($t.videos,e,t),n(t)},$t.reporter(t,i))},$t.loadVideoFromPath=function(t,e,n,i){var s={files:[t]};de.loadVideoFromDescription(s,e,$t.reporter(n,i))},$t.get_videoFormats=function(){return de.getVideoFormats()},$t.reporter=function(t,e){if(null!=t)return t;var n=L.trace,i=e;return function(t){n(t,i)}};var te=function(){};(n["kha.Canvas"]=te).__name__=!0,te.prototype={get_g4:null,get_height:null,get_width:null,__class__:te,__properties__:{get_width:"get_width",get_height:"get_height",get_g4:"get_g4"}};var ee=function(){};(n["kha.Resource"]=ee).__name__=!0;var ne=function(){};(n["kha.Image"]=ne).__name__=!0,ne.__interfaces__=[ee,te],ne.__properties__={get_nonPow2Supported:"get_nonPow2Supported"},ne.create=function(t,e,n,i){return null==n&&(n=xn.RGBA32),null==i&&(i=Sn.StaticUsage),null==ye.gl?new ie(t,e,n,!1):new Ce(t,e,n,!1,0,1)},ne.create3D=function(t,e,n,i,s){return null},ne.createRenderTarget=function(t,e,n,i,s,r){return null==r&&(r=0),null==s&&(s=1),null==i&&(i=0),null==n&&(n=xn.RGBA32),null==ye.gl?new ie(t,e,n,!0):new Ce(t,e,n,!0,i,s)},ne.fromImage=function(t,e){if(null==ye.gl){var n=new ie(t.width,t.height,xn.RGBA32,!1);return n.image=t,n.createTexture(),n}var i=new Ce(t.width,t.height,xn.RGBA32,!1,0,1);return i.image=t,i.createTexture(),i},ne.fromBytes=function(t,e,n,i,s){if(null==i&&(i=xn.RGBA32),null==s&&(s=Sn.StaticUsage),null!=ye.gl){var r=new Ce(e,n,i,!1,0,1);return r.image=r.bytesToArray(t),r.createTexture(),r}return null},ne.fromVideo=function(t){if(null==ye.gl){var e=new ie(t.element.videoWidth,t.element.videoHeight,xn.RGBA32,!1);return e.video=t.element,e.createTexture(),e}var n=new Ce(t.element.videoWidth,t.element.videoHeight,xn.RGBA32,!1,0,1);return n.video=t.element,n.createTexture(),n},ne.get_nonPow2Supported=function(){return null!=ye.gl},ne.prototype={unload:function(){},lock:function(t){return null==t&&(t=0),null},unlock:function(){},generateMipmaps:function(t){},setMipmaps:function(t){},setDepthStencilFrom:function(t){},get_width:function(){return 0},get_height:function(){return 0},get_depth:function(){return 1},get_realWidth:function(){return 0},get_realHeight:function(){return 0},get_g2:function(){return null},get_g4:function(){return null},__class__:ne,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_realHeight:"get_realHeight",get_realWidth:"get_realWidth",get_depth:"get_depth",get_height:"get_height",get_width:"get_width"}};var ie=function(t,e,n,i){this.g2canvas=null,this.myWidth=t,this.myHeight=e,this.format=n,this.renderTarget=i,this.image=null,this.video=null,i&&this.createTexture()};(n["kha.CanvasImage"]=ie).__name__=!0,ie.init=function(){var t=window.document.createElement("canvas");null!=t&&(ie.context=t.getContext("2d"),t.width=2048,t.height=2048,ie.context.globalCompositeOperation="copy")},ie.__super__=ne,ie.prototype=s(ne.prototype,{image:null,video:null,data:null,myWidth:null,myHeight:null,format:null,renderTarget:null,frameBuffer:null,g2canvas:null,get_g2:function(){if(null==this.g2canvas){var t=window.document.createElement("canvas"),e=(this.image=t).getContext("2d");t.width=this.get_width(),t.height=this.get_height(),this.g2canvas=new Pn(e)}return this.g2canvas},get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},texture:null,createTexture:function(){null!=ye.gl&&(this.texture=ye.gl.createTexture(),ye.gl.bindTexture(3553,this.texture),ye.gl.texParameteri(3553,10240,9729),ye.gl.texParameteri(3553,10241,9729),ye.gl.texParameteri(3553,10242,33071),ye.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=ye.gl.createFramebuffer(),ye.gl.bindFramebuffer(36160,this.frameBuffer),ye.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),ye.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),ye.gl.bindFramebuffer(36160,null)):null!=this.video?ye.gl.texImage2D(3553,0,6408,6408,5121,this.video):ye.gl.texImage2D(3553,0,6408,6408,5121,this.image),ye.gl.bindTexture(3553,null))},bytes:null,lock:function(t){return null==t&&(t=0),this.bytes=$.alloc(this.format==xn.RGBA32?4*this.get_width()*this.get_height():this.get_width()*this.get_height()),this.bytes},unlock:function(){if(null!=ye.gl){if(this.texture=ye.gl.createTexture(),ye.gl.bindTexture(3553,this.texture),ye.gl.texParameteri(3553,10240,9729),ye.gl.texParameteri(3553,10241,9729),ye.gl.texParameteri(3553,10242,33071),ye.gl.texParameteri(3553,10243,33071),ye.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,new Uint8Array(this.bytes.getData())),1282==ye.gl.getError()){for(var t=$.alloc(this.get_width()*this.get_height()*4),e=0,n=this.get_height();e<n;)for(var i=e++,s=0,r=this.get_width();s<r;){var a=s++,l=this.bytes.get(i*this.get_width()+a);t.set(i*this.get_width()*4+4*a,l),t.set(i*this.get_width()*4+4*a+1,l),t.set(i*this.get_width()*4+4*a+2,l),t.set(i*this.get_width()*4+4*a+3,255)}ye.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,new Uint8Array(t.getData()))}ye.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){this.image=null,this.video=null,this.data=null},__class__:ie});var se=t.kha._Color.Color_Impl_={};(n["kha._Color.Color_Impl_"]=se).__name__=!0,se.fromBytes=function(t,e,n,i){return null==i&&(i=255),se._new(i<<24|t<<16|e<<8|n)},se.fromFloats=function(t,e,n,i){return null==i&&(i=1),se._new(gt.int(255*i)<<24|gt.int(255*t)<<16|gt.int(255*e)<<8|gt.int(255*n))},se._new=function(t){return t};var re=function(){};(n["kha.CompilerDefines"]=re).__name__=!0;var ae=function(){};(n["kha.Display"]=ae).__name__=!0,ae.__properties__={get_primary:"get_primary"},ae.get_primary=function(){return ae.instance},ae.prototype={get_frequency:function(){return 60},__class__:ae,__properties__:{get_frequency:"get_frequency"}};var le=function(){};(n["kha.DisplayMode"]=le).__name__=!0;var oe=function(t,e,n,i,s){this.window=t,this.graphics1=e,this.graphics2=n,this.graphics4=i,this.graphics5=s};(n["kha.Framebuffer"]=oe).__name__=!0,oe.__interfaces__=[te],oe.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,graphics5:null,init:function(t,e,n,i){this.graphics1=t,this.graphics2=e,this.graphics4=n,this.graphics5=i},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},get_width:function(){return be.windowWidth(this.window)},get_height:function(){return be.windowHeight(this.window)},__class__:oe,__properties__:{get_height:"get_height",get_width:"get_width",get_g4:"get_g4",get_g2:"get_g2"}};var he=function(t,e,n,i,s,r){null==r&&(r=1),null==s&&(s=8),null==i&&(i=16),null==n&&(n=32),null==e&&(e=!0),null==t&&(t=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=t,this.verticalSync=e,this.colorBufferBits=n,this.depthBufferBits=i,this.stencilBufferBits=s,this.samplesPerPixel=r};(n["kha.FramebufferOptions"]=he).__name__=!0,he.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:he};var ue=function(){};(n["kha.AlignedQuad"]=ue).__name__=!0,ue.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:ue};var _e=function(t,e,n,i,s,r,a,l){this.mySize=t,this.width=s,this.height=r,this.chars=a,this.baseline=e;for(var o=0;o<a.length;){var h=a[o];++o,h.yoff+=this.baseline}this.texture=ne.create(s,r,xn.L8);for(var u=this.texture.lock(),_=0,c=0,d=r;c<d;){c++;for(var g=0,f=s;g<f;){g++;u.set(_,l.readU8(_)),++_}}this.texture.unlock()};(n["kha.KravurImage"]=_e).__name__=!0,_e.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(t,e,n,i){if(e>=this.chars.length)return null;var s=1/this.width,r=1/this.height,a=this.chars[e];if(null==a)return null;var l=Math.round(n+a.xoff),o=Math.round(i+a.yoff);return t.x0=l,t.y0=o,t.x1=l+a.x1-a.x0,t.y1=o+a.y1-a.y0,t.s0=a.x0*s,t.t0=a.y0*r,t.s1=a.x1*s,t.t1=a.y1*r,t.xadvance=a.xadvance,t},getCharWidth:function(t){if(0==this.chars.length)return 0;var e=_e.charBlocks[0];if(t<e)return this.chars[0].xadvance;for(var n=1,i=gt.int(_e.charBlocks.length/2);n<i;){var s=n++,r=_e.charBlocks[2*s-1],a=_e.charBlocks[2*s];a-1<t&&(e+=a-1-r)}return t-e>=this.chars.length?this.chars[0].xadvance:this.chars[t-e].xadvance},getHeight:function(){return this.mySize},stringWidth:function(t){for(var e=0,n=0,i=t.length;n<i;){var s=n++;e+=this.getCharWidth(ht.cca(t,s))}return e},charactersWidth:function(t,e,n){for(var i=0,s=e,r=e+n;s<r;){var a=s++;i+=this.getCharWidth(t[a])}return i},getBaselinePosition:function(){return this.baseline},__class__:_e};var ce=function(t){this.images=new tt,this.blob=t};(n["kha.Kravur"]=ce).__name__=!0,ce.__interfaces__=[ee],ce.prototype={oldGlyphs:null,blob:null,images:null,_get:function(t){var e=Oe.fontGlyphs;if(e!=this.oldGlyphs){this.oldGlyphs=e;for(var n=(_e.charBlocks=[e[0]])[0]+1,i=1,s=e.length;i<s;){var r=i++;e[r]!=n?(_e.charBlocks.push(e[r-1]),_e.charBlocks.push(e[r]),n=e[r]+1):++n}_e.charBlocks.push(e[e.length-1])}var a=1e4*t+e.length;if(!this.images.exists(a)){for(var l=64,o=32,h=new Array(e.length),u=0,_=h.length;u<_;){h[u++]=new Ze}for(var c=null,d=-1;d<=0;)o<l?o*=2:l*=2,c=Nn.alloc(l*o),d=Qe.stbtt_BakeFontBitmap(this.blob,0,t,c,l,o,e,h);var g=new Xe;Qe.stbtt_InitFont(g,this.blob,0);var f=Qe.stbtt_GetFontVMetrics(g),p=Qe.stbtt_ScaleForPixelHeight(g,t),m=Math.round(f.ascent*p),v=Math.round(f.descent*p),w=Math.round(f.lineGap*p),b=new _e(gt.int(t),m,v,w,l,o,h,c);return this.images.set(a,b),b}return this.images.get(a)},height:function(t){return this._get(t).getHeight()},width:function(t,e){return this._get(t).stringWidth(e)},unload:function(){this.blob=null,this.images=null},__class__:ce};var de=function(){};(n["kha.LoaderImpl"]=de).__name__=!0,de.getImageFormats=function(){return["png","jpg","hdr"]},de.loadImageFromDescription=function(e,i,n){var s=pt.hasField(e,"readable")&&e.readable;if(J.endsWith(e.files[0],".hdr"))de.loadBlobFromDescription(e,function(t){var e=Vn.parse(t.toBytes()),n=ne.fromBytes($.ofData(e.data.buffer),e.width,e.height,xn.RGBA128,s?Sn.DynamicUsage:Sn.StaticUsage);i(n)},n);else{var r=window.document.createElement("img");r.onerror=function(t){n({url:e.files[0],error:t})},r.onload=function(t){var e=ne.fromImage(r,s);i(e)},r.src=e.files[0],r.crossOrigin=""}},de.getSoundFormats=function(){var t=window.document.createElement("audio"),e=[];return""!=t.canPlayType("audio/mp4")&&e.push("mp4"),""!=t.canPlayType("audio/mp3")&&e.push("mp3"),(ye._hasWebAudio||""!=t.canPlayType("audio/ogg"))&&e.push("ogg"),e},de.loadSoundFromDescription=function(t,e,n){if(ye._hasWebAudio){var i=window.document.createElement("audio");if(""!=i.canPlayType("audio/mp4"))for(var s=0,r=t.files.length;s<r;){var a=s++,l=t.files[a];if(J.endsWith(l,".mp4"))return void new Kn(l,e,n)}if(""!=i.canPlayType("audio/mp3"))for(var o=0,h=t.files.length;o<h;){var u=o++,_=t.files[u];if(J.endsWith(_,".mp3"))return void new Kn(_,e,n)}for(var c=0,d=t.files.length;c<d;){var g=c++,f=t.files[g];if(J.endsWith(f,".ogg"))return void new Kn(f,e,n)}}else if(ye.mobile){var p=window.document.createElement("audio");if(""!=p.canPlayType("audio/mp4"))for(var m=0,v=t.files.length;m<v;){var w=m++,b=t.files[w];if(J.endsWith(b,".mp4"))return void new Yn(b,e,n)}if(""!=p.canPlayType("audio/mp3"))for(var x=0,y=t.files.length;x<y;){var S=x++,C=t.files[S];if(J.endsWith(C,".mp3"))return void new Yn(C,e,n)}for(var I=0,T=t.files.length;I<T;){var k=I++,B=t.files[k];if(J.endsWith(B,".ogg"))return void new Yn(B,e,n)}}else new jn(t.files,e,n)},de.getVideoFormats=function(){return["mp4","webm"]},de.loadVideoFromDescription=function(t,e,n){Un.fromFile(t.files,e)},de.loadRemote=function(l,o,h){var u=new XMLHttpRequest;u.open("GET",l.files[0],!0),u.responseType="arraybuffer",u.onreadystatechange=function(){if(4==u.readyState)if(200<=u.status&&u.status<400||0==u.status&&""==u.statusText){var t=null,e=u.response;if(null!=e){var n=new Uint8Array(e);t=$.ofData(n)}else{if(null==u.responseBody)return void h({url:l.files[0]});var i=VBArray(u.responseBody).toArray();t=$.alloc(i.length);for(var s=0,r=i.length;s<r;){var a=s++;t.set(a,i[a])}}o(new Nn(t))}else h({url:l.files[0]})},u.send(null)},de.loadBlobFromDescription=function(t,e,n){de.loadRemote(t,e,n)},de.loadFontFromDescription=function(t,e,n){de.loadBlobFromDescription(t,function(t){e(new ce(t))},n)};var ge=function(){};(n["kha.TimeTask"]=ge).__name__=!0,ge.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:ge};var fe=function(t,e,n){this.task=t,this.priority=e,this.id=n,this.active=!0,this.paused=!1};(n["kha.FrameTask"]=fe).__name__=!0,fe.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:fe};var pe=function(){};(n["kha.Scheduler"]=pe).__name__=!0,pe.init=function(){pe.deltas=[];for(var t=0,e=pe.DIF_COUNT;t<e;){var n=t++;pe.deltas[n]=0}pe.stopped=!0,pe.frame_tasks_sorted=!0,pe.current=pe.lastTime=pe.realTime(),pe.currentFrameTaskId=0,pe.currentTimeTaskId=0,pe.currentGroupId=0,pe.timeTasks=[],pe.pausedTimeTasks=[],pe.outdatedTimeTasks=[],pe.timeTasksScratchpad=[],pe.frameTasks=[],pe.toDeleteFrame=[]},pe.start=function(t){null==t&&(t=!1),pe.vsync=Ie.get(0).get_vSynced();var e=ae.get_primary().get_frequency();57<=e&&e<=63&&(e=60),pe.onedifhz=1/e,pe.stopped=!1,pe.resetTime(),pe.lastTime=pe.realTime()-pe.startTime;for(var n=0,i=pe.DIF_COUNT;n<i;){var s=n++;pe.deltas[s]=0}if(t){for(var r=0,a=pe.timeTasks;r<a.length;){var l=a[r];++r,l.paused=!1}for(var o=0,h=pe.frameTasks;o<h.length;){var u=h[o];++o,u.paused=!1}}},pe.executeFrame=function(){var t=pe.realTime()-pe.startTime-pe.lastTime,e=pe.current;if(0<=t){if(null==si.the())if(t>pe.maxframetime)pe.startTime+=t-pe.maxframetime,e+=t=pe.maxframetime;else if(pe.vsync){for(var n=pe.onedifhz;n<t-pe.onedifhz;)n+=pe.onedifhz;t=n;for(var i=0,s=pe.DIF_COUNT-2;i<s;){var r=i++;t+=pe.deltas[r],pe.deltas[r]=pe.deltas[r+1]}t+=pe.deltas[pe.DIF_COUNT-2],t/=pe.DIF_COUNT,pe.deltas[pe.DIF_COUNT-2]=n,e+=t}else{for(var a=0,l=pe.DIF_COUNT-1;a<l;){var o=a++;pe.deltas[o]=pe.deltas[o+1]}pe.deltas[pe.DIF_COUNT-1]=t;for(var h=0,u=0,_=pe.DIF_COUNT;u<_;){var c=u++;h+=pe.deltas[c]}e+=h/=pe.DIF_COUNT}else e+=t;pe.lastTime=e,pe.stopped||(pe.current=e);for(var d=0,g=pe.pausedTimeTasks;d<g.length;){var f=g[d];++d,f.next+=t}if(pe.stopped)for(var p=0,m=pe.timeTasks;p<m.length;){var v=m[p];++p,v.next+=t}pe.executeTimeTasks(e);for(var w=0,b=pe.outdatedTimeTasks;w<b.length;){var x=b[w];++w,x.next<e-10&&pe.timeTasksScratchpad.push(x)}for(var y=0,S=pe.timeTasksScratchpad;y<S.length;){var C=S[y];++y,ht.remove(pe.outdatedTimeTasks,C)}for(;0<pe.timeTasksScratchpad.length;)ht.remove(pe.timeTasksScratchpad,pe.timeTasksScratchpad[0])}pe.sortFrameTasks();for(var I=0,T=pe.frameTasks;I<T.length;){var k=T[I];++I,pe.stopped||k.paused||!k.active||k.task()||(k.active=!1)}for(var B=0,E=pe.frameTasks;B<E.length;){var M=E[B];++B,M.active||pe.toDeleteFrame.push(M)}for(;0<pe.toDeleteFrame.length;)ht.remove(pe.frameTasks,pe.toDeleteFrame.pop())},pe.executeTimeTasks=function(t){for(;0<pe.timeTasks.length&&(pe.activeTimeTask=pe.timeTasks[0],pe.activeTimeTask.next<=t);)pe.activeTimeTask.next+=pe.activeTimeTask.period,ht.remove(pe.timeTasks,pe.activeTimeTask),pe.activeTimeTask.active&&pe.activeTimeTask.task()?0<pe.activeTimeTask.period&&(0==pe.activeTimeTask.duration||pe.activeTimeTask.duration>=pe.activeTimeTask.start+pe.activeTimeTask.next)?pe.insertSorted(pe.timeTasks,pe.activeTimeTask):pe.archiveTimeTask(pe.activeTimeTask,t):(pe.activeTimeTask.active=!1,pe.archiveTimeTask(pe.activeTimeTask,t));pe.activeTimeTask=null},pe.archiveTimeTask=function(t,e){},pe.time=function(){return pe.current},pe.realTime=function(){return be.get_time()},pe.resetTime=function(){var t=be.get_time(),e=t-pe.startTime;pe.startTime=t;for(var n=0,i=pe.timeTasks;n<i.length;){var s=i[n];++n,s.start-=e,s.next-=e}for(var r=0,a=pe.DIF_COUNT;r<a;){var l=r++;pe.deltas[l]=0}pe.current=0,pe.lastTime=0},pe.addBreakableTimeTaskToGroup=function(t,e,n,i,s){null==s&&(s=0),null==i&&(i=0);var r=new ge;return r.active=!0,r.task=e,r.id=++pe.currentTimeTaskId,r.groupId=t,r.start=pe.current+n,(r.period=0)!=i&&(r.period=i),(r.duration=0)!=s&&(r.duration=r.start+s),r.next=r.start,pe.insertSorted(pe.timeTasks,r),r.id},pe.addTimeTaskToGroup=function(t,e,n,i,s){return null==s&&(s=0),null==i&&(i=0),pe.addBreakableTimeTaskToGroup(t,function(){return e(),!0},n,i,s)},pe.addTimeTask=function(t,e,n,i){return null==i&&(i=0),null==n&&(n=0),pe.addTimeTaskToGroup(0,t,e,n,i)},pe.insertSorted=function(t,e){for(var n=0,i=t.length;n<i;){var s=n++;if(t[s].next>e.next)return void t.splice(s,0,e)}t.push(e)},pe.sortFrameTasks=function(){pe.frame_tasks_sorted||(pe.frameTasks.sort(function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}),pe.frame_tasks_sorted=!0)};b["kha.ScreenRotation"]={__ename__:!0,__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"],RotationNone:{_hx_index:0,__enum__:"kha.ScreenRotation",toString:i},Rotation90:{_hx_index:1,__enum__:"kha.ScreenRotation",toString:i},Rotation180:{_hx_index:2,__enum__:"kha.ScreenRotation",toString:i},Rotation270:{_hx_index:3,__enum__:"kha.ScreenRotation",toString:i}};var me=function(){};(n["kha.Shaders"]=me).__name__=!0,me.init=function(){var t=[],e=pt.field(me,"Material_mesh_fragData0"),n=mt.run(e);t.push(Nn.fromBytes(n));var i=pt.field(me,"Material_mesh_fragData1"),s=mt.run(i);t.push(Nn.fromBytes(s));var r=pt.field(me,"Material_mesh_fragData2"),a=mt.run(r);t.push(Nn.fromBytes(a)),me.Material_mesh_frag=new sn(t,["Material_mesh.frag.essl","Material_mesh-relaxed.frag.essl","Material_mesh-webgl2.frag.essl"]);var l=[],o=pt.field(me,"Material_mesh_vertData0"),h=mt.run(o);l.push(Nn.fromBytes(h));var u=pt.field(me,"Material_mesh_vertData1"),_=mt.run(u);l.push(Nn.fromBytes(_));var c=pt.field(me,"Material_mesh_vertData2"),d=mt.run(c);l.push(Nn.fromBytes(d)),me.Material_mesh_vert=new Tn(l,["Material_mesh.vert.essl","Material_mesh-relaxed.vert.essl","Material_mesh-webgl2.vert.essl"]);var g=[],f=pt.field(me,"painter_colored_vertData0"),p=mt.run(f);g.push(Nn.fromBytes(p));var m=pt.field(me,"painter_colored_vertData1"),v=mt.run(m);g.push(Nn.fromBytes(v));var w=pt.field(me,"painter_colored_vertData2"),b=mt.run(w);g.push(Nn.fromBytes(b)),me.painter_colored_vert=new Tn(g,["painter-colored.vert.essl","painter-colored-relaxed.vert.essl","painter-colored-webgl2.vert.essl"]);var x=[],y=pt.field(me,"painter_image_fragData0"),S=mt.run(y);x.push(Nn.fromBytes(S));var C=pt.field(me,"painter_image_fragData1"),I=mt.run(C);x.push(Nn.fromBytes(I));var T=pt.field(me,"painter_image_fragData2"),k=mt.run(T);x.push(Nn.fromBytes(k)),me.painter_image_frag=new sn(x,["painter-image.frag.essl","painter-image-relaxed.frag.essl","painter-image-webgl2.frag.essl"]);var B=[],E=pt.field(me,"painter_colored_fragData0"),M=mt.run(E);B.push(Nn.fromBytes(M));var L=pt.field(me,"painter_colored_fragData1"),A=mt.run(L);B.push(Nn.fromBytes(A));var W=pt.field(me,"painter_colored_fragData2"),F=mt.run(W);B.push(Nn.fromBytes(F)),me.painter_colored_frag=new sn(B,["painter-colored.frag.essl","painter-colored-relaxed.frag.essl","painter-colored-webgl2.frag.essl"]);var O=[],R=pt.field(me,"painter_image_vertData0"),D=mt.run(R);O.push(Nn.fromBytes(D));var N=pt.field(me,"painter_image_vertData1"),V=mt.run(N);O.push(Nn.fromBytes(V));var H=pt.field(me,"painter_image_vertData2"),G=mt.run(H);O.push(Nn.fromBytes(G)),me.painter_image_vert=new Tn(O,["painter-image.vert.essl","painter-image-relaxed.vert.essl","painter-image-webgl2.vert.essl"]);var P=[],Z=pt.field(me,"painter_video_vertData0"),X=mt.run(Z);P.push(Nn.fromBytes(X));var z=pt.field(me,"painter_video_vertData1"),Y=mt.run(z);P.push(Nn.fromBytes(Y));var j=pt.field(me,"painter_video_vertData2"),U=mt.run(j);P.push(Nn.fromBytes(U)),me.painter_video_vert=new Tn(P,["painter-video.vert.essl","painter-video-relaxed.vert.essl","painter-video-webgl2.vert.essl"]);var K=[],Q=pt.field(me,"painter_text_fragData0"),J=mt.run(Q);K.push(Nn.fromBytes(J));var q=pt.field(me,"painter_text_fragData1"),$=mt.run(q);K.push(Nn.fromBytes($));var tt=pt.field(me,"painter_text_fragData2"),et=mt.run(tt);K.push(Nn.fromBytes(et)),me.painter_text_frag=new sn(K,["painter-text.frag.essl","painter-text-relaxed.frag.essl","painter-text-webgl2.frag.essl"]);var nt=[],it=pt.field(me,"painter_video_fragData0"),st=mt.run(it);nt.push(Nn.fromBytes(st));var rt=pt.field(me,"painter_video_fragData1"),at=mt.run(rt);nt.push(Nn.fromBytes(at));var lt=pt.field(me,"painter_video_fragData2"),ot=mt.run(lt);nt.push(Nn.fromBytes(ot)),me.painter_video_frag=new sn(nt,["painter-video.frag.essl","painter-video-relaxed.frag.essl","painter-video-webgl2.frag.essl"]);var ht=[],ut=pt.field(me,"painter_text_vertData0"),_t=mt.run(ut);ht.push(Nn.fromBytes(_t));var ct=pt.field(me,"painter_text_vertData1"),dt=mt.run(ct);ht.push(Nn.fromBytes(dt));var gt=pt.field(me,"painter_text_vertData2"),ft=mt.run(gt);ht.push(Nn.fromBytes(ft)),me.painter_text_vert=new Tn(ht,["painter-text.vert.essl","painter-text-relaxed.vert.essl","painter-text-webgl2.vert.essl"])};var ve=function(){};(n["kha.Sound"]=ve).__name__=!0,ve.__interfaces__=[ee],ve.prototype={compressedData:null,uncompressedData:null,uncompress:function(t){},__class__:ve};var we=function(t,e,n,i,s){null==n&&(n=-1),null==e&&(e=-1),null==t&&(t="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=t,this.window=null==i?new Te(null,null,null,null,null,null,null,null,null):i,0<e?(this.window.width=e,this.width=e):this.width=this.window.width,0<n?(this.window.height=n,this.height=n):this.height=this.window.height,null==this.window.title&&(this.window.title=t),this.framebuffer=null==s?new he(null,null,null,null,null,null):s};(n["kha.SystemOptions"]=we).__name__=!0,we.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:we};var be=function(){};(n["kha.System"]=be).__name__=!0,be.__properties__={get_time:"get_time"},be.start=function(t,e){be.theTitle=t.title,ye.init(t,e)},be.notifyOnFrames=function(t){be.renderListeners.push(t)},be.notifyOnCutCopyPaste=function(t,e,n){be.cutListener=t,be.copyListener=e,be.pasteListener=n},be.render=function(t){for(var e=0,n=be.renderListeners;e<n.length;){var i=n[e];++e,i(t)}},be.foreground=function(){for(var t=0,e=be.foregroundListeners;t<e.length;){var n=e[t];++t,n()}},be.background=function(){for(var t=0,e=be.backgroundListeners;t<e.length;){var n=e[t];++t,n()}},be.shutdown=function(){for(var t=0,e=be.shutdownListeners;t<e.length;){var n=e[t];++t,n()}},be.get_time=function(){return ye.getTime()},be.windowWidth=function(t){return null==t&&(t=0),Ie.get(t).get_width()},be.windowHeight=function(t){return null==t&&(t=0),Ie.get_all()[t].get_height()};var xe=function(){this.axes=[],this.buttons=[]};(n["kha.GamepadStates"]=xe).__name__=!0,xe.prototype={axes:null,buttons:null,__class__:xe};var ye=function(){};(n["kha.SystemImpl"]=ye).__name__=!0,ye.init=function(t,e){ye.options=t,ye.mobile=ye.isMobile(),ye.ios=ye.isIOS(),ye.chrome=ye.isChrome(),ye.firefox=ye.isFirefox(),ye.ie=ye.isIE(),ye.initSecondStep(e)},ye.initSecondStep=function(t){ye.init2(ye.options.window.width,ye.options.window.height),t(ye.window),ye.ios?window.ondevicemotion=function(t){On._changed(0,-t.accelerationIncludingGravity.x,-t.accelerationIncludingGravity.y,-t.accelerationIncludingGravity.z)}:window.ondevicemotion=function(t){On._changed(0,t.accelerationIncludingGravity.x,t.accelerationIncludingGravity.y,t.accelerationIncludingGravity.z)},window.ondeviceorientation=function(t){On._changed(1,t.beta,t.gamma,t.alpha)}},ye.isMobile=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("Android")||0<=t.indexOf("webOS")||0<=t.indexOf("BlackBerry")||0<=t.indexOf("Windows Phone")||!!ye.isIOS()},ye.isIOS=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("iPhone")||0<=t.indexOf("iPad")||0<=t.indexOf("iPod")},ye.isChrome=function(){return 0<=window.navigator.userAgent.indexOf("Chrome")},ye.isFirefox=function(){return 0<=window.navigator.userAgent.indexOf("Firefox")},ye.isIE=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("MSIE ")||0<=t.indexOf("Trident/")},ye.setCanvas=function(t){ye.khanvas=t},ye.getTime=function(){return(window.performance?window.performance:window.Date).now()/1e3},ye.init2=function(t,e,n){if(ye.keyboard=new Ln,ye.mouse=new Wn,ye.surface=new Dn,ye.gamepads=[],ye.gamepadStates=[],ye.gamepads[0]=new En(0),ye.gamepadStates[0]=new xe,ye.gamepads[1]=new En(1),ye.gamepadStates[1]=new xe,ye.gamepads[2]=new En(2),ye.gamepadStates[2]=new xe,ye.gamepads[3]=new En(3),ye.gamepadStates[3]=new xe,window.addEventListener("gamepadconnected",function(t){En.sendConnectEvent(t.gamepad.index)}),window.addEventListener("gamepaddisconnected",function(t){En.sendDisconnectEvent(t.gamepad.index)}),ye.ie){ye.pressedKeys=[];for(var i=0;i<256;){i++;ye.pressedKeys.push(!1)}for(var s=0;s<256;){s++;ye.pressedKeys.push(null)}}window.document.addEventListener("copy",function(t){var e=t;if(null!=be.copyListener){var n=be.copyListener();null!=n&&e.clipboardData.setData("text/plain",n),e.preventDefault()}}),window.document.addEventListener("cut",function(t){var e=t;if(null!=be.cutListener){var n=be.cutListener();null!=n&&e.clipboardData.setData("text/plain",n),e.preventDefault()}}),window.document.addEventListener("paste",function(t){var e=t;if(null!=be.pasteListener){var n=e.clipboardData.getData("text/plain");be.pasteListener(n),e.preventDefault()}}),ie.init(),pe.init(),ye.loadFinished(t,e)},ye.getMouse=function(t){return 0!=t?null:ye.mouse},ye.getKeyboard=function(t){return 0!=t?null:ye.keyboard},ye.checkGamepad=function(t){for(var e=0,n=t.axes.length;e<n;){var i=e++;if(null!=t.axes[i]){var s=t.axes[i];i%2==1&&(s=-s),ye.gamepadStates[t.index].axes[i]!=s&&(ye.gamepadStates[t.index].axes[i]=s,ye.gamepads[t.index].sendAxisEvent(i,s))}}for(var r=0,a=t.buttons.length;r<a;){var l=r++;null!=t.buttons[l]&&ye.gamepadStates[t.index].buttons[l]!=t.buttons[l].value&&(ye.gamepadStates[t.index].buttons[l]=t.buttons[l].value,ye.gamepads[t.index].sendButtonEvent(l,t.buttons[l].value))}t.axes.length<=4&&7<t.buttons.length&&(ye.gamepadStates[t.index].axes[4]=t.buttons[6].value,ye.gamepads[t.index].sendAxisEvent(4,t.buttons[6].value),ye.gamepadStates[t.index].axes[5]=t.buttons[7].value,ye.gamepads[t.index].sendAxisEvent(5,t.buttons[7].value))},ye.loadFinished=function(t,e){var o=ye.khanvas;null==o&&(o=window.document.getElementById(re.canvas_id));var n=!(o.style.cursor="default");try{ye.gl=o.getContext("webgl2",{alpha:!1,antialias:1<ye.options.framebuffer.samplesPerPixel,stencil:!0}),ye.gl.pixelStorei(37441,1),ye.halfFloat={HALF_FLOAT_OES:5131},ye.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},ye.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},ye.elementIndexUint=!0,ye.gl.getExtension("EXT_color_buffer_float"),ye.gl.getExtension("OES_texture_float_linear"),ye.gl.getExtension("OES_texture_half_float_linear"),ye.anisotropicFilter=ye.gl.getExtension("EXT_texture_filter_anisotropic"),null==ye.anisotropicFilter&&(ye.anisotropicFilter=ye.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),n=!0,ye.gl2=!0,me.init()}catch(t){t instanceof Xt&&t.val;L.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"kha/SystemImpl.hx",lineNumber:335,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!ye.gl2)try{ye.gl=o.getContext("experimental-webgl",{alpha:!1,antialias:1<ye.options.framebuffer.samplesPerPixel,stencil:!0}),ye.gl.pixelStorei(37441,1),ye.gl.getExtension("OES_texture_float"),ye.gl.getExtension("OES_texture_float_linear"),ye.halfFloat=ye.gl.getExtension("OES_texture_half_float"),ye.gl.getExtension("OES_texture_half_float_linear"),ye.depthTexture=ye.gl.getExtension("WEBGL_depth_texture"),ye.gl.getExtension("EXT_shader_texture_lod"),ye.gl.getExtension("OES_standard_derivatives"),ye.anisotropicFilter=ye.gl.getExtension("EXT_texture_filter_anisotropic"),null==ye.anisotropicFilter&&(ye.anisotropicFilter=ye.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),ye.drawBuffers=ye.gl.getExtension("WEBGL_draw_buffers"),ye.elementIndexUint=ye.gl.getExtension("OES_element_index_uint"),n=!0,me.init()}catch(t){t instanceof Xt&&t.val;L.trace("Could not initialize WebGL, falling back to <canvas>.",{fileName:"kha/SystemImpl.hx",lineNumber:357,className:"kha.SystemImpl",methodName:"loadFinished"})}if(ye.setCanvas(o),ye.window=new Ie(t,e,o),n){var i=new Jn;ye.frame=new oe(0,null,null,i),ye.frame.init(new Re(ye.frame),new qn(ye.frame),i)}else{Zn.Kravur=ce,ce=Zn;var s=new Pn(o.getContext("2d"));ye.frame=new oe(0,null,s,null),ye.frame.init(new Re(ye.frame),s,null)}!ye.mobile&&Be._init()?(ye._hasWebAudio=!0,Ee._init()):ye.mobile?(ye._hasWebAudio=!1,Xn._init(),Ee=Xn):(ye._hasWebAudio=!1,Gn._compile(),Ee=Gn),ti.instance=new ei,pe.start();var r=window,h=r.requestAnimationFrame;null==h&&(h=r.mozRequestAnimationFrame),null==h&&(h=r.webkitRequestAnimationFrame),null==h&&(h=r.msRequestAnimationFrame);var u=null;u=function(t){var e=window;null==h?e.setTimeout(u,16.666666666666668):h(u);var n=ye.getGamepads();if(null!=n)for(var i=0,s=n.length;i<s;){var r=n[i++];null!=r&&ye.checkGamepad(r)}if(pe.executeFrame(),o.getContext){var a=o.clientWidth,l=o.clientHeight;o.width==a&&o.height==l||(o.width=a,o.height=l),be.render([ye.frame]),null!=ye.gl&&(ye.gl.clearColor(1,1,1,1),ye.gl.colorMask(!1,!1,!1,!0),ye.gl.clear(16384),ye.gl.colorMask(!0,!0,!0,!0))}},null==h?r.setTimeout(u,16.666666666666668):h(u),o.focus(),o.oncontextmenu=function(t){t.stopPropagation(),t.preventDefault()},o.onmousedown=ye.mouseDown,o.onmousemove=ye.mouseMove,null!=ye.keyboard&&(o.onkeydown=ye.keyDown,o.onkeyup=ye.keyUp,o.onkeypress=ye.keyPress),o.onblur=ye.onBlur,o.onfocus=ye.onFocus,o.onmousewheel=o.onwheel=ye.mouseWheel,o.onmouseleave=ye.mouseLeave,o.addEventListener("wheel mousewheel",ye.mouseWheel,!1),o.addEventListener("touchstart",ye.touchDown,!1),o.addEventListener("touchend",ye.touchUp,!1),o.addEventListener("touchmove",ye.touchMove,!1),o.addEventListener("touchcancel",ye.touchCancel,!1),window.addEventListener("unload",function(){be.shutdown()})},ye.setMouseXY=function(t){var e=ye.khanvas.getBoundingClientRect(),n=ye.khanvas.clientLeft,i=ye.khanvas.clientTop;ye.mouseX=gt.int((t.clientX-e.left-n)*ye.khanvas.width/(e.width-2*n)),ye.mouseY=gt.int((t.clientY-e.top-i)*ye.khanvas.height/(e.height-2*i))},ye.unlockiOSSound=function(){if(ye.ios&&!ye.iosSoundEnabled){var t=Xn._context.createBuffer(1,1,22050),e=Xn._context.createBufferSource();e.buffer=t,e.connect(Xn._context.destination),e.start(),e.stop(),ye.iosSoundEnabled=!0}},ye.unlockSound=function(){if(!ye.soundEnabled){var t=Be._context;null==t&&(t=Ee._context),null!=t&&t.resume().then(function(t){ye.soundEnabled=!0}).catch(function(t){L.trace(t,{fileName:"kha/SystemImpl.hx",lineNumber:597,className:"kha.SystemImpl",methodName:"unlockSound"})})}ye.unlockiOSSound()},ye.mouseLeave=function(){ye.mouse.sendLeaveEvent(0)},ye.mouseWheel=function(t){return ye.insideInputEvent=!0,ye.unlockSound(),t.preventDefault(),0==t.deltaMode?t.deltaY<0?ye.mouse.sendWheelEvent(0,-1):0<t.deltaY&&ye.mouse.sendWheelEvent(0,1):1==t.deltaMode&&(ye.minimumScroll=gt.int(Math.min(ye.minimumScroll,Math.abs(t.deltaY))),ye.mouse.sendWheelEvent(0,gt.int(t.deltaY/ye.minimumScroll))),ye.insideInputEvent=!1},ye.mouseDown=function(t){ye.insideInputEvent=!0,ye.unlockSound(),ye.setMouseXY(t),1==t.which?(t.ctrlKey?(ye.leftMouseCtrlDown=!0,ye.mouse.sendDownEvent(0,1,ye.mouseX,ye.mouseY)):(ye.leftMouseCtrlDown=!1,ye.mouse.sendDownEvent(0,0,ye.mouseX,ye.mouseY)),null!=ye.khanvas.setCapture?ye.khanvas.setCapture():ye.khanvas.ownerDocument.addEventListener("mousemove",ye.documentMouseMove,!0),ye.khanvas.ownerDocument.addEventListener("mouseup",ye.mouseLeftUp)):2==t.which?(ye.mouse.sendDownEvent(0,2,ye.mouseX,ye.mouseY),ye.khanvas.ownerDocument.addEventListener("mouseup",ye.mouseMiddleUp)):3==t.which&&(ye.mouse.sendDownEvent(0,1,ye.mouseX,ye.mouseY),ye.khanvas.ownerDocument.addEventListener("mouseup",ye.mouseRightUp)),ye.insideInputEvent=!1},ye.mouseLeftUp=function(t){ye.unlockSound(),1==t.which&&(ye.insideInputEvent=!0,ye.khanvas.ownerDocument.removeEventListener("mouseup",ye.mouseLeftUp),null!=ye.khanvas.releaseCapture?ye.khanvas.ownerDocument.releaseCapture():ye.khanvas.ownerDocument.removeEventListener("mousemove",ye.documentMouseMove,!0),ye.leftMouseCtrlDown?ye.mouse.sendUpEvent(0,1,ye.mouseX,ye.mouseY):ye.mouse.sendUpEvent(0,0,ye.mouseX,ye.mouseY),ye.leftMouseCtrlDown=!1,ye.insideInputEvent=!1)},ye.mouseMiddleUp=function(t){ye.unlockSound(),2==t.which&&(ye.insideInputEvent=!0,ye.khanvas.ownerDocument.removeEventListener("mouseup",ye.mouseMiddleUp),ye.mouse.sendUpEvent(0,2,ye.mouseX,ye.mouseY),ye.insideInputEvent=!1)},ye.mouseRightUp=function(t){ye.unlockSound(),3==t.which&&(ye.insideInputEvent=!0,ye.khanvas.ownerDocument.removeEventListener("mouseup",ye.mouseRightUp),ye.mouse.sendUpEvent(0,1,ye.mouseX,ye.mouseY),ye.insideInputEvent=!1)},ye.documentMouseMove=function(t){t.stopPropagation(),ye.mouseMove(t)},ye.mouseMove=function(t){ye.insideInputEvent=!0,ye.unlockSound();var e=ye.mouseX,n=ye.mouseY;ye.setMouseXY(t);var i=t.movementX,s=t.movementY;null==t.movementX&&(i=null!=t.mozMovementX?t.mozMovementX:null!=t.webkitMovementX?t.webkitMovementX:ye.mouseX-e,s=null!=t.mozMovementY?t.mozMovementY:null!=t.webkitMovementY?t.webkitMovementY:ye.mouseY-n),ye.firefox&&(i=gt.int(i*window.devicePixelRatio),s=gt.int(s*window.devicePixelRatio)),ye.mouse.sendMoveEvent(0,ye.mouseX,ye.mouseY,i,s),ye.insideInputEvent=!1},ye.setTouchXY=function(t){var e=ye.khanvas.getBoundingClientRect(),n=ye.khanvas.clientLeft,i=ye.khanvas.clientTop;ye.touchX=gt.int((t.clientX-e.left-n)*ye.khanvas.width/(e.width-2*n)),ye.touchY=gt.int((t.clientY-e.top-i)*ye.khanvas.height/(e.height-2*i))},ye.touchDown=function(t){ye.insideInputEvent=!0,ye.unlockSound(),t.stopPropagation(),t.preventDefault();for(var e=0,n=t.changedTouches;e<n.length;){var i=n[e];++e;var s=i.identifier;ye.ios&&(-1==(s=ye.iosTouchs.indexOf(-1))&&(s=ye.iosTouchs.length),ye.iosTouchs[s]=i.identifier),ye.setTouchXY(i),ye.mouse.sendDownEvent(0,0,ye.touchX,ye.touchY),ye.surface.sendTouchStartEvent(s,ye.touchX,ye.touchY)}ye.insideInputEvent=!1},ye.touchUp=function(t){ye.insideInputEvent=!0,ye.unlockSound();for(var e=0,n=t.changedTouches;e<n.length;){var i=n[e];++e;var s=i.identifier;ye.ios&&(s=ye.iosTouchs.indexOf(s),ye.iosTouchs[s]=-1),ye.setTouchXY(i),ye.mouse.sendUpEvent(0,0,ye.touchX,ye.touchY),ye.surface.sendTouchEndEvent(s,ye.touchX,ye.touchY)}ye.insideInputEvent=!1},ye.touchMove=function(t){ye.insideInputEvent=!0,ye.unlockSound();for(var e=0,n=0,i=t.changedTouches;n<i.length;){var s=i[n];if(++n,ye.setTouchXY(s),0==e){var r=ye.touchX-ye.lastFirstTouchX,a=ye.touchY-ye.lastFirstTouchY;ye.lastFirstTouchX=ye.touchX,ye.lastFirstTouchY=ye.touchY,ye.mouse.sendMoveEvent(0,ye.touchX,ye.touchY,r,a)}var l=s.identifier;ye.ios&&(l=ye.iosTouchs.indexOf(l)),ye.surface.sendMoveEvent(l,ye.touchX,ye.touchY),++e}ye.insideInputEvent=!1},ye.touchCancel=function(t){ye.insideInputEvent=!0,ye.unlockSound();for(var e=0,n=t.changedTouches;e<n.length;){var i=n[e];++e;var s=i.identifier;ye.ios&&(s=ye.iosTouchs.indexOf(s)),ye.setTouchXY(i),ye.mouse.sendUpEvent(0,0,ye.touchX,ye.touchY),ye.surface.sendTouchEndEvent(s,ye.touchX,ye.touchY)}ye.iosTouchs=[],ye.insideInputEvent=!1},ye.onBlur=function(){be.background()},ye.onFocus=function(){be.foreground()},ye.keyDown=function(t){if((t.keyCode<112||123<t.keyCode)&&null!=t.key&&1!=t.key.length&&t.preventDefault(),t.stopPropagation(),ye.ie){if(ye.pressedKeys[t.keyCode])return void t.preventDefault();ye.pressedKeys[t.keyCode]=!0}else if(t.repeat)return void t.preventDefault();ye.keyboard.sendDownEvent(t.keyCode)},ye.keyUp=function(t){t.preventDefault(),t.stopPropagation(),ye.ie&&(ye.pressedKeys[t.keyCode]=!1),ye.keyboard.sendUpEvent(t.keyCode)},ye.keyPress=function(t){if(0!=t.which){t.preventDefault(),t.stopPropagation();var e=t.which;ye.keyboard.sendPressEvent(String.fromCodePoint(e))}},ye.getGamepads=function(){return ye.chrome&&ti.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null},ye.getPen=function(t){return null};var Se=function(){};(n["kha.Video"]=Se).__name__=!0,Se.__interfaces__=[ee],Se.prototype={__class__:Se};var Ce=function(t,e,n,i,s,r){this.depthTexture=null,this.texture=null,this.renderBuffer=null,this.frameBuffer=null,this.myWidth=t,this.myHeight=e,this.format=n,this.renderTarget=i,this.samples=r,this.image=null,this.video=null,this.depthStencilFormat=s,Ce.init(),i&&this.createTexture()};(n["kha.WebGLImage"]=Ce).__name__=!0,Ce.init=function(){null==Ce.context&&(Ce.canvas=window.document.createElement("canvas"),null!=Ce.canvas&&(Ce.context=Ce.canvas.getContext("2d"),Ce.canvas.width=4096,Ce.canvas.height=4096,Ce.context.globalCompositeOperation="copy"))},Ce.formatByteSize=function(t){switch(t._hx_index){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2}},Ce.__super__=ne,Ce.prototype=s(ne.prototype,{image:null,video:null,myWidth:null,myHeight:null,format:null,renderTarget:null,samples:null,frameBuffer:null,renderBuffer:null,texture:null,depthTexture:null,graphics2:null,graphics4:null,depthStencilFormat:null,get_g2:function(){return null==this.graphics2&&(this.graphics2=new qn(this)),this.graphics2},get_g4:function(){return null==this.graphics4&&(this.graphics4=new Jn(this)),this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){if(null!=ye.gl){if(this.texture=ye.gl.createTexture(),ye.gl.bindTexture(3553,this.texture),ye.gl.texParameteri(3553,10240,9729),ye.gl.texParameteri(3553,10241,9729),ye.gl.texParameteri(3553,10242,33071),ye.gl.texParameteri(3553,10243,33071),this.renderTarget){switch(this.frameBuffer=ye.gl.createFramebuffer(),ye.gl.bindFramebuffer(36160,this.frameBuffer),this.format._hx_index){case 0:ye.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:ye.gl.texImage2D(3553,0,ye.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:ye.gl.texImage2D(3553,0,ye.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:ye.gl.texImage2D(3553,0,ye.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,ye.halfFloat.HALF_FLOAT_OES,null);break;case 5:ye.gl.texImage2D(3553,0,ye.gl2?33326:6406,this.get_realWidth(),this.get_realHeight(),0,ye.gl2?6403:6406,5126,null);break;case 6:ye.gl.texImage2D(3553,0,ye.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,ye.gl2?6403:6406,ye.halfFloat.HALF_FLOAT_OES,null);break;default:ye.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(this.format==xn.DEPTH16){if(ye.gl.texParameteri(3553,10240,9728),ye.gl.texParameteri(3553,10241,9728),ye.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),!ye.gl2){var t=ye.gl.createTexture();ye.gl.bindTexture(3553,t),ye.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),ye.gl.framebufferTexture2D(36160,36064,3553,t,0),ye.gl.bindTexture(3553,this.texture)}}else ye.gl.framebufferTexture2D(36160,36064,3553,this.texture,0);this.initDepthStencilBuffer(this.depthStencilFormat),36053!=ye.gl.checkFramebufferStatus(36160)&&L.trace("WebGL error: Framebuffer incomplete",{fileName:"kha/WebGLImage.hx",lineNumber:225,className:"kha.WebGLImage",methodName:"createTexture"}),ye.gl.bindRenderbuffer(36161,null),ye.gl.bindFramebuffer(36160,null)}else if(null!=this.video)ye.gl.texImage2D(3553,0,6408,6408,5121,this.video);else switch(this.format._hx_index){case 0:this.image instanceof Uint8Array?ye.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):ye.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 1:ye.gl.texImage2D(3553,0,6409,this.myWidth,this.myHeight,0,6409,5121,this.image);break;case 2:ye.gl.texImage2D(3553,0,ye.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:ye.gl.texImage2D(3553,0,ye.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ye.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:ye.gl.texImage2D(3553,0,ye.gl2?33326:6406,this.myWidth,this.myHeight,0,ye.gl2?6403:6406,5126,this.image);break;case 6:ye.gl.texImage2D(3553,0,ye.gl2?33325:6406,this.myWidth,this.myHeight,0,ye.gl2?6403:6406,ye.halfFloat.HALF_FLOAT_OES,this.image);break;default:ye.gl.texImage2D(3553,0,6408,6408,5121,this.image)}ye.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(t){switch(t){case 0:break;case 1:case 5:null==ye.depthTexture?(this.renderBuffer=ye.gl.createRenderbuffer(),ye.gl.bindRenderbuffer(36161,this.renderBuffer),ye.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),ye.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=ye.gl.createTexture(),ye.gl.bindTexture(3553,this.depthTexture),1==t?ye.gl.texImage2D(3553,0,ye.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):ye.gl.texImage2D(3553,0,ye.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null),ye.gl.texParameteri(3553,10240,9728),ye.gl.texParameteri(3553,10241,9728),ye.gl.texParameteri(3553,10242,33071),ye.gl.texParameteri(3553,10243,33071),ye.gl.bindFramebuffer(36160,this.frameBuffer),ye.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0));break;case 2:case 3:case 4:null==ye.depthTexture?(this.renderBuffer=ye.gl.createRenderbuffer(),ye.gl.bindRenderbuffer(36161,this.renderBuffer),ye.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),ye.gl.framebufferRenderbuffer(36160,33306,36161,this.renderBuffer)):(this.depthTexture=ye.gl.createTexture(),ye.gl.bindTexture(3553,this.depthTexture),ye.gl.texImage2D(3553,0,ye.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,ye.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),ye.gl.texParameteri(3553,10240,9728),ye.gl.texParameteri(3553,10241,9728),ye.gl.texParameteri(3553,10242,33071),ye.gl.texParameteri(3553,10243,33071),ye.gl.bindFramebuffer(36160,this.frameBuffer),ye.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,0))}},set:function(t){ye.gl.activeTexture(33984+t),ye.gl.bindTexture(3553,this.texture),null!=this.video&&ye.gl.texImage2D(3553,0,6408,6408,5121,this.video)},setDepth:function(t){ye.gl.activeTexture(33984+t),ye.gl.bindTexture(3553,this.depthTexture)},setDepthStencilFrom:function(t){ye.gl.bindFramebuffer(36160,this.frameBuffer),ye.gl.framebufferTexture2D(36160,36096,3553,zt.__cast(t,Ce).depthTexture,0)},bytesToArray:function(t){switch(this.format._hx_index){case 0:case 1:return new Uint8Array(t.getData());case 2:case 4:case 5:case 6:return new Float32Array(t.getData());default:return new Uint8Array(t.getData())}},bytes:null,lock:function(t){return null==t&&(t=0),this.bytes=$.alloc(Ce.formatByteSize(this.format)*this.get_width()*this.get_height()),this.bytes},unlock:function(){if(null!=ye.gl){switch(this.texture=ye.gl.createTexture(),ye.gl.bindTexture(3553,this.texture),ye.gl.texParameteri(3553,10240,9729),ye.gl.texParameteri(3553,10241,9729),ye.gl.texParameteri(3553,10242,33071),ye.gl.texParameteri(3553,10243,33071),this.format._hx_index){case 0:ye.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:if(ye.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes)),1282==ye.gl.getError()){for(var t=$.alloc(this.get_width()*this.get_height()*4),e=0,n=this.get_height();e<n;)for(var i=e++,s=0,r=this.get_width();s<r;){var a=s++,l=this.bytes.get(i*this.get_width()+a);t.set(i*this.get_width()*4+4*a,l),t.set(i*this.get_width()*4+4*a+1,l),t.set(i*this.get_width()*4+4*a+2,l),t.set(i*this.get_width()*4+4*a+3,255)}ye.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(t))}break;case 2:ye.gl.texImage2D(3553,0,ye.gl2?34836:6408,this.get_width(),this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:ye.gl.texImage2D(3553,0,ye.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,ye.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:ye.gl.texImage2D(3553,0,ye.gl2?33326:6406,this.get_width(),this.get_height(),0,ye.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:ye.gl.texImage2D(3553,0,ye.gl2?33325:6406,this.get_width(),this.get_height(),0,ye.gl2?6403:6406,ye.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;default:ye.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}ye.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){null!=this.texture&&ye.gl.deleteTexture(this.texture),null!=this.depthTexture&&ye.gl.deleteTexture(this.depthTexture),null!=this.frameBuffer&&ye.gl.deleteFramebuffer(this.frameBuffer),null!=this.renderBuffer&&ye.gl.deleteRenderbuffer(this.renderBuffer)},generateMipmaps:function(t){ye.gl.bindTexture(3553,this.texture),ye.gl.generateMipmap(3553)},setMipmaps:function(t){if(ye.gl.bindTexture(3553,this.texture),this.format==xn.RGBA128)for(var e=0,n=t.length;e<n;){var i=e++;ye.gl.texImage2D(3553,i+1,ye.gl2?34836:6408,t[i].get_width(),t[i].get_height(),0,6408,5126,zt.__cast(t[i],Ce).image)}else if(this.format==xn.RGBA64)for(var s=0,r=t.length;s<r;){var a=s++;ye.gl.texImage2D(3553,a+1,ye.gl2?34842:6408,t[a].get_width(),t[a].get_height(),0,6408,ye.halfFloat.HALF_FLOAT_OES,zt.__cast(t[a],Ce).image)}else for(var l=0,o=t.length;l<o;){var h=l++;ye.gl.texImage2D(3553,h+1,6408,6408,5121,zt.__cast(t[h],Ce).image)}},__class__:Ce});var Ie=function(t,e,n){this.canvas=n,this.defaultWidth=t,this.defaultHeight=e,Ie.windows.push(this)};(n["kha.Window"]=Ie).__name__=!0,Ie.__properties__={get_all:"get_all"},Ie.get=function(t){return Ie.windows[t]},Ie.get_all=function(){return Ie.windows},Ie.prototype={canvas:null,defaultWidth:null,defaultHeight:null,get_width:function(){return 0==this.canvas.width?this.defaultWidth:this.canvas.width},get_height:function(){return 0==this.canvas.height?this.defaultHeight:this.canvas.height},get_vSynced:function(){return!0},__class__:Ie,__properties__:{get_vSynced:"get_vSynced",get_height:"get_height",get_width:"get_width"}};var Te=function(t,e,n,i,s,r,a,l,o){null==o&&(o=0),null==a&&(a=!0),null==s&&(s=600),null==i&&(i=800),null==n&&(n=-1),null==e&&(e=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=null,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=t,this.x=e,this.y=n,this.width=i,this.height=s,this.display=null==r?ae.get_primary():r,this.visible=a,this.windowFeatures=null==l?7:l,this.mode=o};(n["kha.WindowOptions"]=Te).__name__=!0,Te.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:Te};var ke=function(){};(n["kha.audio1.AudioChannel"]=ke).__name__=!0,ke.prototype={play:null,set_volume:null,get_finished:null,__class__:ke,__properties__:{get_finished:"get_finished",set_volume:"set_volume"}};var Be=function(){};(n["kha.audio2.Audio"]=Be).__name__=!0,Be.initContext=function(){try{return void(Be._context=new AudioContext)}catch(t){t instanceof Xt&&t.val}try{return void(this._context=new webkitAudioContext)}catch(t){t instanceof Xt&&t.val}},Be._init=function(){if(Be.initContext(),null==Be._context)return!1;return Be.buffer=new Le(8192,2,gt.int(Be._context.sampleRate)),Be.processingNode=Be._context.createScriptProcessor(2048,0,2),Be.processingNode.onaudioprocess=function(t){var e=t.outputBuffer.getChannelData(0),n=t.outputBuffer.getChannelData(1);if(null!=Be.audioCallback){Be.audioCallback(2*t.outputBuffer.length,Be.buffer);for(var i=0,s=t.outputBuffer.length;i<s;){var r=i++;e[r]=Be.buffer.data[Be.buffer.readLocation],Be.buffer.readLocation+=1,n[r]=Be.buffer.data[Be.buffer.readLocation],Be.buffer.readLocation+=1,Be.buffer.readLocation>=Be.buffer.size&&(Be.buffer.readLocation=0)}}else for(var a=0,l=t.outputBuffer.length;a<l;){var o=a++;e[o]=0,n[o]=0}},Be.processingNode.connect(Be._context.destination),!0};var Ee=function(){};(n["kha.audio2.Audio1"]=Ee).__name__=!0,Ee._init=function(){var t=new Array(16);Ee.soundChannels=t;var e=new Array(16);Ee.streamChannels=e;var n=new Array(16);Ee.internalSoundChannels=n;var i=new Array(16);Ee.internalStreamChannels=i;var s=new Float32Array(512);Ee.sampleCache1=s;var r=new Float32Array(512);Ee.sampleCache2=r,Be.audioCallback=Ee.mix},Ee.max=function(t,e){return e<t?t:e},Ee.min=function(t,e){return t<e?t:e},Ee.mix=function(t,e){if(Ee.sampleCache1.length<t){var n=new Float32Array(t);Ee.sampleCache1=n;var i=new Float32Array(t);Ee.sampleCache2=i}for(var s=0,r=t;s<r;){var a=s++;Ee.sampleCache2[a]=0}Ee.internalSoundChannels[0]=Ee.soundChannels[0],Ee.internalSoundChannels[1]=Ee.soundChannels[1],Ee.internalSoundChannels[2]=Ee.soundChannels[2],Ee.internalSoundChannels[3]=Ee.soundChannels[3],Ee.internalSoundChannels[4]=Ee.soundChannels[4],Ee.internalSoundChannels[5]=Ee.soundChannels[5],Ee.internalSoundChannels[6]=Ee.soundChannels[6],Ee.internalSoundChannels[7]=Ee.soundChannels[7],Ee.internalSoundChannels[8]=Ee.soundChannels[8],Ee.internalSoundChannels[9]=Ee.soundChannels[9],Ee.internalSoundChannels[10]=Ee.soundChannels[10],Ee.internalSoundChannels[11]=Ee.soundChannels[11],Ee.internalSoundChannels[12]=Ee.soundChannels[12],Ee.internalSoundChannels[13]=Ee.soundChannels[13],Ee.internalSoundChannels[14]=Ee.soundChannels[14],Ee.internalSoundChannels[15]=Ee.soundChannels[15],Ee.internalStreamChannels[0]=Ee.streamChannels[0],Ee.internalStreamChannels[1]=Ee.streamChannels[1],Ee.internalStreamChannels[2]=Ee.streamChannels[2],Ee.internalStreamChannels[3]=Ee.streamChannels[3],Ee.internalStreamChannels[4]=Ee.streamChannels[4],Ee.internalStreamChannels[5]=Ee.streamChannels[5],Ee.internalStreamChannels[6]=Ee.streamChannels[6],Ee.internalStreamChannels[7]=Ee.streamChannels[7],Ee.internalStreamChannels[8]=Ee.streamChannels[8],Ee.internalStreamChannels[9]=Ee.streamChannels[9],Ee.internalStreamChannels[10]=Ee.streamChannels[10],Ee.internalStreamChannels[11]=Ee.streamChannels[11],Ee.internalStreamChannels[12]=Ee.streamChannels[12],Ee.internalStreamChannels[13]=Ee.streamChannels[13],Ee.internalStreamChannels[14]=Ee.streamChannels[14],Ee.internalStreamChannels[15]=Ee.streamChannels[15];for(var l=0,o=Ee.internalSoundChannels;l<o.length;){var h=o[l];if(++l,null!=h&&!h.get_finished()){h.nextSamples(Ee.sampleCache1,t,e.samplesPerSecond);for(var u=0,_=t;u<_;){var c=u++;Ee.sampleCache2[c]+=Ee.sampleCache1[c]*h.get_volume()}}}for(var d=0,g=Ee.internalStreamChannels;d<g.length;){var f=g[d];if(++d,null!=f&&!f.get_finished()){f.nextSamples(Ee.sampleCache1,t,e.samplesPerSecond);for(var p=0,m=t;p<m;){var v=p++;Ee.sampleCache2[v]+=Ee.sampleCache1[v]*f.get_volume()}}}for(var w=0,b=t;w<b;){var x=w++;e.data[e.writeLocation]=Ee.max(Ee.min(Ee.sampleCache2[x],1),-1),e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}},Ee._playAgain=function(t){for(var e=0;e<16;){var n=e++;if(null==Ee.soundChannels[n]||Ee.soundChannels[n].get_finished()||Ee.soundChannels[n]==t){Ee.soundChannels[n]=t;break}}};var Me=function(t){this.paused=!1,this.looping=t,this.myVolume=1,this.myPosition=0};(n["kha.audio2.AudioChannel"]=Me).__name__=!0,Me.__interfaces__=[ke],Me.prototype={data:null,myVolume:null,myPosition:null,paused:null,looping:null,nextSamples:function(t,e,n){if(this.paused)for(var i=0,s=e;i<s;){t[i++]=0}else{for(var r=0,a=0;r<e;){for(var l=this.data.length-this.myPosition,o=l<e-r?l:e-r;a<o;)t[r]=this.data[this.myPosition],++this.myPosition,++a,++r;if(!this.looping)break;a=0,this.myPosition>=this.data.length&&(this.myPosition=0)}for(;r<e;)t[r]=0,++r}},play:function(){this.paused=!1,this.get_finished()&&(this.myPosition=0,Ee._playAgain(this))},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.myPosition>=this.data.length},__class__:Me,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume"}};var Le=function(t,e,n){this.size=t;var i=new Float32Array(t);this.data=i,this.channels=e,this.samplesPerSecond=n,this.readLocation=0,this.writeLocation=0};(n["kha.audio2.Buffer"]=Le).__name__=!0,Le.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:Le};var Ae=function(t,e){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=e};(n["kha.audio2.StreamChannel"]=Ae).__name__=!0,Ae.__interfaces__=[ke],Ae.prototype={atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(t,e,n){if(this.paused)for(var i=0,s=e;i<s;){t[i++]=0}else;},play:function(){this.paused=!1},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.atend},__class__:Ae,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume"}};var We=function(){};(n["kha.audio2.ogg.vorbis.data.Header"]=We).__name__=!0;var Fe=function(){};(n["kha.graphics1.Graphics"]=Fe).__name__=!0;var Oe=function(){this.transformations=[],this.transformations.push(new Lt(1,0,0,0,1,0,0,0,1)),this.opacities=[],this.opacities.push(1),this.myFontSize=12,this.pipe=null};(n["kha.graphics2.Graphics"]=Oe).__name__=!0,Oe.prototype={begin:function(t,e){null==t&&(t=!0)},end:function(){},drawImage:function(t,e,n){this.drawSubImage(t,e,n,0,0,t.get_width(),t.get_height())},drawSubImage:function(t,e,n,i,s,r,a){this.drawScaledSubImage(t,i,s,r,a,e,n,r,a)},drawScaledImage:function(t,e,n,i,s){this.drawScaledSubImage(t,0,0,t.get_width(),t.get_height(),e,n,i,s)},drawScaledSubImage:function(t,e,n,i,s,r,a,l,o){},drawRect:function(t,e,n,i,s){null==s&&(s=1)},fillRect:function(t,e,n,i){},drawString:function(t,e,n){},drawLine:function(t,e,n,i,s){null==s&&(s=1)},fillTriangle:function(t,e,n,i,s,r){},set_imageScaleQuality:function(t){return Ne.High},get_color:function(){return-16777216},set_color:function(t){return-16777216},get_font:function(){return null},set_font:function(t){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(t){return this.myFontSize=t},pushTransformation:function(t){var e=new Lt(1,0,0,0,1,0,0,0,1);e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,this.setTransformation(e),this.transformations.push(e)},popTransformation:function(){var t=this.transformations.pop();return this.setTransformation(this.get_transformation()),t},get_transformation:function(){return this.transformations[this.transformations.length-1]},rotation:function(t,e,n){var i=new Lt(1,0,e,0,1,n,0,0,1),s=new Lt(Math.cos(t),-Math.sin(t),0,Math.sin(t),Math.cos(t),0,0,0,1),r=new Lt(i._00*s._00+i._10*s._01+i._20*s._02,i._00*s._10+i._10*s._11+i._20*s._12,i._00*s._20+i._10*s._21+i._20*s._22,i._01*s._00+i._11*s._01+i._21*s._02,i._01*s._10+i._11*s._11+i._21*s._12,i._01*s._20+i._11*s._21+i._21*s._22,i._02*s._00+i._12*s._01+i._22*s._02,i._02*s._10+i._12*s._11+i._22*s._12,i._02*s._20+i._12*s._21+i._22*s._22),a=new Lt(1,0,-e,0,1,-n,0,0,1),l=new Lt(r._00*a._00+r._10*a._01+r._20*a._02,r._00*a._10+r._10*a._11+r._20*a._12,r._00*a._20+r._10*a._21+r._20*a._22,r._01*a._00+r._11*a._01+r._21*a._02,r._01*a._10+r._11*a._11+r._21*a._12,r._01*a._20+r._11*a._21+r._21*a._22,r._02*a._00+r._12*a._01+r._22*a._02,r._02*a._10+r._12*a._11+r._22*a._12,r._02*a._20+r._12*a._21+r._22*a._22),o=this.get_transformation();return new Lt(l._00*o._00+l._10*o._01+l._20*o._02,l._00*o._10+l._10*o._11+l._20*o._12,l._00*o._20+l._10*o._21+l._20*o._22,l._01*o._00+l._11*o._01+l._21*o._02,l._01*o._10+l._11*o._11+l._21*o._12,l._01*o._20+l._11*o._21+l._21*o._22,l._02*o._00+l._12*o._01+l._22*o._02,l._02*o._10+l._12*o._11+l._22*o._12,l._02*o._20+l._12*o._21+l._22*o._22)},pushRotation:function(t,e,n){this.pushTransformation(this.rotation(t,e,n))},get_opacity:function(){return this.opacities[this.opacities.length-1]},pipe:null,transformations:null,opacities:null,myFontSize:null,setTransformation:function(t){},__class__:Oe,__properties__:{get_opacity:"get_opacity",get_transformation:"get_transformation",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_font:"set_font",get_font:"get_font",set_color:"set_color",get_color:"get_color",set_imageScaleQuality:"set_imageScaleQuality"}};var Re=function(t){this.canvas=t};(n["kha.graphics2.Graphics1"]=Re).__name__=!0,Re.__interfaces__=[Fe],Re.prototype={canvas:null,__class__:Re};var De=function(){};(n["kha.graphics2.GraphicsExtension"]=De).__name__=!0,De.fillCircle=function(t,e,n,i,s){if(null==s&&(s=0),null!=ye.gl){s<=0&&(s=Math.floor(10*Math.sqrt(i)));for(var r=2*Math.PI/s,a=Math.cos(r),l=Math.sin(r),o=i,h=0,u=0,_=s;u<_;){u++;var c=o+e,d=h+n,g=o;o=a*o-l*h,h=a*h+l*g,t.fillTriangle(c,d,o+e,h+n,e,n)}}else{t.fillCircle(e,n,i)}};var Ne=b["kha.graphics2.ImageScaleQuality"]={__ename__:!0,__constructs__:["Low","High"],Low:{_hx_index:0,__enum__:"kha.graphics2.ImageScaleQuality",toString:i},High:{_hx_index:1,__enum__:"kha.graphics2.ImageScaleQuality",toString:i}},Ve=function(){};(n["kha.graphics2.truetype.VectorOfIntPointer"]=Ve).__name__=!0,Ve.prototype={value:null,__class__:Ve};var He=function(){};(n["kha.graphics2.truetype.Stbtt_temp_rect"]=He).__name__=!0,He.prototype={x0:null,y0:null,x1:null,y1:null,__class__:He};var Ge=function(){};(n["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=Ge).__name__=!0,Ge.prototype={advanceWidth:null,leftSideBearing:null,__class__:Ge};var Pe=function(){};(n["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=Pe).__name__=!0,Pe.prototype={ascent:null,descent:null,lineGap:null,__class__:Pe};var Ze=function(){};(n["kha.graphics2.truetype.Stbtt_bakedchar"]=Ze).__name__=!0,Ze.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:Ze};var Xe=function(){};(n["kha.graphics2.truetype.Stbtt_fontinfo"]=Xe).__name__=!0,Xe.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:Xe};var ze=function(){};(n["kha.graphics2.truetype.Stbtt_vertex"]=ze).__name__=!0,ze.prototype={x:null,y:null,cx:null,cy:null,type:null,__class__:ze};var Ye=function(){};(n["kha.graphics2.truetype.Stbtt__bitmap"]=Ye).__name__=!0,Ye.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:Ye};var je=function(){};(n["kha.graphics2.truetype.Stbtt__edge"]=je).__name__=!0,je.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:je};var Ue=function(){};(n["kha.graphics2.truetype.Stbtt__active_edge"]=Ue).__name__=!0,Ue.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:Ue};var Ke=function(){};(n["kha.graphics2.truetype.Stbtt__point"]=Ke).__name__=!0,Ke.prototype={x:null,y:null,__class__:Ke};var Qe=function(){};(n["kha.graphics2.truetype.StbTruetype"]=Qe).__name__=!0,Qe.STBTT_assert=function(t){if(!t)throw new Xt("Error")},Qe.ttBYTE=function(t,e){return null==e&&(e=0),t.readU8(e)},Qe.ttCHAR=function(t,e){null==e&&(e=0);var n=t.readU8(e);return 128<=n?n-256:n},Qe.ttUSHORT=function(t,e){null==e&&(e=0);var n=t.readU8(e);return t.readU8(e+1)|n<<8},Qe.ttSHORT=function(t,e){null==e&&(e=0);var n=t.readU8(e),i=t.readU8(e+1)|n<<8;return 0!=(32768&i)?i-65536:i},Qe.ttULONG=function(t,e){return null==e&&(e=0),Qe.ttLONG(t,e)},Qe.ttLONG=function(t,e){null==e&&(e=0);var n=t.readU8(e),i=t.readU8(e+1),s=t.readU8(e+2);return t.readU8(e+3)|s<<8|i<<16|n<<24},Qe.stbtt_tag4=function(t,e,n,i,s,r){return t.readU8(e)==n&&t.readU8(e+1)==i&&t.readU8(e+2)==s&&t.readU8(e+3)==r},Qe.stbtt_tag=function(t,e,n){return Qe.stbtt_tag4(t,e,ht.cca(n,0),ht.cca(n,1),ht.cca(n,2),ht.cca(n,3))},Qe.stbtt__find_table=function(t,e,n){for(var i=e+12,s=0,r=Qe.ttUSHORT(t,e+4);s<r;){var a=i+16*s++;if(Qe.stbtt_tag(t,a,n))return Qe.ttULONG(t,a+8)}return 0},Qe.stbtt_InitFont=function(t,e,n){t.data=e,t.fontstart=n;var i=Qe.stbtt__find_table(e,n,"cmap");if(t.loca=Qe.stbtt__find_table(e,n,"loca"),t.head=Qe.stbtt__find_table(e,n,"head"),t.glyf=Qe.stbtt__find_table(e,n,"glyf"),t.hhea=Qe.stbtt__find_table(e,n,"hhea"),t.hmtx=Qe.stbtt__find_table(e,n,"hmtx"),t.kern=Qe.stbtt__find_table(e,n,"kern"),0==i||0==t.loca||0==t.head||0==t.glyf||0==t.hhea||0==t.hmtx)return!1;var s=Qe.stbtt__find_table(e,n,"maxp");t.numGlyphs=0!=s?Qe.ttUSHORT(e,s+4):65535;for(var r=Qe.ttUSHORT(e,i+2),a=t.index_map=0,l=r;a<l;){var o=i+4+8*a++;switch(Qe.ttUSHORT(e,o)){case 0:t.index_map=i+Qe.ttULONG(e,o+4);break;case 3:switch(Qe.ttUSHORT(e,o+2)){case 1:case 10:t.index_map=i+Qe.ttULONG(e,o+4)}}}return 0!=t.index_map&&(t.indexToLocFormat=Qe.ttUSHORT(e,t.head+50),!0)},Qe.stbtt_FindGlyphIndex=function(t,e){var n=t.data,i=t.index_map,s=Qe.ttUSHORT(n,i);if(0==s)return e<Qe.ttUSHORT(n,i+2)-6?Qe.ttBYTE(n,i+6+e):0;if(6==s){var r=Qe.ttUSHORT(n,i+6),a=Qe.ttUSHORT(n,i+8);return r<=e&&e<r+a?Qe.ttUSHORT(n,i+10+2*(e-r)):0}if(2==s)return Qe.STBTT_assert(!1),0;if(4==s){var l=Qe.ttUSHORT(n,i+6)>>1,o=Qe.ttUSHORT(n,i+8)>>1,h=Qe.ttUSHORT(n,i+10),u=Qe.ttUSHORT(n,i+12)>>1,_=i+14,c=_;if(65535<e)return 0;for(e>=Qe.ttUSHORT(n,c+2*u)&&(c+=2*u),c-=2;0!=h;){o>>=1,Qe.ttUSHORT(n,c+2*o)<e&&(c+=2*o),--h}var d=(c+=2)-_>>1;Qe.STBTT_assert(e<=Qe.ttUSHORT(n,_+2*d));var g=Qe.ttUSHORT(n,i+14+2*l+2+2*d);if(e<g)return 0;var f=Qe.ttUSHORT(n,i+14+6*l+2+2*d);return 0==f?e+Qe.ttSHORT(n,i+14+4*l+2+2*d):Qe.ttUSHORT(n,f+2*(e-g)+i+14+6*l+2+2*d)}if(12==s||13==s){for(var p=0,m=Qe.ttULONG(n,i+12);p<m;){var v=p+(m-p>>1),w=Qe.ttULONG(n,i+16+12*v),b=Qe.ttULONG(n,i+16+12*v+4);if(e<w)m=v;else{if(!(b<e)){var x=Qe.ttULONG(n,i+16+12*v+8);return 12==s?x+e-w:x}p=v+1}}return 0}return Qe.STBTT_assert(!1),0},Qe.stbtt_setvertex=function(t,e,n,i,s,r){t.type=e,t.x=n,t.y=i,t.cx=s,t.cy=r},Qe.stbtt__GetGlyfOffset=function(t,e){var n,i;return e>=t.numGlyphs?-1:2<=t.indexToLocFormat?-1:(0==t.indexToLocFormat?(n=t.glyf+2*Qe.ttUSHORT(t.data,t.loca+2*e),i=t.glyf+2*Qe.ttUSHORT(t.data,t.loca+2*e+2)):(n=t.glyf+Qe.ttULONG(t.data,t.loca+4*e),i=t.glyf+Qe.ttULONG(t.data,t.loca+4*e+4)),n==i?-1:n)},Qe.stbtt_GetGlyphBox=function(t,e,n){var i=Qe.stbtt__GetGlyfOffset(t,e);return!(i<0)&&(n.x0=Qe.ttSHORT(t.data,i+2),n.y0=Qe.ttSHORT(t.data,i+4),n.x1=Qe.ttSHORT(t.data,i+6),n.y1=Qe.ttSHORT(t.data,i+8),!0)},Qe.stbtt__close_shape=function(t,e,n,i,s,r,a,l,o,h){return i?(n&&Qe.stbtt_setvertex(t[e++],3,o+a>>1,h+l>>1,o,h),Qe.stbtt_setvertex(t[e++],3,s,r,a,l)):n?Qe.stbtt_setvertex(t[e++],3,s,r,o,h):Qe.stbtt_setvertex(t[e++],2,s,r,0,0),e},Qe.copyVertices=function(t,e,n,i){for(var s=0,r=i;s<r;){var a=s++;e[n+a]=t[a]}},Qe.stbtt_GetGlyphShape=function(t,e){var n,i=t.data,s=null,r=0,a=Qe.stbtt__GetGlyfOffset(t,e);if(a<0)return null;var l=Qe.ttSHORT(i,a);if(0<l){var o,h=0,u=0,_=0,c=!1,d=!1,g=0;n=i.sub(a+10,i.get_length()-(a+10));var f=Qe.ttUSHORT(i,a+10+2*l),p=i.sub(a+10+2*l+2+f,i.get_length()-(a+10+2*l+2+f)),m=1+Qe.ttUSHORT(n,2*l-2),v=m+2*l;if(null==(s=new Array(v)))return null;for(var w=0,b=s.length;w<b;){s[w++]=new ze}var x=_=0;o=v-m;for(var y=0,S=m;y<S;){var C=y++;0==x?0!=(8&(h=p.readU8(g++)))&&(x=p.readU8(g++)):--x,s[o+C].type=h}for(var I=0,T=0,k=m;T<k;){var B=T++;if(0!=(2&(h=s[o+B].type))){var E=p.readU8(g++);I+=0!=(16&h)?E:-E}else if(0==(16&h)){var M=p.readU8(g),L=p.readU8(g+1)|M<<8;I+=0!=(32768&L)?L-65536:L,g+=2}s[o+B].x=I}for(var A=0,W=0,F=m;W<F;){var O=W++;if(0!=(4&(h=s[o+O].type))){var R=p.readU8(g++);A+=0!=(32&h)?R:-R}else if(0==(32&h)){var D=p.readU8(g),N=p.readU8(g+1)|D<<8;A+=0!=(32768&N)?N-65536:N,g+=2}s[o+O].y=A}for(var V=r=0,H=V,G=H,P=G,Z=P,X=Z,z=0;z<m;)h=s[o+z].type,I=s[o+z].x,A=s[o+z].y,_==z?(0!=z&&(r=Qe.stbtt__close_shape(s,r,c,d,X,Z,H,V,P,G)),(d=0==(1&h))?(H=I,V=A,0==(1&s[o+z+1].type)?(X=I+s[o+z+1].x>>1,Z=A+s[o+z+1].y>>1):(X=s[o+z+1].x,Z=s[o+z+1].y,++z)):(X=I,Z=A),Qe.stbtt_setvertex(s[r++],1,X,Z,0,0),c=!1,_=1+Qe.ttUSHORT(n,2*u),++u):0==(1&h)?(c&&Qe.stbtt_setvertex(s[r++],3,P+I>>1,G+A>>1,P,G),P=I,G=A,c=!0):(c?Qe.stbtt_setvertex(s[r++],3,I,A,P,G):Qe.stbtt_setvertex(s[r++],2,I,A,0,0),c=!1),++z;r=Qe.stbtt__close_shape(s,r,c,d,X,Z,H,V,P,G)}else if(-1==l){var Y=1,j=i.sub(a+10,i.get_length()-(a+10)),U=0;for(r=0,s=null;0!=Y;){var K,Q,J=null,q=1,$=0,tt=0,et=1,nt=0,it=0,st=Qe.ttSHORT(j,U);U+=2;var rt=Qe.ttSHORT(j,U);U+=2,0!=(2&st)?0!=(1&st)?(nt=Qe.ttSHORT(j,U),U+=2,it=Qe.ttSHORT(j,U),U+=2):(nt=Qe.ttCHAR(j,U),++U,it=Qe.ttCHAR(j,U),++U):Qe.STBTT_assert(!1),0!=(8&st)?(q=et=Qe.ttSHORT(j,U)/16384,U+=2,$=tt=0):0!=(64&st)?(q=Qe.ttSHORT(j,U)/16384,U+=2,$=tt=0,et=Qe.ttSHORT(j,U)/16384,U+=2):0!=(128&st)&&(q=Qe.ttSHORT(j,U)/16384,U+=2,$=Qe.ttSHORT(j,U)/16384,U+=2,tt=Qe.ttSHORT(j,U)/16384,U+=2,et=Qe.ttSHORT(j,U)/16384,U+=2);var at=Math.sqrt(q*q+$*$),lt=Math.sqrt(tt*tt+et*et);if(0<(K=null==(Q=Qe.stbtt_GetGlyphShape(t,rt))?0:Q.length)){for(var ot=0,ht=K;ot<ht;){var ut=Q[ot++],_t=ut.x,ct=ut.y;ut.x=gt.int(at*(q*_t+tt*ct+nt)),ut.y=gt.int(lt*($*_t+et*ct+it)),_t=ut.cx,ct=ut.cy,ut.cx=gt.int(at*(q*_t+tt*ct+nt)),ut.cy=gt.int(lt*($*_t+et*ct+it))}if(null==(J=new Array(r+K)))return null;0<r&&Qe.copyVertices(s,J,0,r),Qe.copyVertices(Q,J,r,K),s=J,r+=K}Y=32&st}}else l<0&&Qe.STBTT_assert(!1);if(null==s)return null;if(Qe.STBTT_assert(s.length>=r),r<s.length){var dt=new Array(r);return Qe.copyVertices(s,dt,0,r),dt}return s},Qe.stbtt_GetGlyphHMetrics=function(t,e){var n=Qe.ttUSHORT(t.data,t.hhea+34),i=new Ge;return e<n?(i.advanceWidth=Qe.ttSHORT(t.data,t.hmtx+4*e),i.leftSideBearing=Qe.ttSHORT(t.data,t.hmtx+4*e+2)):(i.advanceWidth=Qe.ttSHORT(t.data,t.hmtx+4*(n-1)),i.leftSideBearing=Qe.ttSHORT(t.data,t.hmtx+4*n+2*(e-n))),i},Qe.stbtt_GetFontVMetrics=function(t){var e=new Pe;return e.ascent=Qe.ttSHORT(t.data,t.hhea+4),e.descent=Qe.ttSHORT(t.data,t.hhea+6),e.lineGap=Qe.ttSHORT(t.data,t.hhea+8),e},Qe.stbtt_ScaleForPixelHeight=function(t,e){return e/(Qe.ttSHORT(t.data,t.hhea+4)-Qe.ttSHORT(t.data,t.hhea+6))},Qe.stbtt_GetGlyphBitmapBoxSubpixel=function(t,e,n,i,s,r){var a=new He;if(Qe.stbtt_GetGlyphBox(t,e,a)){var l=a.x0,o=a.x1,h=a.y0,u=a.y1;a.x0=Math.floor(l*n+s),a.y0=Math.floor(-u*i+r),a.x1=Math.ceil(o*n+s),a.y1=Math.ceil(-h*i+r)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},Qe.stbtt_GetGlyphBitmapBox=function(t,e,n,i){return Qe.stbtt_GetGlyphBitmapBoxSubpixel(t,e,n,i,0,0)},Qe.stbtt__new_active=function(t,e,n,i){var s=new Ue,r=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==s||(s.fdx=r,s.fdy=0!=r?1/r:0,s.fx=t[e].x0+r*(i-t[e].y0),s.fx-=n,s.direction=t[e].invert?1:-1,s.sy=t[e].y0,s.ey=t[e].y1,s.next=null),s},Qe.stbtt__handle_clipped_edge=function(t,e,n,i,s,r,a,l){if(r!=l&&(Qe.STBTT_assert(r<l),Qe.STBTT_assert(i.sy<=i.ey),!(r>i.ey||l<i.sy)))if(r<i.sy&&(s+=(a-s)*(i.sy-r)/(l-r),r=i.sy),l>i.ey&&(a+=(a-s)*(i.ey-l)/(l-r),l=i.ey),s==n?Qe.STBTT_assert(a<=n+1):s==n+1?Qe.STBTT_assert(n<=a):s<=n?Qe.STBTT_assert(a<=n):n+1<=s?Qe.STBTT_assert(n+1<=a):Qe.STBTT_assert(n<=a&&a<=n+1),s<=n&&a<=n){var o=e+n,h=t;h[o]=h[o]+i.direction*(l-r)}else if(!(n+1<=s&&n+1<=a)){Qe.STBTT_assert(n<=s&&s<=n+1&&n<=a&&a<=n+1);var u=e+n,_=t;_[u]=_[u]+i.direction*(l-r)*(1-(s-n+(a-n))/2)}},Qe.stbtt__fill_active_edges_new=function(t,e,n,i,s,r){for(var a=r+1;null!=s;){if(Qe.STBTT_assert(s.ey>=r),0==s.fdx){var l=s.fx;l<i&&(0<=l?(Qe.stbtt__handle_clipped_edge(t,0,gt.int(l),s,l,r,l,a),Qe.stbtt__handle_clipped_edge(e,n-1,gt.int(l+1),s,l,r,l,a)):Qe.stbtt__handle_clipped_edge(e,n-1,0,s,l,r,l,a))}else{var o,h,u,_,c=s.fx,d=s.fdx,g=c+d,f=s.fdy;if(Qe.STBTT_assert(s.sy<=a&&s.ey>=r),s.sy>r?(o=c+d*(s.sy-r),u=s.sy):(o=c,u=r),s.ey<a?(h=c+d*(s.ey-r),_=s.ey):(h=g,_=a),0<=o&&0<=h&&o<i&&h<i)if(gt.int(o)==gt.int(h)){var p=gt.int(o),m=_-u;Qe.STBTT_assert(0<=p&&p<i);var v=p,w=t;w[v]=w[v]+s.direction*(1-(o-p+(h-p))/2)*m;var b=n+p,x=e;x[b]=x[b]+s.direction*m}else{if(h<o){var y=u=a-(u-r);u=_=a-(_-r),_=y,y=h,h=o,o=y,d=-d,f=-f,y=c,c=g,g=y}var S=gt.int(o),C=gt.int(h),I=(S+1-c)*f+r,T=s.direction,k=T*(I-u),B=S,E=t;E[B]=E[B]+k*(1-(o-S+(S+1-S))/2);for(var M=T*f,L=S+1,A=C;L<A;){var W=L++,F=t;F[W]=F[W]+(k+M/2),k+=M}I+=f*(C-(S+1)),Qe.STBTT_assert(Math.abs(k)<=1.01);var O=C,R=t;R[O]=R[O]+(k+T*(1-(C-C+(h-C))/2)*(_-I));var D=n+C,N=e;N[D]=N[D]+T*(_-u)}else for(var V=0,H=i;V<H;){var G=V++,P=r,Z=G,X=G+1,z=g,Y=a,j=(G-c)/d+r,U=(G+1-c)/d+r;c<Z&&X<z?(Qe.stbtt__handle_clipped_edge(t,0,G,s,c,P,Z,j),Qe.stbtt__handle_clipped_edge(t,0,G,s,Z,j,X,U),Qe.stbtt__handle_clipped_edge(t,0,G,s,X,U,z,Y)):z<Z&&X<c?(Qe.stbtt__handle_clipped_edge(t,0,G,s,c,P,X,U),Qe.stbtt__handle_clipped_edge(t,0,G,s,X,U,Z,j),Qe.stbtt__handle_clipped_edge(t,0,G,s,Z,j,z,Y)):c<Z&&Z<z?(Qe.stbtt__handle_clipped_edge(t,0,G,s,c,P,Z,j),Qe.stbtt__handle_clipped_edge(t,0,G,s,Z,j,z,Y)):z<Z&&Z<c?(Qe.stbtt__handle_clipped_edge(t,0,G,s,c,P,Z,j),Qe.stbtt__handle_clipped_edge(t,0,G,s,Z,j,z,Y)):c<X&&X<z?(Qe.stbtt__handle_clipped_edge(t,0,G,s,c,P,X,U),Qe.stbtt__handle_clipped_edge(t,0,G,s,X,U,z,Y)):z<X&&X<c?(Qe.stbtt__handle_clipped_edge(t,0,G,s,c,P,X,U),Qe.stbtt__handle_clipped_edge(t,0,G,s,X,U,z,Y)):Qe.stbtt__handle_clipped_edge(t,0,G,s,c,P,z,Y)}}s=s.next}},Qe.stbtt__rasterize_sorted_edges=function(t,e,n,i,s,r){var a,l,o=null,h=0,u=0;64<t.w?a=new Array(2*t.w+1):a=new Array(129);var _=a;l=t.w;var c=r;for(e[u+n].y0=r+t.h+1;h<t.h;){for(var d=c+0,g=c+1,f=o,p=null,m=0,v=t.w;m<v;){a[m++]=0}for(var w=0,b=t.w+1;w<b;){_[l+w++]=0}for(;null!=f;){var x=f;x.ey<=d?(null==p?o=x.next:p.next=x.next,f=x.next,Qe.STBTT_assert(0!=x.direction),x.direction=0):f=(p=f).next}for(;e[u].y0<=g;){if(e[u].y0!=e[u].y1){var y=Qe.stbtt__new_active(e,u,s,d);Qe.STBTT_assert(y.ey>=d),y.next=o,o=y}++u}null!=o&&Qe.stbtt__fill_active_edges_new(a,_,l+1,t.w,o,d);for(var S=0,C=0,I=t.w;C<I;){var T=C++;S+=_[l+T];var k=a[T]+S;k=255*Math.abs(k)+.5;var B=gt.int(k);255<B&&(B=255),t.pixels.writeU8(t.pixels_offset+h*t.stride+T,B)}for(p=null,f=o;null!=f;){var E=f;E.fx+=E.fdx,f=(p=f).next}++c,++h}},Qe.STBTT__COMPARE=function(t,e){return t.y0<e.y0},Qe.stbtt__sort_edges_ins_sort=function(t,e){for(var n,i=1,s=e;i<s;){var r=i++,a=t[r],l=a;for(n=r;0<n;){var o=t[n-1];if(!Qe.STBTT__COMPARE(l,o))break;t[n]=t[n-1],--n}r!=n&&(t[n]=a)}},Qe.stbtt__sort_edges_quicksort=function(t,e,n){for(;12<n;){var i,s=n>>1,r=Qe.STBTT__COMPARE(t[e],t[e+s]),a=Qe.STBTT__COMPARE(t[e+s],t[e+n-1]);if(r!=a){var l=Qe.STBTT__COMPARE(t[e],t[e+n-1])==a?0:n-1;i=t[e+l],t[e+l]=t[e+s],t[e+s]=i}i=t[e],t[e]=t[e+s],t[e+s]=i;for(var o=1,h=n-1;;){for(;Qe.STBTT__COMPARE(t[e+o],t[e]);)++o;for(;Qe.STBTT__COMPARE(t[e],t[e+h]);)--h;if(h<=o)break;i=t[e+o],t[e+o]=t[e+h],t[e+h]=i,++o,--h}h<n-o?(Qe.stbtt__sort_edges_quicksort(t,e,h),e+=o,n-=o):(Qe.stbtt__sort_edges_quicksort(t,e+o,n-o),n=h)}},Qe.stbtt__sort_edges=function(t,e){Qe.stbtt__sort_edges_quicksort(t,0,e),Qe.stbtt__sort_edges_ins_sort(t,e)},Qe.stbtt__rasterize=function(t,e,n,i,s,r,a,l,o,h,u){for(var _,c=u?-r:r,d=0,g=0,f=i;g<f;){d+=n[g++]}var p=new Array(d+1);if(null!=p){for(var m=0,v=p.length;m<v;){p[m++]=new je}for(var w=d=0,b=0,x=i;b<x;){var y=b++,S=e,C=0+w;w+=n[y],_=n[y]-1;for(var I=0,T=n[y];I<T;){var k=I++,B=k,E=_;S[C+_].y!=S[C+k].y?(p[d].invert=!1,(u?S[C+_].y>S[C+k].y:S[C+_].y<S[C+k].y)&&(p[d].invert=!0,B=_,E=k),p[d].x0=S[C+B].x*s+a,p[d].y0=1*(S[C+B].y*c+l),p[d].x1=S[C+E].x*s+a,p[d].y1=1*(S[C+E].y*c+l),++d,_=k):_=k}}Qe.stbtt__sort_edges(p,d),Qe.stbtt__rasterize_sorted_edges(t,p,d,1,o,h)}},Qe.stbtt__add_point=function(t,e,n,i){null!=t&&(t[e].x=n,t[e].y=i)},Qe.stbtt__tesselate_curve=function(t,e,n,i,s,r,a,l,o,h){var u=(n+2*s+a)/4,_=(i+2*r+l)/4,c=(n+a)/2-u,d=(i+l)/2-_;return 16<h||(o<c*c+d*d?(Qe.stbtt__tesselate_curve(t,e,n,i,(n+s)/2,(i+r)/2,u,_,o,h+1),Qe.stbtt__tesselate_curve(t,e,u,_,(s+a)/2,(r+l)/2,a,l,o,h+1)):(Qe.stbtt__add_point(t,e.value,a,l),e.value+=1)),1},Qe.stbtt_FlattenCurves=function(t,e,n,i,s){for(var r=null,a=0,l=n*n,o=0,h=0,u=0,_=e;u<_;){1==t[u++].type&&++o}if(0==(s.value=o))return null;var c=new Array(o);if(i.value=c,null==i.value)return s.value=0,null;for(var d=0;d<2;){var g=0,f=0;if(1==d++){if(null==(r=new Array(a)))return i.value=null,s.value=0,null;for(var p=0,m=r.length;p<m;){r[p++]=new Ke}}o=-1;for(var v=a=0,w=e;v<w;){var b=v++;switch(t[b].type){case 1:0<=o&&(i.value[o]=a-h),++o,h=a,g=t[b].x,f=t[b].y,Qe.stbtt__add_point(r,a++,g,f);break;case 2:g=t[b].x,f=t[b].y,Qe.stbtt__add_point(r,a++,g,f);break;case 3:var x={value:a};Qe.stbtt__tesselate_curve(r,x,g,f,t[b].cx,t[b].cy,t[b].x,t[b].y,l,0),a=x.value,g=t[b].x,f=t[b].y}}i.value[o]=a-h}return r},Qe.stbtt_Rasterize=function(t,e,n,i,s,r,a,l,o,h,u){var _,c=r<s?r:s,d=0,g={value:d},f=new Ve,p=Qe.stbtt_FlattenCurves(n,i,e/c,f,g);d=g.value,_=f.value,null!=p&&Qe.stbtt__rasterize(t,p,_,d,s,r,a,l,o,h,u)},Qe.stbtt_MakeGlyphBitmapSubpixel=function(t,e,n,i,s,r,a,l,o,h,u){var _,c,d=Qe.stbtt_GetGlyphShape(t,u),g=null==d?0:d.length,f=new Ye,p=Qe.stbtt_GetGlyphBitmapBoxSubpixel(t,u,a,l,o,h);_=p.x0,c=p.y0,f.pixels=e,f.pixels_offset=n,f.w=i,f.h=s,f.stride=r,0!=f.w&&0!=f.h&&Qe.stbtt_Rasterize(f,.35,d,g,a,l,o,h,_,c,!0)},Qe.stbtt_MakeGlyphBitmap=function(t,e,n,i,s,r,a,l,o){Qe.stbtt_MakeGlyphBitmapSubpixel(t,e,n,i,s,r,a,l,0,0,o)},Qe.stbtt_BakeFontBitmap=function(t,e,n,i,s,r,a,l){var o=new Xe;if(!Qe.stbtt_InitFont(o,t,e))return-1;for(var h=0,u=s*r;h<u;){var _=h++;i.writeU8(_,0)}for(var c=1,d=c,g=1,f=Qe.stbtt_ScaleForPixelHeight(o,n),p=0,m=0;m<a.length;){var v=a[m];++m;var w=Qe.stbtt_FindGlyphIndex(o,v),b=Qe.stbtt_GetGlyphHMetrics(o,w),x=b.advanceWidth,y=(b.leftSideBearing,Qe.stbtt_GetGlyphBitmapBox(o,w,f,f)),S=y.x0,C=y.y0,I=y.x1-S,T=y.y1-C;if(s<=d+I+1&&(c=g,d=1),r<=c+T+1)return-p;Qe.STBTT_assert(d+I<s),Qe.STBTT_assert(c+T<r),Qe.stbtt_MakeGlyphBitmap(o,i,d+c*s,I,T,s,f,f,w),l[p].x0=d,l[p].y0=c,l[p].x1=d+I,l[p].y1=c+T,l[p].xadvance=f*x,l[p].xoff=S,l[p].yoff=C,d=d+I+1,g<c+T+1&&(g=c+T+1),++p}return g};var Je=b["kha.graphics4.BlendingFactor"]={__ename__:!0,__constructs__:["Undefined","BlendOne","BlendZero","SourceAlpha","DestinationAlpha","InverseSourceAlpha","InverseDestinationAlpha","SourceColor","DestinationColor","InverseSourceColor","InverseDestinationColor"],Undefined:{_hx_index:0,__enum__:"kha.graphics4.BlendingFactor",toString:i},BlendOne:{_hx_index:1,__enum__:"kha.graphics4.BlendingFactor",toString:i},BlendZero:{_hx_index:2,__enum__:"kha.graphics4.BlendingFactor",toString:i},SourceAlpha:{_hx_index:3,__enum__:"kha.graphics4.BlendingFactor",toString:i},DestinationAlpha:{_hx_index:4,__enum__:"kha.graphics4.BlendingFactor",toString:i},InverseSourceAlpha:{_hx_index:5,__enum__:"kha.graphics4.BlendingFactor",toString:i},InverseDestinationAlpha:{_hx_index:6,__enum__:"kha.graphics4.BlendingFactor",toString:i},SourceColor:{_hx_index:7,__enum__:"kha.graphics4.BlendingFactor",toString:i},DestinationColor:{_hx_index:8,__enum__:"kha.graphics4.BlendingFactor",toString:i},InverseSourceColor:{_hx_index:9,__enum__:"kha.graphics4.BlendingFactor",toString:i},InverseDestinationColor:{_hx_index:10,__enum__:"kha.graphics4.BlendingFactor",toString:i}},qe=b["kha.graphics4.BlendingOperation"]={__ename__:!0,__constructs__:["Add","Subtract","ReverseSubtract","Min","Max"],Add:{_hx_index:0,__enum__:"kha.graphics4.BlendingOperation",toString:i},Subtract:{_hx_index:1,__enum__:"kha.graphics4.BlendingOperation",toString:i},ReverseSubtract:{_hx_index:2,__enum__:"kha.graphics4.BlendingOperation",toString:i},Min:{_hx_index:3,__enum__:"kha.graphics4.BlendingOperation",toString:i},Max:{_hx_index:4,__enum__:"kha.graphics4.BlendingOperation",toString:i}},$e=b["kha.graphics4.CompareMode"]={__ename__:!0,__constructs__:["Always","Never","Equal","NotEqual","Less","LessEqual","Greater","GreaterEqual"],Always:{_hx_index:0,__enum__:"kha.graphics4.CompareMode",toString:i},Never:{_hx_index:1,__enum__:"kha.graphics4.CompareMode",toString:i},Equal:{_hx_index:2,__enum__:"kha.graphics4.CompareMode",toString:i},NotEqual:{_hx_index:3,__enum__:"kha.graphics4.CompareMode",toString:i},Less:{_hx_index:4,__enum__:"kha.graphics4.CompareMode",toString:i},LessEqual:{_hx_index:5,__enum__:"kha.graphics4.CompareMode",toString:i},Greater:{_hx_index:6,__enum__:"kha.graphics4.CompareMode",toString:i},GreaterEqual:{_hx_index:7,__enum__:"kha.graphics4.CompareMode",toString:i}},tn=function(){};(n["kha.graphics4.ConstantLocation"]=tn).__name__=!0;var en=function(t,e,n,i){this.isDepthAttachment=!1,this.depthTexture=null,this.texture=null,this.frameBuffer=null,this.myWidth=t,this.myHeight=t,this.format=e,this.renderTarget=n,this.depthStencilFormat=i,n&&this.createTexture()};(n["kha.graphics4.CubeMap"]=en).__name__=!0,en.__interfaces__=[ee,te],en.prototype={myWidth:null,myHeight:null,format:null,renderTarget:null,depthStencilFormat:null,graphics4:null,frameBuffer:null,texture:null,depthTexture:null,isDepthAttachment:null,createTexture:function(){if(null!=ye.gl){if(this.texture=ye.gl.createTexture(),ye.gl.bindTexture(34067,this.texture),ye.gl.texParameteri(34067,10240,9729),ye.gl.texParameteri(34067,10241,9729),ye.gl.texParameteri(34067,10242,33071),ye.gl.texParameteri(34067,10243,33071),this.renderTarget){switch(this.frameBuffer=ye.gl.createFramebuffer(),ye.gl.bindFramebuffer(36160,this.frameBuffer),this.format._hx_index){case 0:ye.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null);break;case 2:ye.gl.texImage2D(34069,0,ye.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ye.gl.texImage2D(34070,0,ye.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ye.gl.texImage2D(34071,0,ye.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ye.gl.texImage2D(34072,0,ye.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ye.gl.texImage2D(34073,0,ye.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),ye.gl.texImage2D(34074,0,ye.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null);break;case 3:ye.gl.texImage2D(34069,0,ye.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ye.gl.texImage2D(34070,0,ye.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ye.gl.texImage2D(34071,0,ye.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ye.gl.texImage2D(34072,0,ye.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ye.gl.texImage2D(34073,0,ye.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ye.gl.texImage2D(34074,0,ye.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null);break;case 4:ye.gl.texImage2D(34069,0,ye.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34070,0,ye.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34071,0,ye.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34072,0,ye.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34073,0,ye.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34074,0,ye.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,ye.halfFloat.HALF_FLOAT_OES,null);break;case 5:ye.gl.texImage2D(34069,0,ye.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ye.gl.texImage2D(34070,0,ye.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ye.gl.texImage2D(34071,0,ye.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ye.gl.texImage2D(34072,0,ye.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ye.gl.texImage2D(34073,0,ye.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),ye.gl.texImage2D(34074,0,ye.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null);break;case 6:ye.gl.texImage2D(34069,0,ye.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34070,0,ye.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34071,0,ye.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34072,0,ye.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34073,0,ye.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ye.halfFloat.HALF_FLOAT_OES,null),ye.gl.texImage2D(34074,0,ye.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,ye.halfFloat.HALF_FLOAT_OES,null);break;default:ye.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}if(this.format==xn.DEPTH16&&(ye.gl.texParameteri(34067,10240,9728),ye.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,!ye.gl2)){var t=ye.gl.createTexture();ye.gl.bindTexture(34067,t),ye.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.framebufferTexture2D(36160,36064,34069,t,0),ye.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.framebufferTexture2D(36160,36064,34070,t,0),ye.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.framebufferTexture2D(36160,36064,34071,t,0),ye.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.framebufferTexture2D(36160,36064,34072,t,0),ye.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.framebufferTexture2D(36160,36064,34073,t,0),ye.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),ye.gl.framebufferTexture2D(36160,36064,34074,t,0),ye.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat),ye.gl.bindFramebuffer(36160,null)}ye.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(t){switch(t){case 0:break;case 1:case 5:this.depthTexture=ye.gl.createTexture(),ye.gl.bindTexture(34067,this.depthTexture),1==t?ye.gl.texImage2D(34067,0,ye.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,5125,null):ye.gl.texImage2D(34067,0,ye.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),ye.gl.texParameteri(34067,10240,9728),ye.gl.texParameteri(34067,10241,9728),ye.gl.texParameteri(34067,10242,33071),ye.gl.texParameteri(34067,10243,33071),ye.gl.bindFramebuffer(36160,this.frameBuffer),ye.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=ye.gl.createTexture(),ye.gl.bindTexture(34067,this.depthTexture),ye.gl.texImage2D(34067,0,ye.gl2?35056:34041,this.myWidth,this.myHeight,0,34041,ye.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),ye.gl.texParameteri(34067,10240,9728),ye.gl.texParameteri(34067,10241,9728),ye.gl.texParameteri(34067,10242,33071),ye.gl.texParameteri(34067,10243,33071),ye.gl.bindFramebuffer(36160,this.frameBuffer),ye.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},set:function(t){ye.gl.activeTexture(33984+t),ye.gl.bindTexture(34067,this.texture)},setDepth:function(t){ye.gl.activeTexture(33984+t),ye.gl.bindTexture(34067,this.depthTexture)},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_g4:function(){return null==this.graphics4&&(this.graphics4=new Jn(this)),this.graphics4},__class__:en,__properties__:{get_g4:"get_g4",get_height:"get_height",get_width:"get_width"}};var nn=b["kha.graphics4.CullMode"]={__ename__:!0,__constructs__:["Clockwise","CounterClockwise","None"],Clockwise:{_hx_index:0,__enum__:"kha.graphics4.CullMode",toString:i},CounterClockwise:{_hx_index:1,__enum__:"kha.graphics4.CullMode",toString:i},None:{_hx_index:2,__enum__:"kha.graphics4.CullMode",toString:i}},sn=function(t,e){this.sources=[];for(var n=0;n<t.length;){var i=t[n];++n,this.sources.push(i.toString())}this.type=35632,this.shader=null,this.files=e};(n["kha.graphics4.FragmentShader"]=sn).__name__=!0,sn.fromSource=function(t){var e=new sn([],["runtime-string"]);return e.sources.push(t),e},sn.prototype={sources:null,type:null,shader:null,files:null,__class__:sn};var rn=function(){};(n["kha.graphics4.GeometryShader"]=rn).__name__=!0;var an=function(){};(n["kha.graphics4.Graphics"]=an).__name__=!0,an.prototype={begin:null,beginFace:null,end:null,clear:null,viewport:null,scissor:null,disableScissor:null,setVertexBuffer:null,setVertexBuffers:null,setIndexBuffer:null,setTexture:null,setTextureDepth:null,setImageTexture:null,setTextureParameters:null,setTexture3DParameters:null,setCubeMap:null,setCubeMapDepth:null,renderTargetsInvertedY:null,setPipeline:null,setBool:null,setInt:null,setFloat:null,setFloat2:null,setFloat3:null,setFloat4:null,setFloats:null,setMatrix:null,setMatrix3:null,drawIndexedVertices:null,drawIndexedVerticesInstanced:null,__class__:an};var ln=function(t){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=t,ln.bufferIndex=0,ln.initShaders(),this.initBuffers(),this.projectionLocation=ln.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=ln.shaderPipeline.getTextureUnit("tex")};(n["kha.graphics4.ImageShaderPainter"]=ln).__name__=!0,ln.initShaders=function(){null==ln.structure&&(ln.structure=un.createImageVertexStructure()),null==ln.shaderPipeline&&(ln.shaderPipeline=un.createImagePipeline(ln.structure),ln.shaderPipeline.compile())},ln.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,projectionLocation:null,textureLocation:null,get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==ln.rectVertexBuffer){ln.rectVertexBuffer=new Cn(6e3,ln.structure,Sn.DynamicUsage),ln.rectVertices=ln.rectVertexBuffer.lock(),ln.indexBuffer=new _n(9e3,Sn.StaticUsage);for(var t=ln.indexBuffer.lock(),e=0;e<1500;){var n=e++;t[3*n*2]=4*n,t[3*n*2+1]=4*n+1,t[3*n*2+2]=4*n+2,t[3*n*2+3]=4*n,t[3*n*2+4]=4*n+2,t[3*n*2+5]=4*n+3}ln.indexBuffer.unlock()}},setRectVertices:function(t,e,n,i,s,r,a,l){var o=9*ln.bufferIndex*4;ln.rectVertices[o]=t,ln.rectVertices[o+1]=e,ln.rectVertices[o+2]=-5,ln.rectVertices[o+9]=n,ln.rectVertices[o+10]=i,ln.rectVertices[o+11]=-5,ln.rectVertices[o+18]=s,ln.rectVertices[o+19]=r,ln.rectVertices[o+20]=-5,ln.rectVertices[o+27]=a,ln.rectVertices[o+28]=l,ln.rectVertices[o+29]=-5},setRectTexCoords:function(t,e,n,i){var s=9*ln.bufferIndex*4;ln.rectVertices[s+3]=t,ln.rectVertices[s+4]=i,ln.rectVertices[s+12]=t,ln.rectVertices[s+13]=e,ln.rectVertices[s+21]=n,ln.rectVertices[s+22]=e,ln.rectVertices[s+30]=n,ln.rectVertices[s+31]=i},setRectColor:function(t,e,n,i){var s=9*ln.bufferIndex*4;ln.rectVertices[s+5]=t,ln.rectVertices[s+6]=e,ln.rectVertices[s+7]=n,ln.rectVertices[s+8]=i,ln.rectVertices[s+14]=t,ln.rectVertices[s+15]=e,ln.rectVertices[s+16]=n,ln.rectVertices[s+17]=i,ln.rectVertices[s+23]=t,ln.rectVertices[s+24]=e,ln.rectVertices[s+25]=n,ln.rectVertices[s+26]=i,ln.rectVertices[s+32]=t,ln.rectVertices[s+33]=e,ln.rectVertices[s+34]=n,ln.rectVertices[s+35]=i},drawBuffer:function(){ln.rectVertexBuffer.unlock(),this.g.setVertexBuffer(ln.rectVertexBuffer),this.g.setIndexBuffer(ln.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?ln.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,ln.lastTexture),this.g.setTextureParameters(this.textureLocation,wn.Clamp,wn.Clamp,this.bilinear?bn.LinearFilter:bn.PointFilter,this.bilinear?bn.LinearFilter:bn.PointFilter,this.bilinearMipmaps?cn.LinearMipFilter:cn.NoMipFilter),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*ln.bufferIndex*3),this.g.setTexture(this.textureLocation,null),ln.bufferIndex=0,ln.rectVertices=ln.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},drawImage:function(t,e,n,i,s,r,a,l,o,h,u){var _=t;(1500<=ln.bufferIndex+1||null!=ln.lastTexture&&_!=ln.lastTexture)&&this.drawBuffer(),this.setRectColor(.00392156862745098*((16711680&u)>>>16),.00392156862745098*((65280&u)>>>8),.00392156862745098*(255&u),.00392156862745098*(u>>>24)*h),this.setRectTexCoords(0,0,_.get_width()/_.get_realWidth(),_.get_height()/_.get_realHeight()),this.setRectVertices(e,n,i,s,r,a,l,o),++ln.bufferIndex,ln.lastTexture=_},drawImage2:function(t,e,n,i,s,r,a,l,o,h,u,_,c,d,g){var f=t;(1500<=ln.bufferIndex+1||null!=ln.lastTexture&&f!=ln.lastTexture)&&this.drawBuffer(),this.setRectTexCoords(e/f.get_realWidth(),n/f.get_realHeight(),(e+i)/f.get_realWidth(),(n+s)/f.get_realHeight()),this.setRectColor(.00392156862745098*((16711680&g)>>>16),.00392156862745098*((65280&g)>>>8),.00392156862745098*(255&g),.00392156862745098*(g>>>24)*d),this.setRectVertices(r,a,l,o,h,u,_,c),++ln.bufferIndex,ln.lastTexture=f},end:function(){0<ln.bufferIndex&&this.drawBuffer(),ln.lastTexture=null},__class__:ln,__properties__:{get_pipeline:"get_pipeline"}};var on=function(t){this.myPipeline=null,this.g=t,on.bufferIndex=0,on.triangleBufferIndex=0,on.initShaders(),this.initBuffers(),this.projectionLocation=on.shaderPipeline.getConstantLocation("projectionMatrix")};(n["kha.graphics4.ColoredShaderPainter"]=on).__name__=!0,on.initShaders=function(){null==on.structure&&(on.structure=un.createColoredVertexStructure()),null==on.shaderPipeline&&(on.shaderPipeline=un.createColoredPipeline(on.structure),on.shaderPipeline.compile())},on.prototype={projectionMatrix:null,g:null,myPipeline:null,projectionLocation:null,get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==on.rectVertexBuffer){on.rectVertexBuffer=new Cn(400,on.structure,Sn.DynamicUsage),on.rectVertices=on.rectVertexBuffer.lock(),on.indexBuffer=new _n(600,Sn.StaticUsage);for(var t=on.indexBuffer.lock(),e=0;e<100;){var n=e++;t[3*n*2]=4*n,t[3*n*2+1]=4*n+1,t[3*n*2+2]=4*n+2,t[3*n*2+3]=4*n,t[3*n*2+4]=4*n+2,t[3*n*2+5]=4*n+3}on.indexBuffer.unlock(),on.triangleVertexBuffer=new Cn(300,on.structure,Sn.DynamicUsage),on.triangleVertices=on.triangleVertexBuffer.lock(),on.triangleIndexBuffer=new _n(300,Sn.StaticUsage);for(var i=on.triangleIndexBuffer.lock(),s=0;s<100;){var r=s++;i[3*r]=3*r,i[3*r+1]=3*r+1,i[3*r+2]=3*r+2}on.triangleIndexBuffer.unlock()}},setRectVertices:function(t,e,n,i,s,r,a,l){var o=7*on.bufferIndex*4;on.rectVertices[o]=t,on.rectVertices[o+1]=e,on.rectVertices[o+2]=-5,on.rectVertices[o+7]=n,on.rectVertices[o+8]=i,on.rectVertices[o+9]=-5,on.rectVertices[o+14]=s,on.rectVertices[o+15]=r,on.rectVertices[o+16]=-5,on.rectVertices[o+21]=a,on.rectVertices[o+22]=l,on.rectVertices[o+23]=-5},setRectColors:function(t,e){var n=7*on.bufferIndex*4,i=t*(.00392156862745098*(e>>>24));on.rectVertices[n+3]=.00392156862745098*((16711680&e)>>>16),on.rectVertices[n+4]=.00392156862745098*((65280&e)>>>8),on.rectVertices[n+5]=.00392156862745098*(255&e),on.rectVertices[n+6]=i,on.rectVertices[n+10]=.00392156862745098*((16711680&e)>>>16),on.rectVertices[n+11]=.00392156862745098*((65280&e)>>>8),on.rectVertices[n+12]=.00392156862745098*(255&e),on.rectVertices[n+13]=i,on.rectVertices[n+17]=.00392156862745098*((16711680&e)>>>16),on.rectVertices[n+18]=.00392156862745098*((65280&e)>>>8),on.rectVertices[n+19]=.00392156862745098*(255&e),on.rectVertices[n+20]=i,on.rectVertices[n+24]=.00392156862745098*((16711680&e)>>>16),on.rectVertices[n+25]=.00392156862745098*((65280&e)>>>8),on.rectVertices[n+26]=.00392156862745098*(255&e),on.rectVertices[n+27]=i},setTriVertices:function(t,e,n,i,s,r){var a=7*on.triangleBufferIndex*3;on.triangleVertices[a]=t,on.triangleVertices[a+1]=e,on.triangleVertices[a+2]=-5,on.triangleVertices[a+7]=n,on.triangleVertices[a+8]=i,on.triangleVertices[a+9]=-5,on.triangleVertices[a+14]=s,on.triangleVertices[a+15]=r,on.triangleVertices[a+16]=-5},setTriColors:function(t,e){var n=7*on.triangleBufferIndex*3,i=t*(.00392156862745098*(e>>>24));on.triangleVertices[n+3]=.00392156862745098*((16711680&e)>>>16),on.triangleVertices[n+4]=.00392156862745098*((65280&e)>>>8),on.triangleVertices[n+5]=.00392156862745098*(255&e),on.triangleVertices[n+6]=i,on.triangleVertices[n+10]=.00392156862745098*((16711680&e)>>>16),on.triangleVertices[n+11]=.00392156862745098*((65280&e)>>>8),on.triangleVertices[n+12]=.00392156862745098*(255&e),on.triangleVertices[n+13]=i,on.triangleVertices[n+17]=.00392156862745098*((16711680&e)>>>16),on.triangleVertices[n+18]=.00392156862745098*((65280&e)>>>8),on.triangleVertices[n+19]=.00392156862745098*(255&e),on.triangleVertices[n+20]=i},drawBuffer:function(t){t||this.endTris(!0),on.rectVertexBuffer.unlock(),this.g.setVertexBuffer(on.rectVertexBuffer),this.g.setIndexBuffer(on.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?on.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*on.bufferIndex*3),on.bufferIndex=0,on.rectVertices=on.rectVertexBuffer.lock()},drawTriBuffer:function(t){t||this.endRects(!0),on.triangleVertexBuffer.unlock(),this.g.setVertexBuffer(on.triangleVertexBuffer),this.g.setIndexBuffer(on.triangleIndexBuffer),this.g.setPipeline(null==this.get_pipeline()?on.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*on.triangleBufferIndex),on.triangleBufferIndex=0,on.triangleVertices=on.triangleVertexBuffer.lock()},fillRect:function(t,e,n,i,s,r,a,l,o,h){0<on.triangleBufferIndex&&this.drawTriBuffer(!0),100<=on.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(t,e),this.setRectVertices(n,i,s,r,a,l,o,h),++on.bufferIndex},fillTriangle:function(t,e,n,i,s,r,a,l){0<on.bufferIndex&&this.drawBuffer(!0),100<=on.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(t,e),this.setTriVertices(n,i,s,r,a,l),++on.triangleBufferIndex},endTris:function(t){0<on.triangleBufferIndex&&this.drawTriBuffer(t)},endRects:function(t){0<on.bufferIndex&&this.drawBuffer(t)},end:function(){this.endTris(!1),this.endRects(!1)},__class__:on,__properties__:{get_pipeline:"get_pipeline"}};var hn=function(t){this.bakedQuadCache=new ue,this.bilinear=!1,this.myPipeline=null,this.g=t,hn.bufferIndex=0,hn.initShaders(),this.initBuffers(),this.projectionLocation=hn.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=hn.shaderPipeline.getTextureUnit("tex")};(n["kha.graphics4.TextShaderPainter"]=hn).__name__=!0,hn.initShaders=function(){null==hn.structure&&(hn.structure=un.createTextVertexStructure()),null==hn.shaderPipeline&&(hn.shaderPipeline=un.createTextPipeline(hn.structure),hn.shaderPipeline.compile())},hn.findIndex=function(t){Oe.fontGlyphs;for(var e=_e.charBlocks,n=0,i=0,s=gt.int(e.length/2);i<s;){var r=i++,a=e[2*r],l=e[2*r+1];if(a<=t&&t<=l)return n+t-a;n+=l-a+1}return 0},hn.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,projectionLocation:null,textureLocation:null,fontSize:null,bilinear:null,get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==hn.rectVertexBuffer){hn.rectVertexBuffer=new Cn(400,hn.structure,Sn.DynamicUsage),hn.rectVertices=hn.rectVertexBuffer.lock(),hn.indexBuffer=new _n(600,Sn.StaticUsage);for(var t=hn.indexBuffer.lock(),e=0;e<100;){var n=e++;t[3*n*2]=4*n,t[3*n*2+1]=4*n+1,t[3*n*2+2]=4*n+2,t[3*n*2+3]=4*n,t[3*n*2+4]=4*n+2,t[3*n*2+5]=4*n+3}hn.indexBuffer.unlock()}},setRectVertices:function(t,e,n,i,s,r,a,l){var o=9*hn.bufferIndex*4;hn.rectVertices[o]=t,hn.rectVertices[o+1]=e,hn.rectVertices[o+2]=-5,hn.rectVertices[o+9]=n,hn.rectVertices[o+10]=i,hn.rectVertices[o+11]=-5,hn.rectVertices[o+18]=s,hn.rectVertices[o+19]=r,hn.rectVertices[o+20]=-5,hn.rectVertices[o+27]=a,hn.rectVertices[o+28]=l,hn.rectVertices[o+29]=-5},setRectTexCoords:function(t,e,n,i){var s=9*hn.bufferIndex*4;hn.rectVertices[s+3]=t,hn.rectVertices[s+4]=i,hn.rectVertices[s+12]=t,hn.rectVertices[s+13]=e,hn.rectVertices[s+21]=n,hn.rectVertices[s+22]=e,hn.rectVertices[s+30]=n,hn.rectVertices[s+31]=i},setRectColors:function(t,e){var n=9*hn.bufferIndex*4,i=t*(.00392156862745098*(e>>>24));hn.rectVertices[n+5]=.00392156862745098*((16711680&e)>>>16),hn.rectVertices[n+6]=.00392156862745098*((65280&e)>>>8),hn.rectVertices[n+7]=.00392156862745098*(255&e),hn.rectVertices[n+8]=i,hn.rectVertices[n+14]=.00392156862745098*((16711680&e)>>>16),hn.rectVertices[n+15]=.00392156862745098*((65280&e)>>>8),hn.rectVertices[n+16]=.00392156862745098*(255&e),hn.rectVertices[n+17]=i,hn.rectVertices[n+23]=.00392156862745098*((16711680&e)>>>16),hn.rectVertices[n+24]=.00392156862745098*((65280&e)>>>8),hn.rectVertices[n+25]=.00392156862745098*(255&e),hn.rectVertices[n+26]=i,hn.rectVertices[n+32]=.00392156862745098*((16711680&e)>>>16),hn.rectVertices[n+33]=.00392156862745098*((65280&e)>>>8),hn.rectVertices[n+34]=.00392156862745098*(255&e),hn.rectVertices[n+35]=i},drawBuffer:function(){hn.rectVertexBuffer.unlock(),this.g.setVertexBuffer(hn.rectVertexBuffer),this.g.setIndexBuffer(hn.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?hn.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,hn.lastTexture),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.textureLocation,wn.Clamp,wn.Clamp,this.bilinear?bn.LinearFilter:bn.PointFilter,this.bilinear?bn.LinearFilter:bn.PointFilter,cn.NoMipFilter),this.g.drawIndexedVertices(0,2*hn.bufferIndex*3),this.g.setTexture(this.textureLocation,null),hn.bufferIndex=0,hn.rectVertices=hn.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setFont:function(t){this.font=zt.__cast(t,ce)},text:null,startString:function(t){this.text=t},charCodeAt:function(t){return ht.cca(this.text,t)},stringLength:function(){return this.text.length},endString:function(){this.text=null},bakedQuadCache:null,drawString:function(t,e,n,i,s,r){var a=this.font._get(this.fontSize),l=a.getTexture();null!=hn.lastTexture&&l!=hn.lastTexture&&this.drawBuffer(),hn.lastTexture=l;var o=i,h=s;this.startString(t);for(var u=0,_=this.stringLength();u<_;){var c=u++,d=a.getBakedQuad(this.bakedQuadCache,hn.findIndex(this.charCodeAt(c)),o,h);if(null!=d){100<=hn.bufferIndex+1&&this.drawBuffer(),this.setRectColors(e,n),this.setRectTexCoords(d.s0*l.get_width()/l.get_realWidth(),d.t0*l.get_height()/l.get_realHeight(),d.s1*l.get_width()/l.get_realWidth(),d.t1*l.get_height()/l.get_realHeight());var g=new ni(d.x0,d.y1),f=r._02*g.x+r._12*g.y+r._22,p=(r._00*g.x+r._10*g.y+r._20)/f,m=(r._01*g.x+r._11*g.y+r._21)/f,v=new ni(p,m),w=new ni(d.x0,d.y0),b=r._02*w.x+r._12*w.y+r._22,x=(r._00*w.x+r._10*w.y+r._20)/b,y=(r._01*w.x+r._11*w.y+r._21)/b,S=new ni(x,y),C=new ni(d.x1,d.y0),I=r._02*C.x+r._12*C.y+r._22,T=(r._00*C.x+r._10*C.y+r._20)/I,k=(r._01*C.x+r._11*C.y+r._21)/I,B=new ni(T,k),E=new ni(d.x1,d.y1),M=r._02*E.x+r._12*E.y+r._22,L=(r._00*E.x+r._10*E.y+r._20)/M,A=(r._01*E.x+r._11*E.y+r._21)/M,W=new ni(L,A);this.setRectVertices(v.x,v.y,S.x,S.y,B.x,B.y,W.x,W.y),o+=d.xadvance,++hn.bufferIndex}}this.endString()},end:function(){0<hn.bufferIndex&&this.drawBuffer(),hn.lastTexture=null},__class__:hn,__properties__:{get_pipeline:"get_pipeline"}};var un=function(t){this.myImageScaleQuality=Ne.High,Oe.call(this),this.set_color(-1),this.canvas=t,this.g=t.get_g4(),this.imagePainter=new ln(this.g),this.coloredPainter=new on(this.g),this.textPainter=new hn(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new p(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==un.videoPipeline&&(un.videoPipeline=un.createImagePipeline(un.createImageVertexStructure()),un.videoPipeline.fragmentShader=me.painter_video_frag,un.videoPipeline.vertexShader=me.painter_video_vert,un.videoPipeline.compile())};(n["kha.graphics4.Graphics2"]=un).__name__=!0,un.upperPowerOfTwo=function(t){return--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t},un.createImageVertexStructure=function(){var t=new kn;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},un.createImagePipeline=function(t){var e=new gn;return e.fragmentShader=me.painter_image_frag,e.vertexShader=me.painter_image_vert,e.inputLayout=[t],e.blendSource=Je.BlendOne,e.blendDestination=Je.InverseSourceAlpha,e.alphaBlendSource=Je.BlendOne,e.alphaBlendDestination=Je.InverseSourceAlpha,e},un.createColoredVertexStructure=function(){var t=new kn;return t.add("vertexPosition",2),t.add("vertexColor",3),t},un.createColoredPipeline=function(t){var e=new gn;return e.fragmentShader=me.painter_colored_frag,e.vertexShader=me.painter_colored_vert,e.inputLayout=[t],e.blendSource=Je.SourceAlpha,e.blendDestination=Je.InverseSourceAlpha,e.alphaBlendSource=Je.SourceAlpha,e.alphaBlendDestination=Je.InverseSourceAlpha,e},un.createTextVertexStructure=function(){var t=new kn;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},un.createTextPipeline=function(t){var e=new gn;return e.fragmentShader=me.painter_text_frag,e.vertexShader=me.painter_text_vert,e.inputLayout=[t],e.blendSource=Je.SourceAlpha,e.blendDestination=Je.InverseSourceAlpha,e.alphaBlendSource=Je.SourceAlpha,e.alphaBlendDestination=Je.InverseSourceAlpha,e},un.__super__=Oe,un.prototype=s(Oe.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var t=this.canvas.get_width(),e=this.canvas.get_height();if(this.canvas instanceof oe){var n=this.projectionMatrix,i=p.orthogonalProjection(0,t,e,0,.1,1e3);n._00=i._00,n._10=i._10,n._20=i._20,n._30=i._30,n._01=i._01,n._11=i._11,n._21=i._21,n._31=i._31,n._02=i._02,n._12=i._12,n._22=i._22,n._32=i._32,n._03=i._03,n._13=i._13,n._23=i._23,n._33=i._33}else if(ne.get_nonPow2Supported()||(t=un.upperPowerOfTwo(t),e=un.upperPowerOfTwo(e)),this.g.renderTargetsInvertedY()){var s=this.projectionMatrix,r=p.orthogonalProjection(0,t,0,e,.1,1e3);s._00=r._00,s._10=r._10,s._20=r._20,s._30=r._30,s._01=r._01,s._11=r._11,s._21=r._21,s._31=r._31,s._02=r._02,s._12=r._12,s._22=r._22,s._32=r._32,s._03=r._03,s._13=r._13,s._23=r._23,s._33=r._33}else{var a=this.projectionMatrix,l=p.orthogonalProjection(0,t,e,0,.1,1e3);a._00=l._00,a._10=l._10,a._20=l._20,a._30=l._30,a._01=l._01,a._11=l._11,a._21=l._21,a._31=l._31,a._02=l._02,a._12=l._12,a._22=l._22,a._32=l._32,a._03=l._03,a._13=l._13,a._23=l._23,a._33=l._33}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(t,e,n){this.coloredPainter.end(),this.textPainter.end();var i=e+t.get_width(),s=n+t.get_height(),r=this.get_transformation(),a=new ni(e,s),l=r._02*a.x+r._12*a.y+r._22,o=(r._00*a.x+r._10*a.y+r._20)/l,h=(r._01*a.x+r._11*a.y+r._21)/l,u=new ni(o,h),_=this.get_transformation(),c=new ni(e,n),d=_._02*c.x+_._12*c.y+_._22,g=(_._00*c.x+_._10*c.y+_._20)/d,f=(_._01*c.x+_._11*c.y+_._21)/d,p=new ni(g,f),m=this.get_transformation(),v=new ni(i,n),w=m._02*v.x+m._12*v.y+m._22,b=(m._00*v.x+m._10*v.y+m._20)/w,x=(m._01*v.x+m._11*v.y+m._21)/w,y=new ni(b,x),S=this.get_transformation(),C=new ni(i,s),I=S._02*C.x+S._12*C.y+S._22,T=(S._00*C.x+S._10*C.y+S._20)/I,k=(S._01*C.x+S._11*C.y+S._21)/I,B=new ni(T,k);this.imagePainter.drawImage(t,u.x,u.y,p.x,p.y,y.x,y.y,B.x,B.y,this.get_opacity(),this.get_color())},drawScaledSubImage:function(t,e,n,i,s,r,a,l,o){this.coloredPainter.end(),this.textPainter.end();var h=this.get_transformation(),u=new ni(r,a+o),_=h._02*u.x+h._12*u.y+h._22,c=(h._00*u.x+h._10*u.y+h._20)/_,d=(h._01*u.x+h._11*u.y+h._21)/_,g=new ni(c,d),f=this.get_transformation(),p=new ni(r,a),m=f._02*p.x+f._12*p.y+f._22,v=(f._00*p.x+f._10*p.y+f._20)/m,w=(f._01*p.x+f._11*p.y+f._21)/m,b=new ni(v,w),x=this.get_transformation(),y=new ni(r+l,a),S=x._02*y.x+x._12*y.y+x._22,C=(x._00*y.x+x._10*y.y+x._20)/S,I=(x._01*y.x+x._11*y.y+x._21)/S,T=new ni(C,I),k=this.get_transformation(),B=new ni(r+l,a+o),E=k._02*B.x+k._12*B.y+k._22,M=(k._00*B.x+k._10*B.y+k._20)/E,L=(k._01*B.x+k._11*B.y+k._21)/E,A=new ni(M,L);this.imagePainter.drawImage2(t,e,n,i,s,g.x,g.y,b.x,b.y,T.x,T.y,A.x,A.y,this.get_opacity(),this.get_color())},get_color:function(){return this.myColor},set_color:function(t){return this.myColor=t},drawRect:function(t,e,n,i,s){null==s&&(s=1),this.imagePainter.end(),this.textPainter.end();var r=this.get_transformation(),a=new ni(t-s/2,e+s/2),l=r._02*a.x+r._12*a.y+r._22,o=(r._00*a.x+r._10*a.y+r._20)/l,h=(r._01*a.x+r._11*a.y+r._21)/l,u=new ni(o,h),_=this.get_transformation(),c=new ni(t-s/2,e-s/2),d=_._02*c.x+_._12*c.y+_._22,g=(_._00*c.x+_._10*c.y+_._20)/d,f=(_._01*c.x+_._11*c.y+_._21)/d,p=new ni(g,f),m=this.get_transformation(),v=new ni(t+n+s/2,e-s/2),w=m._02*v.x+m._12*v.y+m._22,b=(m._00*v.x+m._10*v.y+m._20)/w,x=(m._01*v.x+m._11*v.y+m._21)/w,y=new ni(b,x),S=this.get_transformation(),C=new ni(t+n+s/2,e+s/2),I=S._02*C.x+S._12*C.y+S._22,T=(S._00*C.x+S._10*C.y+S._20)/I,k=(S._01*C.x+S._11*C.y+S._21)/I,B=new ni(T,k);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,p.x,p.y,y.x,y.y,B.x,B.y);var E=this.get_transformation(),M=new ni(t-s/2,e+i-s/2),L=E._02*M.x+E._12*M.y+E._22,A=(E._00*M.x+E._10*M.y+E._20)/L,W=(E._01*M.x+E._11*M.y+E._21)/L;u=new ni(A,W);var F=this.get_transformation(),O=new ni(t-s/2,e+s/2),R=F._02*O.x+F._12*O.y+F._22,D=(F._00*O.x+F._10*O.y+F._20)/R,N=(F._01*O.x+F._11*O.y+F._21)/R;p=new ni(D,N);var V=this.get_transformation(),H=new ni(t+s/2,e+s/2),G=V._02*H.x+V._12*H.y+V._22,P=(V._00*H.x+V._10*H.y+V._20)/G,Z=(V._01*H.x+V._11*H.y+V._21)/G;y=new ni(P,Z);var X=this.get_transformation(),z=new ni(t+s/2,e+i-s/2),Y=X._02*z.x+X._12*z.y+X._22,j=(X._00*z.x+X._10*z.y+X._20)/Y,U=(X._01*z.x+X._11*z.y+X._21)/Y;B=new ni(j,U),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,p.x,p.y,y.x,y.y,B.x,B.y);var K=this.get_transformation(),Q=new ni(t-s/2,e+i+s/2),J=K._02*Q.x+K._12*Q.y+K._22,q=(K._00*Q.x+K._10*Q.y+K._20)/J,$=(K._01*Q.x+K._11*Q.y+K._21)/J;u=new ni(q,$);var tt=this.get_transformation(),et=new ni(t-s/2,e+i-s/2),nt=tt._02*et.x+tt._12*et.y+tt._22,it=(tt._00*et.x+tt._10*et.y+tt._20)/nt,st=(tt._01*et.x+tt._11*et.y+tt._21)/nt;p=new ni(it,st);var rt=this.get_transformation(),at=new ni(t+n+s/2,e+i-s/2),lt=rt._02*at.x+rt._12*at.y+rt._22,ot=(rt._00*at.x+rt._10*at.y+rt._20)/lt,ht=(rt._01*at.x+rt._11*at.y+rt._21)/lt;y=new ni(ot,ht);var ut=this.get_transformation(),_t=new ni(t+n+s/2,e+i+s/2),ct=ut._02*_t.x+ut._12*_t.y+ut._22,dt=(ut._00*_t.x+ut._10*_t.y+ut._20)/ct,gt=(ut._01*_t.x+ut._11*_t.y+ut._21)/ct;B=new ni(dt,gt),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,p.x,p.y,y.x,y.y,B.x,B.y);var ft=this.get_transformation(),pt=new ni(t+n-s/2,e+i-s/2),mt=ft._02*pt.x+ft._12*pt.y+ft._22,vt=(ft._00*pt.x+ft._10*pt.y+ft._20)/mt,wt=(ft._01*pt.x+ft._11*pt.y+ft._21)/mt;u=new ni(vt,wt);var bt=this.get_transformation(),xt=new ni(t+n-s/2,e+s/2),yt=bt._02*xt.x+bt._12*xt.y+bt._22,St=(bt._00*xt.x+bt._10*xt.y+bt._20)/yt,Ct=(bt._01*xt.x+bt._11*xt.y+bt._21)/yt;p=new ni(St,Ct);var It=this.get_transformation(),Tt=new ni(t+n+s/2,e+s/2),kt=It._02*Tt.x+It._12*Tt.y+It._22,Bt=(It._00*Tt.x+It._10*Tt.y+It._20)/kt,Et=(It._01*Tt.x+It._11*Tt.y+It._21)/kt;y=new ni(Bt,Et);var Mt=this.get_transformation(),Lt=new ni(t+n+s/2,e+i-s/2),At=Mt._02*Lt.x+Mt._12*Lt.y+Mt._22,Wt=(Mt._00*Lt.x+Mt._10*Lt.y+Mt._20)/At,Ft=(Mt._01*Lt.x+Mt._11*Lt.y+Mt._21)/At;B=new ni(Wt,Ft),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,p.x,p.y,y.x,y.y,B.x,B.y)},fillRect:function(t,e,n,i){this.imagePainter.end(),this.textPainter.end();var s=this.get_transformation(),r=new ni(t,e+i),a=s._02*r.x+s._12*r.y+s._22,l=(s._00*r.x+s._10*r.y+s._20)/a,o=(s._01*r.x+s._11*r.y+s._21)/a,h=new ni(l,o),u=this.get_transformation(),_=new ni(t,e),c=u._02*_.x+u._12*_.y+u._22,d=(u._00*_.x+u._10*_.y+u._20)/c,g=(u._01*_.x+u._11*_.y+u._21)/c,f=new ni(d,g),p=this.get_transformation(),m=new ni(t+n,e),v=p._02*m.x+p._12*m.y+p._22,w=(p._00*m.x+p._10*m.y+p._20)/v,b=(p._01*m.x+p._11*m.y+p._21)/v,x=new ni(w,b),y=this.get_transformation(),S=new ni(t+n,e+i),C=y._02*S.x+y._12*S.y+y._22,I=(y._00*S.x+y._10*S.y+y._20)/C,T=(y._01*S.x+y._11*S.y+y._21)/C,k=new ni(I,T);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h.x,h.y,f.x,f.y,x.x,x.y,k.x,k.y)},drawString:function(t,e,n){this.imagePainter.end(),this.coloredPainter.end(),this.textPainter.drawString(t,this.get_opacity(),this.get_color(),e,n,this.get_transformation())},get_font:function(){return this.myFont},set_font:function(t){return this.textPainter.setFont(t),this.myFont=t},set_fontSize:function(t){return Oe.prototype.set_fontSize.call(this,this.textPainter.fontSize=t)},drawLine:function(t,e,n,i,s){var r;null==s&&(s=1),this.imagePainter.end(),this.textPainter.end(),(r=i==e?new ni(0,-1):new ni(1,-(n-t)/(i-e))).set_length(s);var a=new ni(t+.5*r.x,e+.5*r.y),l=new ni(n+.5*r.x,i+.5*r.y),o=new ni(a.x-r.x,a.y-r.y),h=new ni(l.x-r.x,l.y-r.y),u=this.get_transformation(),_=u._02*a.x+u._12*a.y+u._22,c=(u._00*a.x+u._10*a.y+u._20)/_,d=(u._01*a.x+u._11*a.y+u._21)/_;a=new ni(c,d);var g=this.get_transformation(),f=g._02*l.x+g._12*l.y+g._22,p=(g._00*l.x+g._10*l.y+g._20)/f,m=(g._01*l.x+g._11*l.y+g._21)/f;l=new ni(p,m);var v=this.get_transformation(),w=v._02*o.x+v._12*o.y+v._22,b=(v._00*o.x+v._10*o.y+v._20)/w,x=(v._01*o.x+v._11*o.y+v._21)/w;o=new ni(b,x);var y=this.get_transformation(),S=y._02*h.x+y._12*h.y+y._22,C=(y._00*h.x+y._10*h.y+y._20)/S,I=(y._01*h.x+y._11*h.y+y._21)/S;h=new ni(C,I),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),a.x,a.y,l.x,l.y,o.x,o.y),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),o.x,o.y,l.x,l.y,h.x,h.y)},fillTriangle:function(t,e,n,i,s,r){this.imagePainter.end(),this.textPainter.end();var a=this.get_transformation(),l=new ni(t,e),o=a._02*l.x+a._12*l.y+a._22,h=(a._00*l.x+a._10*l.y+a._20)/o,u=(a._01*l.x+a._11*l.y+a._21)/o,_=new ni(h,u),c=this.get_transformation(),d=new ni(n,i),g=c._02*d.x+c._12*d.y+c._22,f=(c._00*d.x+c._10*d.y+c._20)/g,p=(c._01*d.x+c._11*d.y+c._21)/g,m=new ni(f,p),v=this.get_transformation(),w=new ni(s,r),b=v._02*w.x+v._12*w.y+v._22,x=(v._00*w.x+v._10*w.y+v._20)/b,y=(v._01*w.x+v._11*w.y+v._21)/b,S=new ni(x,y);this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),_.x,_.y,m.x,m.y,S.x,S.y)},myImageScaleQuality:null,set_imageScaleQuality:function(t){return this.imagePainter.setBilinearFilter(t==Ne.High),this.textPainter.setBilinearFilter(t==Ne.High),this.myImageScaleQuality=t},begin:function(t,e){null==t&&(t=!0),this.g.begin(),t&&this.clear(e),this.setProjection()},clear:function(t){this.flush(),this.g.clear(null==t?-16777216:t)},flush:function(){this.imagePainter.end(),this.textPainter.end(),this.coloredPainter.end()},end:function(){this.flush(),this.g.end()},__class__:un});var _n=function(t,e,n){null==n&&(n=!1),this.usage=e,this.mySize=t,this.buffer=ye.gl.createBuffer();var i=new Uint32Array(t);this._data=i};(n["kha.graphics4.IndexBuffer"]=_n).__name__=!0,_n.prototype={buffer:null,_data:null,mySize:null,usage:null,lock:function(t,e){return null==t&&(t=0),null==e&&(e=this.mySize),this._data.subarray(t,t+e)},unlock:function(){ye.gl.bindBuffer(34963,this.buffer);var t=null==ye.elementIndexUint?new Uint16Array(this._data):this._data;ye.gl.bufferData(34963,t,this.usage==Sn.DynamicUsage?35048:35044)},set:function(){ye.gl.bindBuffer(34963,this.buffer)},count:function(){return this.mySize},__class__:_n};var cn=b["kha.graphics4.MipMapFilter"]={__ename__:!0,__constructs__:["NoMipFilter","PointMipFilter","LinearMipFilter"],NoMipFilter:{_hx_index:0,__enum__:"kha.graphics4.MipMapFilter",toString:i},PointMipFilter:{_hx_index:1,__enum__:"kha.graphics4.MipMapFilter",toString:i},LinearMipFilter:{_hx_index:2,__enum__:"kha.graphics4.MipMapFilter",toString:i}},dn=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=nn.None,this.depthWrite=!1,this.depthMode=$e.Always,this.stencilMode=$e.Always,this.stencilBothPass=fn.Keep,this.stencilDepthFail=fn.Keep,this.stencilFail=fn.Keep,this.stencilReferenceValue=pn.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=Je.BlendOne,this.blendDestination=Je.BlendZero,this.blendOperation=qe.Add,this.alphaBlendSource=Je.BlendOne,this.alphaBlendDestination=Je.BlendZero,this.alphaBlendOperation=qe.Add,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1};(n["kha.graphics4.PipelineStateBase"]=dn).__name__=!0,dn.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,get_colorWriteMaskRed:function(){return this.colorWriteMasksRed[0]},set_colorWriteMaskRed:function(t){return this.colorWriteMasksRed[0]=t},get_colorWriteMaskGreen:function(){return this.colorWriteMasksGreen[0]},set_colorWriteMaskGreen:function(t){return this.colorWriteMasksGreen[0]=t},get_colorWriteMaskBlue:function(){return this.colorWriteMasksBlue[0]},set_colorWriteMaskBlue:function(t){return this.colorWriteMasksBlue[0]=t},get_colorWriteMaskAlpha:function(){return this.colorWriteMasksAlpha[0]},set_colorWriteMaskAlpha:function(t){return this.colorWriteMasksAlpha[0]=t},conservativeRasterization:null,__class__:dn,__properties__:{set_colorWriteMaskAlpha:"set_colorWriteMaskAlpha",get_colorWriteMaskAlpha:"get_colorWriteMaskAlpha",set_colorWriteMaskBlue:"set_colorWriteMaskBlue",get_colorWriteMaskBlue:"get_colorWriteMaskBlue",set_colorWriteMaskGreen:"set_colorWriteMaskGreen",get_colorWriteMaskGreen:"get_colorWriteMaskGreen",set_colorWriteMaskRed:"set_colorWriteMaskRed",get_colorWriteMaskRed:"get_colorWriteMaskRed"}};var gn=function(){this.program=null,dn.call(this),this.textures=[],this.textureValues=[]};(n["kha.graphics4.PipelineState"]=gn).__name__=!0,gn.__super__=dn,gn.prototype=s(dn.prototype,{program:null,textures:null,textureValues:null,delete:function(){null!=this.program&&ye.gl.deleteProgram(this.program)},compile:function(){null!=this.program&&ye.gl.deleteProgram(this.program),this.program=ye.gl.createProgram(),this.compileShader(this.vertexShader),this.compileShader(this.fragmentShader),ye.gl.attachShader(this.program,this.vertexShader.shader),ye.gl.attachShader(this.program,this.fragmentShader.shader);for(var t=0,e=0,n=this.inputLayout;e<n.length;){var i=n[e];++e;for(var s=0,r=i.elements;s<r.length;){var a=r[s];++s,ye.gl.bindAttribLocation(this.program,t,a.name),4==a.data?t+=4:++t}}if(ye.gl.linkProgram(this.program),!ye.gl.getProgramParameter(this.program,35714))throw new Xt("Could not link the shader program:\n"+ye.gl.getProgramInfoLog(this.program))},set:function(){ye.gl.useProgram(this.program);for(var t=0,e=this.textureValues.length;t<e;){var n=t++;ye.gl.uniform1i(this.textureValues[n],n)}ye.gl.colorMask(this.get_colorWriteMaskRed(),this.get_colorWriteMaskGreen(),this.get_colorWriteMaskBlue(),this.get_colorWriteMaskAlpha())},compileShader:function(t){if(null==t.shader){for(var e=ye.gl.createShader(t.type),n=0!=ye.gl.getShaderPrecisionFormat(35632,36338).precision,i=t.files,s=0,r=i.length;s<r;){var a=s++;if(ye.gl2){if(0<=i[a].indexOf("-webgl2")||0<=i[a].indexOf("runtime-string")){ye.gl.shaderSource(e,t.sources[a]);break}}else{if(!n&&(0<=i[a].indexOf("-relaxed")||0<=i[a].indexOf("runtime-string"))){ye.gl.shaderSource(e,t.sources[a]);break}if(n&&(i[a].indexOf("-relaxed")<0||0<=i[a].indexOf("runtime-string"))){ye.gl.shaderSource(e,t.sources[a]);break}}}if(ye.gl.compileShader(e),!ye.gl.getShaderParameter(e,35713))throw new Xt("Could not compile shader:\n"+ye.gl.getShaderInfoLog(e));t.shader=e}},getConstantLocation:function(t){var e=ye.gl.getUniformLocation(this.program,t);null==e&&L.trace("Warning: Uniform "+t+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:92,className:"kha.graphics4.PipelineState",methodName:"getConstantLocation"});for(var n=5126,i=0,s=ye.gl.getProgramParameter(this.program,35718);i<s;){var r=i++,a=ye.gl.getActiveUniform(this.program,r);if(a.name==t||a.name==t+"[0]"){n=a.type;break}}return new Qn(e,n)},getTextureUnit:function(t){var e=this.findTexture(t);if(e<0){var n=ye.gl.getUniformLocation(this.program,t);null==n&&L.trace("Warning: Sampler "+t+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:111,className:"kha.graphics4.PipelineState",methodName:"getTextureUnit"}),e=this.textures.length,this.textureValues.push(n),this.textures.push(t)}return new $n(e)},findTexture:function(t){for(var e=0,n=this.textures.length;e<n;){var i=e++;if(this.textures[i]==t)return i}return-1},__class__:gn});var fn=b["kha.graphics4.StencilAction"]={__ename__:!0,__constructs__:["Keep","Zero","Replace","Increment","IncrementWrap","Decrement","DecrementWrap","Invert"],Keep:{_hx_index:0,__enum__:"kha.graphics4.StencilAction",toString:i},Zero:{_hx_index:1,__enum__:"kha.graphics4.StencilAction",toString:i},Replace:{_hx_index:2,__enum__:"kha.graphics4.StencilAction",toString:i},Increment:{_hx_index:3,__enum__:"kha.graphics4.StencilAction",toString:i},IncrementWrap:{_hx_index:4,__enum__:"kha.graphics4.StencilAction",toString:i},Decrement:{_hx_index:5,__enum__:"kha.graphics4.StencilAction",toString:i},DecrementWrap:{_hx_index:6,__enum__:"kha.graphics4.StencilAction",toString:i},Invert:{_hx_index:7,__enum__:"kha.graphics4.StencilAction",toString:i}},pn=b["kha.graphics4.StencilValue"]={__ename__:!0,__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:i},Static:(S=function(t){return{_hx_index:1,value:t,__enum__:"kha.graphics4.StencilValue",toString:i}},S.__params__=["value"],S)},mn=function(){};(n["kha.graphics4.TessellationControlShader"]=mn).__name__=!0;var vn=function(){};(n["kha.graphics4.TessellationEvaluationShader"]=vn).__name__=!0;var wn=b["kha.graphics4.TextureAddressing"]={__ename__:!0,__constructs__:["Repeat","Mirror","Clamp"],Repeat:{_hx_index:0,__enum__:"kha.graphics4.TextureAddressing",toString:i},Mirror:{_hx_index:1,__enum__:"kha.graphics4.TextureAddressing",toString:i},Clamp:{_hx_index:2,__enum__:"kha.graphics4.TextureAddressing",toString:i}},bn=b["kha.graphics4.TextureFilter"]={__ename__:!0,__constructs__:["PointFilter","LinearFilter","AnisotropicFilter"],PointFilter:{_hx_index:0,__enum__:"kha.graphics4.TextureFilter",toString:i},LinearFilter:{_hx_index:1,__enum__:"kha.graphics4.TextureFilter",toString:i},AnisotropicFilter:{_hx_index:2,__enum__:"kha.graphics4.TextureFilter",toString:i}},xn=b["kha.graphics4.TextureFormat"]={__ename__:!0,__constructs__:["RGBA32","L8","RGBA128","DEPTH16","RGBA64","A32","A16"],RGBA32:{_hx_index:0,__enum__:"kha.graphics4.TextureFormat",toString:i},L8:{_hx_index:1,__enum__:"kha.graphics4.TextureFormat",toString:i},RGBA128:{_hx_index:2,__enum__:"kha.graphics4.TextureFormat",toString:i},DEPTH16:{_hx_index:3,__enum__:"kha.graphics4.TextureFormat",toString:i},RGBA64:{_hx_index:4,__enum__:"kha.graphics4.TextureFormat",toString:i},A32:{_hx_index:5,__enum__:"kha.graphics4.TextureFormat",toString:i},A16:{_hx_index:6,__enum__:"kha.graphics4.TextureFormat",toString:i}},yn=function(){};(n["kha.graphics4.TextureUnit"]=yn).__name__=!0;var Sn=b["kha.graphics4.Usage"]={__ename__:!0,__constructs__:["StaticUsage","DynamicUsage","ReadableUsage"],StaticUsage:{_hx_index:0,__enum__:"kha.graphics4.Usage",toString:i},DynamicUsage:{_hx_index:1,__enum__:"kha.graphics4.Usage",toString:i},ReadableUsage:{_hx_index:2,__enum__:"kha.graphics4.Usage",toString:i}},Cn=function(t,e,n,i,s){null==s&&(s=!1),null==i&&(i=0),this.usage=n,this.instanceDataStepRate=i,this.mySize=t;for(var r=this.myStride=0,a=e.elements;r<a.length;){var l=a[r];switch(++r,l.data){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64}}this.buffer=ye.gl.createBuffer();var o=new Float32Array(gt.int(t*this.myStride/4));this._data=o,this.sizes=[],this.offsets=[],this.sizes[e.elements.length-1]=0;for(var h=this.offsets[e.elements.length-1]=0,u=0,_=0,c=e.elements;_<c.length;){var d,g=c[_];switch(++_,g.data){case 0:d=1;break;case 1:d=2;break;case 2:d=3;break;case 3:d=4;break;case 4:d=16}switch(this.sizes[u]=d,this.offsets[u]=h,g.data){case 0:h+=4;break;case 1:h+=8;break;case 2:h+=12;break;case 3:h+=16;break;case 4:h+=64}++u}};(n["kha.graphics4.VertexBuffer"]=Cn).__name__=!0,Cn.prototype={buffer:null,_data:null,mySize:null,myStride:null,sizes:null,offsets:null,usage:null,instanceDataStepRate:null,lock:function(t,e){return null==t&&(t=0),null==e&&(e=this.mySize),this._data.subarray(t*this.stride(),(t+e)*this.stride())},unlock:function(){ye.gl.bindBuffer(34962,this.buffer),ye.gl.bufferData(34962,this._data,this.usage==Sn.DynamicUsage?35048:35044)},stride:function(){return this.myStride},set:function(t){var e=!!ye.gl2||ye.gl.getExtension("ANGLE_instanced_arrays");ye.gl.bindBuffer(34962,this.buffer);for(var n=0,i=0,s=this.sizes.length;i<s;){var r=i++;if(4<this.sizes[r])for(var a=this.sizes[r],l=0;0<a;)ye.gl.enableVertexAttribArray(t+n),ye.gl.vertexAttribPointer(t+n,4,5126,!1,this.myStride,this.offsets[r]+l),e&&(ye.gl2?ye.gl.vertexAttribDivisor(t+n,this.instanceDataStepRate):e.vertexAttribDivisorANGLE(t+n,this.instanceDataStepRate)),a-=4,l+=16,++n;else ye.gl.enableVertexAttribArray(t+n),ye.gl.vertexAttribPointer(t+n,this.sizes[r],5126,!1,this.myStride,this.offsets[r]),e&&(ye.gl2?ye.gl.vertexAttribDivisor(t+n,this.instanceDataStepRate):e.vertexAttribDivisorANGLE(t+n,this.instanceDataStepRate)),++n}return n},__class__:Cn};var In=function(t,e){this.name=t,this.data=e};(n["kha.graphics4.VertexElement"]=In).__name__=!0,In.prototype={name:null,data:null,__class__:In};var Tn=function(t,e){this.sources=[];for(var n=0;n<t.length;){var i=t[n];++n,this.sources.push(i.toString())}this.type=35633,this.shader=null,this.files=e};(n["kha.graphics4.VertexShader"]=Tn).__name__=!0,Tn.fromSource=function(t){var e=new Tn([],["runtime-string"]);return e.sources.push(t),e},Tn.prototype={sources:null,type:null,shader:null,files:null,__class__:Tn};var kn=function(){this.elements=[],this.instanced=!1};(n["kha.graphics4.VertexStructure"]=kn).__name__=!0,kn.prototype={elements:null,instanced:null,add:function(t,e){this.elements.push(new In(t,e))},size:function(){return this.elements.length},byteSize:function(){for(var t=0,e=0,n=this.elements.length;e<n;){var i=e++;t+=this.dataByteSize(this.elements[i].data)}return t},dataByteSize:function(t){switch(t){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64}},get:function(t){return this.elements[t]},__class__:kn};var Bn=function(){};(n["kha.graphics5.Graphics"]=Bn).__name__=!0;var En=t.kha.input.Gamepad=function(t,e){null==e&&(e="unknown"),null==t&&(t=0),this.index=t,this.axisListeners=[],this.buttonListeners=[],En.instances[t]=this};(n["kha.input.Gamepad"]=En).__name__=!0,En.get=function(t){return null==t&&(t=0),t>=En.instances.length?null:En.instances[t]},En.sendConnectEvent=function(t){En.instances[t].connected=!0;for(var e=0,n=En.connectListeners;e<n.length;){var i=n[e];++e,i(t)}},En.sendDisconnectEvent=function(t){En.instances[t].connected=!1;for(var e=0,n=En.disconnectListeners;e<n.length;){var i=n[e];++e,i(t)}},En.prototype={index:null,notify:function(t,e){null!=t&&this.axisListeners.push(t),null!=e&&this.buttonListeners.push(e)},axisListeners:null,buttonListeners:null,connected:null,sendAxisEvent:function(t,e){for(var n=0,i=this.axisListeners;n<i.length;){var s=i[n];++n,s(t,e)}},sendButtonEvent:function(t,e){for(var n=0,i=this.buttonListeners;n<i.length;){var s=i[n];++n,s(t,e)}},__class__:En};var Mn=function(){this.__id=ii.nextId++,this._inputBuffer=$.alloc(1)};(n["kha.netsync.Controller"]=Mn).__name__=!0,Mn.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},__class__:Mn};var Ln=t.kha.input.Keyboard=function(){Mn.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],Ln.instance=this};(n["kha.input.Keyboard"]=Ln).__name__=!0,Ln.get=function(t){return null==t&&(t=0),ye.getKeyboard(t)},Ln.__super__=Mn,Ln.prototype=s(Mn.prototype,{notify:function(t,e,n){null!=t&&this.downListeners.push(t),null!=e&&this.upListeners.push(e),null!=n&&this.pressListeners.push(n)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(t){if(null!=si.the()){var e=$.alloc(5);e.setInt32(0,0),e.set(4,t),si.the().sendControllerUpdate(this._id(),e)}for(var n=0,i=this.downListeners;n<i.length;){var s=i[n];++n,s(t)}},sendUpEvent:function(t){if(null!=si.the()){var e=$.alloc(5);e.setInt32(0,1),e.set(4,t),si.the().sendControllerUpdate(this._id(),e)}for(var n=0,i=this.upListeners;n<i.length;){var s=i[n];++n,s(t)}},sendPressEvent:function(t){if(null!=si.the()){var e=$.alloc(5);e.setInt32(0,2),e.set(4,ht.cca(t,0)),si.the().sendControllerUpdate(this._id(),e)}for(var n=0,i=this.pressListeners;n<i.length;){var s=i[n];++n,s(t)}},__class__:Ln});var An=t.kha.input.Mouse=function(){Mn.call(this),An.instance=this};(n["kha.input.Mouse"]=An).__name__=!0,An.get=function(t){return null==t&&(t=0),ye.getMouse(t)},An.__super__=Mn,An.prototype=s(Mn.prototype,{notify:function(t,e,n,i,s){this.notifyWindowed(0,t,e,n,i,s)},notifyWindowed:function(t,e,n,i,s,r){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=n){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(n)}if(null!=i){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(i)}if(null!=s){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=t;)this.windowWheelListeners.push([]);this.windowWheelListeners[t].push(s)}if(null!=r){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=t;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[t].push(r)}},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(t){if(null!=si.the()){var e=$.alloc(8);e.setInt32(0,0),e.setInt32(4,t),si.the().sendControllerUpdate(this._id(),e)}if(null!=this.windowLeaveListeners)for(var n=0,i=this.windowLeaveListeners[t];n<i.length;){var s=i[n];++n,s()}},sendDownEvent:function(t,e,n,i){if(null!=si.the()){var s=$.alloc(20);s.setInt32(0,1),s.setInt32(4,t),s.setInt32(8,e),s.setInt32(12,n),s.setInt32(16,i),si.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowDownListeners)for(var r=0,a=this.windowDownListeners[t];r<a.length;){var l=a[r];++r,l(e,n,i)}},sendUpEvent:function(t,e,n,i){if(null!=si.the()){var s=$.alloc(20);s.setInt32(0,2),s.setInt32(4,t),s.setInt32(8,e),s.setInt32(12,n),s.setInt32(16,i),si.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowUpListeners)for(var r=0,a=this.windowUpListeners[t];r<a.length;){var l=a[r];++r,l(e,n,i)}},sendMoveEvent:function(t,e,n,i,s){if(null!=si.the()){var r=$.alloc(24);r.setInt32(0,3),r.setInt32(4,t),r.setInt32(8,e),r.setInt32(12,n),r.setInt32(16,i),r.setInt32(20,s),si.the().sendControllerUpdate(this._id(),r)}if(null!=this.windowMoveListeners)for(var a=0,l=this.windowMoveListeners[t];a<l.length;){var o=l[a];++a,o(e,n,i,s)}},sendWheelEvent:function(t,e){if(null!=si.the()){var n=$.alloc(12);n.setInt32(0,4),n.setInt32(4,t),n.setInt32(8,e),si.the().sendControllerUpdate(this._id(),n)}if(null!=this.windowWheelListeners)for(var i=0,s=this.windowWheelListeners[t];i<s.length;){var r=s[i];++i,r(e)}},__class__:An});var Wn=function(){An.call(this)};(n["kha.input.MouseImpl"]=Wn).__name__=!0,Wn.__super__=An,Wn.prototype=s(An.prototype,{__class__:Wn});var Fn=function(){Fn.instance=this};(n["kha.input.Pen"]=Fn).__name__=!0,Fn.get=function(t){return null==t&&(t=0),ye.getPen(t)},Fn.prototype={notify:function(t,e,n){this.notifyWindowed(0,t,e,n)},notifyWindowed:function(t,e,n,i){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=n){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(n)}if(null!=i){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(i)}},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,__class__:Fn};var On=function(){this.listeners=[]};(n["kha.input.Sensor"]=On).__name__=!0,On.get=function(t){switch(t._hx_index){case 0:return On.accelerometer;case 1:return On.gyroscope}},On._changed=function(t,e,n,i){for(var s=0,r=On.get(0==t?Rn.Accelerometer:Rn.Gyroscope).listeners;s<r.length;){var a=r[s];++s,a(e,n,i)}},On.prototype={listeners:null,notify:function(t){this.listeners.push(t)},__class__:On};var Rn=b["kha.input.SensorType"]={__ename__:!0,__constructs__:["Accelerometer","Gyroscope"],Accelerometer:{_hx_index:0,__enum__:"kha.input.SensorType",toString:i},Gyroscope:{_hx_index:1,__enum__:"kha.input.SensorType",toString:i}},Dn=t.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],Dn.instance=this};(n["kha.input.Surface"]=Dn).__name__=!0,Dn.prototype={touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(t,e,n){for(var i=0,s=this.touchStartListeners;i<s.length;){var r=s[i];++i,r(t,e,n)}},sendTouchEndEvent:function(t,e,n){for(var i=0,s=this.touchEndListeners;i<s.length;){var r=s[i];++i,r(t,e,n)}},sendMoveEvent:function(t,e,n){for(var i=0,s=this.moveListeners;i<s.length;){var r=s[i];++i,r(t,e,n)}},__class__:Dn};var Nn=function(t){this.bytes=t};(n["kha.internal.BytesBlob"]=Nn).__name__=!0,Nn.__interfaces__=[ee],Nn.fromBytes=function(t){return new Nn(t)},Nn.alloc=function(t){return new Nn($.alloc(t))},Nn.readF32=function(t){var e=0==(-2147483648&t)?1:-1,n=t>>23&255,i=8388607&t;switch(n){case 0:return 0;case 255:return 0!=i?NaN:0<e?1/0:-1/0;default:return e*((i+8388608)/8388608)*Math.pow(2,n-127)}},Nn.bit=function(t,e){if(1==(t>>>e&1)){return 0,!0}return 0,!1},Nn.toText=function(t,e){for(var n="",i=0,s=e;i<s;){var r=i++;n+=String.fromCodePoint(t[r])}return n},Nn.prototype={bytes:null,sub:function(t,e){return new Nn(this.bytes.sub(t,e))},length:null,get_length:function(){return this.bytes.length},writeU8:function(t,e){this.bytes.set(t,e)},readU8:function(t){var e=this.bytes.get(t);return++t,e},readS8:function(t){var e=this.bytes.get(t);return++t,(0==(128&e)?1:-1)*(e&=127)},readU16BE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1);return t+=2,256*e+n},readU16LE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1);return t+=2,256*n+e},readU32LE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=this.bytes.get(t+2),s=this.bytes.get(t+3);return t+=4,e+256*n+256*i*256+256*s*256*256},readU32BE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=this.bytes.get(t+2),s=this.bytes.get(t+3);return t+=4,s+256*i+256*n*256+256*e*256*256},readS16BE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1);t+=2;var i=0==(128&e)?1:-1;return e&=127,-1==i?256*e-32767+n:256*e+n},readS16LE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=0==(128&n)?1:-1;return n&=127,t+=2,-1==i?256*n-32767+e:256*n+e},readS32LE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=this.bytes.get(t+2),s=this.bytes.get(t+3),r=0==(128&s)?1:-1;return s&=127,t+=4,-1==r?-2147483647+e+256*n+256*i*256+256*s*256*256:e+256*n+256*i*256+256*s*256*256},readS32BE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=this.bytes.get(t+2),s=this.bytes.get(t+3),r=0==(128&e)?1:-1;return e&=127,t+=4,-1==r?-2147483647+s+256*i+256*n*256+256*e*256*256:s+256*i+256*n*256+256*e*256*256},readF32LE:function(t){return Nn.readF32(this.readS32LE(t))},readF32BE:function(t){return Nn.readF32(this.readS32BE(t))},toString:function(){return this.bytes.toString()},readUtf8Char:function(t){if(t.value>=this.get_length())return-1;var e=this.readU8(t.value);++t.value;var n=0;if(Nn.bit(e,7))if(Nn.bit(e,7)&&Nn.bit(e,6)&&!Nn.bit(e,5)){var i=31&e,s=this.readU8(t.value);++t.value,n=i<<6|63&s}else Nn.bit(e,7)&&Nn.bit(e,6)&&Nn.bit(e,5)&&!Nn.bit(e,4)?t.value+=2:Nn.bit(e,7)&&Nn.bit(e,6)&&Nn.bit(e,5)&&Nn.bit(e,4)&&!Nn.bit(e,3)&&(t.value+=3);else n=e;return n},readUtf8Block:function(t,e){var n=0;if(e.value>=this.get_length())return"";for(;n<2e3;){var i=this.readUtf8Char(e);if(i<0)break;t[n]=i,++n}return Nn.toText(t,n)},readUtf8String:function(){var t=new Array(2e3),e="",n=0;3<=this.get_length()&&239==this.bytes.get(0)&&187==this.bytes.get(1)&&191==this.bytes.get(2)&&(n=3);for(var i={value:n};i.value<this.get_length();)e+=this.readUtf8Block(t,i);return e},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:Nn,__properties__:{get_length:"get_length"}};var Vn=function(){};(n["kha.internal.HdrFormat"]=Vn).__name__=!0,Vn.readBuf=function(t){for(var e=0;t[e++]=255&Vn.buffer[Vn.fileOffset],++Vn.fileOffset<Vn.bufferLength&&e<t.length;);return e},Vn.readBufOffset=function(t,e,n){for(var i=0;t[e+i++]=255&Vn.buffer[Vn.fileOffset],++Vn.fileOffset<Vn.bufferLength&&i<n;);return i},Vn.readPixelsRaw=function(t,e,n,i){var s=4*i,r=Vn.readBufOffset(e,n,s);r<s&&L.trace("Error reading raw pixels: got "+r+" bytes, expected "+s,{fileName:"kha/internal/HdrFormat.hx",lineNumber:43,className:"kha.internal.HdrFormat",methodName:"readPixelsRaw"})},Vn.readPixelsRawRLE=function(t,e,n,i,s){var r,a,l,o=new Uint8Array(4),h=null,u=new Uint8Array(2);for(t.length;0<s;){if(Vn.readBuf(o)<o.length)return void L.trace("Error reading bytes: expected "+o.length,{fileName:"kha/internal/HdrFormat.hx",lineNumber:59,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(2!=o[0]||2!=o[1]||0!=(128&o[2]))return e[n++]=255&o[0],e[n++]=255&o[1],e[n++]=255&o[2],e[n++]=255&o[3],void Vn.readPixelsRaw(t,e,n,i*s-1);if(((255&o[2])<<8|255&o[3])!=i)return void L.trace("Wrong scanline width "+((255&o[2])<<8|255&o[3])+", expected "+i,{fileName:"kha/internal/HdrFormat.hx",lineNumber:74,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(null==h)h=new Uint8Array(4*i);for(var _=r=0;_<4;){for(a=(_+++1)*i;r<a;){if(Vn.readBuf(u)<u.length)return void L.trace("Error reading 2-byte buffer",{fileName:"kha/internal/HdrFormat.hx",lineNumber:88,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(128<(255&u[0])){if(0==(l=(255&u[0])-128)||a-r<l)return void L.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:95,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});for(;0<l--;)h[r++]=255&u[1]}else{if(0==(l=255&u[0])||a-r<l)return void L.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:106,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(h[r++]=255&u[1],0<--l){if(Vn.readBufOffset(h,r,l)<l)return void L.trace("Error reading non-run data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:112,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});r+=l}}}}for(var c=0,d=i;c<d;){var g=c++;e[n]=255&h[g],e[n+1]=255&h[g+i],e[n+2]=255&h[g+2*i],e[n+3]=255&h[g+3*i],n+=4}--s}},Vn.readLine=function(){for(var t="";;){var e=Vn.buffer[Vn.fileOffset];if(10==e){++Vn.fileOffset;break}if(t+=String.fromCodePoint(e),!(++Vn.fileOffset<Vn.bufferLength))break}return t},Vn.parse=function(t){Vn.buffer=Z.fromBytes(t),Vn.bufferLength=Vn.buffer.length;for(var e=Vn.fileOffset=0,n=0,i=!1,s=0;s<20;){s++;var r=Vn.readLine();if(Vn.formatPattern.match(r))i=!0;else if(Vn.exposurePattern.match(r))gt.parseFloat(Vn.exposurePattern.matched(1));else if(Vn.widthHeightPattern.match(r)){n=gt.parseInt(Vn.widthHeightPattern.matched(1)),e=gt.parseInt(Vn.widthHeightPattern.matched(2));break}}if(!i)return L.trace("File is not run length encoded!",{fileName:"kha/internal/HdrFormat.hx",lineNumber:175,className:"kha.internal.HdrFormat",methodName:"parse"}),null;var a=new Uint8Array(e*n*4),l=e,o=n;Vn.readPixelsRawRLE(Vn.buffer,a,0,l,o);for(var h=new Float32Array(e*n*4),u=0;u<a.length;){var _=a[u]/255,c=a[u+1]/255,d=a[u+2]/255,g=a[u+3],f=Math.pow(2,g-128);_*=f,c*=f,d*=f,h[u]=_,h[u+1]=c,h[u+2]=d,h[u+3]=1,u+=4}return{width:e,height:n,data:h}};var Hn=function(t){this.stopped=!1,this.element=t};(n["kha.js.AEAudioChannel"]=Hn).__name__=!0,Hn.__interfaces__=[ke],Hn.prototype={element:null,stopped:null,play:function(){this.stopped=!1,ye.mobile?ye.insideInputEvent?(this.element.play(),ye.mobileAudioPlaying=!0):ye.mobileAudioPlaying?this.element.play():Hn.todo.push(this):this.element.play()},get_length:function(){return isFinite(this.element.duration)?this.element.duration:1/0},get_position:function(){return this.element.currentTime},set_volume:function(t){return this.element.volume=t},get_finished:function(){return!!this.stopped||this.get_position()>=this.get_length()},__class__:Hn,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_position:"get_position",get_length:"get_length"}};var Gn=function(){};(n["kha.js.AudioElementAudio"]=Gn).__name__=!0,Gn._compile=function(){},Gn.play=function(t,e){return null==e&&(e=!1),Gn.stream(t,e)},Gn.stream=function(t,e){null==e&&(e=!1),t.element.loop=e;var n=new Hn(t.element);return n.play(),n};var Pn=function(t){this.bakedQuadCache=new ue,Oe.call(this),this.canvas=t,(Pn.instance=this).myColor=se.fromBytes(0,0,0)};(n["kha.js.CanvasGraphics"]=Pn).__name__=!0,Pn.__super__=Oe,Pn.prototype=s(Oe.prototype,{canvas:null,webfont:null,myColor:null,scaleQuality:null,begin:function(t,e){null==t&&(t=!0),t&&this.clear(e)},clear:function(t){null==t&&(t=0),this.canvas.strokeStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",.00392156862745098*(t>>>24)==0?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.set_color(this.myColor)},end:function(){},drawImage:function(t,e,n){this.canvas.globalAlpha=this.get_opacity(),this.canvas.drawImage(zt.__cast(t,ie).image,e,n),this.canvas.globalAlpha=1},drawScaledSubImage:function(t,e,n,i,s,r,a,l,o){this.canvas.globalAlpha=this.get_opacity();try{if(l<0||o<0){this.canvas.save(),this.canvas.translate(r,a);var h=0,u=0;l<0&&(this.canvas.scale(-1,1),h=-l),o<0&&(this.canvas.scale(1,-1),u=-o),this.canvas.drawImage(zt.__cast(t,ie).image,e,n,i,s,h,u,l,o),this.canvas.restore()}else this.canvas.drawImage(zt.__cast(t,ie).image,e,n,i,s,r,a,l,o)}catch(t){t instanceof Xt&&t.val}this.canvas.globalAlpha=1},set_color:function(t){return this.myColor=t,this.canvas.strokeStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",t},get_color:function(){return this.myColor},set_imageScaleQuality:function(t){return t==Ne.Low?(this.canvas.mozImageSmoothingEnabled=!1,this.canvas.webkitImageSmoothingEnabled=!1,this.canvas.msImageSmoothingEnabled=!1,this.canvas.imageSmoothingEnabled=!1):(this.canvas.mozImageSmoothingEnabled=!0,this.canvas.webkitImageSmoothingEnabled=!0,this.canvas.msImageSmoothingEnabled=!0,this.canvas.imageSmoothingEnabled=!0),this.scaleQuality=t},drawRect:function(t,e,n,i,s){null==s&&(s=1),this.canvas.beginPath();var r=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(s),this.canvas.rect(t,e,n,i),this.canvas.stroke(),this.canvas.lineWidth=r},fillRect:function(t,e,n,i){var s=this.get_opacity();this.canvas.globalAlpha=s*(.00392156862745098*(this.myColor>>>24)),this.canvas.fillRect(t,e,n,i),this.canvas.globalAlpha=this.get_opacity()},fillCircle:function(t,e,n){this.canvas.beginPath(),this.canvas.arc(t,e,n,0,2*Math.PI,!1),this.canvas.fill()},bakedQuadCache:null,drawString:function(t,e,n){var i=this.webfont.getImage(this.get_fontSize(),this.myColor);if(0<i.width)for(var s=e,r=n,a=0,l=t.length;a<l;){var o=a++,h=this.webfont.kravur._get(this.get_fontSize()).getBakedQuad(this.bakedQuadCache,Oe.fontGlyphs.indexOf(ht.cca(t,o)),s,r);null!=h&&(0<h.s1-h.s0&&0<h.t1-h.t0&&0<h.x1-h.x0&&0<h.y1-h.y0&&this.canvas.drawImage(i,h.s0*i.width,h.t0*i.height,(h.s1-h.s0)*i.width,(h.t1-h.t0)*i.height,h.x0,h.y0,h.x1-h.x0,h.y1-h.y0),s+=h.xadvance)}},set_font:function(t){return this.webfont=zt.__cast(t,Zn),this.webfont},get_font:function(){return this.webfont},drawLine:function(t,e,n,i,s){null==s&&(s=1),this.canvas.beginPath();var r=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(s),this.canvas.moveTo(t,e),this.canvas.lineTo(n,i),this.canvas.moveTo(0,0),this.canvas.stroke(),this.canvas.lineWidth=r},fillTriangle:function(t,e,n,i,s,r){this.canvas.beginPath(),this.canvas.closePath(),this.canvas.fill()},setTransformation:function(t){this.canvas.setTransform(t._00,t._01,t._10,t._11,t._20,t._21)},__class__:Pn});var Zn=function(t){this.images=new tt,this.kravur=new Zn.Kravur(t)};(n["kha.js.Font"]=Zn).__name__=!0,Zn.__interfaces__=[ee],Zn.fromBytes=function(t){return new Zn(Nn.fromBytes(t))},Zn.prototype={kravur:null,images:null,height:function(t){return this.kravur._get(t).getHeight()},width:function(t,e){return this.kravur._get(t).stringWidth(e)},widthOfCharacters:function(t,e,n,i){return this.kravur._get(t).charactersWidth(e,n,i)},baseline:function(t){return this.kravur._get(t).getBaselinePosition()},getImage:function(t,e){var n=1e4*t+Oe.fontGlyphs.length;if(!this.images.exists(n)){var i=this.images,s=new tt;i.set(n,s)}if(!this.images.get(n).exists(e)){var r=this.kravur._get(t),a=window.document.createElement("canvas");a.width=r.width,a.height=r.height;var l=a.getContext("2d");l.fillStyle="black",l.fillRect(0,0,r.width,r.height);for(var o=l.getImageData(0,0,r.width,r.height),h=zt.__cast(r.getTexture(),ie).bytes,u=0,_=h.length;u<_;){var c=u++;o.data[4*c]=(16711680&e)>>>16,o.data[4*c+1]=(65280&e)>>>8,o.data[4*c+2]=255&e,o.data[4*c+3]=h.get(c)}l.putImageData(o,0,0);var d=window.document.createElement("img");return d.src=a.toDataURL("image/png"),this.images.get(n).set(e,d),d}return this.images.get(n).get(e)},unload:function(){this.kravur=null,this.images=null},__class__:Zn};var Xn=function(){};(n["kha.js.MobileWebAudio"]=Xn).__name__=!0,Xn._init=function(){try{return void(Xn._context=new AudioContext)}catch(t){t instanceof Xt&&t.val}try{return void(this._context=new webkitAudioContext)}catch(t){t instanceof Xt&&t.val}},Xn.play=function(t,e){null==e&&(e=!1);var n=new zn(t,e);return n.play(),n},Xn.stream=function(t,e){return null==e&&(e=!1),Xn.play(t,e)};var zn=function(t,e){this.stopped=!1,this.paused=!1,this.buffer=t._buffer,this.loop=e,this.createSource()};(n["kha.js.MobileWebAudioChannel"]=zn).__name__=!0,zn.__interfaces__=[ke],zn.prototype={buffer:null,loop:null,source:null,gain:null,startTime:null,pauseTime:null,paused:null,stopped:null,createSource:function(){var t=this;this.source=Xn._context.createBufferSource(),this.source.loop=this.loop,this.source.buffer=this.buffer,this.source.onended=function(){t.stopped=!0},this.gain=Xn._context.createGain(),this.source.connect(this.gain),this.gain.connect(Xn._context.destination)},play:function(){(this.paused||this.stopped)&&this.createSource(),this.stopped=!1,this.paused?(this.paused=!1,this.startTime=Xn._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=Xn._context.currentTime,this.source.start())},set_volume:function(t){return this.gain.gain.value=t},get_finished:function(){return this.stopped},__class__:zn,__properties__:{get_finished:"get_finished",set_volume:"set_volume"}};var Yn=function(t,e,n){var i=this;ve.call(this);var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="arraybuffer",s.onerror=function(){n({url:t})},s.onload=function(){i.compressedData=$.ofData(s.response),i.uncompressedData=null,Xn._context.decodeAudioData(i.compressedData.getData(),function(t){i._buffer=t,e(i)},function(){n({url:t,error:"Audio format not supported"})})},s.send(null)};(n["kha.js.MobileWebAudioSound"]=Yn).__name__=!0,Yn.__super__=ve,Yn.prototype=s(ve.prototype,{_buffer:null,uncompress:function(t){t()},__class__:Yn});var jn=function(t,e,n){ve.call(this),this.done=e,this.failed=n,jn.loading.push(this),this.element=window.document.createElement("audio"),this.filenames=[];for(var i=0;i<t.length;){var s=t[i];++i,""!=this.element.canPlayType("audio/ogg")&&J.endsWith(s,".ogg")&&this.filenames.push(s),""!=this.element.canPlayType("audio/mp4")&&J.endsWith(s,".mp4")&&this.filenames.push(s)}this.element.addEventListener("error",ci(this,this.errorListener),!1),this.element.addEventListener("canplay",ci(this,this.canPlayThroughListener),!1),this.element.src=this.filenames[0],this.element.preload="auto",this.element.load()};(n["kha.js.Sound"]=jn).__name__=!0,jn.__super__=ve,jn.prototype=s(ve.prototype,{filenames:null,done:null,failed:null,element:null,errorListener:function(t){if(4==this.element.error.code)for(var e=0,n=this.filenames.length-1;e<n;){var i=e++;if(this.element.src==this.filenames[i])return void(this.element.src=this.filenames[i+1])}this.failed({url:this.element.src}),this.finishAsset()},canPlayThroughListener:function(t){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",ci(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",ci(this,this.canPlayThroughListener),!1),this.done(this),ht.remove(jn.loading,this)},uncompress:function(t){t()},__class__:jn});var Un=function(){Se.call(this)};(n["kha.js.Video"]=Un).__name__=!0,Un.fromFile=function(t,e){var n=new Un;n.done=e,n.element=window.document.createElement("video"),n.filenames=[];for(var i=0;i<t.length;){var s=t[i];++i,""!=n.element.canPlayType("video/webm")&&J.endsWith(s,".webm")&&n.filenames.push(s),""!=n.element.canPlayType("video/mp4")&&J.endsWith(s,".mp4")&&n.filenames.push(s)}n.element.addEventListener("error",ci(n,n.errorListener),!1),n.element.addEventListener("canplaythrough",ci(n,n.canPlayThroughListener),!1),n.element.preload="auto",n.element.src=n.filenames[0]},Un.__super__=Se,Un.prototype=s(Se.prototype,{filenames:null,element:null,done:null,texture:null,errorListener:function(t){if(4==this.element.error.code)for(var e=0,n=this.filenames.length-1;e<n;){var i=e++;if(this.element.src==this.filenames[i])return void(this.element.src=this.filenames[i+1])}L.trace("Error loading "+this.element.src,{fileName:"kha/js/Video.hx",lineNumber:120,className:"kha.js.Video",methodName:"errorListener"}),this.finishAsset()},canPlayThroughListener:function(t){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",ci(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",ci(this,this.canPlayThroughListener),!1),null!=ye.gl&&(this.texture=ne.fromVideo(this)),this.done(this)},__class__:Un});var Kn=function(t,e,n){var i=this;ve.call(this);var s=new XMLHttpRequest;s.open("GET",t,!0),s.responseType="arraybuffer",s.onerror=function(){n({url:t})},s.onload=function(){i.compressedData=$.ofData(s.response),i.uncompressedData=null,e(i)},s.send(null)};(n["kha.js.WebAudioSound"]=Kn).__name__=!0,Kn.__super__=ve,Kn.prototype=s(ve.prototype,{superUncompress:function(t){ve.prototype.uncompress.call(this,t)},uncompress:function(d){var g=this;Be._context.decodeAudioData(this.compressedData.getData(),function(t){var n=t.getChannelData(0),e=n.length,i=new Float32Array(2*e);if(g.uncompressedData=i,1==t.numberOfChannels){var s=0,r=0,a=2*e,l=function(){};(l=function(){for(var t=s+11025,e=a<t?a:t;s<e;)g.uncompressedData[s]=n[r],g.uncompressedData[s+1]=n[r],s+=2,r+=1;s<a?window.setTimeout(l,0):g.compressedData=null})(),window.setTimeout(d,250)}else{var o=t.getChannelData(1),h=0,u=0,_=2*e,c=function(){};(c=function(){for(var t=h+11025,e=_<t?_:t;h<e;)g.uncompressedData[h]=n[u],g.uncompressedData[h+1]=o[u],h+=2,u+=1;h<_?window.setTimeout(c,0):g.compressedData=null})(),window.setTimeout(d,250)}},function(){g.superUncompress(d)})},__class__:Kn});var Qn=function(t,e){this.value=t,this.type=e};(n["kha.js.graphics4.ConstantLocation"]=Qn).__name__=!0,Qn.__interfaces__=[tn],Qn.prototype={value:null,type:null,__class__:Qn};var Jn=function(t){this.matrix3Cache=new Float32Array(9),this.matrixCache=new Float32Array(16),this.isDepthAttachment=!1,this.isCubeMap=!1,this.colorMaskAlpha=!0,this.colorMaskBlue=!0,this.colorMaskGreen=!0,this.colorMaskRed=!0,this.depthMask=!1,this.depthTest=!1,this.renderTarget=t,this.init(),ye.gl2?this.instancedExtension=!0:(this.instancedExtension=ye.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=ye.gl.getExtension("EXT_blend_minmax"))};(n["kha.js.graphics4.Graphics"]=Jn).__name__=!0,Jn.__interfaces__=[an],Jn.getBlendFunc=function(t){switch(t._hx_index){case 1:return 1;case 0:case 2:return 0;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}},Jn.getBlendOp=function(t){switch(t._hx_index){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}},Jn.prototype={depthTest:null,depthMask:null,colorMaskRed:null,colorMaskGreen:null,colorMaskBlue:null,colorMaskAlpha:null,indicesCount:null,renderTarget:null,renderTargetFrameBuffer:null,renderTargetTexture:null,isCubeMap:null,isDepthAttachment:null,instancedExtension:null,blendMinMaxExtension:null,init:function(){if(null!=this.renderTarget)if(this.isCubeMap=this.renderTarget instanceof en,this.isCubeMap){var t=zt.__cast(this.renderTarget,en);this.renderTargetFrameBuffer=t.frameBuffer,this.renderTargetTexture=t.texture,this.isDepthAttachment=t.isDepthAttachment}else{var e=zt.__cast(this.renderTarget,Ce);this.renderTargetFrameBuffer=e.frameBuffer,this.renderTargetTexture=e.texture}},begin:function(t){if(ye.gl.enable(3042),ye.gl.blendFunc(770,771),null==this.renderTarget)ye.gl.bindFramebuffer(36160,null),ye.gl.viewport(0,0,be.windowWidth(),be.windowHeight());else if(ye.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),ye.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=t){ye.gl.framebufferTexture2D(36160,ye.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var e=0,n=t.length;e<n;){var i=e++;ye.gl.framebufferTexture2D(36160,ye.drawBuffers.COLOR_ATTACHMENT0_WEBGL+i+1,3553,zt.__cast(t[i],Ce).texture,0)}for(var s=[ye.drawBuffers.COLOR_ATTACHMENT0_WEBGL],r=0,a=t.length;r<a;){var l=r++;s.push(ye.drawBuffers.COLOR_ATTACHMENT0_WEBGL+l+1)}ye.gl2?ye.gl.drawBuffers(s):ye.drawBuffers.drawBuffersWEBGL(s)}},beginFace:function(t){ye.gl.enable(3042),ye.gl.blendFunc(770,771),ye.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),ye.gl.framebufferTexture2D(36160,this.isDepthAttachment?36096:36064,34069+t,this.renderTargetTexture,0),ye.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height())},end:function(){},clear:function(t,e,n){var i=0;null!=t&&(i|=16384,ye.gl.colorMask(!0,!0,!0,!0),ye.gl.clearColor(.00392156862745098*((16711680&t)>>>16),.00392156862745098*((65280&t)>>>8),.00392156862745098*(255&t),.00392156862745098*(t>>>24))),null!=e&&(i|=256,ye.gl.enable(2929),ye.gl.depthMask(!0),ye.gl.clearDepth(e)),null!=n&&(i|=1024,ye.gl.enable(2960),ye.gl.stencilMask(255),ye.gl.clearStencil(n)),ye.gl.clear(i),ye.gl.colorMask(this.colorMaskRed,this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha),this.depthTest?ye.gl.enable(2929):ye.gl.disable(2929),ye.gl.depthMask(this.depthMask)},viewport:function(t,e,n,i){null==this.renderTarget?ye.gl.viewport(t,be.windowHeight(0)-e-i,n,i):ye.gl.viewport(t,e,n,i)},scissor:function(t,e,n,i){ye.gl.enable(3089),null==this.renderTarget?ye.gl.scissor(t,be.windowHeight(0)-e-i,n,i):ye.gl.scissor(t,e,n,i)},disableScissor:function(){ye.gl.disable(3089)},renderTargetsInvertedY:function(){return!0},setDepthMode:function(t,e){switch(e._hx_index){case 0:t?ye.gl.enable(2929):ye.gl.disable(2929),this.depthTest=t,ye.gl.depthFunc(519);break;case 1:ye.gl.enable(2929),this.depthTest=!0,ye.gl.depthFunc(512);break;case 2:ye.gl.enable(2929),this.depthTest=!0,ye.gl.depthFunc(514);break;case 3:ye.gl.enable(2929),this.depthTest=!0,ye.gl.depthFunc(517);break;case 4:ye.gl.enable(2929),this.depthTest=!0,ye.gl.depthFunc(513);break;case 5:ye.gl.enable(2929),this.depthTest=!0,ye.gl.depthFunc(515);break;case 6:ye.gl.enable(2929),this.depthTest=!0,ye.gl.depthFunc(516);break;case 7:ye.gl.enable(2929),this.depthTest=!0,ye.gl.depthFunc(518)}ye.gl.depthMask(t),this.depthMask=t},setBlendingMode:function(t,e,n,i,s,r){t==Je.BlendOne&&e==Je.BlendZero?ye.gl.disable(3042):(ye.gl.enable(3042),ye.gl.blendFuncSeparate(Jn.getBlendFunc(t),Jn.getBlendFunc(e),Jn.getBlendFunc(i),Jn.getBlendFunc(s)),ye.gl.blendEquationSeparate(Jn.getBlendOp(n),Jn.getBlendOp(r)))},setVertexBuffer:function(t){zt.__cast(t,Cn).set(0)},setVertexBuffers:function(t){for(var e=0,n=0;n<t.length;){var i=t[n];++n,e+=zt.__cast(i,Cn).set(e)}},setIndexBuffer:function(t){this.indicesCount=t.count(),zt.__cast(t,_n).set()},setTexture:function(t,e){null==e?(ye.gl.activeTexture(33984+zt.__cast(t,$n).value),ye.gl.bindTexture(3553,null)):zt.__cast(e,Ce).set(zt.__cast(t,$n).value)},setTextureDepth:function(t,e){zt.__cast(e,Ce).setDepth(zt.__cast(t,$n).value)},setImageTexture:function(t,e){},setTextureParameters:function(t,e,n,i,s,r){switch(ye.gl.activeTexture(33984+zt.__cast(t,$n).value),e._hx_index){case 0:ye.gl.texParameteri(3553,10242,10497);break;case 1:ye.gl.texParameteri(3553,10242,33648);break;case 2:ye.gl.texParameteri(3553,10242,33071)}switch(n._hx_index){case 0:ye.gl.texParameteri(3553,10243,10497);break;case 1:ye.gl.texParameteri(3553,10243,33648);break;case 2:ye.gl.texParameteri(3553,10243,33071)}switch(i._hx_index){case 0:switch(r._hx_index){case 0:ye.gl.texParameteri(3553,10241,9728);break;case 1:ye.gl.texParameteri(3553,10241,9984);break;case 2:ye.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(r._hx_index){case 0:ye.gl.texParameteri(3553,10241,9729);break;case 1:ye.gl.texParameteri(3553,10241,9985);break;case 2:ye.gl.texParameteri(3553,10241,9987)}i==bn.AnisotropicFilter&&ye.gl.texParameteri(3553,ye.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(s._hx_index){case 0:ye.gl.texParameteri(3553,10240,9728);break;case 1:case 2:ye.gl.texParameteri(3553,10240,9729)}},setTexture3DParameters:function(t,e,n,i,s,r,a){},setCubeMap:function(t,e){null==e?(ye.gl.activeTexture(33984+zt.__cast(t,$n).value),ye.gl.bindTexture(34067,null)):e.set(zt.__cast(t,$n).value)},setCubeMapDepth:function(t,e){e.setDepth(zt.__cast(t,$n).value)},setCullMode:function(t){switch(t._hx_index){case 0:ye.gl.enable(2884),ye.gl.cullFace(1029);break;case 1:ye.gl.enable(2884),ye.gl.cullFace(1028);break;case 2:ye.gl.disable(2884)}},setPipeline:function(t){this.setCullMode(t.cullMode),this.setDepthMode(t.depthWrite,t.depthMode),this.setStencilParameters(t.stencilMode,t.stencilBothPass,t.stencilDepthFail,t.stencilFail,t.stencilReferenceValue,t.stencilReadMask,t.stencilWriteMask),this.setBlendingMode(t.blendSource,t.blendDestination,t.blendOperation,t.alphaBlendSource,t.alphaBlendDestination,t.alphaBlendOperation),t.set(),this.colorMaskRed=t.get_colorWriteMaskRed(),this.colorMaskGreen=t.get_colorWriteMaskGreen(),this.colorMaskBlue=t.get_colorWriteMaskBlue(),this.colorMaskAlpha=t.get_colorWriteMaskAlpha()},setBool:function(t,e){ye.gl.uniform1i(zt.__cast(t,Qn).value,e?1:0)},setInt:function(t,e){ye.gl.uniform1i(zt.__cast(t,Qn).value,e)},setFloat:function(t,e){ye.gl.uniform1f(zt.__cast(t,Qn).value,e)},setFloat2:function(t,e,n){ye.gl.uniform2f(zt.__cast(t,Qn).value,e,n)},setFloat3:function(t,e,n,i){ye.gl.uniform3f(zt.__cast(t,Qn).value,e,n,i)},setFloat4:function(t,e,n,i,s){ye.gl.uniform4f(zt.__cast(t,Qn).value,e,n,i,s)},setFloats:function(t,e){var n=zt.__cast(t,Qn);switch(n.type){case 35664:ye.gl.uniform2fv(n.value,e);break;case 35665:ye.gl.uniform3fv(n.value,e);break;case 35666:ye.gl.uniform4fv(n.value,e);break;case 35676:ye.gl.uniformMatrix4fv(n.value,!1,e);break;default:ye.gl.uniform1fv(n.value,e)}},matrixCache:null,setMatrix:function(t,e){this.matrixCache[0]=e._00,this.matrixCache[1]=e._01,this.matrixCache[2]=e._02,this.matrixCache[3]=e._03,this.matrixCache[4]=e._10,this.matrixCache[5]=e._11,this.matrixCache[6]=e._12,this.matrixCache[7]=e._13,this.matrixCache[8]=e._20,this.matrixCache[9]=e._21,this.matrixCache[10]=e._22,this.matrixCache[11]=e._23,this.matrixCache[12]=e._30,this.matrixCache[13]=e._31,this.matrixCache[14]=e._32,this.matrixCache[15]=e._33,ye.gl.uniformMatrix4fv(zt.__cast(t,Qn).value,!1,this.matrixCache)},matrix3Cache:null,setMatrix3:function(t,e){this.matrix3Cache[0]=e._00,this.matrix3Cache[1]=e._01,this.matrix3Cache[2]=e._02,this.matrix3Cache[3]=e._10,this.matrix3Cache[4]=e._11,this.matrix3Cache[5]=e._12,this.matrix3Cache[6]=e._20,this.matrix3Cache[7]=e._21,this.matrix3Cache[8]=e._22,ye.gl.uniformMatrix3fv(zt.__cast(t,Qn).value,!1,this.matrix3Cache)},drawIndexedVertices:function(t,e){null==e&&(e=-1),null==t&&(t=0);var n=null==ye.elementIndexUint?5123:5125,i=5123==n?2:4;ye.gl.drawElements(4,-1==e?this.indicesCount:e,n,t*i)},convertStencilAction:function(t){switch(t._hx_index){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},convertCompareMode:function(t){switch(t._hx_index){case 0:return 519;case 1:return 512;case 2:return 514;case 3:return 517;case 4:return 513;case 5:return 515;case 6:return 516;case 7:return 518}},setStencilParameters:function(t,e,n,i,s,r,a){if(null==a&&(a=255),null==r&&(r=255),t==$e.Always&&e==fn.Keep&&n==fn.Keep&&i==fn.Keep)ye.gl.disable(2960);else{ye.gl.enable(2960);var l=this.convertCompareMode(t);switch(ye.gl.stencilMask(a),ye.gl.stencilOp(this.convertStencilAction(i),this.convertStencilAction(n),this.convertStencilAction(e)),s._hx_index){case 0:ye.gl.stencilFunc(l,0,r);break;case 1:var o=s.value;ye.gl.stencilFunc(l,o,r)}}},drawIndexedVerticesInstanced:function(t,e,n){if(null==n&&(n=-1),null==e&&(e=0),this.instancedRenderingAvailable()){var i=null==ye.elementIndexUint?5123:5125,s=null==ye.elementIndexUint?2:4;ye.gl2?ye.gl.drawElementsInstanced(4,-1==n?this.indicesCount:n,i,e*s,t):this.instancedExtension.drawElementsInstancedANGLE(4,-1==n?this.indicesCount:n,i,e*s,t)}},instancedRenderingAvailable:function(){return this.instancedExtension},__class__:Jn};var qn=function(t){un.call(this,t)};(n["kha.js.graphics4.Graphics2"]=qn).__name__=!0,qn.__super__=un,qn.prototype=s(un.prototype,{begin:function(t,e){null==t&&(t=!0),ye.gl.colorMask(!0,!0,!0,!0),ye.gl.disable(2929),ye.gl.depthFunc(519),un.prototype.begin.call(this,t,e)},__class__:qn});var $n=function(t){this.value=t};(n["kha.js.graphics4.TextureUnit"]=$n).__name__=!0,$n.__interfaces__=[yn],$n.prototype={value:null,__class__:$n};var ti=function(){};(n["kha.vr.VrInterface"]=ti).__name__=!0,ti.prototype={IsVrEnabled:function(){return!1},__class__:ti};var ei=function(){this.vrHeight=0,this.vrWidth=0,this.height=0,this.width=0,this.vrEnabled=!1,ti.call(this)};(n["kha.js.vr.VrInterface"]=ei).__name__=!0,ei.__super__=ti,ei.prototype=s(ti.prototype,{vrEnabled:null,vrDisplay:null,frameData:null,width:null,height:null,vrWidth:null,vrHeight:null,getVRDisplays:function(){var i=this;navigator.getVRDisplays().then(function(t){if(0<t.length){i.frameData=new VRFrameData,i.vrDisplay=t[0],i.vrDisplay.depthNear=.1,i.vrDisplay.depthFar=1024;var e=i.vrDisplay.getEyeParameters("left"),n=i.vrDisplay.getEyeParameters("right");i.width=ye.khanvas.width,i.height=ye.khanvas.height,i.vrWidth=gt.int(2*Math.max(e.renderWidth,n.renderWidth)),i.vrHeight=gt.int(Math.max(e.renderHeight,n.renderHeight))}else L.trace("There are no VR displays connected.",{fileName:"kha/js/vr/VrInterface.hx",lineNumber:59,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},IsVrEnabled:function(){return this.vrEnabled},__class__:ei});var ni=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};(n["kha.math.FastVector2"]=ni).__name__=!0,ni.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=this.get_length();if(0==e)return 0;var n=t/e;return this.x*=n,this.y*=n,t},__class__:ni,__properties__:{set_length:"set_length",get_length:"get_length"}};var ii=function(){};(n["kha.netsync.ControllerBuilder"]=ii).__name__=!0;var si=function(t,e,n){this.controllers=new tt,(si.instance=this).maxPlayers=t,this.address=e,this.port=n};(n["kha.netsync.Session"]=si).__name__=!0,si.the=function(){return si.instance},si.prototype={controllers:null,maxPlayers:null,address:null,port:null,sendControllerUpdate:function(t,e){if(this.controllers.exists(t)){if(this.controllers.get(t)._inputBuffer.length<this.controllers.get(t)._inputBufferIndex+4+e.length){var n=$.alloc(this.controllers.get(t)._inputBufferIndex+4+e.length);n.blit(0,this.controllers.get(t)._inputBuffer,0,this.controllers.get(t)._inputBufferIndex),this.controllers.get(t)._inputBuffer=n}this.controllers.get(t)._inputBuffer.setInt32(this.controllers.get(t)._inputBufferIndex,e.length),this.controllers.get(t)._inputBuffer.blit(this.controllers.get(t)._inputBufferIndex+4,e,0,e.length),this.controllers.get(t)._inputBufferIndex+=4+e.length}},__class__:si};var ri=function(t){this.changed=!1,this.dragY=0,this.dragX=0,this.dragEnabled=!1,this.dragging=!1,this.lastMaxY=0,this.lastMaxX=0,this.layout=0,this.scrollEnabled=!1,this.scrollOffset=0,this.scrolling=!1,this.redraws=2,this.texture=null,this.text="",this.value=0,this.color=-1,this.position=0,this.selected=!1,null!=t&&(null!=t.selected&&(this.selected=t.selected),null!=t.position&&(this.position=t.position),null!=t.value&&(this.value=t.value),null!=t.text&&(this.text=t.text),null!=t.color&&(this.color=t.color),null!=t.layout&&(this.layout=t.layout))};(n["zui.Handle"]=ri).__name__=!0,ri.prototype={selected:null,position:null,color:null,value:null,text:null,texture:null,redraws:null,scrolling:null,scrollOffset:null,scrollEnabled:null,layout:null,lastMaxX:null,lastMaxY:null,dragging:null,dragEnabled:null,dragX:null,dragY:null,changed:null,children:null,nest:function(t,e){for(null==this.children&&(this.children=[]);this.children.length<=t;)this.children.push(null);return null==this.children[t]&&(this.children[t]=new ri(e)),this.children[t]},__class__:ri};var ai=function(){};(n["zui.Canvas"]=ai).__name__=!0,ai.draw=function(t,e,n){-1==ai.screenW&&(ai.screenW=be.windowWidth(),ai.screenH=be.windowHeight()),ai.events=[],(ai._ui=t).begin(n),t.g=n;for(var i=0,s=e.elements;i<s.length;){var r=s[i];++i,null==r.parent&&ai.drawElement(t,e,r)}return t.end(),ai.events},ai.drawElement=function(t,e,n,i,s){if(null==s&&(s=0),null==i&&(i=0),null!=n&&0!=n.visible){t._x=e.x+ai.scaled(n.x)+ai.scaled(i),t._y=e.y+ai.scaled(n.y)+ai.scaled(s),t._w=ai.scaled(n.width);var r=ai.scaled(e.width),a=ai.scaled(e.height);switch(n.anchor){case 1:t._x-=(r-ai.screenW)/2;break;case 2:t._x-=r-ai.screenW;break;case 3:t._y-=(a-ai.screenH)/2;break;case 4:t._x-=(r-ai.screenW)/2,t._y-=(a-ai.screenH)/2;break;case 5:t._x-=r-ai.screenW,t._y-=(a-ai.screenH)/2;break;case 6:t._y-=a-ai.screenH;break;case 7:t._x-=(r-ai.screenW)/2,t._y-=a-ai.screenH;break;case 8:t._x-=r-ai.screenW,t._y-=a-ai.screenH}var l=null!=n.rotation&&0!=n.rotation;switch(l&&t.g.pushRotation(n.rotation,t._x+ai.scaled(n.width)/2,t._y+ai.scaled(n.height)/2),n.type){case 0:var o=t.ops.font,h=t.fontSize,u=t.t.TEXT_COL;null!=n.asset&&J.endsWith(n.asset,".ttf")&&(t.ops.font=ai.getAsset(e,n.asset)),t.fontSize=ai.scaled(n.height),t.t.TEXT_COL=n.color,t.text(ai.getText(e,n)),t.ops.font=o,t.fontSize=h,t.t.TEXT_COL=u;break;case 1:var _=ai.getAsset(e,n.asset),c=null!=n.asset&&J.endsWith(n.asset,".ttf");if(null!=_&&!c){t.imageScrollAlign=!1;var d=null!=n.color?n.color:-1;if(3==t.image(_,d,ai.scaled(n.height))){var g=n.event;null!=g&&""!=g&&ai.events.push(g)}t.imageScrollAlign=!0}break;case 2:var f=t.t.BUTTON_H;if(t.t.BUTTON_H=ai.scaled(n.height),t.button(ai.getText(e,n))){var p=n.event;null!=p&&""!=p&&ai.events.push(p)}t.t.BUTTON_H=f;break;case 3:break;case 6:t.check(ai.h.nest(n.id),ai.getText(e,n));break;case 7:t.inlineRadio(ai.h.nest(n.id),ai.getText(e,n).split(";"));break;case 8:t.combo(ai.h.nest(n.id),ai.getText(e,n).split(";"));break;case 9:var m=t.g.get_color();t.g.set_color(n.color),t.g.fillRect(t._x,t._y,t._w,ai.scaled(n.height)),t.g.set_color(m);break;case 10:t.slider(ai.h.nest(n.id),ai.getText(e,n),0,1,!0);break;case 11:t.textInput(ai.h.nest(n.id),ai.getText(e,n))}if(null!=n.children)for(var v=0,w=n.children;v<w.length;){var b=w[v];++v,ai.drawElement(t,e,ai.elemById(e,b),n.x+i,n.y+s)}l&&t.g.popTransformation()}},ai.getText=function(t,e){return e.text},ai.getAsset=function(t,e){for(var n=0,i=t.assets;n<i.length;){var s=i[n];if(++n,s.name==e)return ai.assetMap.get(s.id)}return null},ai.elemById=function(t,e){for(var n=0,i=t.elements;n<i.length;){var s=i[n];if(++n,s.id==e)return s}return null},ai.scaled=function(t){return gt.int(t*ai._ui.SCALE)};var li=function(){};(n["zui.Ext"]=li).__name__=!0,li.colorWheel=function(t,e,n,i,s){null==s&&(s=!1),null==n&&(n=!1),null==i&&(i=t._w),li.rgbToHsv(.00392156862745098*((16711680&e.color)>>>16),.00392156862745098*((65280&e.color)>>>8),.00392156862745098*(255&e.color),li.ar);var r=li.ar[0],a=li.ar[1],l=li.ar[2],o=.00392156862745098*(e.color>>>24),h=t._x,u=t._y;null!=t.currentWindow&&t.currentWindow.scrollEnabled||(i-=t.SCROLL_W(),h+=t.SCROLL_W()/2),t.image(t.ops.color_wheel,se.fromFloats(l,l,l));var _=h+i/2,c=u+(t._y-u)/2,d=.7*i,g=d/2,f=_,p=c+a*g,m=r*(2*Math.PI),v=Math.cos(m)*(f-_)-Math.sin(m)*(p-c)+_,w=Math.sin(m)*(f-_)+Math.cos(m)*(p-c)+c;f=v,p=w,t.g.set_color(-16777216),t.g.fillRect(f-3,p-3,6,6),t.g.set_color(-1),t.g.fillRect(f-2,p-2,4,4),s&&(n?t.row([.3333333333333333,.3333333333333333,.3333333333333333]):t.row([.5,.5]));var b=e.nest(0);b.value=Math.round(100*l)/100,l=t.slider(b,"Value",0,1,!0),n&&(o=t.slider(e.nest(1,{value:Math.round(100*o)/100}),"Alpha",0,1,!0));var x=_+t._windowX,y=c+t._windowY;if(t.inputStarted&&t.getInputInRect(x-g,y-g,d,d)&&(li.wheelSelectedHande=e),t.inputReleased&&(li.wheelSelectedHande=null),t.inputDown&&li.wheelSelectedHande==e){a=Math.min(li.dist(x,y,t.inputX,t.inputY),g)/g;var S=Math.atan2(t.inputX-x,t.inputY-y);S<0&&(S=Math.PI+(Math.PI-Math.abs(S))),r=(S=2*Math.PI-S)/(2*Math.PI),e.changed=t.changed=!0}return li.hsvToRgb(r,a,l,li.ar),e.color=se.fromFloats(li.ar[0],li.ar[1],li.ar[2],o),t.text("",2,e.color),e.color},li.dist=function(t,e,n,i){var s=t-n,r=e-i;return Math.sqrt(s*s+r*r)},li.fract=function(t){return t-gt.int(t)},li.mix=function(t,e,n){return t*(1-n)+e*n},li.clamp=function(t,e,n){return Math.min(Math.max(t,e),n)},li.step=function(t,e){return e<t?0:1},li.hsvToRgb=function(t,e,n,i){var s=Math.abs(6*li.fract(t+1)-3),r=Math.abs(6*li.fract(t+.6666666666666666)-3),a=Math.abs(6*li.fract(t+.3333333333333333)-3);i[0]=n*li.mix(1,li.clamp(s-1,0,1),e),i[1]=n*li.mix(1,li.clamp(r-1,0,1),e),i[2]=n*li.mix(1,li.clamp(a-1,0,1),e)},li.rgbToHsv=function(t,e,n,i){var s=li.mix(n,e,li.step(n,e)),r=li.mix(e,n,li.step(n,e)),a=li.mix(-1,0,li.step(n,e)),l=li.mix(.6666666666666666,-.3333333333333333,li.step(n,e)),o=li.mix(s,t,li.step(s,t)),h=li.mix(r,r,li.step(s,t)),u=li.mix(l,a,li.step(s,t)),_=li.mix(t,s,li.step(s,t)),c=o-Math.min(_,h);i[0]=Math.abs(u+(_-h)/(6*c+1e-10)),i[1]=c/(o+1e-10),i[2]=o};var oi=function(){this.nodeId=-1,this.lastNodesCount=0,this.handle=new ri,this.snapY=0,this.snapX=0,this.snapSocket=0,this.snapToId=-1,this.snapFromId=-1,this.linkDrag=null,this.SCALE=1,this.uih=0,this.uiw=0,this.zoom=1,this.panY=0,this.panX=0,this.nodeSelected=null,this.nodeDrag=null};(n["zui.Nodes"]=oi).__name__=!0,oi.prototype={nodeDrag:null,nodeSelected:null,panX:null,panY:null,zoom:null,uiw:null,uih:null,SCALE:null,linkDrag:null,snapFromId:null,snapToId:null,snapSocket:null,snapX:null,snapY:null,handle:null,lastNodesCount:null,PAN_X:function(){var t=(1-this.zoom)*this.uiw/2.5;return this.panX*this.SCALE+t},PAN_Y:function(){var t=(1-this.zoom)*this.uih/2.5;return this.panY*this.SCALE+t},LINE_H:function(){return gt.int(22*this.SCALE)},BUTTONS_H:function(t){for(var e=0,n=0,i=t.buttons;n<i.length;){var s=i[n];++n,"RGBA"==s.type?e+=132*this.SCALE:"VECTOR"==s.type?e+=4*this.LINE_H():"RAMP"==s.type?e+=9.5*this.LINE_H():"CURVES"==s.type?e+=8*this.LINE_H():e+=this.LINE_H()}return gt.int(e)},NODE_H:function(t){return gt.int(2*this.LINE_H()+t.inputs.length*this.LINE_H()+t.outputs.length*this.LINE_H()+this.BUTTONS_H(t))},NODE_W:function(){return gt.int(140*this.SCALE)},NODE_X:function(t){return t.x*this.SCALE+this.PAN_X()},NODE_Y:function(t){return t.y*this.SCALE+this.PAN_Y()},SOCKET_Y:function(t){return 2*this.LINE_H()+t*this.LINE_H()},p:function(t){return t*this.SCALE},getNode:function(t,e){for(var n=0;n<t.length;){var i=t[n];if(++n,i.id==e)return i}return null},nodeId:null,getNodeId:function(t){if(-1==this.nodeId)for(var e=0;e<t.length;){var n=t[e];++e,this.nodeId<n.id&&(this.nodeId=n.id)}return++this.nodeId},getLinkId:function(t){for(var e=0,n=0;n<t.length;){var i=t[n];++n,i.id>=e&&(e=i.id+1)}return e},getSocketId:function(t){for(var e=0,n=0;n<t.length;){var i=t[n];++n;for(var s=0,r=i.inputs;s<r.length;){var a=r[s];++s,a.id>=e&&(e=a.id+1)}for(var l=0,o=i.outputs;l<o.length;){var h=o[l];++l,h.id>=e&&(e=h.id+1)}}return e},bakeElements:function(t){t.g.end(),oi.elementsBaked=!0,oi.socketImage=ne.createRenderTarget(20,20);var e=oi.socketImage.get_g2();e.begin(!0,0),e.set_color(-16777216),De.fillCircle(e,10,10,10),e.set_color(-1),De.fillCircle(e,10,10,8),e.end(),t.g.begin(!1)},nodeCanvas:function(t,e){oi.elementsBaked||this.bakeElements(t),this.lastNodesCount>e.nodes.length&&(t.changed=!0),this.lastNodesCount=e.nodes.length;var n=t._windowX,i=t._windowY;t.inputDownR&&(this.panX+=t.inputDX/this.SCALE,this.panY+=t.inputDY/this.SCALE),0!=t.inputWheelDelta&&(this.zoom+=-t.inputWheelDelta/10,this.zoom<.4?this.zoom=.4:1<this.zoom&&(this.zoom=1),this.zoom=Math.round(10*this.zoom)/10,this.uiw=t._w,this.uih=t._h),this.SCALE=t.ops.scaleFactor*this.zoom;var s=t.SCALE;t.setScale(this.SCALE),t.elementsBaked=!0,t.g.set_font(t.ops.font),t.g.set_fontSize(t.fontSize);for(var r=0,a=e.links;r<a.length;){var l=a[r];++r;var o=this.getNode(e.nodes,l.from_id),h=this.getNode(e.nodes,l.to_id),u=null==o?t.inputX:n+this.NODE_X(o)+this.NODE_W(),_=null==o?t.inputY:i+this.NODE_Y(o)+this.SOCKET_Y(l.from_socket),c=null==h?t.inputX:n+this.NODE_X(h),d=null==h?t.inputY:i+this.NODE_Y(h)+this.SOCKET_Y(l.to_socket+h.outputs.length)+this.BUTTONS_H(h);if(this.linkDrag==l){-1!=this.snapFromId&&(u=this.snapX,_=this.snapY),-1!=this.snapToId&&(c=this.snapX,d=this.snapY),this.snapFromId=this.snapToId=-1;for(var g=0,f=e.nodes;g<f.length;){var p=f[g];++g;var m=p.inputs,v=p.outputs,w=this.NODE_H(p),b=n+this.NODE_X(p)-this.LINE_H()/2,x=i+this.NODE_Y(p)-this.LINE_H()/2,y=this.NODE_W()+this.LINE_H(),S=w+this.LINE_H();if(t.getInputInRect(b,x,y,S))if(null==o&&p.id!=h.id)for(var C=0,I=v.length;C<I;){var T=C++,k=n+this.NODE_X(p)+this.NODE_W(),B=i+this.NODE_Y(p)+this.SOCKET_Y(T),E=k-this.LINE_H()/2,M=B-this.LINE_H()/2;if(t.getInputInRect(E,M,this.LINE_H(),this.LINE_H())){this.snapX=k,this.snapY=B,this.snapFromId=p.id,this.snapSocket=T;break}}else if(null==h&&p.id!=o.id)for(var L=0,A=m.length;L<A;){var W=L++,F=n+this.NODE_X(p),O=i+this.NODE_Y(p)+this.SOCKET_Y(W+v.length)+this.BUTTONS_H(p),R=F-this.LINE_H()/2,D=O-this.LINE_H()/2;if(t.getInputInRect(R,D,this.LINE_H(),this.LINE_H())){this.snapX=F,this.snapY=O,this.snapToId=p.id,this.snapSocket=W;break}}}}var N=null!=this.nodeSelected&&(l.from_id==this.nodeSelected.id||l.to_id==this.nodeSelected.id);this.drawLink(t,u-n,_-i,c-n,d-i,N)}for(var V=0,H=e.nodes;V<H.length;){var G=H[V];++V;var P=G.inputs,Z=G.outputs,X=this.NODE_H(G);if(t.inputStarted&&t.getInputInRect(n+this.NODE_X(G)-this.LINE_H()/2,i+this.NODE_Y(G),this.NODE_W()+this.LINE_H(),this.LINE_H())&&(this.nodeDrag=G,this.nodeSelected=this.nodeDrag),t.inputStarted&&t.getInputInRect(n+this.NODE_X(G)-this.LINE_H()/2,i+this.NODE_Y(G)-this.LINE_H()/2,this.NODE_W()+this.LINE_H(),X+this.LINE_H())){for(var z=0,Y=Z.length;z<Y;){var j=z++,U=n+this.NODE_X(G)+this.NODE_W(),K=i+this.NODE_Y(G)+this.SOCKET_Y(j);if(t.getInputInRect(U-this.LINE_H()/2,K-this.LINE_H()/2,this.LINE_H(),this.LINE_H())){var Q={id:this.getLinkId(e.links),from_id:G.id,from_socket:j,to_id:-1,to_socket:-1};e.links.push(Q),this.linkDrag=Q;break}}if(null==this.linkDrag)for(var J=0,q=P.length;J<q;){var $=J++,tt=n+this.NODE_X(G),et=i+this.NODE_Y(G)+this.SOCKET_Y($+Z.length)+this.BUTTONS_H(G);if(t.getInputInRect(tt-this.LINE_H()/2,et-this.LINE_H()/2,this.LINE_H(),this.LINE_H())){for(var nt=0,it=e.links;nt<it.length;){var st=it[nt];if(++nt,st.to_id==G.id&&st.to_socket==$){st.to_id=st.to_socket=-1,this.linkDrag=st;break}}if(null!=this.linkDrag)break;var rt={id:this.getLinkId(e.links),from_id:-1,from_socket:-1,to_id:G.id,to_socket:$};e.links.push(rt),this.linkDrag=rt;break}}}else if(t.inputReleased){if(-1!=this.snapToId){for(var at=0,lt=e.links;at<lt.length;){var ot=lt[at];if(++at,ot.to_id==this.snapToId&&ot.to_socket==this.snapSocket){ht.remove(e.links,ot);break}}this.linkDrag.to_id=this.snapToId,this.linkDrag.to_socket=this.snapSocket,t.changed=!0}else-1!=this.snapFromId?(this.linkDrag.from_id=this.snapFromId,this.linkDrag.from_socket=this.snapSocket,t.changed=!0):null!=this.linkDrag&&(ht.remove(e.links,this.linkDrag),t.changed=!0);this.snapToId=this.snapFromId=-1,this.linkDrag=null,this.nodeDrag=null}this.nodeDrag!=G||t.inputDownR||(G.x+=gt.int(t.inputDX/this.SCALE),G.y+=gt.int(t.inputDY/this.SCALE)),this.drawNode(t,G,e)}t.setScale(s),t.elementsBaked=!0},drawNode:function(t,e,n){t._windowX,t._windowY;var i=this.NODE_W(),s=t.g,r=this.NODE_H(e),a=this.NODE_X(e),l=this.NODE_Y(e),o=e.name,h=this.LINE_H();s.set_color(e==this.nodeSelected?-5592406:-14671840),s.fillRect(a-1,l-1,i+2,r+2),s.set_color(e.color),s.fillRect(a,l,i,h),s.set_color(-14671840),s.fillRect(a,l+h,i,r-h),s.set_color(-1579033);var u=s.get_font().width(t.fontSize,o);s.drawString(o,a+i/2-u/2,l+this.p(4)),l+=h;for(var _=0,c=e.outputs;_<c.length;){var d=c[_];++_,l+=h,s.set_color(d.color),s.drawScaledImage(oi.socketImage,a+i-this.p(5),l-this.p(5),this.p(10),this.p(10))}l-=h*e.outputs.length,s.set_color(-1579033);for(var g=0,f=e.outputs;g<f.length;){var p=f[g];++g,l+=h;var m=t.ops.font.width(t.fontSize,p.name);s.drawString(p.name,a+i-m-this.p(12),l-this.p(7))}var v=this.handle.nest(e.id);l-=h/3;for(var w=0,b=e.buttons.length;w<b;){var x=w++,y=e.buttons[x];if("RGBA"==y.type){l+=h,t._x=a,t._y=l,t._w=i;var S=e.outputs[y.output].default_value;v.color=se.fromFloats(S[0],S[1],S[2]),li.colorWheel(t,v,!1),S[0]=.00392156862745098*((16711680&v.color)>>>16),S[1]=.00392156862745098*((65280&v.color)>>>8),S[2]=.00392156862745098*(255&v.color)}else if("VECTOR"==y.type){l+=h,t._x=a,t._y=l,t._w=i;var C=null!=y.min?y.min:0,I=null!=y.max?y.max:1,T=t.t.LABEL_COL,k=t.t.TEXT_OFFSET;t.t.LABEL_COL=-1,t.t.TEXT_OFFSET=6,t.text(y.name);var B=y.default_value[0];y.default_value[0]=t.slider(v.nest(x).nest(0,{value:B}),"X",C,I,!0,100,!0,0);var E=y.default_value[1];y.default_value[1]=t.slider(v.nest(x).nest(1,{value:E}),"Y",C,I,!0,100,!0,0);var M=y.default_value[2];y.default_value[2]=t.slider(v.nest(x).nest(2,{value:M}),"Z",C,I,!0,100,!0,0),t.t.LABEL_COL=T,t.t.TEXT_OFFSET=k,null!=y.output&&(e.outputs[y.output].default_value=y.default_value),l+=3*h}else if("VALUE"==y.type){l+=h,t._x=a,t._y=l,t._w=i;var L=e.outputs[y.output],A=null!=y.min?y.min:0,W=null!=y.max?y.max:1,F=t.t.LABEL_COL,O=t.t.TEXT_OFFSET;t.t.LABEL_COL=-1,t.t.TEXT_OFFSET=6,L.default_value=t.slider(v.nest(0,{value:L.default_value}),"Value",A,W,!0,100,!0,0),t.t.LABEL_COL=F,t.t.TEXT_OFFSET=O}else if("STRING"==y.type){l+=h,t._x=a,t._y=l,t._w=i;var R=null!=y.output?e.outputs[y.output]:null;y.default_value=t.textInput(v.nest(0,{text:null!=R?R.default_value:""}),y.name),null!=R&&(R.default_value=y.default_value)}else if("ENUM"==y.type){l+=h,t._x=a,t._y=l,t._w=i;var D=y.data instanceof Array&&null==y.data.__enum__,N=D?y.data:oi.getEnumTexts();y.default_value=t.combo(v.nest(x,{position:y.default_value}),N,y.name),D||(y.data=oi.mapEnum(N[y.default_value]))}else if("BOOL"==y.type)l+=h,t._x=a,t._y=l,t._w=i,t.check(v.nest(0,{selected:y.default_value}),y.name);else if("RAMP"==y.type){l+=h,t._x=a,t._y=l,t._w=i;for(var V=y.default_value,H=i/this.SCALE,G=0;G<V.length;){var P=V[G];++G;var Z=P[4],X=se.fromFloats(P[0],P[1],P[2]);t.fill(Z*H,0,(1-Z)*H,h-2*this.SCALE,X)}t._y+=h;var z=v.nest(2);if(t.row([.25,.25,.5]),t.button("+")){var Y=V[V.length-1];V.push([Y[0],Y[1],Y[2],Y[3],1]),z.value+=1}t.button("-")&&1<V.length&&(V.pop(),z.value-=1),y.data=t.combo(v.nest(1,{position:y.data}),["Linear","Constant"],"Interpolate"),t.row([.5,.5]);var j=V[gt.int(t.slider(z,"Index",0,V.length-1,!1,1,!0,0))];v.nest(3).value=j[4],j[4]=t.slider(v.nest(3),"Pos",0,1,!0,100,!0,0);var U=v.nest(4);U.color=se.fromFloats(j[0],j[1],j[2]),li.colorWheel(t,U,!1),j[0]=.00392156862745098*((16711680&U.color)>>>16),j[1]=.00392156862745098*((65280&U.color)>>>8),j[2]=.00392156862745098*(255&U.color),l+=8*h+.5*h}else if("CURVES"==y.type){l+=h,t._x=a,t._y=l,t._w=i,t.row([.3333333333333333,.3333333333333333,.3333333333333333]),t.radio(v.nest(1),0,"X"),t.radio(v.nest(1),1,"Y"),t.radio(v.nest(1),2,"Z");var K=v.nest(1).position,Q=y.default_value[K],J=gt.int(Q.length/2);t._y+=5*h,t.row([.2,.2,.6]),t.button("+")&&(Q.push(0),Q.push(0)),t.button("-")&&4<Q.length&&(Q.pop(),Q.pop());var q=gt.int(t.slider(v.nest(2).nest(K,{position:0}),"Index",0,J-1,!1,1,!0,0));t.row([.5,.5]),v.nest(3).value=Q[2*q],v.nest(4).value=Q[2*q+1],Q[2*q]=t.slider(v.nest(3,{value:0}),"X",-1,1,!0,100,!0,0),Q[2*q+1]=t.slider(v.nest(4,{value:0}),"Y",-1,1,!0,100,!0,0),l+=7*h}}l+=h/3;for(var $=0,tt=e.inputs.length;$<tt;){var et=$++,nt=e.inputs[et];l+=h,s.set_color(nt.color),s.drawScaledImage(oi.socketImage,a-this.p(5),l-this.p(5),this.p(10),this.p(10));for(var it=!1,st=0,rt=n.links;st<rt.length;){var at=rt[st];if(++st,at.to_id==e.id&&at.to_socket==et){it=!0;break}}if(it||"VALUE"!=nt.type)s.set_color(-1579033),s.drawString(nt.name,a+this.p(12),l-this.p(7));else{t._x=a+this.p(6),t._y=l-this.p(9),t._w=gt.int(i-this.p(6));var lt=nt,ot=null!=lt.min?lt.min:0,ht=null!=lt.max?lt.max:1,ut=t.t.LABEL_COL,_t=t.t.TEXT_OFFSET;t.t.LABEL_COL=-1,t.t.TEXT_OFFSET=6,lt.default_value=t.slider(v.nest(et,{value:lt.default_value}),nt.name,ot,ht,!0,100,!0,0),t.t.LABEL_COL=ut,t.t.TEXT_OFFSET=_t}}},drawLink:function(t,e,n,i,s,r){null==r&&(r=!1);var a=t.g;a.set_color(r?-861033043:-864585865),a.drawLine(e,n,i,s,1),a.set_color(r?-1716671059:-1720223881),a.drawLine(e+.5,n,i+.5,s,1),a.drawLine(e-.5,n,i-.5,s,1),a.drawLine(e,n+.5,i,s+.5,1),a.drawLine(e,n-.5,i,s-.5,1)},removeNode:function(t,e){if(null!=t){for(var n=0;n<e.links.length;){var i=e.links[n];i.from_id==t.id||i.to_id==t.id?e.links.splice(n,1):++n}ht.remove(e.nodes,t)}},__class__:oi};var hi=function(){};(n["zui.Themes"]=hi).__name__=!0;var ui=function(t){this.restoreY=-1,this.restoreX=-1,this.checkSelectImage=null,this.elementsBaked=!1,this.tabScroll=0,this.tabHandle=null,this.tabNames=null,this.tooltipTime=0,this.tooltipShown=!1,this.tooltipY=0,this.tooltipX=0,this.tooltipInvertY=!1,this.tooltipImg=null,this.tooltipText="",this.comboToSubmit=0,this.submitComboHandle=null,this.comboSelectedWindow=null,this.comboSelectedHandle=null,this.tabPressedHandle=null,this.tabPressed=!1,this.textToSubmit="",this.submitTextHandle=null,this.textSelectedHandle=null,this.windowHeader=0,this.scrollingHandle=null,this.windowEnded=!0,this.imageScrollAlign=!0,this.scrollAlign=0,this.curRatio=-1,this.highlightAnchor=0,this.cursorY=0,this.cursorX=0,this.key=null,this.isAltDown=!1,this.isCtrlDown=!1,this.isShiftDown=!1,this.isKeyDown=!1,this.inputWheelDelta=0,this.inputEnabled=!0,this.inputRegistered=!1,this.scrollEnabled=!0,this.imageInvertY=!1,this.alwaysRedraw=!1,this.changed=!1,this.isReleased=!1,this.isHovered=!1,this.isPushed=!1,this.isStarted=!1,this.isTyping=!1,this.isScrolling=!1,null==t.theme&&(t.theme=hi.dark),this.t=t.theme,null==t.khaWindowId&&(t.khaWindowId=0),null==t.scaleFactor&&(t.scaleFactor=1),null==t.scaleTexture&&(t.scaleTexture=1),null==t.autoNotifyInput&&(t.autoNotifyInput=!0),this.ops=t,this.setScale(t.scaleFactor),t.autoNotifyInput&&this.registerInput(),this.bakeElements()};(n["zui.Zui"]=ui).__name__=!0,ui.prototype={isScrolling:null,isTyping:null,isStarted:null,isPushed:null,isHovered:null,isReleased:null,changed:null,alwaysRedraw:null,imageInvertY:null,scrollEnabled:null,inputRegistered:null,inputEnabled:null,inputX:null,inputY:null,inputInitialX:null,inputInitialY:null,inputDX:null,inputDY:null,inputWheelDelta:null,inputStarted:null,inputStartedR:null,inputReleased:null,inputReleasedR:null,inputDown:null,inputDownR:null,isKeyDown:null,isShiftDown:null,isCtrlDown:null,isAltDown:null,key:null,char:null,cursorX:null,cursorY:null,highlightAnchor:null,ratios:null,curRatio:null,xBeforeSplit:null,wBeforeSplit:null,g:null,globalG:null,t:null,SCALE:null,ops:null,fontSize:null,fontOffsetY:null,arrowOffsetX:null,arrowOffsetY:null,titleOffsetX:null,buttonOffsetY:null,checkOffsetX:null,checkOffsetY:null,checkSelectOffsetX:null,checkSelectOffsetY:null,radioOffsetX:null,radioOffsetY:null,radioSelectOffsetX:null,radioSelectOffsetY:null,scrollAlign:null,imageScrollAlign:null,_x:null,_y:null,_w:null,_h:null,_windowX:null,_windowY:null,_windowW:null,_windowH:null,currentWindow:null,windowEnded:null,scrollingHandle:null,windowHeader:null,textSelectedHandle:null,textSelectedCurrentText:null,submitTextHandle:null,textToSubmit:null,tabPressed:null,tabPressedHandle:null,comboSelectedHandle:null,comboSelectedWindow:null,comboSelectedAlign:null,comboSelectedTexts:null,comboSelectedLabel:null,comboSelectedX:null,comboSelectedY:null,comboSelectedW:null,submitComboHandle:null,comboToSubmit:null,tooltipText:null,tooltipImg:null,tooltipInvertY:null,tooltipX:null,tooltipY:null,tooltipShown:null,tooltipTime:null,tabNames:null,tabHandle:null,tabScroll:null,elementsBaked:null,checkSelectImage:null,setScale:function(t){this.ops.scaleFactor=t,this.SCALE=this.ops.scaleFactor*this.ops.scaleTexture,this.fontSize=gt.int(this.t.FONT_SIZE*this.ops.scaleFactor);var e=this.ops.font.height(this.fontSize);this.fontOffsetY=(this.ELEMENT_H()-e)/2,this.arrowOffsetY=(this.ELEMENT_H()-this.ARROW_SIZE())/2,this.arrowOffsetX=this.arrowOffsetY,this.titleOffsetX=(2*this.arrowOffsetX+this.ARROW_SIZE())/this.SCALE,this.buttonOffsetY=(this.ELEMENT_H()-this.BUTTON_H())/2,this.checkOffsetY=(this.ELEMENT_H()-this.CHECK_SIZE())/2,this.checkOffsetX=this.checkOffsetY,this.checkSelectOffsetY=(this.CHECK_SIZE()-this.CHECK_SELECT_SIZE())/2,this.checkSelectOffsetX=this.checkSelectOffsetY,this.radioOffsetY=(this.ELEMENT_H()-this.CHECK_SIZE())/2,this.radioOffsetX=this.radioOffsetY,this.radioSelectOffsetY=(this.CHECK_SIZE()-this.CHECK_SELECT_SIZE())/2,this.radioSelectOffsetX=this.radioSelectOffsetY,this.elementsBaked=!1},bakeElements:function(){null!=this.checkSelectImage&&this.checkSelectImage.unload(),this.checkSelectImage=ne.createRenderTarget(gt.int(this.CHECK_SELECT_SIZE()),gt.int(this.CHECK_SELECT_SIZE()),null,0,1,this.ops.khaWindowId);var t=this.checkSelectImage.get_g2();t.begin(!0,0),t.set_color(this.t.ACCENT_SELECT_COL),t.drawLine(0,0,this.checkSelectImage.get_width(),this.checkSelectImage.get_height(),2*this.SCALE),t.drawLine(this.checkSelectImage.get_width(),0,0,this.checkSelectImage.get_height(),2*this.SCALE),t.end(),this.elementsBaked=!0},registerInput:function(){An.get().notifyWindowed(this.ops.khaWindowId,ci(this,this.onMouseDown),ci(this,this.onMouseUp),ci(this,this.onMouseMove),ci(this,this.onMouseWheel)),Ln.get().notify(ci(this,this.onKeyDown),ci(this,this.onKeyUp),ci(this,this.onKeyPress)),be.notifyOnCutCopyPaste(ci(this,this.onCut),ci(this,this.onCopy),ci(this,this.onPaste)),this.inputRegistered=!0},begin:function(t){this.elementsBaked||this.bakeElements(),this.changed=!1,this.globalG=t,this._x=0,this._y=0,this._w=0,this._h=0},end:function(t){null==t&&(t=!0),this.windowEnded||this.endWindow(),null!=this.comboSelectedHandle&&this.drawCombo(),t&&this.endInput(),null!=this.tabPressedHandle&&(this.tabPressedHandle=null)},endInput:function(){this.isKeyDown=!1,this.inputStarted=!1,this.inputStartedR=!1,this.inputReleased=!1,this.inputReleasedR=!1,this.inputDX=0,this.inputDY=0,this.inputWheelDelta=0,ui.textToPaste="",ui.isCut=!1},beginLayout:function(t,e,n,i){this.elementsBaked||this.bakeElements(),this.currentWindow=null,this.g=t,this._windowX=0,this._windowY=0,this._windowW=i,this._x=e,this._y=n,this._w=i},endLayout:function(t){null==t&&(t=!0),t&&this.endInput()},inputChanged:function(){return!!(0!=this.inputDX||0!=this.inputDY||0!=this.inputWheelDelta||this.inputStarted||this.inputStartedR||this.inputReleased||this.inputReleasedR||this.inputDown||this.inputDownR)||this.isKeyDown},windowDirty:function(t,e,n,i,s){var r=e+t.dragX,a=n+t.dragY,l=this.getInputInRect(r,a,i,s)&&this.inputChanged();return!!(this.alwaysRedraw||this.isScrolling||this.isTyping)||l},window:function(t,e,n,i,s,r){return null==r&&(r=!1),null!=t.texture&&i==t.texture.get_width()&&s==t.texture.get_height()||this.resize(t,i,s,this.ops.khaWindowId),this.windowEnded||this.endWindow(),this.windowEnded=!1,this.g=t.texture.get_g2(),this.currentWindow=t,this._windowX=e+t.dragX,this._windowY=n+t.dragY,this._windowW=i,this._windowH=s,this.windowHeader=0,this.windowDirty(t,e,n,i,s)&&(t.redraws=2),0!=t.redraws&&(this._x=0,this._y=t.scrollOffset,1==t.layout&&(i=gt.int(this.ELEMENT_W())),this._w=t.scrollEnabled?i-this.SCROLL_W():i,this._h=s,this.tooltipText="",this.tooltipImg=null,this.tabNames=null,this.t.FILL_WINDOW_BG?this.g.begin(!0,this.t.WINDOW_BG_COL):(this.g.begin(!0,0),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x,this._y-t.scrollOffset,t.lastMaxX,t.lastMaxY)),(t.dragEnabled=r)&&(this.inputStarted&&this.getInputInRect(this._windowX,this._windowY,this._windowW,15)?t.dragging=!0:this.inputReleased&&(t.dragging=!1),t.dragging&&(t.redraws=2,t.dragX+=gt.int(this.inputDX),t.dragY+=gt.int(this.inputDY)),this._y+=15,this.windowHeader+=15),!0)},endWindow:function(t){null==t&&(t=!0);var e=this.currentWindow;if(null!=e){if(0<e.redraws||this.isScrolling||this.isTyping){null!=this.tabNames&&this.drawTabs(),e.dragEnabled&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,0,this._windowW,15));var n=this._y-e.scrollOffset;if(n<this._windowH||1==e.layout||!this.scrollEnabled)e.scrollEnabled=!1,e.scrollOffset=0;else{e.scrollEnabled=!0,this.tabScroll<0&&(e.scrollOffset=this.tabScroll,this.tabScroll=0);var i=n-this._windowH,s=-e.scrollOffset/i,r=this._windowH*Math.abs(this._windowH/n);r=Math.max(r,this.ELEMENT_H());var a=this._windowH-r,l=i/a,o=a*s;this.inputStarted&&this.getInputInRect(this._windowX+this._windowW-this.SCROLL_W(),o+this._windowY,this.SCROLL_W(),r)&&(e.scrolling=!0,this.scrollingHandle=e,this.isScrolling=!0),e.scrolling?this.scroll(this.inputDY*l,n):0!=this.inputWheelDelta&&this.scroll(this.inputWheelDelta*this.ELEMENT_H(),n),0<e.scrollOffset?e.scrollOffset=0:n+e.scrollOffset<this._windowH&&(e.scrollOffset=this._windowH-n),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._windowW-this.SCROLL_W(),this._windowY,this.SCROLL_W(),this._windowH),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this._windowW-this.SCROLL_W()-this.scrollAlign,o,this.SCROLL_W(),r)}e.lastMaxX=this._x,e.lastMaxY=this._y,0==e.layout?e.lastMaxX+=this._windowW:e.lastMaxY+=this._windowH,e.redraws--,this.g.end()}this.windowEnded=!0,t&&this.globalG.begin(!1),this.globalG.set_color(this.t.WINDOW_TINT_COL),this.globalG.drawScaledImage(e.texture,this._windowX,this._windowY,e.texture.get_width()/this.ops.scaleTexture,e.texture.get_height()/this.ops.scaleTexture),""!=this.tooltipText||null!=this.tooltipImg?(this.tooltipShown||(this.tooltipShown=!0,this.tooltipX=this.inputX,this.tooltipTime=pe.time()),pe.time()-this.tooltipTime>this.t.TOOLTIP_DELAY&&(""!=this.tooltipText?this.drawTooltip():this.drawTooltipImage())):this.tooltipShown=!1,t&&this.globalG.end()}},scroll:function(t,e){this.currentWindow.scrollOffset-=t},restoreX:null,restoreY:null,drawTabs:function(){if(this.inputX=this.restoreX,this.inputY=this.restoreY,null!=this.currentWindow){var t=0,e=this._y;this._y=this.currentWindow.dragEnabled?15:0,this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(0,this._y,this._windowW,this.buttonOffsetY+this.BUTTON_H()),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this.buttonOffsetY,this._y+this.buttonOffsetY+this.BUTTON_H(),this._windowW-2*this.buttonOffsetY,this.LINE_STRENGTH());for(var n=0,i=this.tabNames.length;n<i;){var s=n++;this._x=t,this._w=gt.int(this.ops.font.width(this.fontSize,this.tabNames[s])+2*this.buttonOffsetY+14*this.SCALE);var r=this.getReleased(),a=this.getPushed(),l=this.getHover();if(r){var o=this.tabHandle.nest(this.tabHandle.position);o.scrollOffset=this.currentWindow.scrollOffset,o=this.tabHandle.nest(s),this.tabScroll=o.scrollOffset,this.tabHandle.position=s,this.currentWindow.redraws=3}var h=this.tabHandle.position==s;this.g.set_color(a?this.t.ACCENT_HOVER_COL:l?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),t+=this._w+5,this.drawRect(this.g,!h,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w,this.BUTTON_H()),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,this.tabNames[s],this.TEXT_OFFSET(),0,0),h&&(this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x+this.buttonOffsetY+1,this._y+this.buttonOffsetY+this.BUTTON_H(),this._w-1,this.LINE_STRENGTH()))}this._x=0,this._y=e,this._w=gt.int(this.currentWindow.scrollEnabled?this._windowW-this.SCROLL_W():this._windowW)}},image:function(t,e,n){null==e&&(e=-1);var i=t.get_width()*this.SCALE,s=t.get_height()*this.SCALE,r=Math.min(i,this._w),a=this._x;if(this.imageScrollAlign&&(r=Math.min(i,this._w-2*this.buttonOffsetY),a+=this.buttonOffsetY,!(null!=this.currentWindow&&this.currentWindow.scrollEnabled))){var l=-1==this.curRatio?1:this.ratios[this.curRatio];r-=this.SCROLL_W()*l,a+=this.SCROLL_W()*l/2}var o=null==n?r/i:n/s;if(null==n?n=s*o:r=i*o,!this.isVisible(n))return this.endElement(n),0;var h=this.getStarted(n),u=this.getPushed(n),_=this.getReleased(n);this.getHover();this.g.set_color(e);var c=n;return this.imageInvertY?this.g.drawScaledImage(t,a,this._y+c,r,-c):this.g.drawScaledImage(t,a,this._y,r,c),this.endElement(n),h?1:_?3:u?2:0},text:function(t,e,n){null==n&&(n=0),null==e&&(e=0),this.isVisible(this.ELEMENT_H())&&(this.getReleased(),0!=n&&(this.g.set_color(n),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H())),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.TEXT_OFFSET(),0,e)),this.endElement()},startTextEdit:function(t){this.isTyping=!0,this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=t,this.textSelectedCurrentText=t.text,this.tabPressed=!1,this.tabPressedHandle=t,this.cursorX=t.text.length,this.cursorY=0,this.highlightAnchor=0,null!=Ln.get()&&Ln.get().show()},submitTextEdit:function(){this.submitTextHandle.text=this.textToSubmit,this.submitTextHandle.changed=this.changed=!0,this.submitTextHandle=null,this.textToSubmit="",this.textSelectedCurrentText=""},updateTextEdit:function(t){null==t&&(t=0);var e=this.textSelectedCurrentText;this.isKeyDown&&(37==this.key?0<this.cursorX&&this.cursorX--:39==this.key?this.cursorX<e.length&&this.cursorX++:8==this.key?0<this.cursorX&&this.highlightAnchor==this.cursorX?(e=ht.substr(e,0,this.cursorX-1)+ht.substr(e,this.cursorX,e.length),this.cursorX--):this.highlightAnchor<this.cursorX?(e=ht.substr(e,0,this.highlightAnchor)+ht.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=ht.substr(e,0,this.cursorX)+ht.substr(e,this.highlightAnchor,e.length):46==this.key?this.highlightAnchor==this.cursorX?e=ht.substr(e,0,this.cursorX)+ht.substr(e,this.cursorX+1,null):this.highlightAnchor<this.cursorX?(e=ht.substr(e,0,this.highlightAnchor)+ht.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=ht.substr(e,0,this.cursorX)+ht.substr(e,this.highlightAnchor,e.length):13==this.key?this.deselectText():27==this.key?(this.textSelectedCurrentText=this.textSelectedHandle.text,this.deselectText()):9==this.key?(this.tabPressed=!0,this.deselectText(),this.key=null):36==this.key?this.cursorX=0:35==this.key?this.cursorX=e.length:16!=this.key&&20!=this.key&&17!=this.key&&18!=this.key&&null!=this.char&&""!=this.char&&32<=ht.cca(this.char,0)&&127!=ht.cca(this.char,0)&&(e=ht.substr(e,0,this.highlightAnchor)+this.char+ht.substr(e,this.cursorX,null),this.cursorX++),this.isShiftDown&&(37==this.key||39==this.key)||this.isCtrlDown||(this.highlightAnchor=this.cursorX));""!=ui.textToPaste&&(e=ht.substr(e,0,this.highlightAnchor)+ui.textToPaste+ht.substr(e,this.cursorX,null),this.cursorX+=ui.textToPaste.length,this.highlightAnchor=this.cursorX,ui.textToPaste=""),this.highlightAnchor==this.cursorX?ui.textToCopy=e:this.highlightAnchor<this.cursorX?ui.textToCopy=e.substring(this.highlightAnchor,this.cursorX):ui.textToCopy=e.substring(this.cursorX,this.highlightAnchor),ui.isCut&&(this.highlightAnchor==this.cursorX?e="":this.highlightAnchor<this.cursorX?(e=ht.substr(e,0,this.highlightAnchor)+ht.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=ht.substr(e,0,this.cursorX)+ht.substr(e,this.highlightAnchor,e.length));var n=this.TEXT_OFFSET(),i=this.ELEMENT_H(),s=i-3*this.buttonOffsetY;if(this.highlightAnchor!=this.cursorX){var r=this.cursorX,a=this.highlightAnchor;this.highlightAnchor<this.cursorX&&(r=this.highlightAnchor,a=this.cursorX);var l=ht.substr(e,r,a-r),o=this.g.get_font().width(this.g.get_fontSize(),l),h=this.g.get_font().width(this.g.get_fontSize(),ht.substr(e,0,r)),u=0==t?this._x+h+n:this._x+this._w-o-n;2==t&&(u-=this.g.get_font().width(this.g.get_fontSize(),ht.substr(e,a,e.length))),this.g.fillRect(u,this._y+this.cursorY*i+1.5*this.buttonOffsetY,o*this.SCALE,s)}if(pe.time()%(2*this.t.FLASH_SPEED)<this.t.FLASH_SPEED){this.g.set_color(this.t.TEXT_COL);var _=0==t?ht.substr(e,0,this.cursorX):e.substring(this.cursorX,e.length),c=this.g.get_font().width(this.g.get_fontSize(),_),d=0==t?this._x+c+n:this._x+this._w-c-n;this.g.fillRect(d,this._y+this.cursorY*i+1.5*this.buttonOffsetY,this.SCALE,s)}this.textSelectedCurrentText=e},textInput:function(t,e,n){if(null==n&&(n=0),null==e&&(e=""),!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.text;var i=this.getHover();this.g.set_color(i?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H());var s=this.getReleased()||this.tabPressed;if(this.textSelectedHandle!=t&&s&&this.startTextEdit(t),this.textSelectedHandle==t&&this.updateTextEdit(n),this.submitTextHandle==t?this.submitTextEdit():t.changed=!1,""!=e){this.g.set_color(this.t.LABEL_COL);var r=2==n?0:2,a=0==r?7:0;this.drawString(this.g,e,a,0,r)}return this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.text,null,0,n):this.drawString(this.g,this.textSelectedCurrentText,null,0,n),this.endElement(),t.text},deselectText:function(){this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=null,this.isTyping=!1,null!=this.currentWindow&&(this.currentWindow.redraws=2),null!=Ln.get()&&Ln.get().hide(),this.highlightAnchor=this.cursorX},button:function(t,e){if(null==e&&(e=1),!this.isVisible(this.ELEMENT_H()))return this.endElement(),!1;var n=this.getReleased(),i=this.getPushed(),s=this.getHover();return this.g.set_color(i?this.t.BUTTON_PRESSED_COL:s?this.t.BUTTON_HOVER_COL:this.t.BUTTON_COL),this.drawRect(this.g,this.t.FILL_BUTTON_BG,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H()),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,t,this.TEXT_OFFSET(),0,e),this.endElement(),n},check:function(t,e){if(!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.selected;this.getReleased()?(t.selected=!t.selected,t.changed=this.changed=!0):t.changed=!1;var n=this.getHover();return this.drawCheck(t.selected,n),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.titleOffsetX,0,0),this.endElement(),t.selected},radio:function(t,e,n){if(!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.position==e;this.getReleased()?(t.position=e,t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawRadio(t.position==e,i),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,n,this.titleOffsetX,0),this.endElement(),t.position==e},inlineRadio:function(t,e){if(!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.position;this.getReleased()?(++t.position>=e.length&&(t.position=0),t.changed=this.changed=!0):t.changed=!1;var n=this.getHover();return this.drawInlineRadio(e[t.position],n),this.endElement(),t.position},combo:function(t,e,n,i,s){if(null==s&&(s=0),null==i&&(i=!1),null==n&&(n=""),!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.position;this.getReleased()&&null==this.comboSelectedHandle&&(this.inputEnabled=!1,this.comboSelectedHandle=t,this.comboSelectedWindow=this.currentWindow,this.comboSelectedAlign=s,this.comboSelectedTexts=e,this.comboSelectedLabel=n,this.comboSelectedX=gt.int(this._x+this._windowX),this.comboSelectedY=gt.int(this._y+this._windowY+this.ELEMENT_H()+this.ELEMENT_OFFSET()),this.comboSelectedW=gt.int(this._w)),t==this.submitComboHandle?(t.position=this.comboToSubmit,this.submitComboHandle=null,t.changed=this.changed=!0):t.changed=!1,this.getHover()?this.g.set_color(this.t.ACCENT_HOVER_COL):this.g.set_color(this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H());var r=this._x+this._w-this.arrowOffsetX-8,a=this._y+this.arrowOffsetY+3;return this.g.fillTriangle(r,a,r+this.ARROW_SIZE(),a,r+this.ARROW_SIZE()/2,a+this.ARROW_SIZE()/2),this.g.set_color(this.t.TEXT_COL),i&&""!=n&&(0==s&&(this._x-=15),this.drawString(this.g,n,null,0,0==s?2:0),0==s&&(this._x+=15)),2==s&&(this._x-=15),this.drawString(this.g,e[t.position],null,0,s),2==s&&(this._x+=15),this.endElement(),t.position},slider:function(t,e,n,i,s,r,a,l,o){if(null==o&&(o=!0),null==l&&(l=2),null==a&&(a=!0),null==r&&(r=100),null==s&&(s=!1),null==i&&(i=1),null==n&&(n=0),!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.value;if(this.getStarted()&&(t.scrolling=!0,this.scrollingHandle=t,this.isScrolling=!0),t.changed=!1,t.scrolling){var h=i-n,u=this._x+this._windowX+this.buttonOffsetY,_=h/(this._w-2*this.buttonOffsetY),c=n+(this.inputX-u)*_;t.value=Math.round(c*r)/r,t.value<n?t.value=n:t.value>i&&(t.value=i),t.changed=this.changed=!0}var d=this.getHover();this.drawSlider(t.value,n,i,s,d),(this.getReleased()||this.tabPressed)&&o&&(t.text=t.value+"",this.startTextEdit(t));var g=0==l?2:0;return this.textSelectedHandle==t&&this.updateTextEdit(g),this.submitTextHandle==t&&(this.submitTextEdit(),t.value=gt.parseFloat(t.text)),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,e,null,0,l),a&&(this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.value+"",null,0,g):this.drawString(this.g,this.textSelectedCurrentText,null,0,g)),this.endElement(),t.value},drawCheck:function(t,e){var n=this._x+this.checkOffsetX,i=this._y+this.checkOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,n,i,this.CHECK_SIZE(),this.CHECK_SIZE()),t&&(this.g.set_color(-1),this.g.drawImage(this.checkSelectImage,n+this.checkSelectOffsetX,i+this.checkSelectOffsetY))},drawRadio:function(t,e){var n=this._x+this.radioOffsetX,i=this._y+this.radioOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,n,i,this.CHECK_SIZE(),this.CHECK_SIZE()),t&&(this.g.set_color(this.t.ACCENT_SELECT_COL),this.g.fillRect(n+this.radioSelectOffsetX,i+this.radioSelectOffsetY,this.CHECK_SELECT_SIZE(),this.CHECK_SELECT_SIZE()))},drawInlineRadio:function(t,e){e?(this.g.set_color(this.t.ACCENT_HOVER_COL),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H())):(this.g.set_color(this.t.ACCENT_COL),this.g.drawRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H())),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.titleOffsetX,0,1)},drawSlider:function(t,e,n,i,s){var r=this._x+this.buttonOffsetY,a=this._y+this.buttonOffsetY,l=this._w-2*this.buttonOffsetY;this.g.set_color(s?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,r,a,l,this.BUTTON_H()),this.g.set_color(s?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var o=(t-e)/(n-e),h=8*this.SCALE,u=i?r:r+(l-h)*o,_=i?l*o:h;_=Math.min(_,l),this.g.fillRect(u,a,_,this.BUTTON_H())},drawCombo:function(){var t=this.g;this.globalG.set_color(-14540254);var e=this.ELEMENT_H()+this.ELEMENT_OFFSET();this.globalG.begin(!1),this.globalG.fillRect(this.comboSelectedX,this.comboSelectedY,this.comboSelectedW,(this.comboSelectedTexts.length+1)*e),this.beginLayout(this.globalG,this.comboSelectedX,this.comboSelectedY,this.comboSelectedW),this.inputEnabled=!0;for(var n=0,i=this.comboSelectedTexts.length;n<i;){var s=n++;if(this.button(this.comboSelectedTexts[s],this.comboSelectedAlign)){this.comboToSubmit=s,this.submitComboHandle=this.comboSelectedHandle,null!=this.comboSelectedWindow&&(this.comboSelectedWindow.redraws=2);break}}this.text(this.comboSelectedLabel),this.inputReleased&&!ui.comboFirst?(this.comboSelectedHandle=null,ui.comboFirst=!0):ui.comboFirst=!1,this.inputEnabled=null==this.comboSelectedHandle,this.endLayout(!1),this.globalG.end(),this.g=t},drawTooltip:function(){this.globalG.set_color(this.t.TEXT_COL);for(var t=this.tooltipText.split("\n"),e=0,n=0;n<t.length;){var i=t[n];++n;var s=this.ops.font.width(this.fontSize,i);e<s&&(e=s)}this.tooltipX=Math.min(this.tooltipX,be.windowWidth()-e-20),this.globalG.fillRect(this.tooltipX,this.tooltipY,e+20,this.ELEMENT_H()*t.length*.6),this.globalG.set_font(this.ops.font),this.globalG.set_fontSize(this.fontSize),this.globalG.set_color(this.t.ACCENT_COL);for(var r=0,a=t.length;r<a;){var l=r++;this.globalG.drawString(t[l],this.tooltipX+5,this.tooltipY+l*this.fontSize)}},drawTooltipImage:function(){this.tooltipX=Math.min(this.tooltipX,be.windowWidth()-this.tooltipImg.get_width()-20),this.globalG.set_color(-16777216),this.globalG.fillRect(this.tooltipX,this.tooltipY,this.tooltipImg.get_width(),this.tooltipImg.get_height()),this.globalG.set_color(-1),this.tooltipInvertY?this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY+this.tooltipImg.get_height(),this.tooltipImg.get_width(),-this.tooltipImg.get_height()):this.globalG.drawImage(this.tooltipImg,this.tooltipX,this.tooltipY)},drawString:function(t,e,n,i,s){null==s&&(s=0),null==i&&(i=0);var r=gt.int(this._w/gt.int(this.fontSize/2));e.length>r&&(e=e.substring(0,r)+".."),null==n&&(n=this.t.TEXT_OFFSET),n*=this.SCALE,t.set_font(this.ops.font),t.set_fontSize(this.fontSize),1==s?n=this._w/2-this.ops.font.width(this.fontSize,e)/2:2==s&&(n=this._w-this.ops.font.width(this.fontSize,e)-this.TEXT_OFFSET()),t.drawString(e,this._x+n,this._y+this.fontOffsetY+i)},endElement:function(t){null!=this.currentWindow?0==this.currentWindow.layout?-1==this.curRatio||null!=this.ratios&&this.curRatio==this.ratios.length-1?(null==t&&(t=this.ELEMENT_H()+this.ELEMENT_OFFSET()),this._y+=t,null!=this.ratios&&this.curRatio==this.ratios.length-1&&(this.curRatio=-1,this.ratios=null,this._x=this.xBeforeSplit,this._w=this.wBeforeSplit)):(this.curRatio++,this._x+=this._w,this._w=gt.int(this.wBeforeSplit*this.ratios[this.curRatio])):this._x+=this._w+this.ELEMENT_OFFSET():this._y+=this.ELEMENT_H()+this.ELEMENT_OFFSET()},row:function(t){this.ratios=t,this.curRatio=0,this.xBeforeSplit=this._x,this.wBeforeSplit=this._w,this._w=gt.int(this._w*t[this.curRatio])},fill:function(t,e,n,i,s){this.g.set_color(s),this.g.fillRect(this._x+t*this.SCALE,this._y+e*this.SCALE,n*this.SCALE,i*this.SCALE),this.g.set_color(-1)},drawRect:function(t,e,n,i,s,r,a){null==a&&(a=0),0==a&&(a=this.LINE_STRENGTH()),e?t.fillRect(n,i,s,r):t.drawRect(n,i,s,r,a)},isVisible:function(t){return null==this.currentWindow||0<this._y+t&&this._y<this.currentWindow.texture.get_height()},getReleased:function(t){return null==t&&(t=-1),this.isReleased=this.inputEnabled&&this.inputReleased&&this.getHover(t)&&this.getInitialHover(t),this.isReleased},getPushed:function(t){return null==t&&(t=-1),this.isPushed=this.inputEnabled&&this.inputDown&&this.getHover(t)&&this.getInitialHover(t),this.isPushed},getStarted:function(t){return null==t&&(t=-1),this.isStarted=this.inputEnabled&&this.inputStarted&&this.getHover(t),this.isStarted},getInitialHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.ELEMENT_H()),!!(this.inputEnabled&&this.inputInitialX>=this._windowX+this._x&&this.inputInitialX<this._windowX+this._x+this._w&&this.inputInitialY>=this._windowY+this._y)&&this.inputInitialY<this._windowY+this._y+t},getHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.ELEMENT_H()),this.isHovered=this.inputEnabled&&this.inputX>=this._windowX+this._x&&this.inputX<this._windowX+this._x+this._w&&this.inputY>=this._windowY+this._y&&this.inputY<this._windowY+this._y+t,this.isHovered},getInputInRect:function(t,e,n,i,s){return null==s&&(s=1),!!(this.inputEnabled&&this.inputX>=t*s&&this.inputX<(t+n)*s&&this.inputY>=e*s)&&this.inputY<(e+i)*s},onMouseDown:function(t,e,n){0==t?this.inputStarted=!0:this.inputStartedR=!0,0==t?this.inputDown=!0:this.inputDownR=!0;var i=gt.int(e*this.ops.scaleTexture),s=gt.int(n*this.ops.scaleTexture);this.setInputPosition(i,s),this.inputInitialX=i,this.inputInitialY=s},onMouseUp:function(t,e,n){0==t?this.isScrolling?(this.isScrolling=!1,null!=this.scrollingHandle&&(this.scrollingHandle.scrolling=!1),e==this.inputInitialX&&n==this.inputInitialY&&(this.inputReleased=!0)):this.inputReleased=!0:1==t&&(this.inputReleasedR=!0),0==t?this.inputDown=!1:this.inputDownR=!1,this.setInputPosition(gt.int(e*this.ops.scaleTexture),gt.int(n*this.ops.scaleTexture)),this.deselectText()},onMouseMove:function(t,e,n,i){this.setInputPosition(gt.int(t*this.ops.scaleTexture),gt.int(e*this.ops.scaleTexture))},onMouseWheel:function(t){this.inputWheelDelta=t},setInputPosition:function(t,e){this.inputDX+=t-this.inputX,this.inputDY+=e-this.inputY,this.inputX=t,this.inputY=e},onKeyDown:function(t){switch(this.key=t,this.isKeyDown=!0,t){case 16:this.isShiftDown=!0;break;case 17:this.isCtrlDown=!0;break;case 18:this.isAltDown=!0;break;case 32:this.char=" "}},onKeyUp:function(t){switch(t){case 16:this.isShiftDown=!1;break;case 17:this.isCtrlDown=!1;break;case 18:this.isAltDown=!1}},onKeyPress:function(t){this.char=t,this.isKeyDown=!0},onCut:function(){return ui.isCut=!0,this.onCopy()},onCopy:function(){return ui.textToCopy},onPaste:function(t){ui.textToPaste=t},ELEMENT_W:function(){return this.t.ELEMENT_W*this.SCALE},ELEMENT_H:function(){return this.t.ELEMENT_H*this.SCALE},ELEMENT_OFFSET:function(){return this.t.ELEMENT_OFFSET*this.SCALE},ARROW_SIZE:function(){return this.t.ARROW_SIZE*this.SCALE},BUTTON_H:function(){return this.t.BUTTON_H*this.SCALE},CHECK_SIZE:function(){return this.t.CHECK_SIZE*this.SCALE},CHECK_SELECT_SIZE:function(){return this.t.CHECK_SELECT_SIZE*this.SCALE},SCROLL_W:function(){return gt.int(this.t.SCROLL_W*this.SCALE)},TEXT_OFFSET:function(){return this.t.TEXT_OFFSET},LINE_STRENGTH:function(){return this.t.LINE_STRENGTH*this.SCALE},resize:function(t,e,n,i){null==i&&(i=0),t.redraws=2,null!=t.texture&&t.texture.unload(),t.texture=ne.createRenderTarget(e,n,xn.RGBA32,0,1,i),t.texture.get_g2().set_imageScaleQuality(Ne.High)},__class__:ui};var _i=0;function ci(t,e){return null==e?null:(null==e.__id__&&(e.__id__=_i++),null==t.hx__closures__?t.hx__closures__={}:n=t.hx__closures__[e.__id__],null==n&&(n=e.bind(t),t.hx__closures__[e.__id__]=n),n);var n}n.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=n.String=String,String.__name__=!0,n.Array=Array,Array.__name__=!0,Date.prototype.__class__=n.Date=Date,Date.__name__="Date";var di={},gi={},fi=Number,pi=Boolean,mi={},vi={};nt.count=0;var wi={};Object.defineProperty(Xt.prototype,"message",{get:function(){return String(this.val)}}),null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=jt.sliceImpl),o.lastW=-1,o.lastH=-1,W.helpVec=new E,W.helpMat=W.identity(),m.drawMeshes=f.drawMeshes,v.events=new it,V.packageName="armory.logicnode",mt.DEFAULT_RESOLVER=new A,mt.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",P.helper=new DataView(new ArrayBuffer(8)),X.traitInits=[],X.traitUpdates=[],X.traitLateUpdates=[],X.traitRenders=[],X.traitRenders2D=[],X.pauseUpdates=!1,X.lastw=-1,X.lasth=-1,U.uidCounter=0,U.framePassed=!0,st.cachedSceneRaws=new it,st.cachedMeshes=new it,st.cachedLights=new it,st.cachedCameras=new it,st.cachedMaterials=new it,st.cachedWorlds=new it,st.cachedShaders=new it,st.cachedBlobs=new it,st.cachedImages=new it,st.cachedFonts=new it,st.dataPath="",st.loadingMeshes=new it,st.loadingLights=new it,st.loadingCameras=new it,st.loadingMaterials=new it,st.loadingWorlds=new it,st.loadingShaders=new it,st.loadingSceneRaws=new it,st.assetsLoaded=0,st.loadingBlobs=new it,st.loadingImages=new it,st.loadingFonts=new it,lt.uidCounter=0,ot.num=0,bt.m1=W.identity(),bt.m2=W.identity(),bt.vpos=new E,bt.vpos2=new E,bt.vscl=new E,bt.vscl2=new E,bt.q1=new w,bt.q2=new w,bt.q3=new w,bt.vp=new E,bt.vs=new E,xt.uidCounter=0,xt.seed=1,yt.temp=new E,yt.sphereCenter=new E,yt.vcenter=new E,yt.vup=new E,It.cascadeBounds=1,It.m=W.identity(),It.eye=new E,Mt.temp=W.identity(),At.biasMat=new W(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),At.helpMat=W.identity(),At.helpMat2=W.identity(),At.helpMat3=vt.identity(),At.helpVec=new E,At.helpVec2=new E,At.helpQuat=new w,Ot.occupied=!1,Ot.gamepads=[],Ot.registered=!1,Nt.buttons=["left","right","middle"],Ht.keys=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9",".",",","space","backspace","tab","enter","shift","control","alt","escape","delete","back","up","right","left","down","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12"],Pt.buttonsPS=["cross","circle","square","triangle","l1","r1","l2","r2","share","options","l3","r3","up","down","left","right","home","touchpad"],Pt.buttons=Pt.buttonsPS,Zt.scale=1,Zt.last=0,Zt.realDelta=0,zt.__toStr={}.toString,$t.images=new Ut,$t.sounds=new Kt,$t.blobs=new Qt,$t.fonts=new Jt,$t.videos=new qt,re.canvas_id="khanvas",ae.instance=new ae,pe.DIF_COUNT=3,pe.maxframetime=.5,pe.startTime=0,me.Material_mesh_fragData0="s1339:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0RGlyOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKdmFyeWluZyBoaWdocCB2ZWMzIHdub3JtYWw7CnZhcnlpbmcgaGlnaHAgdmVjMyB3cG9zaXRpb247CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCnZvaWQgbWFpbigpCnsKICAgIGhpZ2hwIHZlYzMgbiA9IG5vcm1hbGl6ZSh3bm9ybWFsKTsKICAgIGhpZ2hwIHZlYzMgYmFzZWNvbCA9IHZlYzMoMC44MDAwMDAwMTE5MjA5Mjg5NTUwNzgxMjUpOwogICAgaGlnaHAgZmxvYXQgcm91Z2huZXNzID0gMC4wOwogICAgaGlnaHAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBoaWdocCBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBoaWdocCBmbG9hdCBzcGVjdWxhciA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IHZpc2liaWxpdHkgPSAxLjA7CiAgICBoaWdocCBmbG9hdCBkb3ROTCA9IG1heChkb3QobiwgbGlnaHREaXIpLCAwLjApOwogICAgaGlnaHAgdmVjMyBkaXJlY3QgPSAoYmFzZWNvbCAqIGRvdE5MKSAqIGxpZ2h0Q29sb3I7CiAgICBkaXJlY3QgKj0gYXR0ZW51YXRlKGRpc3RhbmNlKHdwb3NpdGlvbiwgbGlnaHRQb3MpKTsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNCgoZGlyZWN0ICogdmlzaWJpbGl0eSkgKyAoKGJhc2Vjb2wgKiAwLjUpICogZW52bWFwU3RyZW5ndGgpLCAxLjApOwogICAgaGlnaHAgdmVjMyBfNzcgPSBwb3coZ2xfRnJhZ0RhdGFbMF0ueHl6LCB2ZWMzKDAuNDU0NTQ1NDY4MDkxOTY0NzIxNjc5Njg3NSkpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KF83Ny54LCBfNzcueSwgXzc3LnosIGdsX0ZyYWdEYXRhWzBdLncpOwp9Cgo",me.Material_mesh_fragData1="s1198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gdmVjMyBsaWdodENvbG9yOwp1bmlmb3JtIHZlYzMgbGlnaHRQb3M7CnVuaWZvcm0gZmxvYXQgZW52bWFwU3RyZW5ndGg7Cgp2YXJ5aW5nIHZlYzMgd25vcm1hbDsKdmFyeWluZyB2ZWMzIHdwb3NpdGlvbjsKCmZsb2F0IGF0dGVudWF0ZShmbG9hdCBkaXN0KQp7CiAgICByZXR1cm4gMS4wIC8gKGRpc3QgKiBkaXN0KTsKfQoKdm9pZCBtYWluKCkKewogICAgdmVjMyBuID0gbm9ybWFsaXplKHdub3JtYWwpOwogICAgdmVjMyBiYXNlY29sID0gdmVjMygwLjgwMDAwMDAxMTkyMDkyODk1NTA3ODEyNSk7CiAgICBmbG9hdCByb3VnaG5lc3MgPSAwLjA7CiAgICBmbG9hdCBtZXRhbGxpYyA9IDAuMDsKICAgIGZsb2F0IG9jY2x1c2lvbiA9IDEuMDsKICAgIGZsb2F0IHNwZWN1bGFyID0gMC4wOwogICAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGZsb2F0IGRvdE5MID0gbWF4KGRvdChuLCBsaWdodERpciksIDAuMCk7CiAgICB2ZWMzIGRpcmVjdCA9IChiYXNlY29sICogZG90TkwpICogbGlnaHRDb2xvcjsKICAgIGRpcmVjdCAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIDAuNSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7CiAgICB2ZWMzIF83NyA9IHBvdyhnbF9GcmFnRGF0YVswXS54eXosIHZlYzMoMC40NTQ1NDU0NjgwOTE5NjQ3MjE2Nzk2ODc1KSk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoXzc3LngsIF83Ny55LCBfNzcueiwgZ2xfRnJhZ0RhdGFbMF0udyk7Cn0KCg",me.Material_mesh_fragData2="s1338:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0RGlyOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKaW4gaGlnaHAgdmVjMyB3bm9ybWFsOwppbiBoaWdocCB2ZWMzIHdwb3NpdGlvbjsKb3V0IGhpZ2hwIHZlYzQgZnJhZ0NvbG9yOwoKaGlnaHAgZmxvYXQgYXR0ZW51YXRlKGhpZ2hwIGZsb2F0IGRpc3QpCnsKICAgIHJldHVybiAxLjAgLyAoZGlzdCAqIGRpc3QpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuODAwMDAwMDExOTIwOTI4OTU1MDc4MTI1KTsKICAgIGhpZ2hwIGZsb2F0IHJvdWdobmVzcyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgaGlnaHAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgaGlnaHAgZmxvYXQgc3BlY3VsYXIgPSAwLjA7CiAgICBoaWdocCBmbG9hdCB2aXNpYmlsaXR5ID0gMS4wOwogICAgaGlnaHAgZmxvYXQgZG90TkwgPSBtYXgoZG90KG4sIGxpZ2h0RGlyKSwgMC4wKTsKICAgIGhpZ2hwIHZlYzMgZGlyZWN0ID0gKGJhc2Vjb2wgKiBkb3ROTCkgKiBsaWdodENvbG9yOwogICAgZGlyZWN0ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICBmcmFnQ29sb3IgPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIDAuNSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7CiAgICBoaWdocCB2ZWMzIF83NyA9IHBvdyhmcmFnQ29sb3IueHl6LCB2ZWMzKDAuNDU0NTQ1NDY4MDkxOTY0NzIxNjc5Njg3NSkpOwogICAgZnJhZ0NvbG9yID0gdmVjNChfNzcueCwgXzc3LnksIF83Ny56LCBmcmFnQ29sb3Iudyk7Cn0KCg",me.Material_mesh_vertData0="s402:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgVzsKdW5pZm9ybSBtYXQzIE47CnVuaWZvcm0gbWF0NCBXVlA7CgphdHRyaWJ1dGUgdmVjMyBwb3M7CnZhcnlpbmcgdmVjMyB3cG9zaXRpb247CnZhcnlpbmcgdmVjMyB3bm9ybWFsOwphdHRyaWJ1dGUgdmVjMyBub3I7Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHNwb3MgPSB2ZWM0KHBvcywgMS4wKTsKICAgIHdwb3NpdGlvbiA9IHZlYzQoVyAqIHNwb3MpLnh5ejsKICAgIHdub3JtYWwgPSBub3JtYWxpemUoTiAqIG5vcik7CiAgICBnbF9Qb3NpdGlvbiA9IFdWUCAqIHNwb3M7Cn0KCg",me.Material_mesh_vertData1="s487:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXOwp1bmlmb3JtIG1lZGl1bXAgbWF0MyBOOwp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXVlA7CgphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIHBvczsKdmFyeWluZyBtZWRpdW1wIHZlYzMgd3Bvc2l0aW9uOwp2YXJ5aW5nIG1lZGl1bXAgdmVjMyB3bm9ybWFsOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIG5vcjsKCnZvaWQgbWFpbigpCnsKICAgIG1lZGl1bXAgdmVjNCBzcG9zID0gdmVjNChwb3MsIDEuMCk7CiAgICB3cG9zaXRpb24gPSB2ZWM0KFcgKiBzcG9zKS54eXo7CiAgICB3bm9ybWFsID0gbm9ybWFsaXplKE4gKiBub3IpOwogICAgZ2xfUG9zaXRpb24gPSBXVlAgKiBzcG9zOwp9Cgo",me.Material_mesh_vertData2="s376:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgVzsKdW5pZm9ybSBtYXQzIE47CnVuaWZvcm0gbWF0NCBXVlA7CgppbiB2ZWMzIHBvczsKb3V0IHZlYzMgd3Bvc2l0aW9uOwpvdXQgdmVjMyB3bm9ybWFsOwppbiB2ZWMzIG5vcjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgc3BvcyA9IHZlYzQocG9zLCAxLjApOwogICAgd3Bvc2l0aW9uID0gdmVjNChXICogc3BvcykueHl6OwogICAgd25vcm1hbCA9IG5vcm1hbGl6ZShOICogbm9yKTsKICAgIGdsX1Bvc2l0aW9uID0gV1ZQICogc3BvczsKfQoK",me.painter_colored_vertData0="s331:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",me.painter_colored_vertData1="s374:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",me.painter_colored_vertData2="s311:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",me.painter_image_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",me.painter_image_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",me.painter_image_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",me.painter_colored_fragData0="s198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IGZyYWdtZW50Q29sb3I7Cn0KCg",me.painter_colored_fragData1="s192:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK",me.painter_colored_fragData2="s223:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSBmcmFnbWVudENvbG9yOwp9Cgo",me.painter_image_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",me.painter_image_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",me.painter_image_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",me.painter_video_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",me.painter_video_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",me.painter_video_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",me.painter_text_fragData0="s351:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",me.painter_text_fragData1="s340:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjNCBmcmFnbWVudENvbG9yOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK",me.painter_text_fragData2="s367:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIGhpZ2hwIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSB2ZWM0KGZyYWdtZW50Q29sb3IueHl6LCB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",me.painter_video_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",me.painter_video_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",me.painter_video_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",me.painter_text_vertData0="s436:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",me.painter_text_vertData1="s500:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",me.painter_text_vertData2="s402:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",be.renderListeners=[],be.foregroundListeners=[],be.backgroundListeners=[],be.shutdownListeners=[],ye.mobile=!1,ye.ios=!1,ye.mobileAudioPlaying=!1,ye.chrome=!1,ye.firefox=!1,ye.ie=!1,ye.insideInputEvent=!1,ye.leftMouseCtrlDown=!1,ye.minimumScroll=999,ye.lastFirstTouchX=0,ye.lastFirstTouchY=0,ye.iosSoundEnabled=!1,ye.soundEnabled=!1,ye.iosTouchs=[],Ie.windows=[],Oe.fontGlyphs=function(t){for(var e=[],n=32;n<256;){var i=n++;e.push(i)}return e}(),En.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},En.instances=[],En.connectListeners=[],En.disconnectListeners=[],Ln.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},An.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},On.accelerometer=new On,On.gyroscope=new On,Nn.bufferSize=2e3,Vn.exposurePattern=new r("EXPOSURE=\\s*([0-9]*[.][0-9]*)","i"),Vn.formatPattern=new r("FORMAT=32-bit_rle_rgbe","i"),Vn.widthHeightPattern=new r("-Y ([0-9]+) \\+X ([0-9]+)","i"),Hn.todo=[],jn.loading=[],ii.nextId=0,ri.global=new ri,ai.assetMap=new tt,ai.events=[],ai.screenW=-1,ai.screenH=-1,ai.h=new ri,li.ar=[0,0,0],oi.elementsBaked=!1,hi.dark={FONT_SIZE:13,ELEMENT_W:100,ELEMENT_H:22,ELEMENT_OFFSET:2,ARROW_SIZE:5,BUTTON_H:17,CHECK_SIZE:15,CHECK_SELECT_SIZE:8,SCROLL_W:8,TEXT_OFFSET:8,TAB_W:12,LINE_STRENGTH:1,FLASH_SPEED:.5,TOOLTIP_DELAY:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-14671840,WINDOW_TINT_COL:-1,ACCENT_COL:-12566464,ACCENT_HOVER_COL:-11513776,ACCENT_SELECT_COL:-10066330,PANEL_BG_COL:-16777216,PANEL_TEXT_COL:-1118482,BUTTON_COL:-13948117,BUTTON_TEXT_COL:-3487289,BUTTON_HOVER_COL:-12895429,BUTTON_PRESSED_COL:-15000805,TEXT_COL:-3487289,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-14277082},hi.light={FONT_SIZE:26,ELEMENT_W:200,ELEMENT_H:44,ELEMENT_OFFSET:4,ARROW_SIZE:10,BUTTON_H:34,CHECK_SIZE:30,CHECK_SELECT_SIZE:16,SCROLL_W:16,TEXT_OFFSET:16,TAB_W:24,LINE_STRENGTH:2,FLASH_SPEED:.5,TOOLTIP_DELAY:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-1052689,WINDOW_TINT_COL:-14540254,ACCENT_COL:-1118482,ACCENT_HOVER_COL:-4473925,ACCENT_SELECT_COL:-5592406,PANEL_BG_COL:-1,PANEL_TEXT_COL:-14540254,BUTTON_COL:-3355444,BUTTON_TEXT_COL:-14540254,BUTTON_HOVER_COL:-5000269,BUTTON_PRESSED_COL:-5131855,TEXT_COL:-6710887,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-6710887},ui.textToPaste="",ui.textToCopy="",ui.isCut=!1,ui.comboFirst=!0,a.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);