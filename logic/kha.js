!function(t,e){"use strict";t.kha=t.kha||{},t.kha.input=t.kha.input||{},t.kha._Color=t.kha._Color||{};var S,n={},i=function(){return hs.__string_rec(this,"")},w=w||{};function r(t,e){var n=Object.create(t);for(var i in e)n[i]=e[i];return e.toString!==Object.prototype.toString&&(n.toString=e.toString),n}var s=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};(n.EReg=s).__name__="EReg",s.prototype={r:null,match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},matched:function(t){if(null!=this.r.m&&0<=t&&t<this.r.m.length)return this.r.m[t];throw new us("EReg::matched")},__class__:s};var ut=function(){};(n.HxOverrides=ut).__name__="HxOverrides",ut.strDate=function(t){switch(t.length){case 8:var e=t.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(e[0]),n.setUTCMinutes(e[1]),n.setUTCSeconds(e[2]),n;case 10:var i=t.split("-");return new Date(i[0],i[1]-1,i[2],0,0,0);case 19:var r=t.split(" "),s=r[0].split("-"),a=r[1].split(":");return new Date(s[0],s[1]-1,s[2],a[0],a[1],a[2]);default:throw new us("Invalid date format : "+t)}},ut.cca=function(t,e){var n=t.charCodeAt(e);return n!=n?cs.get_undefined():n},ut.substr=function(t,e,n){if(null==n)n=t.length;else if(n<0){if(0!=e)return"";n=t.length+n}return t.substr(e,n)},ut.remove=function(t,e){var n=t.indexOf(e);return-1!=n&&(t.splice(n,1),!0)},ut.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var l=function(){};(n.Lambda=l).__name__="Lambda",l.has=function(t,e){for(var n,i=(n=t)instanceof Array?ut.iter(n):n.iterator();i.hasNext();){if(i.next()==e)return!0}return!1};var a=function(){};(n.Main=a).__name__="Main",a.main=function(){Xi.main("Scene",1,!0,!0,!0,1600,900,2,!0,Pi.get)},Math.__name__="Math";var ft=function(){};(n.Reflect=ft).__name__="Reflect",ft.hasField=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},ft.field=function(t,e){try{return t[e]}catch(t){t instanceof us&&t.val;return null}},ft.setField=function(t,e,n){t[e]=n},ft.getProperty=function(t,e){var n;return null==t?null:!!t.__properties__&&(n=t.__properties__["get_"+e])?t[n]():t[e]},ft.setProperty=function(t,e,n){var i;!!t.__properties__&&(i=t.__properties__["set_"+e])?t[i](n):t[e]=n},ft.callMethod=function(t,e,n){return e.apply(t,n)},ft.fields=function(t){var e=[];if(null!=t){var n=Object.prototype.hasOwnProperty;for(var i in t)"__id__"!=i&&"hx__closures__"!=i&&n.call(t,i)&&e.push(i)}return e},ft.isFunction=function(t){return"function"==typeof t&&!(hs.isClass(t)||hs.isEnum(t))},ft.deleteField=function(t,e){return!!ft.hasField(t,e)&&(delete t[e],!0)};var pt=function(){};(n.Std=pt).__name__="Std",pt.is=function(t,e){return hs.__instanceof(t,e)},pt.string=function(t){return hs.__string_rec(t,"")},pt.int=function(t){return 0|t},pt.parseInt=function(t){var e=parseInt(t,!t||"0"!=t[0]||"x"!=t[1]&&"X"!=t[1]?10:16);return isNaN(e)?null:e},pt.parseFloat=function(t){return parseFloat(t)},pt.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var o=function(){this.b=""};(n.StringBuf=o).__name__="StringBuf",o.prototype={b:null,add:function(t){this.b+=pt.string(t)},addChar:function(t){this.b+=String.fromCodePoint(t)},toString:function(){return this.b},__class__:o};var J=function(){};(n.StringTools=J).__name__="StringTools",J.urlEncode=function(t){return encodeURIComponent(t)},J.urlDecode=function(t){return decodeURIComponent(t.split("+").join(" "))},J.startsWith=function(t,e){return t.length>=e.length&&ut.substr(t,0,e.length)==e},J.endsWith=function(t,e){var n=e.length,i=t.length;return n<=i&&ut.substr(t,i-n,n)==e},J.replace=function(t,e,n){return t.split(e).join(n)},J.fastCodeAt=function(t,e){return t.charCodeAt(e)},J.isEof=function(t){return t!=t};var u=w.ValueType={__ename__:"ValueType",__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"],TNull:{_hx_index:0,__enum__:"ValueType",toString:i},TInt:{_hx_index:1,__enum__:"ValueType",toString:i},TFloat:{_hx_index:2,__enum__:"ValueType",toString:i},TBool:{_hx_index:3,__enum__:"ValueType",toString:i},TObject:{_hx_index:4,__enum__:"ValueType",toString:i},TFunction:{_hx_index:5,__enum__:"ValueType",toString:i},TClass:(S=function(t){return{_hx_index:6,c:t,__enum__:"ValueType",toString:i}},S.__params__=["c"],S),TEnum:(S=function(t){return{_hx_index:7,e:t,__enum__:"ValueType",toString:i}},S.__params__=["e"],S),TUnknown:{_hx_index:8,__enum__:"ValueType",toString:i}},q=function(){};(n.Type=q).__name__="Type",q.getClass=function(t){return null==t?null:hs.getClass(t)},q.getClassName=function(t){return t.__name__},q.getEnumName=function(t){return t.__ename__},q.resolveClass=function(t){return n[t]},q.resolveEnum=function(t){return w[t]},q.createInstance=function(t,e){return new(Function.prototype.bind.apply(t,[null].concat(e)))},q.createEmptyInstance=function(t){return Object.create(t.prototype)},q.createEnum=function(t,e,n){var i=ft.field(t,e);if(null==i)throw new us("No such constructor "+e);if(ft.isFunction(i)){if(null==n)throw new us("Constructor "+e+" need parameters");return ft.callMethod(t,i,n)}if(null!=n&&0!=n.length)throw new us("Constructor "+e+" does not need parameters");return i},q.getInstanceFields=function(t){var e=[];for(var n in t.prototype)e.push(n);return ut.remove(e,"__class__"),ut.remove(e,"__properties__"),e},q.getEnumConstructs=function(t){return t.__constructs__.slice()},q.typeof=function(t){switch(typeof t){case"boolean":return u.TBool;case"function":return hs.isClass(t)||hs.isEnum(t)?u.TObject:u.TFunction;case"number":return Math.ceil(t)==t%2147483648?u.TInt:u.TFloat;case"object":if(null==t)return u.TNull;var e=t.__enum__;if(null!=e)return u.TEnum(w[e]);var n=hs.getClass(t);return null!=n?u.TClass(n):u.TObject;case"string":return u.TClass(String);case"undefined":return u.TNull;default:return u.TUnknown}},q.enumConstructor=function(t){return w[t.__enum__].__constructs__[t._hx_index]},q.enumParameters=function(t){var e=w[t.__enum__],n=e[e.__constructs__[t._hx_index]].__params__;if(null!=n){for(var i=[],r=0;r<n.length;){var s=n[r];++r,i.push(t[s])}return i}return[]};var h=function(){this._render2D=null,this._render=null,this._lateUpdate=null,this._update=null,this._remove=null,this._init=null,this._add=null};(n["iron.Trait"]=h).__name__="iron.Trait",h.prototype={object:null,_add:null,_init:null,_remove:null,_update:null,_lateUpdate:null,_render:null,_render2D:null,remove:function(){this.object.removeTrait(this)},notifyOnAdd:function(t){null==this._add&&(this._add=[]),this._add.push(t)},notifyOnInit:function(t){null==this._init&&(this._init=[]),this._init.push(t),mr.notifyOnInit(t)},notifyOnRemove:function(t){null==this._remove&&(this._remove=[]),this._remove.push(t)},notifyOnUpdate:function(t){null==this._update&&(this._update=[]),this._update.push(t),mr.notifyOnUpdate(t)},removeUpdate:function(t){ut.remove(this._update,t),mr.removeUpdate(t)},notifyOnRender2D:function(t){null==this._render2D&&(this._render2D=[]),this._render2D.push(t),mr.notifyOnRender2D(t)},__class__:h};var _=function(){h.call(this),Cr.getFont("font_default.ttf",function(t){_.font=t,br.active.root.addTrait(new k)})};(n["arm.App"]=_).__name__="arm.App",_.w=function(){var t=pt.int(zs.windowWidth()/3);return 0<t?t:1},_.h=function(){var t;return 0<(t=zs.windowHeight())?t:1},_.x=function(){return 0},_.y=function(){return 0},_.realw=function(){return zs.windowWidth()},_.realh=function(){return zs.windowHeight()},_.resize=function(){br.active.camera.buildProjection(),null!=k.inst.grid&&(k.inst.grid.unload(),k.inst.grid=null)},_.render=function(t){0<=_.lastW&&0<_.realw()&&(_.lastW!=_.realw()||_.lastH!=_.realh())&&_.resize(),_.lastW=_.realw(),_.lastH=_.realh()},_.__super__=h,_.prototype=r(h.prototype,{__class__:_});var C=function(){};(n["arm.NodeCreatorLogic"]=C).__name__="arm.NodeCreatorLogic",C.nodeColor=function(t){switch(t){case"Action":case"Animation":case"Event":case"Input":case"Logic":case"Native":case"Navmesh":case"Physics":case"Sound":case"Value":case"Variable":return-5025958}return-5025958},C.socketColor=function(t){switch(t){case"ACTION":return-3388340;case"BOOL":case"INTEGER":return-10238109;case"OBJECT":return-14250817;case"RGBA":return-10238109;case"SHADER":return-11959648;case"STRING":return-1;case"VALUE":case"VECTOR":return-10238109}return-5025958},C.socketDefault=function(t){switch(t){case"ACTION":return 0;case"BOOL":return!1;case"INTEGER":case"OBJECT":return 0;case"RGBA":return[0,0,0,0];case"SHADER":return 0;case"STRING":return"";case"VALUE":return 0;case"VECTOR":return[0,0,0]}return 0},C.draw=function(t){for(var e=k.inst.ui,n=Fo(S=k.inst,S.getNodeX),i=Fo(S=k.inst,S.getNodeY),r=k.inst.nodes,s=k.inst.canvasLogic,a=0,o=C.list.categories[t].nodes;a<o.length;){var l=o[a];if(++a,e.button(l.name)){for(var u=r.getNodeId(s.nodes),h={id:u,name:l.name,type:l.type,x:n(),y:i(),color:C.nodeColor(l.type),inputs:[],outputs:[],buttons:[]},_=0,c=l.inputs;_<c.length;){var d=c[_];++_;var p={id:r.getSocketId(s.nodes),node_id:u,name:d.name,type:d.type,color:C.socketColor(d.type),default_value:C.socketDefault(d.type)};h.inputs.push(p)}for(var g=0,f=l.outputs;g<f.length;){var m=f[g];++g;var v={id:r.getSocketId(s.nodes),node_id:u,name:m.name,type:m.type,color:C.socketColor(m.type),default_value:C.socketDefault(m.type)};h.outputs.push(v)}for(var y=0,w=l.buttons;y<w.length;){var b=w[y];++y;var x={name:b.name,type:b.type,output:0,default_value:b.default_value,data:b.data};h.buttons.push(x)}s.nodes.push(h),r.nodeDrag=h,r.nodeSelected=h}}};var k=function(){this.lastT=null,this.hwnd=No.global.nest(0,null),this.grid=null,this.changed=!1,this.canvasLogic=null,this.nodes=new Eo,this.popupY=0,this.popupX=0,this.addNodeButton=!1,this.menuCategory=0,this.hideMenu=!1,this.showMenu=!1,this.drawMenu=!1;var s=this;h.call(this),k.inst=this,Cr.getBlob("logic_nodes.json",function(t){var e='{"nodes":[],"links":[]}',n=J.urlDecode(window.location.href);0<n.indexOf("?")&&(e=n.split("?")[1]),s.canvasLogic=JSON.parse(e),(C.list=JSON.parse(t.toString())).categories.sort(function(t,e){return t.name<e.name?-1:t.name>e.name?1:0});var i=Ao.dark;i.ELEMENT_H=18,i.BUTTON_H=16;var r=d.raw.window_scale;s.ui=new Bo({font:_.font,color_wheel:_.color_wheel,scaleFactor:r}),s.ui.scrollEnabled=!1,s.notifyOnRender2D(Fo(s,s.render2D)),s.notifyOnUpdate(Fo(s,s.update)),s.notifyOnInit(Fo(s,s.parseLogic))})};(n["arm.UINodes"]=k).__name__="arm.UINodes",k.__super__=h,k.prototype=r(h.prototype,{wx:null,wy:null,ww:null,ui:null,drawMenu:null,showMenu:null,hideMenu:null,menuCategory:null,addNodeButton:null,popupX:null,popupY:null,nodes:null,canvasLogic:null,changed:null,grid:null,hwnd:null,update:function(){var t=Jr.getMouse(),e=Jr.getKeyboard();(this.ui.changed||this.changed)&&(this.parseLogic(),this.changed=!1),this.wx=pt.int(mr.w()),this.wy=0;var n=t.x+_.x(),i=t.y+_.y();if(!(n<this.wx||i<this.wy)&&!this.ui.isTyping&&(this.addNodeButton?(this.showMenu=!0,this.addNodeButton=!1):t.released()&&(this.hideMenu=!0),(e.started("x")||e.started("backspace"))&&null!=this.nodes.nodeSelected)){var r=this.canvasLogic;this.nodes.removeNode(this.nodes.nodeSelected,r),this.changed=!0}},getNodeX:function(){var t=Jr.getMouse();return pt.int((t.x+_.x()-this.wx-this.nodes.PAN_X())/this.nodes.SCALE)},getNodeY:function(){var t=Jr.getMouse();return pt.int((t.y+_.y()-this.wy-this.nodes.PAN_Y())/this.nodes.SCALE)},drawGrid:function(){var t=_.realw()-mr.w()+80,e=mr.h()+80;this.grid=xs.createRenderTarget(t,e),this.grid.get_g2().begin(!0,-14408668);for(var n=0,i=pt.int(e/40)+1;n<i;){var r=n++;this.grid.get_g2().set_color(-14145496),this.grid.get_g2().drawLine(0,40*r,t,40*r),this.grid.get_g2().set_color(-13487566),this.grid.get_g2().drawLine(0,40*r+20,t,40*r+20)}for(var s=0,a=pt.int(t/40)+1;s<a;){var o=s++;this.grid.get_g2().set_color(-14145496),this.grid.get_g2().drawLine(40*o,0,40*o,e),this.grid.get_g2().set_color(-13487566),this.grid.get_g2().drawLine(40*o+20,0,40*o+20,e)}this.grid.get_g2().end()},render2D:function(t){t.end(),null==this.grid&&this.drawGrid(),this.ui.begin(t),this.ww=pt.int(_.realw()-mr.w());this.wx=pt.int(mr.w()),this.wy=0;var e=pt.int(this.ui.ELEMENT_W());if(this.ui.window(this.hwnd,this.wx,this.wy,this.ww,mr.h())){this.ui.g.set_color(-1),this.ui.g.drawImage(this.grid,this.nodes.panX*this.nodes.SCALE%40-40,this.nodes.panY*this.nodes.SCALE%40-40),this.ui.g.set_font(_.font),this.ui.g.set_fontSize(22);this.ui.g.get_font().width(22,"Logic"),this.ui.g.get_font().height(22);var n=this.canvasLogic;this.nodes.nodeCanvas(this.ui,n),this.ui.g.set_color(this.ui.t.WINDOW_BG_COL),this.ui.g.set_color(-1),this.ui._x=3,this.ui._y=3,this.ui._w=e}if(this.ui.endWindow(),this.drawMenu){var i=20*C.list.categories[this.menuCategory].nodes.length,r=this.popupY;t.set_color(-14540254),t.fillRect(this.popupX,r,e,i),this.ui.beginLayout(t,pt.int(this.popupX),pt.int(r),e),C.draw(this.menuCategory),this.ui.endLayout()}this.ui.end(),t.begin(!1),this.showMenu&&(this.showMenu=!1,this.drawMenu=!0),this.hideMenu&&(this.hideMenu=!1,this.drawMenu=!1)},lastT:null,parseLogic:function(){null!=this.lastT&&br.active.getChild("Cube").removeTrait(this.lastT),Zi.packageName="armory.logicnode";var t=Zi.parse(this.canvasLogic);this.lastT=t,br.active.getChild("Cube").addTrait(t)},__class__:k});var d=function(){};(n["armory.data.Config"]=d).__name__="armory.data.Config";var c=function(t){this.outputs=[],this.inputs=[],this.tree=t};(n["armory.logicnode.LogicNode"]=c).__name__="armory.logicnode.LogicNode",c.prototype={tree:null,inputs:null,outputs:null,addInput:function(t,e){this.inputs.push(new ue(t,e))},addOutputs:function(t){this.outputs.push(t)},run:function(t){},runOutput:function(t){if(!(t>=this.outputs.length))for(var e=0,n=this.outputs[t];e<n.length;){var i=n[e];++e;for(var r=0,s=i.inputs.length;r<s;){var a=r++;if(i.inputs[a].node==this){i.run(a);break}}}},get:function(t){return this},set:function(t){},__class__:c};var p=function(t){c.call(this,t)};(n["armory.logicnode.ActiveCameraNode"]=p).__name__="armory.logicnode.ActiveCameraNode",p.__super__=c,p.prototype=r(c.prototype,{get:function(t){return br.active.camera},__class__:p});var g=function(t){c.call(this,t)};(n["armory.logicnode.ActiveSceneNode"]=g).__name__="armory.logicnode.ActiveSceneNode",g.__super__=c,g.prototype=r(c.prototype,{get:function(t){return br.active.raw.name},__class__:g});var f=function(t){c.call(this,t)};(n["armory.logicnode.AddGroupNode"]=f).__name__="armory.logicnode.AddGroupNode",f.__super__=c,f.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null==br.active.groups.get(e)&&br.active.groups.set(e,[]),this.runOutput(0)},__class__:f});var m=function(t){c.call(this,t)};(n["armory.logicnode.AddTraitNode"]=m).__name__="armory.logicnode.AddTraitNode",m.__super__=c,m.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&(e.addTrait(n),this.runOutput(0))},__class__:m});var v=function(t){this.b=!0,c.call(this,t)};(n["armory.logicnode.AlternateNode"]=v).__name__="armory.logicnode.AlternateNode",v.__super__=c,v.prototype=r(c.prototype,{b:null,run:function(t){this.b?this.runOutput(0):this.runOutput(1),this.b=!this.b},__class__:v});var y=function(t,e){null==e&&(e=""),c.call(this,t),this.value=e};(n["armory.logicnode.AnimActionNode"]=y).__name__="armory.logicnode.AnimActionNode",y.__super__=c,y.prototype=r(c.prototype,{value:null,get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:y});var b=function(t){c.call(this,t)};(n["armory.logicnode.AnimationStateNode"]=b).__name__="armory.logicnode.AnimationStateNode",b.__super__=c,b.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var n=e.animation;return null==n&&(n=e.getParentArmature(e.name)),0==t?!n.paused:1==t?n.action:n.currentFrame()},__class__:b});var x=function(t){c.call(this,t)};(n["armory.logicnode.AppendTransformNode"]=x).__name__="armory.logicnode.AppendTransformNode",x.__super__=c,x.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&(e.transform.multMatrix(n),this.runOutput(0))},__class__:x});var I=function(t){c.call(this,t)};(n["armory.logicnode.ApplyForceAtLocationNode"]=I).__name__="armory.logicnode.ApplyForceAtLocationNode",I.__super__=c,I.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=this.inputs[3].get();null!=e&&null!=n&&null!=i&&this.runOutput(0)},__class__:I});var T=function(t){c.call(this,t)};(n["armory.logicnode.ApplyForceNode"]=T).__name__="armory.logicnode.ApplyForceNode",T.__super__=c,T.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&this.runOutput(0)},__class__:T});var N=function(t){c.call(this,t)};(n["armory.logicnode.ApplyImpulseAtLocationNode"]=N).__name__="armory.logicnode.ApplyImpulseAtLocationNode",N.__super__=c,N.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=this.inputs[3].get();null!=e&&null!=n&&null!=i&&this.runOutput(0)},__class__:N});var M=function(t){c.call(this,t)};(n["armory.logicnode.ApplyImpulseNode"]=M).__name__="armory.logicnode.ApplyImpulseNode",M.__super__=c,M.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&this.runOutput(0)},__class__:M});var O=function(t){c.call(this,t)};(n["armory.logicnode.ApplyTorqueImpulseNode"]=O).__name__="armory.logicnode.ApplyTorqueImpulseNode",O.__super__=c,O.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&this.runOutput(0)},__class__:O});var E=function(t){c.call(this,t)};(n["armory.logicnode.ApplyTorqueNode"]=E).__name__="armory.logicnode.ApplyTorqueNode",E.__super__=c,E.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&this.runOutput(0)},__class__:E});var A=function(t){c.call(this,t)};(n["armory.logicnode.ArrayAddNode"]=A).__name__="armory.logicnode.ArrayAddNode",A.__super__=c,A.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){if(2<this.inputs.length)for(var n=2,i=this.inputs.length;n<i;){var r=n++,s=this.inputs[r].get();e.push(s)}this.runOutput(0)}},__class__:A});var B=function(t){c.call(this,t)};(n["armory.logicnode.ArrayAddUniqueNode"]=B).__name__="armory.logicnode.ArrayAddUniqueNode",B.__super__=c,B.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){if(2<this.inputs.length)for(var n=2,i=this.inputs.length;n<i;){var r=n++,s=this.inputs[r].get();-1==e.indexOf(s)&&e.push(s)}this.runOutput(0)}},__class__:B});var L=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(n["armory.logicnode.ArrayBooleanNode"]=L).__name__="armory.logicnode.ArrayBooleanNode",L.__super__=c,L.prototype=r(c.prototype,{value:null,initialized:null,get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,n=this.inputs;e<n.length;){var i=n[e];++e;var r=i.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:L});var F=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(n["armory.logicnode.ArrayColorNode"]=F).__name__="armory.logicnode.ArrayColorNode",F.__super__=c,F.prototype=r(c.prototype,{value:null,initialized:null,get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,n=this.inputs;e<n.length;){var i=n[e];++e;var r=i.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:F});var W=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(n["armory.logicnode.ArrayFloatNode"]=W).__name__="armory.logicnode.ArrayFloatNode",W.__super__=c,W.prototype=r(c.prototype,{value:null,initialized:null,get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,n=this.inputs;e<n.length;){var i=n[e];++e;var r=i.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:W});var R=function(t){c.call(this,t)};(n["armory.logicnode.ArrayGetNode"]=R).__name__="armory.logicnode.ArrayGetNode",R.__super__=c,R.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var n=this.inputs[1].get();if(n<0&&(n=e.length+n),n<0||n>e.length-1){var i=q.getClassName(q.getClass(this.tree)),r=i.substring(i.lastIndexOf(".")+1),s=this.tree.object.name;return Ji.trace("Logic error (object: "+s+", trait: "+r+"): Array Get - index out of range",{fileName:"Sources/armory/logicnode/ArrayGetNode.hx",lineNumber:19,className:"armory.logicnode.ArrayGetNode",methodName:"get"}),null}return e[n]},__class__:R});var D=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(n["armory.logicnode.ArrayIntegerNode"]=D).__name__="armory.logicnode.ArrayIntegerNode",D.__super__=c,D.prototype=r(c.prototype,{value:null,initialized:null,get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,n=this.inputs;e<n.length;){var i=n[e];++e;var r=i.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:D});var G=function(t){c.call(this,t)};(n["armory.logicnode.ArrayLengthNode"]=G).__name__="armory.logicnode.ArrayLengthNode",G.__super__=c,G.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null!=e?e.length:0},__class__:G});var V=function(t){c.call(this,t)};(n["armory.logicnode.ArrayLoopNode"]=V).__name__="armory.logicnode.ArrayLoopNode",V.__super__=c,V.prototype=r(c.prototype,{value:null,run:function(t){var e=this.inputs[1].get();if(null!=e){for(var n=0;n<e.length;){var i=e[n];if(++n,this.value=i,this.runOutput(0),this.tree.loopBreak){this.tree.loopBreak=!1;break}}this.runOutput(2)}},get:function(t){return this.value},__class__:V});var H=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(n["armory.logicnode.ArrayNode"]=H).__name__="armory.logicnode.ArrayNode",H.__super__=c,H.prototype=r(c.prototype,{value:null,initialized:null,get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,n=this.inputs;e<n.length;){var i=n[e];++e;var r=i.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:H});var P=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(n["armory.logicnode.ArrayObjectNode"]=P).__name__="armory.logicnode.ArrayObjectNode",P.__super__=c,P.prototype=r(c.prototype,{value:null,initialized:null,get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,n=this.inputs;e<n.length;){var i=n[e];++e;var r=i.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:P});var z=function(t){c.call(this,t)};(n["armory.logicnode.ArrayPopNode"]=z).__name__="armory.logicnode.ArrayPopNode",z.__super__=c,z.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.pop()},__class__:z});var Z=function(t){this.removedValue=null,c.call(this,t)};(n["armory.logicnode.ArrayRemoveNode"]=Z).__name__="armory.logicnode.ArrayRemoveNode",Z.__super__=c,Z.prototype=r(c.prototype,{removedValue:null,run:function(t){var e=this.inputs[1].get();if(null!=e){var n=this.inputs[2].get();n<0&&(n=e.length+n),this.removedValue=e[n],e.splice(n,1),this.runOutput(0)}},get:function(t){return this.removedValue},__class__:Z});var X=function(t){this.removedValue=null,c.call(this,t)};(n["armory.logicnode.ArrayRemoveValueNode"]=X).__name__="armory.logicnode.ArrayRemoveValueNode",X.__super__=c,X.prototype=r(c.prototype,{removedValue:null,run:function(t){var e=this.inputs[1].get();if(null!=e){var n=this.inputs[2].get();this.removedValue=n,ut.remove(e,n),this.runOutput(0)}},get:function(t){return this.removedValue},__class__:X});var j=function(t){c.call(this,t)};(n["armory.logicnode.ArraySetNode"]=j).__name__="armory.logicnode.ArraySetNode",j.__super__=c,j.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var n=this.inputs[2].get(),i=this.inputs[3].get();n<0?e[e.length+n]=i:e[n]=i,this.runOutput(0)}},__class__:j});var Y=function(t){c.call(this,t)};(n["armory.logicnode.ArrayShiftNode"]=Y).__name__="armory.logicnode.ArrayShiftNode",Y.__super__=c,Y.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.shift()},__class__:Y});var U=function(t){c.call(this,t)};(n["armory.logicnode.ArraySliceNode"]=U).__name__="armory.logicnode.ArraySliceNode",U.__super__=c,U.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var n=this.inputs[1].get(),i=this.inputs[2].get();if(n<0&&(n=e.length+n),n<0||n>e.length-1){var r=q.getClassName(q.getClass(this.tree)),s=r.substring(r.lastIndexOf(".")+1),a=this.tree.object.name;return Ji.trace("Logic error (object: "+a+", trait: "+s+"): Array Get - index out of range",{fileName:"Sources/armory/logicnode/ArraySliceNode.hx",lineNumber:21,className:"armory.logicnode.ArraySliceNode",methodName:"get"}),null}return e.slice(n,i)},__class__:U});var K=function(t){c.call(this,t)};(n["armory.logicnode.ArraySpliceNode"]=K).__name__="armory.logicnode.ArraySpliceNode",K.__super__=c,K.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var n=this.inputs[2].get(),i=this.inputs[3].get();e.splice(n,i),this.runOutput(0)}},__class__:K});var Q=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(n["armory.logicnode.ArrayStringNode"]=Q).__name__="armory.logicnode.ArrayStringNode",Q.__super__=c,Q.prototype=r(c.prototype,{value:null,initialized:null,get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,n=this.inputs;e<n.length;){var i=n[e];++e;var r=i.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:Q});var $=function(t){this.initialized=!1,this.value=[],c.call(this,t)};(n["armory.logicnode.ArrayVectorNode"]=$).__name__="armory.logicnode.ArrayVectorNode",$.__super__=c,$.prototype=r(c.prototype,{value:null,initialized:null,get:function(t){if(!this.initialized){this.initialized=!0;for(var e=0,n=this.inputs;e<n.length;){var i=n[e];++e;var r=i.get();this.value.push(r)}}return 0==t?this.value:this.value.length},set:function(t){this.value=t},__class__:$});var tt=function(t){c.call(this,t)};(n["armory.logicnode.BlendActionNode"]=tt).__name__="armory.logicnode.BlendActionNode",tt.__super__=c,tt.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=this.inputs[3].get(),r=this.inputs[4].get();if(null!=e){var s=e.animation;null==s&&(s=e.getParentArmature(e.name)),s.blend(n,i,r),this.runOutput(0)}},__class__:tt});var et=function(t){this.iw=bi.identity(),this.w=null,this.m=null,this.notified=!1,c.call(this,t)};(n["armory.logicnode.BoneFKNode"]=et).__name__="armory.logicnode.BoneFKNode",et.__super__=c,et.prototype=r(c.prototype,{notified:null,m:null,w:null,iw:null,run:function(t){},__class__:et});var nt=function(t){this.notified=!1,c.call(this,t)};(n["armory.logicnode.BoneIKNode"]=nt).__name__="armory.logicnode.BoneIKNode",nt.__super__=c,nt.prototype=r(c.prototype,{goal:null,notified:null,run:function(t){},__class__:nt});var it=function(t,e){null==e&&(e=!1),c.call(this,t),this.value=e};(n["armory.logicnode.BooleanNode"]=it).__name__="armory.logicnode.BooleanNode",it.__super__=c,it.prototype=r(c.prototype,{value:null,get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:it});var rt=function(t){c.call(this,t)};(n["armory.logicnode.BranchNode"]=rt).__name__="armory.logicnode.BranchNode",rt.__super__=c,rt.prototype=r(c.prototype,{run:function(t){this.inputs[1].get()?this.runOutput(0):this.runOutput(1)},__class__:rt});var st=function(t){c.call(this,t)};(n["armory.logicnode.CallFunctionNode"]=st).__name__="armory.logicnode.CallFunctionNode",st.__super__=c,st.prototype=r(c.prototype,{result:null,run:function(t){var e=this.inputs[1].get();if(null!=e){for(var n=this.inputs[2].get(),i=[],r=3,s=this.inputs.length;r<s;){var a=r++;i.push(this.inputs[a].get())}var o=ft.field(e,n);null!=o&&(this.result=ft.callMethod(e,o,i)),this.runOutput(0)}},get:function(t){return this.result},__class__:st});var at=function(t){this.callTree=null,c.call(this,t)};(n["armory.logicnode.CallGroupNode"]=at).__name__="armory.logicnode.CallGroupNode",at.__super__=c,at.prototype=r(c.prototype,{property0:null,callTree:null,run:function(t){if(null==this.callTree){var e=q.resolveClass(this.property0);this.callTree=q.createInstance(e,[]),this.callTree.object=this.tree.object,this.callTree.add()}null!=this.callTree._init&&this.callTree._init[0](),this.runOutput(0)},__class__:at});var ot=function(t){c.call(this,t)};(n["armory.logicnode.CallHaxeStaticNode"]=ot).__name__="armory.logicnode.CallHaxeStaticNode",ot.__super__=c,ot.prototype=r(c.prototype,{result:null,run:function(t){var e=this.inputs[1].get();if(""!=e){var n=e.lastIndexOf("."),i=ut.substr(e,0,n),r=q.resolveClass(i),s=ut.substr(e,n+1,null);this.result=ft.callMethod(r,ft.field(r,s),[this.tree])}this.runOutput(0)},get:function(t){return this.result},__class__:ot});var lt=function(t){c.call(this,t)};(n["armory.logicnode.CanvasSetLocationNode"]=lt).__name__="armory.logicnode.CanvasSetLocationNode",lt.__super__=c,lt.prototype=r(c.prototype,{canvas:null,element:null,newX:null,newY:null,update:function(){this.canvas.get_ready()&&(this.tree.removeUpdate(Fo(this,this.update)),this.canvas.getElement(this.element).x=this.newX,this.canvas.getElement(this.element).y=this.newY,this.runOutput(0))},run:function(t){this.element=this.inputs[1].get(),this.newX=this.inputs[2].get(),this.newY=this.inputs[3].get(),this.canvas=br.active.getTrait(ji),null==this.canvas&&(this.canvas=br.active.camera.getTrait(ji)),this.tree.notifyOnUpdate(Fo(this,this.update)),this.update()},__class__:lt});var ht=function(t){c.call(this,t)};(n["armory.logicnode.CanvasSetTextNode"]=ht).__name__="armory.logicnode.CanvasSetTextNode",ht.__super__=c,ht.prototype=r(c.prototype,{canvas:null,element:null,text:null,update:function(){this.canvas.get_ready()&&(this.tree.removeUpdate(Fo(this,this.update)),this.canvas.getElement(this.element).text=this.text,this.runOutput(0))},run:function(t){this.element=this.inputs[1].get(),this.text=pt.string(this.inputs[2].get()),this.canvas=br.active.getTrait(ji),null==this.canvas&&(this.canvas=br.active.camera.getTrait(ji)),this.tree.notifyOnUpdate(Fo(this,this.update)),this.update()},__class__:ht});var _t=function(t){this.v=new wi,c.call(this,t)};(n["armory.logicnode.CastPhysicsRayNode"]=_t).__name__="armory.logicnode.CastPhysicsRayNode",_t.__super__=c,_t.prototype=r(c.prototype,{v:null,get:function(t){this.inputs[0].get(),this.inputs[1].get();return null},__class__:_t});var ct=function(t){c.call(this,t)};(n["armory.logicnode.ClearParentNode"]=ct).__name__="armory.logicnode.ClearParentNode",ct.__super__=c,ct.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=e.parent&&(e.parent.removeChild(e,n),br.active.root.addChild(e,!1),this.runOutput(0))},__class__:ct});var dt=function(t,e,n,i,r){null==r&&(r=1),null==i&&(i=.8),null==n&&(n=.8),null==e&&(e=.8),this.value=new wi,c.call(this,t),this.value.set(e,n,i,r)};(n["armory.logicnode.ColorNode"]=dt).__name__="armory.logicnode.ColorNode",dt.__super__=c,dt.prototype=r(c.prototype,{value:null,get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:dt});var gt=function(t){c.call(this,t)};(n["armory.logicnode.CompareNode"]=gt).__name__="armory.logicnode.CompareNode",gt.__super__=c,gt.prototype=r(c.prototype,{property0:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get(),i=!1;switch(this.property0){case"Equal":i=e==n;break;case"Greater Than":i=n<e;break;case"Greater Than or Equal":i=n<=e;break;case"Less Than":i=e<n;break;case"Less Than or Equal":i=e<=n;break;case"Not Equal":i=e!=n}return i},__class__:gt});var mt=function(t,e){null==e&&(e=""),c.call(this,t),this.value=e};(n["armory.logicnode.ConcatenateStringNode"]=mt).__name__="armory.logicnode.ConcatenateStringNode",mt.__super__=c,mt.prototype=r(c.prototype,{value:null,get:function(t){this.value="";for(var e=0,n=this.inputs;e<n.length;){var i=n[e];++e,this.value+=pt.string(i.get())}return this.value},__class__:mt});var vt=function(t){c.call(this,t)};(n["armory.logicnode.ContainsStringNode"]=vt).__name__="armory.logicnode.ContainsStringNode",vt.__super__=c,vt.prototype=r(c.prototype,{property0:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();if(null==e||null==n)return null;switch(this.property0){case"Contains":return 0<=e.indexOf(n);case"Ends With":return J.endsWith(e,n);case"Starts With":return J.startsWith(e,n)}return!1},__class__:vt});var yt=function(t){c.call(this,t)};(n["armory.logicnode.DegToRadNode"]=yt).__name__="armory.logicnode.DegToRadNode",yt.__super__=c,yt.prototype=r(c.prototype,{get:function(t){return.0174532924*this.inputs[0].get()},__class__:yt});var wt=function(t){c.call(this,t)};(n["armory.logicnode.DisplayInfoNode"]=wt).__name__="armory.logicnode.DisplayInfoNode",wt.__super__=c,wt.prototype=r(c.prototype,{get:function(t){return 0==t?Is.get_all()[0].get_width():Is.get_all()[0].get_height()},__class__:wt});var bt=function(t,e){c.call(this,t),this.value=null==e?{}:e};(n["armory.logicnode.DynamicNode"]=bt).__name__="armory.logicnode.DynamicNode",bt.__super__=c,bt.prototype=r(c.prototype,{value:null,get:function(t){return this.value},set:function(t){this.value=t},__class__:bt});var xt=function(t){c.call(this,t)};(n["armory.logicnode.ExpressionNode"]=xt).__name__="armory.logicnode.ExpressionNode",xt.__super__=c,xt.prototype=r(c.prototype,{property0:null,result:null,run:function(t){this.runOutput(0)},get:function(t){return this.result},__class__:xt});var St=function(t,e){null==e&&(e=0),c.call(this,t),this.value=e};(n["armory.logicnode.FloatNode"]=St).__name__="armory.logicnode.FloatNode",St.__super__=c,St.prototype=r(c.prototype,{value:null,get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:St});var Ct=function(t){this.args=[],c.call(this,t)};(n["armory.logicnode.FunctionNode"]=Ct).__name__="armory.logicnode.FunctionNode",Ct.__super__=c,Ct.prototype=r(c.prototype,{args:null,result:null,run:function(t){this.runOutput(0)},get:function(t){return this.args[t-1]},__class__:Ct});var kt=function(t){c.call(this,t)};(n["armory.logicnode.FunctionOutputNode"]=kt).__name__="armory.logicnode.FunctionOutputNode",kt.__super__=c,kt.prototype=r(c.prototype,{result:null,run:function(t){this.result=this.inputs[1].get(),this.runOutput(0)},__class__:kt});var It=function(t){this.coords=new wi,c.call(this,t)};(n["armory.logicnode.GamepadCoordsNode"]=It).__name__="armory.logicnode.GamepadCoordsNode",It.__super__=c,It.prototype=r(c.prototype,{coords:null,get:function(t){var e=this.inputs[0].get(),n=Jr.getGamepad(e);return 0==t?(this.coords.x=n.leftStick.x,this.coords.y=n.leftStick.y,this.coords):1==t?(this.coords.x=n.rightStick.x,this.coords.y=n.rightStick.y,this.coords):2==t?(this.coords.x=n.leftStick.movementX,this.coords.y=n.leftStick.movementY,this.coords):3==t?(this.coords.x=n.rightStick.movementX,this.coords.y=n.rightStick.movementY,this.coords):null},__class__:It});var Tt=function(t){c.call(this,t)};(n["armory.logicnode.GamepadNode"]=Tt).__name__="armory.logicnode.GamepadNode",Tt.__super__=c,Tt.prototype=r(c.prototype,{property0:null,property1:null,get:function(t){var e=this.inputs[0].get(),n=Jr.getGamepad(e);switch(this.property0){case"Down":return n.down(this.property1);case"Released":return n.released(this.property1)?1:0;case"Started":return n.started(this.property1)?1:0}return 0},__class__:Tt});var Nt=function(t){c.call(this,t)};(n["armory.logicnode.GateNode"]=Nt).__name__="armory.logicnode.GateNode",Nt.__super__=c,Nt.prototype=r(c.prototype,{property0:null,property1:null,run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=!1;switch(this.property0){case"Almost Equal":i=e instanceof wi?e.almostEquals(n,this.property1):Math.abs(e-n)<this.property1;break;case"And":i=!0;for(var r=1,s=this.inputs.length;r<s;){var a=r++;if(!this.inputs[a].get()){i=!1;break}}break;case"Equal":i=e instanceof wi?e.equals(n):e==n;break;case"Greater":i=n<e;break;case"Greater Equal":i=n<=e;break;case"Less":i=e<n;break;case"Less Equal":i=e<=n;break;case"Or":for(var o=1,l=this.inputs.length;o<l;){var u=o++;if(this.inputs[u].get()){i=!0;break}}}i?this.runOutput(0):this.runOutput(1)},__class__:Nt});var Mt=function(t){c.call(this,t)};(n["armory.logicnode.GetCameraFovNode"]=Mt).__name__="armory.logicnode.GetCameraFovNode",Mt.__super__=c,Mt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?0:e.data.raw.fov},__class__:Mt});var Ot=function(t){c.call(this,t)};(n["armory.logicnode.GetChildNode"]=Ot).__name__="armory.logicnode.GetChildNode",Ot.__super__=c,Ot.prototype=r(c.prototype,{property0:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();if(null==e||null==n)return null;switch(this.property0){case"By Name":return e.getChild(n);case"Contains":return this.contains(e,n);case"Ends With":return this.endsWith(e,n);case"Starts With":return this.startsWith(e,n)}return null},contains:function(t,e){if(0<=t.name.indexOf(e))return t;for(var n=0,i=t.children;n<i.length;){var r=i[n];++n;var s=this.contains(r,e);if(null!=s)return s}return null},startsWith:function(t,e){if(J.startsWith(t.name,e))return t;for(var n=0,i=t.children;n<i.length;){var r=i[n];++n;var s=this.contains(r,e);if(null!=s)return s}return null},endsWith:function(t,e){if(J.endsWith(t.name,e))return t;for(var n=0,i=t.children;n<i.length;){var r=i[n];++n;var s=this.contains(r,e);if(null!=s)return s}return null},__class__:Ot});var Et=function(t){c.call(this,t)};(n["armory.logicnode.GetChildrenNode"]=Et).__name__="armory.logicnode.GetChildrenNode",Et.__super__=c,Et.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.children},__class__:Et});var At=function(t){c.call(this,t)};(n["armory.logicnode.GetContactsNode"]=At).__name__="armory.logicnode.GetContactsNode",At.__super__=c,At.prototype=r(c.prototype,{get:function(t){this.inputs[0].get();return null},__class__:At});var Bt=function(t){c.call(this,t)};(n["armory.logicnode.GetDistanceNode"]=Bt).__name__="armory.logicnode.GetDistanceNode",Bt.__super__=c,Bt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();return null==e||null==n?0:wi.distance(e.transform.world.getLoc(),n.transform.world.getLoc())},__class__:Bt});var Lt=function(t){c.call(this,t)};(n["armory.logicnode.GetFirstContactNode"]=Lt).__name__="armory.logicnode.GetFirstContactNode",Lt.__super__=c,Lt.prototype=r(c.prototype,{get:function(t){this.inputs[0].get();return null},__class__:Lt});var Ft=function(t){c.call(this,t)};(n["armory.logicnode.GetGravityNode"]=Ft).__name__="armory.logicnode.GetGravityNode",Ft.__super__=c,Ft.prototype=r(c.prototype,{get:function(t){return null},__class__:Ft});var Wt=function(t){c.call(this,t)};(n["armory.logicnode.GetGroupNode"]=Wt).__name__="armory.logicnode.GetGroupNode",Wt.__super__=c,Wt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return br.active.groups.get(e)},__class__:Wt});var Rt=function(t){c.call(this,t)};(n["armory.logicnode.GetHaxePropertyNode"]=Rt).__name__="armory.logicnode.GetHaxePropertyNode",Rt.__super__=c,Rt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();return null==e?null:ft.getProperty(e,n)},__class__:Rt});var Dt=function(t){c.call(this,t)};(n["armory.logicnode.GetLocationNode"]=Dt).__name__="armory.logicnode.GetLocationNode",Dt.__super__=c,Dt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.transform.world.getLoc()},__class__:Dt});var Gt=function(t){c.call(this,t)};(n["armory.logicnode.GetMaterialNode"]=Gt).__name__="armory.logicnode.GetMaterialNode",Gt.__super__=c,Gt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.materials[0]},__class__:Gt});var Vt=function(t){c.call(this,t)};(n["armory.logicnode.GetMeshNode"]=Vt).__name__="armory.logicnode.GetMeshNode",Vt.__super__=c,Vt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.data},__class__:Vt});var Ht=function(t){c.call(this,t)};(n["armory.logicnode.GetNameNode"]=Ht).__name__="armory.logicnode.GetNameNode",Ht.__super__=c,Ht.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?"":e.name},__class__:Ht});var Pt=function(t){c.call(this,t)};(n["armory.logicnode.GetObjectNode"]=Pt).__name__="armory.logicnode.GetObjectNode",Pt.__super__=c,Pt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return br.active.getChild(e)},__class__:Pt});var zt=function(t){c.call(this,t)};(n["armory.logicnode.GetParentNode"]=zt).__name__="armory.logicnode.GetParentNode",zt.__super__=c,zt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.parent},__class__:zt});var Zt=function(t){c.call(this,t)};(n["armory.logicnode.GetPropertyNode"]=Zt).__name__="armory.logicnode.GetPropertyNode",Zt.__super__=c,Zt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();return null==e||null==e.properties?null:e.properties.get(n)},__class__:Zt});var Xt=function(t){c.call(this,t)};(n["armory.logicnode.GetRotationNode"]=Xt).__name__="armory.logicnode.GetRotationNode",Xt.__super__=c,Xt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.transform.rot.getEuler()},__class__:Xt});var jt=function(t){c.call(this,t)};(n["armory.logicnode.GetScaleNode"]=jt).__name__="armory.logicnode.GetScaleNode",jt.__super__=c,jt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.transform.scale},__class__:jt});var Yt=function(t){this.cname=null,c.call(this,t)};(n["armory.logicnode.GetTraitNode"]=Yt).__name__="armory.logicnode.GetTraitNode",Yt.__super__=c,Yt.prototype=r(c.prototype,{cname:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();return null==e?null:(null==this.cname&&(this.cname=q.resolveClass("arm."+n)),null==this.cname&&(this.cname=q.resolveClass("arm.node."+n)),e.getTrait(this.cname))},__class__:Yt});var Ut=function(t){c.call(this,t)};(n["armory.logicnode.GetTransformNode"]=Ut).__name__="armory.logicnode.GetTransformNode",Ut.__super__=c,Ut.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?null:e.transform.world},__class__:Ut});var Kt=function(t){c.call(this,t)};(n["armory.logicnode.GetVelocityNode"]=Kt).__name__="armory.logicnode.GetVelocityNode",Kt.__super__=c,Kt.prototype=r(c.prototype,{get:function(t){this.inputs[0].get();return null},__class__:Kt});var Qt=function(t){c.call(this,t)};(n["armory.logicnode.GetVisibleNode"]=Qt).__name__="armory.logicnode.GetVisibleNode",Qt.__super__=c,Qt.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return e.visible},__class__:Qt});var Jt=function(t){c.call(this,t)};(n["armory.logicnode.GlobalObjectNode"]=Jt).__name__="armory.logicnode.GlobalObjectNode",Jt.__super__=c,Jt.prototype=r(c.prototype,{get:function(t){return br.global},__class__:Jt});var qt=function(t){c.call(this,t)};(n["armory.logicnode.GoToLocationNode"]=qt).__name__="armory.logicnode.GoToLocationNode",qt.__super__=c,qt.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&this.runOutput(0)},__class__:qt});var $t=function(t){c.call(this,t)};(n["armory.logicnode.GroupNode"]=$t).__name__="armory.logicnode.GroupNode",$t.__super__=c,$t.prototype=r(c.prototype,{property0:null,get:function(t){return br.active.groups.get(this.property0)},__class__:$t});var te=function(t){c.call(this,t)};(n["armory.logicnode.GroupOutputNode"]=te).__name__="armory.logicnode.GroupOutputNode",te.__super__=c,te.prototype=r(c.prototype,{run:function(t){this.runOutput(0)},__class__:te});var ee=function(t){c.call(this,t)};(n["armory.logicnode.HasContactNode"]=ee).__name__="armory.logicnode.HasContactNode",ee.__super__=c,ee.prototype=r(c.prototype,{get:function(t){this.inputs[0].get(),this.inputs[1].get();return!1},__class__:ee});var ne=function(t,e){null==e&&(e=0),c.call(this,t),this.value=e};(n["armory.logicnode.IntegerNode"]=ne).__name__="armory.logicnode.IntegerNode",ne.__super__=c,ne.prototype=r(c.prototype,{value:null,get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:ne});var ie=function(t){this.c=!1,c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.InverseNode"]=ie).__name__="armory.logicnode.InverseNode",ie.__super__=c,ie.prototype=r(c.prototype,{c:null,run:function(t){this.c=!0},update:function(){this.c||this.runOutput(0),this.c=!1},__class__:ie});var re=function(t){c.call(this,t)};(n["armory.logicnode.IsFalseNode"]=re).__name__="armory.logicnode.IsFalseNode",re.__super__=c,re.prototype=r(c.prototype,{run:function(t){this.inputs[1].get()||this.runOutput(0)},__class__:re});var se=function(t){c.call(this,t)};(n["armory.logicnode.IsNoneNode"]=se).__name__="armory.logicnode.IsNoneNode",se.__super__=c,se.prototype=r(c.prototype,{run:function(t){null==this.inputs[1].get()&&this.runOutput(0)},__class__:se});var ae=function(t){c.call(this,t)};(n["armory.logicnode.IsNotNoneNode"]=ae).__name__="armory.logicnode.IsNotNoneNode",ae.__super__=c,ae.prototype=r(c.prototype,{run:function(t){null!=this.inputs[1].get()&&this.runOutput(0)},__class__:ae});var oe=function(t){c.call(this,t)};(n["armory.logicnode.IsTrueNode"]=oe).__name__="armory.logicnode.IsTrueNode",oe.__super__=c,oe.prototype=r(c.prototype,{run:function(t){this.inputs[1].get()&&this.runOutput(0)},__class__:oe});var le=function(t){c.call(this,t)};(n["armory.logicnode.KeyboardNode"]=le).__name__="armory.logicnode.KeyboardNode",le.__super__=c,le.prototype=r(c.prototype,{property0:null,property1:null,get:function(t){var e=Jr.getKeyboard();switch(this.property0){case"Down":return e.down(this.property1);case"Released":return e.released(this.property1);case"Started":return e.started(this.property1)}return!1},__class__:le});var ue=function(t,e){this.node=t,this.from=e};(n["armory.logicnode.LogicNodeInput"]=ue).__name__="armory.logicnode.LogicNodeInput",ue.prototype={node:null,from:null,get:function(){return this.node.get(this.from)},set:function(t){this.node.set(t)},__class__:ue};var he=function(){this.paused=!1,this.loopBreak=!1,h.call(this)};(n["armory.logicnode.LogicTree"]=he).__name__="armory.logicnode.LogicTree",he.__super__=h,he.prototype=r(h.prototype,{loopBreak:null,add:function(){},paused:null,pause:function(){if(!this.paused){if(this.paused=!0,null!=this._update)for(var t=0,e=this._update;t<e.length;){var n=e[t];++t,mr.removeUpdate(n)}if(null!=this._lateUpdate)for(var i=0,r=this._lateUpdate;i<r.length;){var s=r[i];++i,mr.removeLateUpdate(s)}}},resume:function(){if(this.paused){if(this.paused=!1,null!=this._update)for(var t=0,e=this._update;t<e.length;){var n=e[t];++t,mr.notifyOnUpdate(n)}if(null!=this._lateUpdate)for(var i=0,r=this._lateUpdate;i<r.length;){var s=r[i];++i,mr.notifyOnLateUpdate(s)}}},__class__:he});var _e=function(t){this.q=new xi,this.v2=new wi,this.v1=new wi,c.call(this,t)};(n["armory.logicnode.LookAtNode"]=_e).__name__="armory.logicnode.LookAtNode",_e.__super__=c,_e.prototype=r(c.prototype,{v1:null,v2:null,q:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();return null==e||null==n?null:(this.v1.set(0,0,1),this.v2.setFrom(n).sub(e).normalize(),this.q.fromTo(this.v1,this.v2),this.q.getEuler())},__class__:_e});var ce=function(t){c.call(this,t)};(n["armory.logicnode.LoopBreakNode"]=ce).__name__="armory.logicnode.LoopBreakNode",ce.__super__=c,ce.prototype=r(c.prototype,{run:function(t){this.tree.loopBreak=!0},__class__:ce});var de=function(t){c.call(this,t)};(n["armory.logicnode.LoopNode"]=de).__name__="armory.logicnode.LoopNode",de.__super__=c,de.prototype=r(c.prototype,{index:null,run:function(t){this.index=0;for(var e=this.inputs[1].get(),n=this.inputs[2].get();e<n;){var i=e++;if(this.index=i,this.runOutput(0),this.tree.loopBreak){this.tree.loopBreak=!1;break}}this.runOutput(2)},get:function(t){return this.index},__class__:de});var pe=function(t){this.value=null;var e=this;c.call(this,t),br.active.notifyOnInit(function(){e.get(0)})};(n["armory.logicnode.MaterialNode"]=pe).__name__="armory.logicnode.MaterialNode",pe.__super__=c,pe.prototype=r(c.prototype,{property0:null,value:null,get:function(t){var e=this;return null!=this.property0&&Cr.getMaterial(br.active.raw.name,this.property0,function(t){e.value=t}),this.value},set:function(t){this.value=t},__class__:pe});var ge=function(t){c.call(this,t)};(n["armory.logicnode.MathNode"]=ge).__name__="armory.logicnode.MathNode",ge.__super__=c,ge.prototype=r(c.prototype,{property0:null,property1:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get(),i=0;switch(this.property0){case"Abs":i=Math.abs(e);break;case"Add":i=e+n;break;case"Arccosine":i=Math.acos(e);break;case"Arcsine":i=Math.asin(e);break;case"Arctan2":i=Math.atan2(e,n);break;case"Arctangent":i=Math.atan(e);break;case"Ceil":i=Math.ceil(e);break;case"Cosine":i=Math.cos(e);break;case"Divide":i=e/n;break;case"Floor":i=Math.floor(e);break;case"Fract":i=Fr.fract(e);break;case"Greater Than":i=n<e?1:0;break;case"Less Than":i=e<n?1:0;break;case"Logarithm":i=Math.log(e);break;case"Max":i=Math.max(e,n);break;case"Min":i=Math.min(e,n);break;case"Modulo":i=e%n;break;case"Multiply":i=e*n;break;case"Power":i=Math.pow(e,n);break;case"Round":i=Math.round(e);break;case"Sine":i=Math.sin(e);break;case"Square Root":i=Math.sqrt(e);break;case"Subtract":i=e-n;break;case"Tangent":i=Math.tan(e)}return"true"==this.property1&&(i=i<0?0:1<i?1:i),i},__class__:ge});var fe=function(t){this.m=bi.identity(),c.call(this,t)};(n["armory.logicnode.MatrixMathNode"]=fe).__name__="armory.logicnode.MatrixMathNode",fe.__super__=c,fe.prototype=r(c.prototype,{property0:null,m:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();return null==e||null==n?null:(this.m.setFrom(e),"Multiply"==this.property0&&this.m.multmat(n),this.m)},__class__:fe});var me=function(t){c.call(this,t)};(n["armory.logicnode.MergeNode"]=me).__name__="armory.logicnode.MergeNode",me.__super__=c,me.prototype=r(c.prototype,{run:function(t){this.runOutput(0)},__class__:me});var ve=function(t){this.value=null;var e=this;c.call(this,t),br.active.notifyOnInit(function(){e.get(0)})};(n["armory.logicnode.MeshNode"]=ve).__name__="armory.logicnode.MeshNode",ve.__super__=c,ve.prototype=r(c.prototype,{property0:null,value:null,get:function(t){var e=this;return Cr.getMesh("mesh_"+this.property0,this.property0,function(t){e.value=t}),this.value},set:function(t){this.value=t},__class__:ve});var ye=function(t){this.ease=null,c.call(this,t)};(n["armory.logicnode.MixNode"]=ye).__name__="armory.logicnode.MixNode",ye.__super__=c,ye.prototype=r(c.prototype,{property0:null,property1:null,property2:null,ease:null,init:function(){switch(this.property0){case"Back":this.ease="In"==this.property1?ls.easeBackIn:"Out"==this.property1?ls.easeBackOut:ls.easeBackInOut;break;case"Circ":this.ease="In"==this.property1?ls.easeCircIn:"Out"==this.property1?ls.easeCircOut:ls.easeCircInOut;break;case"Cubic":this.ease="In"==this.property1?ls.easeCubicIn:"Out"==this.property1?ls.easeCubicOut:ls.easeCubicInOut;break;case"Expo":this.ease="In"==this.property1?ls.easeExpoIn:"Out"==this.property1?ls.easeExpoOut:ls.easeExpoInOut;break;case"Linear":this.ease=ls.easeLinear;break;case"Quad":this.ease="In"==this.property1?ls.easeQuadIn:"Out"==this.property1?ls.easeQuadOut:ls.easeQuadInOut;break;case"Quart":this.ease="In"==this.property1?ls.easeQuartIn:"Out"==this.property1?ls.easeQuartOut:ls.easeQuartInOut;break;case"Quint":this.ease="In"==this.property1?ls.easeQuintIn:"Out"==this.property1?ls.easeQuintOut:ls.easeQuintInOut;break;case"Sine":this.ease="In"==this.property1?ls.easeSineIn:"Out"==this.property1?ls.easeSineOut:ls.easeSineInOut;break;default:this.ease=ls.easeLinear}},get:function(t){null==this.ease&&this.init();var e=this.inputs[0].get(),n=this.inputs[1].get(),i=n+(this.inputs[2].get()-n)*this.ease(e);return"true"==this.property2&&(i=Fr.clamp(i,0,1)),i},__class__:ye});var we=function(t){this.coords=new wi,c.call(this,t)};(n["armory.logicnode.MouseCoordsNode"]=we).__name__="armory.logicnode.MouseCoordsNode",we.__super__=c,we.prototype=r(c.prototype,{coords:null,get:function(t){var e=Jr.getMouse();return 0==t?(this.coords.x=e.x,this.coords.y=e.y,this.coords):1==t?(this.coords.x=e.movementX,this.coords.y=e.movementY,this.coords):e.wheelDelta},__class__:we});var be=function(t){c.call(this,t)};(n["armory.logicnode.MouseNode"]=be).__name__="armory.logicnode.MouseNode",be.__super__=c,be.prototype=r(c.prototype,{property0:null,property1:null,get:function(t){var e=Jr.getMouse();switch(this.property0){case"Down":return e.down(this.property1);case"Moved":return e.moved;case"Released":return e.released(this.property1);case"Started":return e.started(this.property1)}return!1},__class__:be});var xe=function(t){var e=this;c.call(this,t),br.active.notifyOnInit(function(){e.get(0)})};(n["armory.logicnode.NavigableLocationNode"]=xe).__name__="armory.logicnode.NavigableLocationNode",xe.__super__=c,xe.prototype=r(c.prototype,{loc:null,get:function(t){return this.loc},__class__:xe});var Se=function(t){c.call(this,t)};(n["armory.logicnode.NoneNode"]=Se).__name__="armory.logicnode.NoneNode",Se.__super__=c,Se.prototype=r(c.prototype,{get:function(t){return null},__class__:Se});var Ce=function(t){c.call(this,t)};(n["armory.logicnode.NotNode"]=Ce).__name__="armory.logicnode.NotNode",Ce.__super__=c,Ce.prototype=r(c.prototype,{property0:null,get:function(t){return!this.inputs[0].get()},__class__:Ce});var ke=function(t){c.call(this,t)};(n["armory.logicnode.NullNode"]=ke).__name__="armory.logicnode.NullNode",ke.__super__=c,ke.prototype=r(c.prototype,{get:function(t){return null},__class__:ke});var Ie=function(t,e){null==e&&(e=""),this.value=null,this.objectName=e,c.call(this,t)};(n["armory.logicnode.ObjectNode"]=Ie).__name__="armory.logicnode.ObjectNode",Ie.__super__=c,Ie.prototype=r(c.prototype,{objectName:null,value:null,get:function(t){return 0<this.inputs.length?this.inputs[0].get():(null==this.value&&(this.value=""!=this.objectName?br.active.getChild(this.objectName):this.tree.object),this.value)},set:function(t){0<this.inputs.length?this.inputs[0].set(t):(this.objectName=t.name,this.value=t)},__class__:Ie});var Te=function(t){c.call(this,t),t.notifyOnInit(Fo(this,this.init))};(n["armory.logicnode.OnActionMarkerNode"]=Te).__name__="armory.logicnode.OnActionMarkerNode",Te.__super__=c,Te.prototype=r(c.prototype,{init:function(){var t=this,e=this.inputs[0].get(),n=this.inputs[1].get();if(null!=e){var i=e.animation;null==i&&(i=e.getParentArmature(e.name)),i.notifyOnMarker(n,function(){t.runOutput(0)})}},__class__:Te});var Ne=function(t){this.lastContact=!1,c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.OnContactNode"]=Ne).__name__="armory.logicnode.OnContactNode",Ne.__super__=c,Ne.prototype=r(c.prototype,{property0:null,lastContact:null,update:function(){var t=this.inputs[0].get(),e=this.inputs[1].get();null==t&&(t=this.tree.object),null==e&&(e=this.tree.object);var n=!1;switch(this.property0){case"Begin":n=!1;break;case"End":n=this.lastContact;break;case"Overlap":n=!1}this.lastContact=!1,n&&this.runOutput(0)},__class__:Ne});var Me=function(t){this.listener=null,c.call(this,t),t.notifyOnRemove(Fo(this,this.onRemove))};(n["armory.logicnode.OnEventNode"]=Me).__name__="armory.logicnode.OnEventNode",Me.__super__=c,Me.prototype=r(c.prototype,{_property0:null,listener:null,get_property0:function(){return this._property0},set_property0:function(t){return this.listener=zi.add(t,Fo(this,this.onEvent),this.tree.object.uid),this._property0=t},onEvent:function(){this.runOutput(0)},onRemove:function(){null!=this.listener&&zi.removeListener(this.listener)},__class__:Me,__properties__:{set_property0:"set_property0",get_property0:"get_property0"}});var Oe=function(t){c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.OnGamepadNode"]=Oe).__name__="armory.logicnode.OnGamepadNode",Oe.__super__=c,Oe.prototype=r(c.prototype,{property0:null,property1:null,update:function(){var t=this.inputs[0].get(),e=Jr.getGamepad(t);if(null!=e){var n=!1;switch(this.property0){case"Down":n=0<e.down(this.property1);break;case"Released":n=e.released(this.property1);break;case"Started":n=e.started(this.property1)}n&&this.runOutput(0)}},__class__:Oe});var Ee=function(t){c.call(this,t),t.notifyOnInit(Fo(this,this.init))};(n["armory.logicnode.OnInitNode"]=Ee).__name__="armory.logicnode.OnInitNode",Ee.__super__=c,Ee.prototype=r(c.prototype,{init:function(){this.runOutput(0)},__class__:Ee});var Ae=function(t){c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.OnKeyboardNode"]=Ae).__name__="armory.logicnode.OnKeyboardNode",Ae.__super__=c,Ae.prototype=r(c.prototype,{property0:null,property1:null,update:function(){var t=Jr.getKeyboard(),e=!1;switch(this.property0){case"Down":e=t.down(this.property1);break;case"Released":e=t.released(this.property1);break;case"Started":e=t.started(this.property1)}e&&this.runOutput(0)},__class__:Ae});var Be=function(t){c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.OnMouseNode"]=Be).__name__="armory.logicnode.OnMouseNode",Be.__super__=c,Be.prototype=r(c.prototype,{property0:null,property1:null,update:function(){var t=Jr.getMouse(),e=!1;switch(this.property0){case"Down":e=t.down(this.property1);break;case"Moved":e=t.moved;break;case"Released":e=t.released(this.property1);break;case"Started":e=t.started(this.property1)}e&&this.runOutput(0)},__class__:Be});var Le=function(t){c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.OnSurfaceNode"]=Le).__name__="armory.logicnode.OnSurfaceNode",Le.__super__=c,Le.prototype=r(c.prototype,{property0:null,update:function(){var t=Jr.getSurface(),e=!1;switch(this.property0){case"Moved":e=t.moved;break;case"Released":e=t.released();break;case"Started":e=t.started();break;case"Touched":e=t.down()}e&&this.runOutput(0)},__class__:Le});var Fe=function(t){this.repeat=!1,this.duration=0,c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.OnTimerNode"]=Fe).__name__="armory.logicnode.OnTimerNode",Fe.__super__=c,Fe.prototype=r(c.prototype,{duration:null,repeat:null,update:function(){this.duration<=0&&(this.duration=this.inputs[0].get(),this.repeat=this.inputs[1].get()),this.duration-=os.get_delta(),this.duration<=0&&(this.repeat||this.tree.removeUpdate(Fo(this,this.update)),this.runOutput(0))},__class__:Fe});var We=function(t){c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.OnUpdateNode"]=We).__name__="armory.logicnode.OnUpdateNode",We.__super__=c,We.prototype=r(c.prototype,{update:function(){this.runOutput(0)},__class__:We});var Re=function(t){c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.OnVirtualButtonNode"]=Re).__name__="armory.logicnode.OnVirtualButtonNode",Re.__super__=c,Re.prototype=r(c.prototype,{property0:null,property1:null,update:function(){var t=Jr.getVirtualButton(this.property1);if(null!=t){var e=!1;switch(this.property0){case"Down":e=t.down;break;case"Released":e=t.released;break;case"Started":e=t.started}e&&this.runOutput(0)}},__class__:Re});var De=function(t){this.l2=new wi,this.l1=new wi,this.lastOverlap=!1,c.call(this,t),t.notifyOnUpdate(Fo(this,this.update))};(n["armory.logicnode.OnVolumeTriggerNode"]=De).__name__="armory.logicnode.OnVolumeTriggerNode",De.__super__=c,De.prototype=r(c.prototype,{property0:null,lastOverlap:null,l1:null,l2:null,update:function(){var t=this.inputs[0].get(),e=this.inputs[1].get();if(null!=t){null==e&&(e=this.tree.object);var n=t.transform,i=e.transform;this.l1.set(n.worldx(),n.worldy(),n.worldz()),this.l2.set(i.worldx(),i.worldy(),i.worldz());var r=n.dim,s=i.dim,a=this.l1.x+r.x/2>this.l2.x-s.x/2&&this.l1.x-r.x/2<this.l2.x+s.x/2&&this.l1.y+r.y/2>this.l2.y-s.y/2&&this.l1.y-r.y/2<this.l2.y+s.y/2&&this.l1.z+r.z/2>this.l2.z-s.z/2&&this.l1.z-r.z/2<this.l2.z+s.z/2,o=!1;switch(this.property0){case"Enter":o=a&&!this.lastOverlap;break;case"Leave":o=!a&&this.lastOverlap;break;case"Overlap":o=a}this.lastOverlap=a,o&&this.runOutput(0)}},__class__:De});var Ge=function(t){c.call(this,t)};(n["armory.logicnode.PauseActionNode"]=Ge).__name__="armory.logicnode.PauseActionNode",Ge.__super__=c,Ge.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var n=e.animation;null==n&&(n=e.getParentArmature(e.name)),n.pause(),this.runOutput(0)}},__class__:Ge});var Ve=function(t){c.call(this,t)};(n["armory.logicnode.PauseSoundNode"]=Ve).__name__="armory.logicnode.PauseSoundNode",Ve.__super__=c,Ve.prototype=r(c.prototype,{run:function(t){var e=hs.__cast(this.inputs[1].get(),Zr);null!=e&&(e.pause(),this.runOutput(0))},__class__:Ve});var He=function(t){c.call(this,t)};(n["armory.logicnode.PauseTilesheetNode"]=He).__name__="armory.logicnode.PauseTilesheetNode",He.__super__=c,He.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.tilesheet.pause(),this.runOutput(0))},__class__:He});var Pe=function(t){c.call(this,t)};(n["armory.logicnode.PauseTraitNode"]=Pe).__name__="armory.logicnode.PauseTraitNode",Pe.__super__=c,Pe.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&e instanceof he&&(hs.__cast(e,he).pause(),this.runOutput(0))},__class__:Pe});var ze=function(t){this.loc=new wi,c.call(this,t)};(n["armory.logicnode.PickLocationNode"]=ze).__name__="armory.logicnode.PickLocationNode",ze.__super__=c,ze.prototype=r(c.prototype,{loc:null,get:function(t){this.inputs[0].get(),this.inputs[1].get();return null},__class__:ze});var Ze=function(t){this.v=new wi,c.call(this,t)};(n["armory.logicnode.PickObjectNode"]=Ze).__name__="armory.logicnode.PickObjectNode",Ze.__super__=c,Ze.prototype=r(c.prototype,{v:null,get:function(t){this.inputs[0].get();return null},__class__:Ze});var Xe=function(t){c.call(this,t)};(n["armory.logicnode.PlayActionNode"]=Xe).__name__="armory.logicnode.PlayActionNode",Xe.__super__=c,Xe.prototype=r(c.prototype,{run:function(t){var e=this,n=this.inputs[1].get(),i=this.inputs[2].get(),r=3<this.inputs.length?this.inputs[3].get():.2;if(null!=n){var s=n.animation;null==s&&(s=n.getParentArmature(n.name)),s.play(i,function(){e.runOutput(1)},r),this.runOutput(0)}},__class__:Xe});var je=function(t){c.call(this,t)};(n["armory.logicnode.PlaySoundNode"]=je).__name__="armory.logicnode.PlaySoundNode",je.__super__=c,je.prototype=r(c.prototype,{run:function(t){var e=hs.__cast(this.inputs[1].get(),Zr);null!=e&&(e.play(),this.runOutput(0))},__class__:je});var Ye=function(t){c.call(this,t)};(n["armory.logicnode.PlaySoundRawNode"]=Ye).__name__="armory.logicnode.PlaySoundRawNode",Ye.__super__=c,Ye.prototype=r(c.prototype,{property0:null,run:function(t){Cr.getSound(this.property0,function(t){Qr.play(t,!1)}),this.runOutput(0)},__class__:Ye});var Ue=function(t){c.call(this,t)};(n["armory.logicnode.PlayTilesheetNode"]=Ue).__name__="armory.logicnode.PlayTilesheetNode",Ue.__super__=c,Ue.prototype=r(c.prototype,{run:function(t){var e=this,n=this.inputs[1].get(),i=this.inputs[2].get();null!=n&&(n.tilesheet.play(i,function(){e.runOutput(1)}),this.runOutput(0))},__class__:Ue});var Ke=function(t){c.call(this,t)};(n["armory.logicnode.PrintNode"]=Ke).__name__="armory.logicnode.PrintNode",Ke.__super__=c,Ke.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();Ji.trace(e,{fileName:"Sources/armory/logicnode/PrintNode.hx",lineNumber:12,className:"armory.logicnode.PrintNode",methodName:"run"}),this.runOutput(0)},__class__:Ke});var Qe=function(t,e,n,i,r){this.value=new xi,c.call(this,t),null!=e&&(this.addInput(new St(t,e),0),this.addInput(new St(t,n),0),this.addInput(new St(t,i),0),this.addInput(new St(t,r),0))};(n["armory.logicnode.QuaternionNode"]=Qe).__name__="armory.logicnode.QuaternionNode",Qe.__super__=c,Qe.prototype=r(c.prototype,{value:null,get:function(t){return this.value.x=this.inputs[0].get(),this.value.y=this.inputs[1].get(),this.value.z=this.inputs[2].get(),this.value.w=this.inputs[3].get(),this.value},set:function(t){this.value=t},__class__:Qe});var Je=function(t){c.call(this,t)};(n["armory.logicnode.RadToDegNode"]=Je).__name__="armory.logicnode.RadToDegNode",Je.__super__=c,Je.prototype=r(c.prototype,{get:function(t){return 57.29578*this.inputs[0].get()},__class__:Je});var qe=function(t){c.call(this,t)};(n["armory.logicnode.RandomBooleanNode"]=qe).__name__="armory.logicnode.RandomBooleanNode",qe.__super__=c,qe.prototype=r(c.prototype,{get:function(t){return 0==pt.random(2)},__class__:qe});var $e=function(t){this.v=new wi,c.call(this,t)};(n["armory.logicnode.RandomColorNode"]=$e).__name__="armory.logicnode.RandomColorNode",$e.__super__=c,$e.prototype=r(c.prototype,{v:null,get:function(t){var e=Math.random(),n=Math.random(),i=Math.random();return this.v.set(e,n,i),this.v},__class__:$e});var tn=function(t){c.call(this,t)};(n["armory.logicnode.RandomFloatNode"]=tn).__name__="armory.logicnode.RandomFloatNode",tn.__super__=c,tn.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();return e+Math.random()*(n-e)},__class__:tn});var en=function(t){c.call(this,t)};(n["armory.logicnode.RandomIntegerNode"]=en).__name__="armory.logicnode.RandomIntegerNode",en.__super__=c,en.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();return e+pt.random(n-e)},__class__:en});var nn=function(t){this.v=new wi,c.call(this,t)};(n["armory.logicnode.RandomVectorNode"]=nn).__name__="armory.logicnode.RandomVectorNode",nn.__super__=c,nn.prototype=r(c.prototype,{v:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get(),i=e.x+Math.random()*(n.x-e.x),r=e.y+Math.random()*(n.y-e.y),s=e.z+Math.random()*(n.z-e.z);return this.v.set(i,r,s),this.v},__class__:nn});var rn=function(t){c.call(this,t)};(n["armory.logicnode.ReadFileNode"]=rn).__name__="armory.logicnode.ReadFileNode",rn.__super__=c,rn.prototype=r(c.prototype,{data:null,run:function(t){var e=this,n=this.inputs[1].get();Cr.getBlob(n,function(t){e.data=t.toString(),e.runOutput(0)})},get:function(t){return this.data},__class__:rn});var sn=function(t){c.call(this,t)};(n["armory.logicnode.ReadJsonNode"]=sn).__name__="armory.logicnode.ReadJsonNode",sn.__super__=c,sn.prototype=r(c.prototype,{data:null,run:function(t){var n=this,e=this.inputs[1].get();Cr.getBlob(e,function(t){var e=t.toString();n.data=JSON.parse(e),n.runOutput(0)})},get:function(t){return this.data},__class__:sn});var an=function(t){c.call(this,t)};(n["armory.logicnode.ReadStorageNode"]=an).__name__="armory.logicnode.ReadStorageNode",an.parseArg=function(t){if("true"==t)return!0;if("false"==t)return!1;if("'"==t.charAt(0))return J.replace(t,"'","");if("["==t.charAt(0)){t=J.replace(t,"[",""),t=J.replace(t,"]","");for(var e=[],n=(t=J.replace(t," ","")).split(","),i=0;i<n.length;){var r=n[i];++i,e.push(an.parseArg(r))}return e}var s=pt.parseFloat(t),a=pt.parseInt(t);return s==a?a:s},an.__super__=c,an.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get(),n=as.get_data();if(null==n)return null;var i=ft.field(n,e);return null==i&&(i=an.parseArg(this.inputs[1].get())),i},__class__:an});var on=function(t){c.call(this,t)};(n["armory.logicnode.RemoveActiveSceneNode"]=on).__name__="armory.logicnode.RemoveActiveSceneNode",on.__super__=c,on.prototype=r(c.prototype,{run:function(t){br.active.remove(),this.runOutput(0)},__class__:on});var ln=function(t){c.call(this,t)};(n["armory.logicnode.RemoveGroupNode"]=ln).__name__="armory.logicnode.RemoveGroupNode",ln.__super__=c,ln.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();br.active.groups.remove(e),this.runOutput(0)},__class__:ln});var un=function(t){c.call(this,t)};(n["armory.logicnode.RemoveObjectNode"]=un).__name__="armory.logicnode.RemoveObjectNode",un.__super__=c,un.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.remove(),this.runOutput(0))},__class__:un});var hn=function(t){c.call(this,t)};(n["armory.logicnode.RemoveTraitNode"]=hn).__name__="armory.logicnode.RemoveTraitNode",hn.__super__=c,hn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.remove(),this.runOutput(0))},__class__:hn});var _n=function(t){c.call(this,t)};(n["armory.logicnode.ResumeActionNode"]=_n).__name__="armory.logicnode.ResumeActionNode",_n.__super__=c,_n.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(null!=e){var n=e.animation;null==n&&(n=e.getParentArmature(e.name)),n.resume(),this.runOutput(0)}},__class__:_n});var cn=function(t){c.call(this,t)};(n["armory.logicnode.ResumeTilesheetNode"]=cn).__name__="armory.logicnode.ResumeTilesheetNode",cn.__super__=c,cn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.tilesheet.resume(),this.runOutput(0))},__class__:cn});var dn=function(t){c.call(this,t)};(n["armory.logicnode.ResumeTraitNode"]=dn).__name__="armory.logicnode.ResumeTraitNode",dn.__super__=c,dn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&e instanceof he&&(hs.__cast(e,he).resume(),this.runOutput(0))},__class__:dn});var pn=function(t){this.q=new xi,c.call(this,t)};(n["armory.logicnode.RotateObjectNode"]=pn).__name__="armory.logicnode.RotateObjectNode",pn.__super__=c,pn.prototype=r(c.prototype,{q:null,run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&(this.q.fromEuler(n.x,n.y,n.z),e.transform.rot.mult(this.q),e.transform.buildMatrix(),this.runOutput(0))},__class__:pn});var gn=function(t){c.call(this,t)};(n["armory.logicnode.ScaleObjectNode"]=gn).__name__="armory.logicnode.ScaleObjectNode",gn.__super__=c,gn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&(e.transform.scale.add(n),e.transform.buildMatrix(),this.runOutput(0))},__class__:gn});var fn=function(t){c.call(this,t)};(n["armory.logicnode.SceneNode"]=fn).__name__="armory.logicnode.SceneNode",fn.__super__=c,fn.prototype=r(c.prototype,{property0:null,get:function(t){return this.property0},set:function(t){this.property0=t},__class__:fn});var mn=function(t){c.call(this,t)};(n["armory.logicnode.SceneRootNode"]=mn).__name__="armory.logicnode.SceneRootNode",mn.__super__=c,mn.prototype=r(c.prototype,{get:function(t){return br.active.root},__class__:mn});var vn=function(t){this.m=bi.identity(),this.v=new wi,c.call(this,t)};(n["armory.logicnode.ScreenToWorldSpaceNode"]=vn).__name__="armory.logicnode.ScreenToWorldSpaceNode",vn.__super__=c,vn.prototype=r(c.prototype,{property0:null,v:null,m:null,get:function(t){var e=this.inputs[0].get();if(null==e)return null;var n=br.active.camera;return this.v.setFrom(e),this.m.getInverse(n.P),this.v.applyproj(this.m),this.m.getInverse(n.V),this.v.applyproj(this.m),this.v},__class__:vn});var yn=function(t){c.call(this,t)};(n["armory.logicnode.ScriptNode"]=yn).__name__="armory.logicnode.ScriptNode",yn.__super__=c,yn.prototype=r(c.prototype,{property0:null,result:null,run:function(t){this.inputs[1].get();this.runOutput(0)},get:function(t){return this.result},__class__:yn});var wn=function(t){c.call(this,t)};(n["armory.logicnode.SelfNode"]=wn).__name__="armory.logicnode.SelfNode",wn.__super__=c,wn.prototype=r(c.prototype,{get:function(t){return this.tree.object},__class__:wn});var bn=function(t){c.call(this,t)};(n["armory.logicnode.SelfTraitNode"]=bn).__name__="armory.logicnode.SelfTraitNode",bn.__super__=c,bn.prototype=r(c.prototype,{get:function(t){return this.tree},__class__:bn});var xn=function(t){this.entries=null,c.call(this,t)};(n["armory.logicnode.SendEventNode"]=xn).__name__="armory.logicnode.SendEventNode",xn.__super__=c,xn.prototype=r(c.prototype,{entries:null,run:function(t){var e=this.inputs[1].get(),n=2<this.inputs.length?this.inputs[2].get():this.tree.object;if(null!=n){var i=zi.get(e);if(null!=i){this.entries=[];for(var r=0;r<i.length;){var s=i[r];++r,s.mask==n.uid&&this.entries.push(s)}}if(null!=this.entries){for(var a=0,o=this.entries;a<o.length;){var l=o[a];++a,l.onEvent()}this.runOutput(0)}}},__class__:xn});var Sn=function(t){this.entries=null,c.call(this,t)};(n["armory.logicnode.SendGlobalEventNode"]=Sn).__name__="armory.logicnode.SendGlobalEventNode",Sn.__super__=c,Sn.prototype=r(c.prototype,{entries:null,run:function(t){var e=this.inputs[1].get();if(this.entries=zi.get(e),null!=this.entries){for(var n=0,i=this.entries;n<i.length;){var r=i[n];++n,r.onEvent()}this.runOutput(0)}},__class__:Sn});var Cn=function(t){this.coords=new wi,c.call(this,t)};(n["armory.logicnode.SensorCoordsNode"]=Cn).__name__="armory.logicnode.SensorCoordsNode",Cn.__super__=c,Cn.prototype=r(c.prototype,{coords:null,get:function(t){var e=Jr.getSensor();return this.coords.x=e.x,this.coords.y=e.y,this.coords.z=e.z,this.coords},__class__:Cn});var kn=function(t){c.call(this,t)};(n["armory.logicnode.SeparateColorNode"]=kn).__name__="armory.logicnode.SeparateColorNode",kn.__super__=c,kn.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?0:0==t?e.x:1==t?e.y:e.z},__class__:kn});var In=function(t){c.call(this,t)};(n["armory.logicnode.SeparateTransformNode"]=In).__name__="armory.logicnode.SeparateTransformNode",In.__super__=c,In.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();if(null==e)return null;var n=new wi,i=new xi,r=new wi;return e.decompose(n,i,r),0==t?n:1==t?i.getEuler():r},__class__:In});var Tn=function(t){c.call(this,t)};(n["armory.logicnode.SeparateVectorNode"]=Tn).__name__="armory.logicnode.SeparateVectorNode",Tn.__super__=c,Tn.prototype=r(c.prototype,{get:function(t){var e=this.inputs[0].get();return null==e?0:0==t?e.x:1==t?e.y:e.z},__class__:Tn});var Nn=function(t){c.call(this,t)};(n["armory.logicnode.SequenceNode"]=Nn).__name__="armory.logicnode.SequenceNode",Nn.__super__=c,Nn.prototype=r(c.prototype,{run:function(t){this.runOutput(0)},__class__:Nn});var Mn=function(t){c.call(this,t)};(n["armory.logicnode.SetActionSpeedNode"]=Mn).__name__="armory.logicnode.SetActionSpeedNode",Mn.__super__=c,Mn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();if(null!=e){var i=e.animation;null==i&&(i=e.getParentArmature(e.name)),i.speed=n,this.runOutput(0)}},__class__:Mn});var On=function(t){c.call(this,t)};(n["armory.logicnode.SetCameraFovNode"]=On).__name__="armory.logicnode.SetCameraFovNode",On.__super__=c,On.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&(e.data.raw.fov=n,e.buildProjection(),this.runOutput(0))},__class__:On});var En=function(t){c.call(this,t)};(n["armory.logicnode.SetCameraNode"]=En).__name__="armory.logicnode.SetCameraNode",En.__super__=c,En.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();null!=e&&(e.buildProjection(),br.active.camera=e,this.runOutput(0))},__class__:En});var An=function(t){c.call(this,t)};(n["armory.logicnode.SetGravityEnabledNode"]=An).__name__="armory.logicnode.SetGravityEnabledNode",An.__super__=c,An.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();this.inputs[2].get();null!=e&&this.runOutput(0)},__class__:An});var Bn=function(t){c.call(this,t)};(n["armory.logicnode.SetGravityNode"]=Bn).__name__="armory.logicnode.SetGravityNode",Bn.__super__=c,Bn.prototype=r(c.prototype,{run:function(t){null!=this.inputs[1].get()&&this.runOutput(0)},__class__:Bn});var Ln=function(t){c.call(this,t)};(n["armory.logicnode.SetHaxePropertyNode"]=Ln).__name__="armory.logicnode.SetHaxePropertyNode",Ln.__super__=c,Ln.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=this.inputs[3].get();null!=e&&(ft.setProperty(e,n,i),this.runOutput(0))},__class__:Ln});var Fn=function(t){c.call(this,t)};(n["armory.logicnode.SetLightColorNode"]=Fn).__name__="armory.logicnode.SetLightColorNode",Fn.__super__=c,Fn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&(e.data.raw.color[0]=n.x,e.data.raw.color[1]=n.y,e.data.raw.color[2]=n.z,this.runOutput(0))},__class__:Fn});var Wn=function(t){c.call(this,t)};(n["armory.logicnode.SetLightStrengthNode"]=Wn).__name__="armory.logicnode.SetLightStrengthNode",Wn.__super__=c,Wn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&(e.data.raw.strength="sun"==e.data.raw.type?.325*n:.026*n,this.runOutput(0))},__class__:Wn});var Rn=function(t){c.call(this,t)};(n["armory.logicnode.SetLocationNode"]=Rn).__name__="armory.logicnode.SetLocationNode",Rn.__super__=c,Rn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&(e.transform.loc.setFrom(n),e.transform.buildMatrix(),this.runOutput(0))},__class__:Rn});var Dn=function(t){c.call(this,t),Dn.registered||(Dn.registered=!0,Ur.externalTextureLinks.push(Dn.textureLink))};(n["armory.logicnode.SetMaterialImageParamNode"]=Dn).__name__="armory.logicnode.SetMaterialImageParamNode",Dn.textureLink=function(t,e,n){return Dn.map.get(n)},Dn.__super__=c,Dn.prototype=r(c.prototype,{run:function(t){var e=this;Dn.mat=this.inputs[1].get(),null!=Dn.mat&&(Cr.getImage(this.inputs[3].get(),function(t){Dn.map.set(e.inputs[2].get(),t)}),this.runOutput(0))},__class__:Dn});var Gn=function(t){c.call(this,t)};(n["armory.logicnode.SetMaterialNode"]=Gn).__name__="armory.logicnode.SetMaterialNode",Gn.__super__=c,Gn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();if(null!=e){for(var i=0,r=e.materials.length;i<r;){var s=i++;e.materials[s]=n}this.runOutput(0)}},__class__:Gn});var Vn=function(t){c.call(this,t),Vn.registered||(Vn.registered=!0,Ur.externalVec3Links.push(Vn.vec3Link))};(n["armory.logicnode.SetMaterialRgbParamNode"]=Vn).__name__="armory.logicnode.SetMaterialRgbParamNode",Vn.vec3Link=function(t,e,n){return Vn.map.get(n)},Vn.__super__=c,Vn.prototype=r(c.prototype,{run:function(t){Vn.mat=this.inputs[1].get(),null!=Vn.mat&&(Vn.map.set(this.inputs[2].get(),this.inputs[3].get()),this.runOutput(0))},__class__:Vn});var Hn=function(t){c.call(this,t)};(n["armory.logicnode.SetMaterialSlotNode"]=Hn).__name__="armory.logicnode.SetMaterialSlotNode",Hn.__super__=c,Hn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=this.inputs[3].get();null!=e&&(i>=e.materials.length||(e.materials[i]=n,this.runOutput(0)))},__class__:Hn});var Pn=function(t){c.call(this,t),Pn.registered||(Pn.registered=!0,Ur.externalFloatLinks.push(Pn.floatLink))};(n["armory.logicnode.SetMaterialValueParamNode"]=Pn).__name__="armory.logicnode.SetMaterialValueParamNode",Pn.floatLink=function(t,e,n){return Pn.map.get(n)},Pn.__super__=c,Pn.prototype=r(c.prototype,{run:function(t){Pn.mat=this.inputs[1].get(),null!=Pn.mat&&(Pn.map.set(this.inputs[2].get(),this.inputs[3].get()),this.runOutput(0))},__class__:Pn});var zn=function(t){c.call(this,t)};(n["armory.logicnode.SetMeshNode"]=zn).__name__="armory.logicnode.SetMeshNode",zn.__super__=c,zn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&(e.data=n,this.runOutput(0))},__class__:zn});var Zn=function(t){c.call(this,t)};(n["armory.logicnode.SetMouseLockNode"]=Zn).__name__="armory.logicnode.SetMouseLockNode",Zn.__super__=c,Zn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=Jr.getMouse();e?n.lock():n.unlock(),this.runOutput(0)},__class__:Zn});var Xn=function(t){c.call(this,t)};(n["armory.logicnode.SetNameNode"]=Xn).__name__="armory.logicnode.SetNameNode",Xn.__super__=c,Xn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&(e.name=n,this.runOutput(0))},__class__:Xn});var jn=function(t){c.call(this,t)};(n["armory.logicnode.SetParentBoneNode"]=jn).__name__="armory.logicnode.SetParentBoneNode",jn.__super__=c,jn.prototype=r(c.prototype,{run:function(t){},__class__:jn});var Yn=function(t){c.call(this,t)};(n["armory.logicnode.SetParentNode"]=Yn).__name__="armory.logicnode.SetParentNode",Yn.__super__=c,Yn.prototype=r(c.prototype,{run:function(t){var e,n=this.inputs[1].get(),i=!1;this.inputs[2].node instanceof Ie&&(i=""==hs.__cast(this.inputs[2].node,Ie).objectName);e=i?br.active.root:this.inputs[2].get(),null!=n&&null!=e&&n.parent!=e&&(n.parent.removeChild(n,i),e.addChild(n,!i),this.runOutput(0))},__class__:Yn});var Un=function(t){c.call(this,t)};(n["armory.logicnode.SetParticleSpeedNode"]=Un).__name__="armory.logicnode.SetParticleSpeedNode",Un.__super__=c,Un.prototype=r(c.prototype,{run:function(t){},__class__:Un});var Kn=function(t){c.call(this,t)};(n["armory.logicnode.SetPropertyNode"]=Kn).__name__="armory.logicnode.SetPropertyNode",Kn.__super__=c,Kn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=this.inputs[3].get();null!=e&&(null==e.properties&&(e.properties=new ur),e.properties.set(n,i),this.runOutput(0))},__class__:Kn});var Qn=function(t){c.call(this,t)};(n["armory.logicnode.SetRotationNode"]=Qn).__name__="armory.logicnode.SetRotationNode",Qn.__super__=c,Qn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&(e.transform.rot.fromEuler(n.x,n.y,n.z),e.transform.buildMatrix(),this.runOutput(0))},__class__:Qn});var Jn=function(t){c.call(this,t)};(n["armory.logicnode.SetScaleNode"]=Jn).__name__="armory.logicnode.SetScaleNode",Jn.__super__=c,Jn.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&(e.transform.scale.setFrom(n),e.transform.buildMatrix(),this.runOutput(0))},__class__:Jn});var qn=function(t){c.call(this,t)};(n["armory.logicnode.SetSceneNode"]=qn).__name__="armory.logicnode.SetSceneNode",qn.__super__=c,qn.prototype=r(c.prototype,{root:null,run:function(t){var e=this,n=this.inputs[1].get();br.setActive(n,function(t){e.root=t,e.runOutput(0)})},get:function(t){return this.root},__class__:qn});var $n=function(t){c.call(this,t)};(n["armory.logicnode.SetTimeScaleNode"]=$n).__name__="armory.logicnode.SetTimeScaleNode",$n.__super__=c,$n.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();os.scale=e,this.runOutput(0)},__class__:$n});var ti=function(t){c.call(this,t)};(n["armory.logicnode.SetTransformNode"]=ti).__name__="armory.logicnode.SetTransformNode",ti.__super__=c,ti.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&(e.transform.setMatrix(n),this.runOutput(0))},__class__:ti});var ei=function(t){c.call(this,t)};(n["armory.logicnode.SetVariableNode"]=ei).__name__="armory.logicnode.SetVariableNode",ei.__super__=c,ei.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1],n=this.inputs[2].get();e.set(n),this.runOutput(0)},__class__:ei});var ni=function(t){c.call(this,t)};(n["armory.logicnode.SetVelocityNode"]=ni).__name__="armory.logicnode.SetVelocityNode",ni.__super__=c,ni.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=this.inputs[3].get(),r=this.inputs[4].get(),s=this.inputs[5].get();null!=e&&null!=n&&null!=i&&null!=r&&null!=s&&this.runOutput(0)},__class__:ni});var ii=function(t){c.call(this,t)};(n["armory.logicnode.SetVisibleNode"]=ii).__name__="armory.logicnode.SetVisibleNode",ii.__super__=c,ii.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&(e.visible=n,this.runOutput(0))},__class__:ii});var ri=function(t){c.call(this,t)};(n["armory.logicnode.ShowMouseNode"]=ri).__name__="armory.logicnode.ShowMouseNode",ri.__super__=c,ri.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=Jr.getMouse();e?n.show():n.hide(),this.runOutput(0)},__class__:ri});var si=function(t){c.call(this,t)};(n["armory.logicnode.ShutdownNode"]=si).__name__="armory.logicnode.ShutdownNode",si.__super__=c,si.prototype=r(c.prototype,{run:function(t){zs.stop()},__class__:si});var ai=function(t){c.call(this,t)};(n["armory.logicnode.SleepNode"]=ai).__name__="armory.logicnode.SleepNode",ai.__super__=c,ai.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();ls.timer(e,Fo(this,this.done))},done:function(){this.runOutput(0)},__class__:ai});var oi=function(t){this.matrices=[],c.call(this,t)};(n["armory.logicnode.SpawnObjectNode"]=oi).__name__="armory.logicnode.SpawnObjectNode",oi.__super__=c,oi.prototype=r(c.prototype,{object:null,matrices:null,run:function(t){var n=this,e="",i=this.inputs[1].get();""==(e=null==i?hs.__cast(this.inputs[1].node,Ie).objectName:i.name)&&(e=this.tree.object.name);var r=this.inputs[2].get();this.matrices.push(null!=r?r.clone():null);var s=!(3<this.inputs.length)||this.inputs[3].get();br.active.spawnObject(e,null,function(t){n.object=t;var e=n.matrices.pop();null!=e&&n.object.transform.setMatrix(e),n.object.visible=!0,n.runOutput(0)},s)},get:function(t){return this.object},__class__:oi});var li=function(t){c.call(this,t)};(n["armory.logicnode.SpawnSceneNode"]=li).__name__="armory.logicnode.SpawnSceneNode",li.__super__=c,li.prototype=r(c.prototype,{root:null,run:function(t){var e=this,n=this.inputs[1].get(),i=this.inputs[2].get();this.root=br.active.addObject(),this.root.name=n,null!=i&&(this.root.transform.setMatrix(i),this.root.transform.buildMatrix()),br.active.addScene(n,this.root,function(t){e.runOutput(0)})},get:function(t){return this.root},__class__:li});var ui=function(t){c.call(this,t)};(n["armory.logicnode.StopAgentNode"]=ui).__name__="armory.logicnode.StopAgentNode",ui.__super__=c,ui.prototype=r(c.prototype,{run:function(t){null!=this.inputs[1].get()&&this.runOutput(0)},__class__:ui});var hi=function(t){c.call(this,t)};(n["armory.logicnode.StopSoundNode"]=hi).__name__="armory.logicnode.StopSoundNode",hi.__super__=c,hi.prototype=r(c.prototype,{run:function(t){var e=hs.__cast(this.inputs[1].get(),Zr);null!=e&&(e.stop(),this.runOutput(0))},__class__:hi});var _i=function(t,e){null==e&&(e=""),c.call(this,t),this.value=e};(n["armory.logicnode.StringNode"]=_i).__name__="armory.logicnode.StringNode",_i.__super__=c,_i.prototype=r(c.prototype,{value:null,get:function(t){return 0<this.inputs.length?this.inputs[0].get():this.value},set:function(t){0<this.inputs.length?this.inputs[0].set(t):this.value=t},__class__:_i});var ci=function(t){this.coords=new wi,c.call(this,t)};(n["armory.logicnode.SurfaceCoordsNode"]=ci).__name__="armory.logicnode.SurfaceCoordsNode",ci.__super__=c,ci.prototype=r(c.prototype,{coords:null,get:function(t){var e=Jr.getSurface();return 0==t?(this.coords.x=e.x,this.coords.y=e.y,this.coords):1==t?(this.coords.x=e.movementX,this.coords.y=e.movementY,this.coords):e.wheelDelta},__class__:ci});var di=function(t){c.call(this,t)};(n["armory.logicnode.SurfaceNode"]=di).__name__="armory.logicnode.SurfaceNode",di.__super__=c,di.prototype=r(c.prototype,{property0:null,get:function(t){var e=Jr.getSurface();switch(this.property0){case"Moved":return e.moved;case"Released":return Fo(e,e.released);case"Started":return Fo(e,e.started);case"Touched":return Fo(e,e.down)}return!1},__class__:di});var pi=function(t){c.call(this,t)};(n["armory.logicnode.SwitchNode"]=pi).__name__="armory.logicnode.SwitchNode",pi.__super__=c,pi.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get();if(2<this.inputs.length)for(var n=2,i=this.inputs.length;n<i;){var r=n++;if(this.inputs[r].get()==e)return void this.runOutput(r-1)}this.runOutput(0)},__class__:pi});var gi=function(t){c.call(this,t)};(n["armory.logicnode.TimeNode"]=gi).__name__="armory.logicnode.TimeNode",gi.__super__=c,gi.prototype=r(c.prototype,{get:function(t){return 0==t?os.time():os.get_delta()},__class__:gi});var fi=function(t){this.repetitions=0,this.running=!1,this.repeat=0,this.duration=0,this.time=0,c.call(this,t)};(n["armory.logicnode.TimerNode"]=fi).__name__="armory.logicnode.TimerNode",fi.__super__=c,fi.prototype=r(c.prototype,{time:null,duration:null,repeat:null,running:null,repetitions:null,update:function(){this.time+=os.get_delta(),this.time>=this.duration&&(this.repeat--,this.runOutput(0),0!=this.repeat?(this.time=0,this.repetitions++):(this.removeUpdate(),this.runOutput(1)))},run:function(t){0==t?(this.duration=this.inputs[3].get(),this.repeat=this.inputs[4].get(),this.running||(this.running=!0,this.tree.notifyOnUpdate(Fo(this,this.update)))):1==t?this.removeUpdate():(this.removeUpdate(),this.time=0,this.repetitions=0)},removeUpdate:function(){this.running&&(this.running=!1,this.tree.removeUpdate(Fo(this,this.update)))},get:function(t){return 1==t?this.running:2==t?this.time:3==t?this.duration-this.time:4==t?this.time/this.duration:this.repetitions},__class__:fi});var mi=function(t){this.b=!1,c.call(this,t)};(n["armory.logicnode.ToBoolNode"]=mi).__name__="armory.logicnode.ToBoolNode",mi.__super__=c,mi.prototype=r(c.prototype,{value:null,b:null,run:function(t){this.b=!0},get:function(t){return this.value=this.b,this.b=!1,this.value},__class__:mi});var vi=function(t){this.value=null,c.call(this,t)};(n["armory.logicnode.TraitNode"]=vi).__name__="armory.logicnode.TraitNode",vi.__super__=c,vi.prototype=r(c.prototype,{property0:null,value:null,get:function(t){if(null!=this.value)return this.value;var e=q.resolveClass("arm."+this.property0);return null==e&&(e=q.resolveClass("arm.node."+this.property0)),this.value=q.createInstance(e,[]),this.value},set:function(t){this.value=t},__class__:vi});var yi=function(t,e,n,i,r,s,a,o,l,u,h,_,c,d,p,g){this._00=t,this._10=e,this._20=n,this._30=i,this._01=r,this._11=s,this._21=a,this._31=o,this._02=l,this._12=u,this._22=h,this._32=_,this._03=c,this._13=d,this._23=p,this._33=g};(n["kha.math.FastMatrix4"]=yi).__name__="kha.math.FastMatrix4",yi.orthogonalProjection=function(t,e,n,i,r,s){return new yi(2/(e-t),0,0,-(e+t)/(e-t),0,2/(i-n),0,-(i+n)/(i-n),0,0,-2/(s-r),-(s+r)/(s-r),0,0,0,1)},yi.prototype={_00:null,_10:null,_20:null,_30:null,_01:null,_11:null,_21:null,_31:null,_02:null,_12:null,_22:null,_32:null,_03:null,_13:null,_23:null,_33:null,__class__:yi};var wi=function(t,e,n,i){null==i&&(i=1),null==n&&(n=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=n,this.w=i};(n["iron.math.Vec4"]=wi).__name__="iron.math.Vec4",wi.distance=function(t,e){return wi.distancef(t.x,t.y,t.z,e.x,e.y,e.z)},wi.distancef=function(t,e,n,i,r,s){var a=t-i,o=e-r,l=n-s;return Fr.sqrt(a*a+o*o+l*l)},wi.xAxis=function(){return new wi(1,0,0)},wi.yAxis=function(){return new wi(0,1,0)},wi.prototype={x:null,y:null,z:null,w:null,cross:function(t){var e=this.x,n=this.y,i=this.z,r=t.x,s=t.y,a=t.z;return this.x=n*a-i*s,this.y=i*r-e*a,this.z=e*s-n*r,this},crossvecs:function(t,e){var n=t.x,i=t.y,r=t.z,s=e.x,a=e.y,o=e.z;return this.x=i*o-r*a,this.y=r*s-n*o,this.z=n*a-i*s,this},set:function(t,e,n,i){return null==i&&(i=1),this.x=t,this.y=e,this.z=n,this.w=i,this},add:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},addf:function(t,e,n){return this.x+=t,this.y+=e,this.z+=n,this},addvecs:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},normalize:function(){var t=this.length();if(0<t){var e=1/t;this.x*=e,this.y*=e,this.z*=e}return this},mult:function(t){return this.x*=t,this.y*=t,this.z*=t,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},setFrom:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w,this},lerp:function(t,e,n){return this.x=t.x+(e.x-t.x)*n,this.y=t.y+(e.y-t.y)*n,this.z=t.z+(e.z-t.z)*n,this},applyproj:function(t){var e=this.x,n=this.y,i=this.z,r=1/(t.get__03()*e+t.get__13()*n+t.get__23()*i+t.get__33());return this.x=(t.get__00()*e+t.get__10()*n+t.get__20()*i+t.get__30())*r,this.y=(t.get__01()*e+t.get__11()*n+t.get__21()*i+t.get__31())*r,this.z=(t.get__02()*e+t.get__12()*n+t.get__22()*i+t.get__32())*r,this},applymat:function(t){var e=this.x,n=this.y,i=this.z;return this.x=t.get__00()*e+t.get__10()*n+t.get__20()*i+t.get__30(),this.y=t.get__01()*e+t.get__11()*n+t.get__21()*i+t.get__31(),this.z=t.get__02()*e+t.get__12()*n+t.get__22()*i+t.get__32(),this},applymat4:function(t){var e=this.x,n=this.y,i=this.z,r=this.w;return this.x=t.get__00()*e+t.get__10()*n+t.get__20()*i+t.get__30()*r,this.y=t.get__01()*e+t.get__11()*n+t.get__21()*i+t.get__31()*r,this.z=t.get__02()*e+t.get__12()*n+t.get__22()*i+t.get__32()*r,this.w=t.get__03()*e+t.get__13()*n+t.get__23()*i+t.get__33()*r,this},length:function(){return Fr.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},sub:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},clamp:function(t,e){var n=this.length();return n<t?this.normalize().mult(t):e<n&&this.normalize().mult(e),this},__class__:wi};var bi=function(t,e,n,i,r,s,a,o,l,u,h,_,c,d,p,g){this.self=new yi(t,e,n,i,r,s,a,o,l,u,h,_,c,d,p,g)};(n["iron.math.Mat4"]=bi).__name__="iron.math.Mat4",bi.fromFloat32Array=function(t,e){return null==e&&(e=0),new bi(t[e],t[1+e],t[2+e],t[3+e],t[4+e],t[5+e],t[6+e],t[7+e],t[8+e],t[9+e],t[10+e],t[11+e],t[12+e],t[13+e],t[14+e],t[15+e])},bi.identity=function(){return new bi(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},bi.persp=function(t,e,n,i){var r=1/Fr.tan(t/2);return new bi(r/e,0,0,0,0,r,0,0,0,0,(i+n)/(n-i),2*i*n/(n-i),0,0,-1,0)},bi.ortho=function(t,e,n,i,r,s){var a=e-t,o=i-n,l=s-r;return new bi(2/a,0,0,-(e+t)/a,0,2/o,0,-(i+n)/o,0,0,-2/l,-(s+r)/l,0,0,0,1)},bi.prototype={self:null,compose:function(t,e,n){return this.fromQuat(e),this.scale(n),this.setLoc(t),this},decompose:function(t,e,n){t.x=this.get__30(),t.y=this.get__31(),t.z=this.get__32(),n.x=bi.helpVec.set(this.get__00(),this.get__01(),this.get__02()).length(),n.y=bi.helpVec.set(this.get__10(),this.get__11(),this.get__12()).length(),n.z=bi.helpVec.set(this.get__20(),this.get__21(),this.get__22()).length();var i=this.self,r=i._12,s=i._22,a=i._32,o=i._13,l=i._23,u=i._33,h=i._11*(s*u-a*l)-i._21*(r*u-a*o)+i._31*(r*l-s*o),_=i._12,c=i._22,d=i._32,p=i._13,g=i._23,f=i._33,m=i._10*(c*f-d*g)-i._20*(_*f-d*p)+i._30*(_*g-c*p),v=i._11,y=i._21,w=i._31,b=i._13,x=i._23,S=i._33,C=i._10*(y*S-w*x)-i._20*(v*S-w*b)+i._30*(v*x-y*b),k=i._11,I=i._21,T=i._31,N=i._12,M=i._22,O=i._32,E=i._10*(I*O-T*M)-i._20*(k*O-T*N)+i._30*(k*M-I*N);i._00*h-i._01*m+i._02*C-i._03*E<0&&(n.x=-n.x);var A=1/n.x;return bi.helpMat.set__00(this.get__00()*A),bi.helpMat.set__01(this.get__01()*A),bi.helpMat.set__02(this.get__02()*A),A=1/n.y,bi.helpMat.set__10(this.get__10()*A),bi.helpMat.set__11(this.get__11()*A),bi.helpMat.set__12(this.get__12()*A),A=1/n.z,bi.helpMat.set__20(this.get__20()*A),bi.helpMat.set__21(this.get__21()*A),bi.helpMat.set__22(this.get__22()*A),e.fromRotationMat(bi.helpMat),this},setLoc:function(t){return this.set__30(t.x),this.set__31(t.y),this.set__32(t.z),this},fromQuat:function(t){var e=t.x,n=t.y,i=t.z,r=t.w,s=e+e,a=n+n,o=i+i,l=e*s,u=e*a,h=e*o,_=n*a,c=n*o,d=i*o,p=r*s,g=r*a,f=r*o;return this.set__00(1-(_+d)),this.set__10(u-f),this.set__20(h+g),this.set__01(u+f),this.set__11(1-(l+d)),this.set__21(c-p),this.set__02(h-g),this.set__12(c+p),this.set__22(1-(l+_)),this.set__03(0),this.set__13(0),this.set__23(0),this.set__30(0),this.set__31(0),this.set__32(0),this.set__33(1),this},setIdentity:function(){return this.set__00(1),this.set__01(0),this.set__02(0),this.set__03(0),this.set__10(0),this.set__11(1),this.set__12(0),this.set__13(0),this.set__20(0),this.set__21(0),this.set__22(1),this.set__23(0),this.set__30(0),this.set__31(0),this.set__32(0),this.set__33(1),this},scale:function(t){var e=t.x,n=t.y,i=t.z;this.set__00(this.get__00()*e);this.set__01(this.get__01()*e);this.set__02(this.get__02()*e);this.set__03(this.get__03()*e);this.set__10(this.get__10()*n);this.set__11(this.get__11()*n);this.set__12(this.get__12()*n);this.set__13(this.get__13()*n);this.set__20(this.get__20()*i);this.set__21(this.get__21()*i);this.set__22(this.get__22()*i);return this.set__23(this.get__23()*i),this},multmats3x4:function(t,e){var n=t.get__00(),i=t.get__01(),r=t.get__02(),s=t.get__03(),a=t.get__10(),o=t.get__11(),l=t.get__12(),u=t.get__13(),h=t.get__20(),_=t.get__21(),c=t.get__22(),d=t.get__23(),p=t.get__30(),g=t.get__31(),f=t.get__32(),m=t.get__33(),v=e.get__00(),y=e.get__10(),w=e.get__20(),b=e.get__30();return this.set__00(n*v+i*y+r*w+s*b),this.set__10(a*v+o*y+l*w+u*b),this.set__20(h*v+_*y+c*w+d*b),this.set__30(p*v+g*y+f*w+m*b),v=e.get__01(),y=e.get__11(),w=e.get__21(),b=e.get__31(),this.set__01(n*v+i*y+r*w+s*b),this.set__11(a*v+o*y+l*w+u*b),this.set__21(h*v+_*y+c*w+d*b),this.set__31(p*v+g*y+f*w+m*b),v=e.get__02(),y=e.get__12(),w=e.get__22(),b=e.get__32(),this.set__02(n*v+i*y+r*w+s*b),this.set__12(a*v+o*y+l*w+u*b),this.set__22(h*v+_*y+c*w+d*b),this.set__32(p*v+g*y+f*w+m*b),this.set__03(0),this.set__13(0),this.set__23(0),this.set__33(1),this},multmats:function(t,e){var n=e.get__00(),i=e.get__01(),r=e.get__02(),s=e.get__03(),a=e.get__10(),o=e.get__11(),l=e.get__12(),u=e.get__13(),h=e.get__20(),_=e.get__21(),c=e.get__22(),d=e.get__23(),p=e.get__30(),g=e.get__31(),f=e.get__32(),m=e.get__33(),v=t.get__00(),y=t.get__10(),w=t.get__20(),b=t.get__30();return this.set__00(n*v+i*y+r*w+s*b),this.set__10(a*v+o*y+l*w+u*b),this.set__20(h*v+_*y+c*w+d*b),this.set__30(p*v+g*y+f*w+m*b),v=t.get__01(),y=t.get__11(),w=t.get__21(),b=t.get__31(),this.set__01(n*v+i*y+r*w+s*b),this.set__11(a*v+o*y+l*w+u*b),this.set__21(h*v+_*y+c*w+d*b),this.set__31(p*v+g*y+f*w+m*b),v=t.get__02(),y=t.get__12(),w=t.get__22(),b=t.get__32(),this.set__02(n*v+i*y+r*w+s*b),this.set__12(a*v+o*y+l*w+u*b),this.set__22(h*v+_*y+c*w+d*b),this.set__32(p*v+g*y+f*w+m*b),v=t.get__03(),y=t.get__13(),w=t.get__23(),b=t.get__33(),this.set__03(n*v+i*y+r*w+s*b),this.set__13(a*v+o*y+l*w+u*b),this.set__23(h*v+_*y+c*w+d*b),this.set__33(p*v+g*y+f*w+m*b),this},multmat:function(t){var e=this.get__00(),n=this.get__01(),i=this.get__02(),r=this.get__03(),s=this.get__10(),a=this.get__11(),o=this.get__12(),l=this.get__13(),u=this.get__20(),h=this.get__21(),_=this.get__22(),c=this.get__23(),d=this.get__30(),p=this.get__31(),g=this.get__32(),f=this.get__33(),m=t.get__00(),v=t.get__10(),y=t.get__20(),w=t.get__30();return this.set__00(e*m+n*v+i*y+r*w),this.set__10(s*m+a*v+o*y+l*w),this.set__20(u*m+h*v+_*y+c*w),this.set__30(d*m+p*v+g*y+f*w),m=t.get__01(),v=t.get__11(),y=t.get__21(),w=t.get__31(),this.set__01(e*m+n*v+i*y+r*w),this.set__11(s*m+a*v+o*y+l*w),this.set__21(u*m+h*v+_*y+c*w),this.set__31(d*m+p*v+g*y+f*w),m=t.get__02(),v=t.get__12(),y=t.get__22(),w=t.get__32(),this.set__02(e*m+n*v+i*y+r*w),this.set__12(s*m+a*v+o*y+l*w),this.set__22(u*m+h*v+_*y+c*w),this.set__32(d*m+p*v+g*y+f*w),m=t.get__03(),v=t.get__13(),y=t.get__23(),w=t.get__33(),this.set__03(e*m+n*v+i*y+r*w),this.set__13(s*m+a*v+o*y+l*w),this.set__23(u*m+h*v+_*y+c*w),this.set__33(d*m+p*v+g*y+f*w),this},getInverse:function(t){var e=t.get__00(),n=t.get__01(),i=t.get__02(),r=t.get__03(),s=t.get__10(),a=t.get__11(),o=t.get__12(),l=t.get__13(),u=t.get__20(),h=t.get__21(),_=t.get__22(),c=t.get__23(),d=t.get__30(),p=t.get__31(),g=t.get__32(),f=t.get__33(),m=e*a-n*s,v=e*o-i*s,y=e*l-r*s,w=n*o-i*a,b=n*l-r*a,x=i*l-r*o,S=u*p-h*d,C=u*g-_*d,k=u*f-c*d,I=h*g-_*p,T=h*f-c*p,N=_*f-c*g,M=m*N-v*T+y*I+w*k-b*C+x*S;return 0==M?this.setIdentity():(M=1/M,this.set__00((a*N-o*T+l*I)*M),this.set__01((i*T-n*N-r*I)*M),this.set__02((p*x-g*b+f*w)*M),this.set__03((_*b-h*x-c*w)*M),this.set__10((o*k-s*N-l*C)*M),this.set__11((e*N-i*k+r*C)*M),this.set__12((g*y-d*x-f*v)*M),this.set__13((u*x-_*y+c*v)*M),this.set__20((s*T-a*k+l*S)*M),this.set__21((n*k-e*T-r*S)*M),this.set__22((d*b-p*y+f*m)*M),this.set__23((h*y-u*b-c*m)*M),this.set__30((a*C-s*I-o*S)*M),this.set__31((e*I-n*C+i*S)*M),this.set__32((p*v-d*w-g*m)*M),this.set__33((u*w-h*v+_*m)*M),this)},transpose:function(){var t=this.get__01();return this.set__01(this.get__10()),this.set__10(t),t=this.get__02(),this.set__02(this.get__20()),this.set__20(t),t=this.get__03(),this.set__03(this.get__30()),this.set__30(t),t=this.get__12(),this.set__12(this.get__21()),this.set__21(t),t=this.get__13(),this.set__13(this.get__31()),this.set__31(t),t=this.get__23(),this.set__23(this.get__32()),this.set__32(t),this},transpose3x3:function(){var t=this.get__01();return this.set__01(this.get__10()),this.set__10(t),t=this.get__02(),this.set__02(this.get__20()),this.set__20(t),t=this.get__12(),this.set__12(this.get__21()),this.set__21(t),this},clone:function(){return new bi(this.get__00(),this.get__10(),this.get__20(),this.get__30(),this.get__01(),this.get__11(),this.get__21(),this.get__31(),this.get__02(),this.get__12(),this.get__22(),this.get__32(),this.get__03(),this.get__13(),this.get__23(),this.get__33())},setF32:function(t,e){return null==e&&(e=0),this.set__00(t[e]),this.set__10(t[1+e]),this.set__20(t[2+e]),this.set__30(t[3+e]),this.set__01(t[4+e]),this.set__11(t[5+e]),this.set__21(t[6+e]),this.set__31(t[7+e]),this.set__02(t[8+e]),this.set__12(t[9+e]),this.set__22(t[10+e]),this.set__32(t[11+e]),this.set__03(t[12+e]),this.set__13(t[13+e]),this.set__23(t[14+e]),this.set__33(t[15+e]),this},setFrom:function(t){return this.set__00(t.get__00()),this.set__01(t.get__01()),this.set__02(t.get__02()),this.set__03(t.get__03()),this.set__10(t.get__10()),this.set__11(t.get__11()),this.set__12(t.get__12()),this.set__13(t.get__13()),this.set__20(t.get__20()),this.set__21(t.get__21()),this.set__22(t.get__22()),this.set__23(t.get__23()),this.set__30(t.get__30()),this.set__31(t.get__31()),this.set__32(t.get__32()),this.set__33(t.get__33()),this},getLoc:function(){return new wi(this.get__30(),this.get__31(),this.get__32(),this.get__33())},getScale:function(){return new wi(Fr.sqrt(this.get__00()*this.get__00()+this.get__10()*this.get__10()+this.get__20()*this.get__20()),Fr.sqrt(this.get__01()*this.get__01()+this.get__11()*this.get__11()+this.get__21()*this.get__21()),Fr.sqrt(this.get__02()*this.get__02()+this.get__12()*this.get__12()+this.get__22()*this.get__22()))},toRotation:function(){var t=1/bi.helpVec.set(this.get__00(),this.get__01(),this.get__02()).length();return this.set__00(this.get__00()*t),this.set__01(this.get__01()*t),this.set__02(this.get__02()*t),t=1/bi.helpVec.set(this.get__10(),this.get__11(),this.get__12()).length(),this.set__10(this.get__10()*t),this.set__11(this.get__11()*t),this.set__12(this.get__12()*t),t=1/bi.helpVec.set(this.get__20(),this.get__21(),this.get__22()).length(),this.set__20(this.get__20()*t),this.set__21(this.get__21()*t),this.set__22(this.get__22()*t),this.set__03(0),this.set__13(0),this.set__23(0),this.set__30(0),this.set__31(0),this.set__32(0),this.set__33(1),this},setLookAt:function(t,e,n){var i=e.x-t.x,r=e.y-t.y,s=e.z-t.z,a=1/Fr.sqrt(i*i+r*r+s*s);i*=a,s*=a;var o=(r*=a)*n.z-s*n.y,l=s*n.x-i*n.z,u=i*n.y-r*n.x,h=(l*=a=1/Fr.sqrt(o*o+l*l+u*u))*s-(u*=a)*r,_=u*i-(o*=a)*s,c=o*r-l*i,d=-t.x*o-t.y*l-t.z*u,p=-t.x*h-t.y*_-t.z*c,g=t.x*i+t.y*r+t.z*s;return this.set__00(o),this.set__10(l),this.set__20(u),this.set__30(d),this.set__01(h),this.set__11(_),this.set__21(c),this.set__31(p),this.set__02(-i),this.set__12(-r),this.set__22(-s),this.set__32(g),this.set__03(0),this.set__13(0),this.set__23(0),this.set__33(1),this},right:function(){return new wi(this.get__00(),this.get__01(),this.get__02())},up:function(){return new wi(this.get__20(),this.get__21(),this.get__22())},look:function(){return new wi(this.get__10(),this.get__11(),this.get__12())},get__00:function(){return this.self._00},set__00:function(t){return this.self._00=t},get__01:function(){return this.self._01},set__01:function(t){return this.self._01=t},get__02:function(){return this.self._02},set__02:function(t){return this.self._02=t},get__03:function(){return this.self._03},set__03:function(t){return this.self._03=t},get__10:function(){return this.self._10},set__10:function(t){return this.self._10=t},get__11:function(){return this.self._11},set__11:function(t){return this.self._11=t},get__12:function(){return this.self._12},set__12:function(t){return this.self._12=t},get__13:function(){return this.self._13},set__13:function(t){return this.self._13=t},get__20:function(){return this.self._20},set__20:function(t){return this.self._20=t},get__21:function(){return this.self._21},set__21:function(t){return this.self._21=t},get__22:function(){return this.self._22},set__22:function(t){return this.self._22=t},get__23:function(){return this.self._23},set__23:function(t){return this.self._23=t},get__30:function(){return this.self._30},set__30:function(t){return this.self._30=t},get__31:function(){return this.self._31},set__31:function(t){return this.self._31=t},get__32:function(){return this.self._32},set__32:function(t){return this.self._32=t},get__33:function(){return this.self._33},set__33:function(t){return this.self._33=t},__class__:bi,__properties__:{set__33:"set__33",get__33:"get__33",set__32:"set__32",get__32:"get__32",set__31:"set__31",get__31:"get__31",set__30:"set__30",get__30:"get__30",set__23:"set__23",get__23:"get__23",set__22:"set__22",get__22:"get__22",set__21:"set__21",get__21:"get__21",set__20:"set__20",get__20:"get__20",set__13:"set__13",get__13:"get__13",set__12:"set__12",get__12:"get__12",set__11:"set__11",get__11:"get__11",set__10:"set__10",get__10:"get__10",set__03:"set__03",get__03:"get__03",set__02:"set__02",get__02:"get__02",set__01:"set__01",get__01:"get__01",set__00:"set__00",get__00:"get__00"}};var xi=function(t,e,n,i){null==i&&(i=1),null==n&&(n=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.z=n,this.w=i};(n["iron.math.Quat"]=xi).__name__="iron.math.Quat",xi.prototype={x:null,y:null,z:null,w:null,set:function(t,e,n,i){return this.x=t,this.y=e,this.z=n,this.w=i,this},fromAxisAngle:function(t,e){var n=Fr.sin(.5*e);return this.x=t.x*n,this.y=t.y*n,this.z=t.z*n,this.w=Fr.cos(.5*e),this.normalize()},fromMat:function(t){return xi.helpMat.setFrom(t),xi.helpMat.toRotation(),this.fromRotationMat(xi.helpMat)},fromRotationMat:function(t){var e=t.get__00(),n=t.get__10(),i=t.get__20(),r=t.get__01(),s=t.get__11(),a=t.get__21(),o=t.get__02(),l=t.get__12(),u=t.get__22(),h=e+s+u,_=0;return 0<h?(_=.5/Fr.sqrt(h+1),this.w=.25/_,this.x=(l-a)*_,this.y=(i-o)*_,this.z=(r-n)*_):s<e&&u<e?(_=2*Fr.sqrt(1+e-s-u),this.w=(l-a)/_,this.x=.25*_,this.y=(n+r)/_,this.z=(i+o)/_):u<s?(_=2*Fr.sqrt(1+s-e-u),this.w=(i-o)/_,this.x=(n+r)/_,this.y=.25*_,this.z=(a+l)/_):(_=2*Fr.sqrt(1+u-e-s),this.w=(r-n)/_,this.x=(i+o)/_,this.y=(a+l)/_,this.z=.25*_),this},mult:function(t){return this.multquats(this,t)},multquats:function(t,e){var n=t.x,i=t.y,r=t.z,s=t.w,a=e.x,o=e.y,l=e.z,u=e.w;return this.x=n*u+s*a+i*l-r*o,this.y=s*o-n*l+i*u+r*a,this.z=s*l+n*o-i*a+r*u,this.w=s*u-n*a-i*o-r*l,this},normalize:function(){var t=Fr.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0==t?(this.x=0,this.y=0,this.z=0,this.w=0):(t=1/t,this.x*=t,this.y*=t,this.z*=t,this.w*=t),this},getEuler:function(){var t=Fr.get_NaN(),e=0,n=0,i=this.x*this.y+this.z*this.w;if(.499<i&&(t=2*Fr.atan2(this.x,this.w),e=1.5707963267948966,n=0),i<-.499&&(t=-2*Fr.atan2(this.x,this.w),e=-1.5707963267948966,n=0),Fr.isNaN(t)){var r=2*this.z*this.z,s=this.y*this.y;t=Fr.atan2(2*this.y*this.w-2*this.x*this.z,1-2*s-r),s=this.x*this.x,n=Fr.atan2(2*this.x*this.w-2*this.y*this.z,1-2*s-r),e=Fr.asin(2*i)}return new wi(n,t,e)},fromEuler:function(t,e,n){var i=t/2,r=Fr.cos(i),s=Fr.sin(i);i=e/2;var a=Fr.cos(i),o=Fr.sin(i);i=n/2;var l=Fr.cos(i),u=Fr.sin(i);return this.x=s*a*l+r*o*u,this.y=r*o*l+s*a*u,this.z=r*a*u-s*o*l,this.w=r*a*l-s*o*u,this},lerp:function(t,e,n){var i=t.x,r=t.y,s=t.z,a=t.w;return t.dot(e)<0&&(i=-i,r=-r,s=-s,a=-a),this.x=i+(e.x-i)*n,this.y=r+(e.y-r)*n,this.z=s+(e.z-s)*n,this.w=a+(e.w-a)*n,this.normalize()},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},fromTo:function(t,e){var n=xi.helpVec0,i=t.dot(e);return i<-.999999?(n.crossvecs(xi.xAxis,t),n.length()<1e-6&&n.crossvecs(xi.yAxis,t),n.normalize(),this.fromAxisAngle(n,3.141592653589793)):.999999<i?this.set(0,0,0,1):(n.crossvecs(t,e),this.set(n.x,n.y,n.z,1+i),this.normalize()),this},__class__:xi};var Si=function(t){this.value=bi.identity(),c.call(this,t)};(n["armory.logicnode.TransformNode"]=Si).__name__="armory.logicnode.TransformNode",Si.__super__=c,Si.prototype=r(c.prototype,{value:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get(),i=this.inputs[2].get();return null==e||null==n||null==i?null:(Si.q.fromEuler(n.x,n.y,n.z),this.value.compose(e,Si.q,i),this.value)},set:function(t){hs.__cast(t,bi).decompose(Si.v1,Si.q,Si.v2),this.inputs[0].set(Si.v1),this.inputs[1].set(Si.q.getEuler()),this.inputs[2].set(Si.v2)},__class__:Si});var Ci=function(t){c.call(this,t)};(n["armory.logicnode.TranslateObjectNode"]=Ci).__name__="armory.logicnode.TranslateObjectNode",Ci.__super__=c,Ci.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get();null!=e&&null!=n&&(e.transform.loc.add(n),e.transform.buildMatrix(),this.runOutput(0))},__class__:Ci});var ki=function(t){this.vec=new wi,this.loc=new wi,c.call(this,t)};(n["armory.logicnode.TranslateOnLocalAxisNode"]=ki).__name__="armory.logicnode.TranslateOnLocalAxisNode",ki.__super__=c,ki.prototype=r(c.prototype,{loc:null,vec:null,run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=this.inputs[3].get(),r=this.inputs[4].get();null!=e&&(1==i?this.loc.setFrom(e.transform.world.look()):2==i?this.loc.setFrom(e.transform.world.up()):3==i&&this.loc.setFrom(e.transform.world.right()),r&&(this.loc.x=-this.loc.x,this.loc.y=-this.loc.y,this.loc.z=-this.loc.z),this.vec.x=this.loc.x*n,this.vec.y=this.loc.y*n,this.vec.z=this.loc.z*n,e.transform.loc.add(this.vec),e.transform.buildMatrix(),this.runOutput(0))},__class__:ki});var Ii=function(t){this.v=new wi,c.call(this,t)};(n["armory.logicnode.VectorClampToSizeNode"]=Ii).__name__="armory.logicnode.VectorClampToSizeNode",Ii.__super__=c,Ii.prototype=r(c.prototype,{v:null,get:function(t){this.v=this.inputs[0].get();var e=this.inputs[1].get(),n=this.inputs[2].get();return this.v.clamp(e,n),this.v},__class__:Ii});var Ti=function(t){c.call(this,t)};(n["armory.logicnode.VectorFromTransformNode"]=Ti).__name__="armory.logicnode.VectorFromTransformNode",Ti.__super__=c,Ti.prototype=r(c.prototype,{property0:null,get:function(t){var e=this.inputs[0].get();if(null==e)return null;switch(this.property0){case"Look":return e.look();case"Quaternion":return(new xi).fromMat(e);case"Right":return e.right();case"Up":return e.up()}return null},__class__:Ti});var Ni=function(t){this.v=new wi,c.call(this,t)};(n["armory.logicnode.VectorMathNode"]=Ni).__name__="armory.logicnode.VectorMathNode",Ni.__super__=c,Ni.prototype=r(c.prototype,{property0:null,v:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();if(null==e||null==n)return null;this.v.setFrom(e);var i=0;switch(this.property0){case"Add":this.v.add(n);break;case"Average":this.v.add(n),this.v.x*=.5,this.v.y*=.5,this.v.z*=.5;break;case"Cross Product":this.v.cross(n);break;case"Dot Product":i=this.v.dot(n),this.v.set(i,i,i);break;case"Length":i=this.v.length();break;case"Multiply":this.v.x*=n.x,this.v.y*=n.y,this.v.z*=n.z;break;case"Normalize":this.v.normalize();break;case"Subtract":this.v.sub(n)}return 0==t?this.v:i},__class__:Ni});var Mi=function(t){this.ease=null,this.v=new wi,c.call(this,t)};(n["armory.logicnode.VectorMixNode"]=Mi).__name__="armory.logicnode.VectorMixNode",Mi.__super__=c,Mi.prototype=r(c.prototype,{property0:null,property1:null,property2:null,v:null,ease:null,init:function(){switch(this.property0){case"Back":this.ease="In"==this.property1?ls.easeBackIn:"Out"==this.property1?ls.easeBackOut:ls.easeBackInOut;break;case"Circ":this.ease="In"==this.property1?ls.easeCircIn:"Out"==this.property1?ls.easeCircOut:ls.easeCircInOut;break;case"Cubic":this.ease="In"==this.property1?ls.easeCubicIn:"Out"==this.property1?ls.easeCubicOut:ls.easeCubicInOut;break;case"Expo":this.ease="In"==this.property1?ls.easeExpoIn:"Out"==this.property1?ls.easeExpoOut:ls.easeExpoInOut;break;case"Linear":this.ease=ls.easeLinear;break;case"Quad":this.ease="In"==this.property1?ls.easeQuadIn:"Out"==this.property1?ls.easeQuadOut:ls.easeQuadInOut;break;case"Quart":this.ease="In"==this.property1?ls.easeQuartIn:"Out"==this.property1?ls.easeQuartOut:ls.easeQuartInOut;break;case"Quint":this.ease="In"==this.property1?ls.easeQuintIn:"Out"==this.property1?ls.easeQuintOut:ls.easeQuintInOut;break;case"Sine":this.ease="In"==this.property1?ls.easeSineIn:"Out"==this.property1?ls.easeSineOut:ls.easeSineInOut;break;default:this.ease=ls.easeLinear}},get:function(t){null==this.ease&&this.init();var e=this.inputs[0].get(),n=this.inputs[1].get(),i=this.inputs[2].get();if(null==n||null==i)return null;var r=this.ease(e);return this.v.x=n.x+(i.x-n.x)*r,this.v.y=n.y+(i.y-n.y)*r,this.v.z=n.z+(i.z-n.z)*r,"true"==this.property2&&this.v.clamp(0,1),this.v},__class__:Mi});var Oi=function(t,e,n,i){this.value=new wi,c.call(this,t),null!=e&&(this.addInput(new St(t,e),0),this.addInput(new St(t,n),0),this.addInput(new St(t,i),0))};(n["armory.logicnode.VectorNode"]=Oi).__name__="armory.logicnode.VectorNode",Oi.__super__=c,Oi.prototype=r(c.prototype,{value:null,get:function(t){return this.value.x=this.inputs[0].get(),this.value.y=this.inputs[1].get(),this.value.z=this.inputs[2].get(),this.value},set:function(t){this.inputs[0].set(t.x),this.inputs[1].set(t.y),this.inputs[2].set(t.z)},__class__:Oi});var Ei=function(t){c.call(this,t)};(n["armory.logicnode.VirtualButtonNode"]=Ei).__name__="armory.logicnode.VirtualButtonNode",Ei.__super__=c,Ei.prototype=r(c.prototype,{property0:null,property1:null,get:function(t){var e=Jr.getVirtualButton(this.property1);if(null==e)return!1;switch(this.property0){case"Down":return e.down;case"Released":return e.released;case"Started":return e.started}return!1},__class__:Ei});var Ai=function(t){this.lastOverlap=!1,c.call(this,t)};(n["armory.logicnode.VolumeTriggerNode"]=Ai).__name__="armory.logicnode.VolumeTriggerNode",Ai.__super__=c,Ai.prototype=r(c.prototype,{property0:null,lastOverlap:null,get:function(t){var e=this.inputs[0].get(),n=this.inputs[1].get();if(null==e)return!1;null==n&&(n=this.tree.object);var i=e.transform,r=n.transform,s=i.overlap(r),a=!1;switch(this.property0){case"Enter":a=s&&!this.lastOverlap;break;case"Leave":a=!s&&this.lastOverlap;break;case"Overlap":a=s}return this.lastOverlap=s,a},__class__:Ai});var Bi=function(t){c.call(this,t)};(n["armory.logicnode.WhileNode"]=Bi).__name__="armory.logicnode.WhileNode",Bi.__super__=c,Bi.prototype=r(c.prototype,{run:function(t){for(var e=this.inputs[1].get();e;)if(this.runOutput(0),e=this.inputs[1].get(),this.tree.loopBreak){this.tree.loopBreak=!1;break}this.runOutput(1)},__class__:Bi});var Li=function(t){c.call(this,t)};(n["armory.logicnode.WindowInfoNode"]=Li).__name__="armory.logicnode.WindowInfoNode",Li.__super__=c,Li.prototype=r(c.prototype,{get:function(t){return 0==t?zs.windowWidth():zs.windowHeight()},__class__:Li});var Fi=function(t){this.v=new wi,c.call(this,t)};(n["armory.logicnode.WorldToScreenSpaceNode"]=Fi).__name__="armory.logicnode.WorldToScreenSpaceNode",Fi.__super__=c,Fi.prototype=r(c.prototype,{property0:null,v:null,get:function(t){var e=this.inputs[0].get();if(null==e)return null;var n=br.active.camera;return this.v.setFrom(e),this.v.applyproj(n.V),this.v.applyproj(n.P),this.v},__class__:Fi});var Wi=function(t){c.call(this,t)};(n["armory.logicnode.WriteFileNode"]=Wi).__name__="armory.logicnode.WriteFileNode",Wi.__super__=c,Wi.prototype=r(c.prototype,{run:function(t){this.inputs[1].get(),this.inputs[2].get()},__class__:Wi});var Ri=function(t){c.call(this,t)};(n["armory.logicnode.WriteJsonNode"]=Ri).__name__="armory.logicnode.WriteJsonNode",Ri.__super__=c,Ri.prototype=r(c.prototype,{run:function(t){this.inputs[1].get();var e=this.inputs[2].get(),n=JSON.stringify(e);Ji.trace(n,{fileName:"Sources/armory/logicnode/WriteJsonNode.hx",lineNumber:14,className:"armory.logicnode.WriteJsonNode",methodName:"run"})},__class__:Ri});var Di=function(t){c.call(this,t)};(n["armory.logicnode.WriteStorageNode"]=Di).__name__="armory.logicnode.WriteStorageNode",Di.__super__=c,Di.prototype=r(c.prototype,{run:function(t){var e=this.inputs[1].get(),n=this.inputs[2].get(),i=as.get_data();null!=i&&(ft.setField(i,e,n),as.save(),this.runOutput(0))},__class__:Di});var Gi=function(){};(n["armory.object.Uniforms"]=Gi).__name__="armory.object.Uniforms",Gi.register=function(){Ur.externalTextureLinks=[Gi.textureLink],Ur.externalVec3Links=[Gi.vec3Link],Ur.externalFloatLinks=[Gi.floatLink]},Gi.textureLink=function(t,e,n){return"_smaaSearch"==n?br.active.embedded.get("smaa_search.png"):"_smaaArea"==n?br.active.embedded.get("smaa_area.png"):"_lensTexture"==n?br.active.embedded.get("lenstexture.jpg"):"_lutTexture"==n?br.active.embedded.get("luttexture.jpg"):"_cloudsTexture"==n?br.active.embedded.get("cloudstexture.png"):null},Gi.vec3Link=function(t,e,n){return null},Gi.floatLink=function(t,e,n){return null};var Vi=function(){};(n["armory.renderpath.Inc"]=Vi).__name__="armory.renderpath.Inc",Vi.init=function(t){Vi.path=t};var Hi=function(){};(n["armory.renderpath.RenderPathForward"]=Hi).__name__="armory.renderpath.RenderPathForward",Hi.drawMeshes=function(){Hi.path.drawMeshes("mesh")},Hi.init=function(t){Hi.path=t},Hi.commands=function(){br.active.lights.length;Hi.path.setTarget(""),Hi.path.clearTarget(-1,1),Pi.drawMeshes()};var Pi=function(){};(n["armory.renderpath.RenderPathCreator"]=Pi).__name__="armory.renderpath.RenderPathCreator",Pi.get=function(){return Pi.path=new vr,Vi.init(Pi.path),Hi.init(Pi.path),Pi.path.commands=Hi.commands,Pi.path};var zi=function(){};(n["armory.system.Event"]=zi).__name__="armory.system.Event",zi.get=function(t){return zi.events.get(t)},zi.add=function(t,e,n){null==n&&(n=-1);var i={name:t,onEvent:e,mask:n},r=zi.events.get(t);return null!=r?r.push(i):zi.events.set(t,[i]),i},zi.removeListener=function(t){var e=zi.events.get(t.name);null!=e&&ut.remove(e,t)};var Zi=function(){};(n["armory.system.Logic"]=Zi).__name__="armory.system.Logic",Zi.getNode=function(t){for(var e=0,n=Zi.nodes;e<n.length;){var i=n[e];if(++e,i.id==t)return i}return null},Zi.getInputLink=function(t){for(var e=0,n=Zi.links;e<n.length;){var i=n[e];if(++e,i.to_id==t.node_id){var r=Zi.getNode(t.node_id);if(r.inputs.length<=i.to_socket)return null;if(r.inputs[i.to_socket]==t)return i}}return null},Zi.getOutputLinks=function(t){for(var e=[],n=0,i=Zi.links;n<i.length;){var r=i[n];if(++n,r.from_id==t.node_id){var s=Zi.getNode(t.node_id);if(s.outputs.length<=r.from_socket)continue;s.outputs[r.from_socket]==t&&e.push(r)}}return e},Zi.safesrc=function(t){return J.replace(t," ","")},Zi.node_name=function(t){return Zi.safesrc(t.name)+t.id},Zi.parse=function(t,e){null==e&&(e=!0),Zi.nodes=t.nodes,Zi.links=t.links,Zi.parsed_nodes=[],Zi.parsed_labels=new ur,Zi.nodeMap=new ur;var n=Zi.get_root_nodes(t);if(Zi.tree=new he,e)Zi.tree.notifyOnAdd(function(){for(var t=0;t<n.length;){var e=n[t];++t,Zi.build_node(e)}});else for(var i=0;i<n.length;){var r=n[i];++i,Zi.build_node(r)}return Zi.tree},Zi.build_node=function(t){var e=Zi.node_name(t);if(-1!=Zi.parsed_nodes.indexOf(e))return e;Zi.parsed_nodes.push(e);var n=Zi.createClassInstance(t.type,[Zi.tree]);Zi.nodeMap.set(e,n);for(var i=0,r=t.buttons;i<r.length;){var s=r[i];++i,"property0"==s.name&&ft.setProperty(n,s.name,s.data[s.default_value])}for(var a=0,o=t.buttons;a<o.length;){var l=o[a];++a,"property1"==l.name&&ft.setProperty(n,l.name,l.data[l.default_value])}for(var u=0,h=t.buttons;u<h.length;){var _=h[u];++u,"property2"==_.name&&ft.setProperty(n,_.name,_.data[_.default_value])}for(var c=0,d=t.buttons;c<d.length;){var p=d[c];++c,"property3"==p.name&&ft.setProperty(n,p.name,p.data[p.default_value])}for(var g=0,f=t.buttons;g<f.length;){var m=f[g];++g,"property4"==m.name&&ft.setProperty(n,m.name,m.data[m.default_value])}for(var v=null,y=0,w=0,b=t.inputs.length;w<b;){var x=w++,S=t.inputs[x],C=Zi.getInputLink(S);if(null!=C){var k=Zi.getNode(C.from_id),I=k.outputs[C.from_socket];v=Zi.nodeMap.get(Zi.build_node(k));for(var T=0,N=k.outputs.length;T<N;){var M=T++;if(k.outputs[M]==I){y=M;break}}}else v=Zi.build_default_node(S),y=0;n.addInput(v,y)}for(var O=0,E=t.outputs;O<E.length;){var A=E[O];++O;var B=[],L=Zi.getOutputLinks(A);if(null!=L&&0<L.length)for(var F=0;F<L.length;){var W=L[F];++F;var R=Zi.getNode(W.to_id),D=Zi.build_node(R);B.push(Zi.nodeMap.get(D))}else B.push(Zi.build_default_node(A));n.addOutputs(B)}return e},Zi.get_root_nodes=function(t){for(var e=[],n=0,i=t.nodes;n<i.length;){var r=i[n];++n;for(var s=!1,a=0,o=r.outputs;a<o.length;){var l=o[a];++a;var u=Zi.getOutputLinks(l);if(null!=u&&0<u.length){s=!0;break}}s||e.push(r)}return e},Zi.build_default_node=function(t){var e=null;return"ACTION"==t.type?e=Zi.createClassInstance("NullNode",[Zi.tree]):"OBJECT"==t.type?e=Zi.createClassInstance("ObjectNode",[Zi.tree,t.default_value]):"ANIMACTION"==t.type?e=Zi.createClassInstance("StringNode",[Zi.tree,t.default_value]):"VECTOR"==t.type?(null==t.default_value&&(t.default_value=[0,0,0]),e=Zi.createClassInstance("VectorNode",[Zi.tree,t.default_value[0],t.default_value[1],t.default_value[2]])):"RGBA"==t.type?(null==t.default_value&&(t.default_value=[0,0,0]),e=Zi.createClassInstance("ColorNode",[Zi.tree,t.default_value[0],t.default_value[1],t.default_value[2],t.default_value[3]])):"RGB"==t.type?(null==t.default_value&&(t.default_value=[0,0,0]),e=Zi.createClassInstance("ColorNode",[Zi.tree,t.default_value[0],t.default_value[1],t.default_value[2]])):"VALUE"==t.type?e=Zi.createClassInstance("FloatNode",[Zi.tree,t.default_value]):"INT"==t.type?e=Zi.createClassInstance("IntegerNode",[Zi.tree,t.default_value]):"BOOLEAN"==t.type?e=Zi.createClassInstance("BooleanNode",[Zi.tree,t.default_value]):"STRING"==t.type&&(e=Zi.createClassInstance("StringNode",[Zi.tree,t.default_value])),e},Zi.createClassInstance=function(t,e){var n=q.resolveClass(Zi.packageName+"."+t);return null==n?null:q.createInstance(n,e)};var Xi=function(){};(n["armory.system.Starter"]=Xi).__name__="armory.system.Starter",Xi.main=function(i,r,s,a,o,l,u,h,_,c){Xi.tasks=1,Xi.tasks--,function(){if(!(0<Xi.tasks)){null==d.raw&&(d.raw={});var t=d.raw;null==t.window_mode&&(t.window_mode=r),null==t.window_resizable&&(t.window_resizable=s),null==t.window_minimizable&&(t.window_minimizable=a),null==t.window_maximizable&&(t.window_maximizable=o),null==t.window_w&&(t.window_w=l),null==t.window_h&&(t.window_h=u),null==t.window_msaa&&(t.window_msaa=h),null==t.window_vsync&&(t.window_vsync=_),Gi.register();var e=0==t.window_mode?0:1,n=0;t.window_resizable&&(n|=1),t.window_maximizable&&(n|=4),t.window_minimizable&&(n|=2),zs.start(new Ps("ArmorLogic",t.window_w,t.window_h,new Ks(null,null,null,null,null,null,null,n,e),new Ms(null,t.window_vsync,null,null,null,t.window_msaa)),function(t){mr.init(function(){br.setActive(i,function(t){vr.setActive(c())})})})}}()};var ji=function(t){this.onReady=null,this.canvas=null;var l=this;h.call(this),Cr.getBlob(t+".json",function(o){Cr.getFont("font_default.ttf",function(t){l.cui=new Bo({font:t,theme:Ao.light});var n=JSON.parse(o.toString());if(null==n.assets||0==n.assets.length)l.canvas=n;else for(var i=0,e=0,r=n.assets;e<r.length;){var s=[r[e]];++e;var a=s[0].name;Cr.getImage(a,function(e){return function(t){Mo.assetMap.set(e[0].id,t),(i+=1)>=n.assets.length&&(l.canvas=n)}}(s))}})}),this.notifyOnRender2D(function(t){if(null!=l.canvas){for(var e=Mo.draw(l.cui,l.canvas,t),n=0;n<e.length;){var i=e[n];++n;var r=zi.get(i);if(null!=r)for(var s=0;s<r.length;){var a=r[s];++s,a.onEvent()}}null!=l.onReady&&(l.onReady(),l.onReady=null)}})};(n["armory.trait.internal.CanvasScript"]=ji).__name__="armory.trait.internal.CanvasScript",ji.__super__=h,ji.prototype=r(h.prototype,{cui:null,canvas:null,get_ready:function(){return null!=this.canvas},onReady:null,getElement:function(t){for(var e=0,n=this.canvas.elements;e<n.length;){var i=n[e];if(++e,i.name==t)return i}return null},__class__:ji,__properties__:{get_ready:"get_ready"}});var Yi=function(){h.call(this)};(n["armory.trait.navigation.Navigation"]=Yi).__name__="armory.trait.navigation.Navigation",Yi.__super__=h,Yi.prototype=r(h.prototype,{__class__:Yi});var Ui=function(){h.call(this)};(n["armory.trait.physics.PhysicsWorld"]=Ui).__name__="armory.trait.physics.PhysicsWorld",Ui.__super__=h,Ui.prototype=r(h.prototype,{__class__:Ui});var Ki=function(){h.call(this)};(n["armory.trait.physics.RigidBody"]=Ki).__name__="armory.trait.physics.RigidBody",Ki.__super__=h,Ki.prototype=r(h.prototype,{__class__:Ki});var Qi=function(){};(n["haxe.IMap"]=Qi).__name__="haxe.IMap";var Ji=function(){};(n["haxe.Log"]=Ji).__name__="haxe.Log",Ji.formatOutput=function(t,e){var n=pt.string(t);if(null==e)return n;var i=e.fileName+":"+e.lineNumber;if(null!=e&&null!=e.customParams)for(var r=0,s=e.customParams;r<s.length;){var a=s[r];++r,n+=", "+pt.string(a)}return i+": "+n},Ji.trace=function(t,e){var n=Ji.formatOutput(t,e);"undefined"!=typeof console&&null!=console.log&&console.log(n)};var qi=function(){this.buf=new o,this.cache=[],this.useCache=qi.USE_CACHE,this.useEnumIndex=qi.USE_ENUM_INDEX,this.shash=new ur,this.scount=0};(n["haxe.Serializer"]=qi).__name__="haxe.Serializer",qi.run=function(t){var e=new qi;return e.serialize(t),e.toString()},qi.prototype={buf:null,cache:null,shash:null,scount:null,useCache:null,useEnumIndex:null,toString:function(){return this.buf.toString()},serializeString:function(t){var e=this.shash.get(t);if(null!=e)return this.buf.add("R"),void this.buf.add(e);this.shash.set(t,this.scount++),this.buf.add("y"),t=J.urlEncode(t),this.buf.add(t.length),this.buf.add(":"),this.buf.add(t)},serializeRef:function(t){for(var e=typeof t,n=0,i=this.cache.length;n<i;){var r=n++,s=this.cache[r];if(typeof s==e&&s==t)return this.buf.add("r"),this.buf.add(r),!0}return this.cache.push(t),!1},serializeFields:function(t){for(var e=0,n=ft.fields(t);e<n.length;){var i=n[e];++e,this.serializeString(i),this.serialize(ft.field(t,i))}this.buf.add("g")},serialize:function(t){var e=q.typeof(t);switch(e._hx_index){case 0:this.buf.add("n");break;case 1:var n=t;if(0==n)return void this.buf.add("z");this.buf.add("i"),this.buf.add(n);break;case 2:var i=t;isNaN(i)?this.buf.add("k"):isFinite(i)?(this.buf.add("d"),this.buf.add(i)):this.buf.add(i<0?"m":"p");break;case 3:this.buf.add(t?"t":"f");break;case 4:if(pt.is(t,Vo)){var r=q.getClassName(t);this.buf.add("A"),this.serializeString(r)}else if(pt.is(t,Ho))this.buf.add("B"),this.serializeString(q.getEnumName(t));else{if(this.useCache&&this.serializeRef(t))return;this.buf.add("o"),this.serializeFields(t)}break;case 5:throw new us("Cannot serialize function");case 6:var s=e.c;if(s==String)return void this.serializeString(t);if(this.useCache&&this.serializeRef(t))return;switch(s){case Array:var a=0;this.buf.add("a");for(var o=0,l=t.length;o<l;){var u=o++;null==t[u]?++a:(0<a&&(1==a?this.buf.add("n"):(this.buf.add("u"),this.buf.add(a)),a=0),this.serialize(t[u]))}0<a&&(1==a?this.buf.add("n"):(this.buf.add("u"),this.buf.add(a))),this.buf.add("h");break;case Date:var h=t;this.buf.add("v"),this.buf.add(h.getTime());break;case ir:this.buf.add("q");for(var _=t,c=_.keys();c.hasNext();){var d=c.next();this.buf.add(":"),this.buf.add(d),this.serialize(_.get(d))}this.buf.add("h");break;case rr:this.buf.add("l");for(var p=t.iterator();p.hasNext();){var g=p.next();this.serialize(g)}this.buf.add("h");break;case or:this.buf.add("M");for(var f=t,m=f.keys();m.hasNext();){var v=m.next(),y=ft.field(v,"__id__");ft.deleteField(v,"__id__"),this.serialize(v),ft.setField(v,"__id__",y),this.serialize(f.get(v))}this.buf.add("h");break;case ur:this.buf.add("b");for(var w=t,b=w.keys();b.hasNext();){var x=b.next();this.serializeString(x),this.serialize(w.get(x))}this.buf.add("h");break;case er:var S=t;this.buf.add("s"),this.buf.add(Math.ceil(8*S.length/6)),this.buf.add(":");var C=0,k=S.length-2,I=qi.BASE64_CODES;if(null==I){I=new Array(qi.BASE64.length);for(var T=0,N=qi.BASE64.length;T<N;){var M=T++;I[M]=ut.cca(qi.BASE64,M)}qi.BASE64_CODES=I}for(;C<k;){var O=S.get(C++),E=S.get(C++),A=S.get(C++);this.buf.addChar(I[O>>2]),this.buf.addChar(I[63&(O<<4|E>>4)]),this.buf.addChar(I[63&(E<<2|A>>6)]),this.buf.addChar(I[63&A])}if(C==k){var B=S.get(C++),L=S.get(C++);this.buf.addChar(I[B>>2]),this.buf.addChar(I[63&(B<<4|L>>4)]),this.buf.addChar(I[L<<2&63])}else if(C==k+1){var F=S.get(C++);this.buf.addChar(I[F>>2]),this.buf.addChar(I[F<<4&63])}break;default:this.useCache&&this.cache.pop(),null!=t.hxSerialize?(this.buf.add("C"),this.serializeString(q.getClassName(s)),this.useCache&&this.cache.push(t),t.hxSerialize(this),this.buf.add("g")):(this.buf.add("c"),this.serializeString(q.getClassName(s)),this.useCache&&this.cache.push(t),this.serializeFields(t))}break;case 7:var W=e.e;if(this.useCache){if(this.serializeRef(t))return;this.cache.pop()}this.buf.add(this.useEnumIndex?"j":"w"),this.serializeString(q.getEnumName(W)),this.useEnumIndex?(this.buf.add(":"),this.buf.add(t._hx_index)):this.serializeString(q.enumConstructor(t)),this.buf.add(":");var R=q.enumParameters(t);this.buf.add(R.length);for(var D=0;D<R.length;){var G=R[D];++D,this.serialize(G)}this.useCache&&this.cache.push(t);break;default:throw new us("Cannot serialize "+pt.string(t))}},__class__:qi};var $i=function(){};(n["haxe._Unserializer.DefaultResolver"]=$i).__name__="haxe._Unserializer.DefaultResolver",$i.prototype={resolveClass:function(t){return q.resolveClass(t)},resolveEnum:function(t){return q.resolveEnum(t)},__class__:$i};var tr=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=tr.DEFAULT_RESOLVER;null==e&&(e=new $i,tr.DEFAULT_RESOLVER=e),this.resolver=e};(n["haxe.Unserializer"]=tr).__name__="haxe.Unserializer",tr.initCodes=function(){for(var t=[],e=0,n=tr.BASE64.length;e<n;){var i=e++;t[J.fastCodeAt(tr.BASE64,i)]=i}return t},tr.run=function(t){return new tr(t).unserialize()},tr.prototype={buf:null,pos:null,length:null,cache:null,scache:null,resolver:null,get:function(t){return J.fastCodeAt(this.buf,t)},readDigits:function(){for(var t=0,e=!1,n=this.pos;;){var i=this.get(this.pos);if(J.isEof(i))break;if(45!=i){if(i<48||57<i)break;t=10*t+(i-48),this.pos++}else{if(this.pos!=n)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.get(this.pos);if(J.isEof(e))break;if(!(43<=e&&e<58||101==e||69==e))break;this.pos++}return pt.parseFloat(ut.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new us("Invalid object");if(103==this.get(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new us("Invalid object key");var n=this.unserialize();ft.setField(t,e,n)}this.pos++},unserializeEnum:function(t,e){if(58!=this.get(this.pos++))throw new us("Invalid enum format");var n=this.readDigits();if(0==n)return q.createEnum(t,e);for(var i=[];0<n--;)i.push(this.unserialize());return q.createEnum(t,e,i)},unserialize:function(){switch(this.get(this.pos++)){case 65:var t=this.unserialize(),e=this.resolver.resolveClass(t);if(null==e)throw new us("Class not found "+t);return e;case 66:var n=this.unserialize(),i=this.resolver.resolveEnum(n);if(null==i)throw new us("Enum not found "+n);return i;case 67:var r=this.unserialize(),s=this.resolver.resolveClass(r);if(null==s)throw new us("Class not found "+r);var a=q.createEmptyInstance(s);if(this.cache.push(a),a.hxUnserialize(this),103!=this.get(this.pos++))throw new us("Invalid custom data");return a;case 77:var o=new or;this.cache.push(o);for(this.buf;104!=this.get(this.pos);){var l=this.unserialize();o.set(l,this.unserialize())}return this.pos++,o;case 82:var u=this.readDigits();if(u<0||u>=this.scache.length)throw new us("Invalid string reference");return this.scache[u];case 97:this.buf;var h=[];for(this.cache.push(h);;){var _=this.get(this.pos);if(104==_){this.pos++;break}if(117==_){this.pos++;var c=this.readDigits();h[h.length+c-1]=null}else h.push(this.unserialize())}return h;case 98:var d=new ur;this.cache.push(d);for(this.buf;104!=this.get(this.pos);){var p=this.unserialize();d.set(p,this.unserialize())}return this.pos++,d;case 99:var g=this.unserialize(),f=this.resolver.resolveClass(g);if(null==f)throw new us("Class not found "+g);var m=q.createEmptyInstance(f);return this.cache.push(m),this.unserializeObject(m),m;case 100:return this.readFloat();case 102:return!1;case 105:return this.readDigits();case 106:var v=this.unserialize(),y=this.resolver.resolveEnum(v);if(null==y)throw new us("Enum not found "+v);this.pos++;var w=this.readDigits(),b=q.getEnumConstructs(y)[w];if(null==b)throw new us("Unknown enum index "+v+"@"+w);var x=this.unserializeEnum(y,b);return this.cache.push(x),x;case 107:return NaN;case 108:var S=new rr;this.cache.push(S);for(this.buf;104!=this.get(this.pos);)S.add(this.unserialize());return this.pos++,S;case 109:return-1/0;case 110:return null;case 111:var C={};return this.cache.push(C),this.unserializeObject(C),C;case 112:return 1/0;case 113:var k=new ir;this.cache.push(k);this.buf;for(var I=this.get(this.pos++);58==I;){var T=this.readDigits();k.set(T,this.unserialize()),I=this.get(this.pos++)}if(104!=I)throw new us("Invalid IntMap format");return k;case 114:var N=this.readDigits();if(N<0||N>=this.cache.length)throw new us("Invalid reference");return this.cache[N];case 115:var M=this.readDigits(),O=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<M)throw new us("Invalid bytes length");var E=tr.CODES;null==E&&(E=tr.initCodes(),tr.CODES=E);for(var A=this.pos,B=3&M,L=3*(M>>2)+(2<=B?B-1:0),F=A+(M-B),W=er.alloc(L),R=0;A<F;){var D=E[J.fastCodeAt(O,A++)],G=E[J.fastCodeAt(O,A++)];W.set(R++,D<<2|G>>4);var V=E[J.fastCodeAt(O,A++)];W.set(R++,G<<4|V>>2);var H=E[J.fastCodeAt(O,A++)];W.set(R++,V<<6|H)}if(2<=B){var P=E[J.fastCodeAt(O,A++)],z=E[J.fastCodeAt(O,A++)];if(W.set(R++,P<<2|z>>4),3==B){var Z=E[J.fastCodeAt(O,A++)];W.set(R++,z<<4|Z>>2)}}return this.pos+=M,this.cache.push(W),W;case 116:return!0;case 118:var X;return 48<=this.get(this.pos)&&this.get(this.pos)<=57&&48<=this.get(this.pos+1)&&this.get(this.pos+1)<=57&&48<=this.get(this.pos+2)&&this.get(this.pos+2)<=57&&48<=this.get(this.pos+3)&&this.get(this.pos+3)<=57&&45==this.get(this.pos+4)?(X=ut.strDate(ut.substr(this.buf,this.pos,19)),this.pos+=19):X=new Date(this.readFloat()),this.cache.push(X),X;case 119:var j=this.unserialize(),Y=this.resolver.resolveEnum(j);if(null==Y)throw new us("Enum not found "+j);var U=this.unserializeEnum(Y,this.unserialize());return this.cache.push(U),U;case 120:throw us.wrap(this.unserialize());case 121:var K=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<K)throw new us("Invalid string length");var Q=ut.substr(this.buf,this.pos,K);return this.pos+=K,Q=J.urlDecode(Q),this.scache.push(Q),Q;case 122:return 0}throw this.pos--,new us("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:tr};var er=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),(this.b.bufferValue=t).hxBytes=this,t.bytes=this.b};(n["haxe.io.Bytes"]=er).__name__="haxe.io.Bytes",er.alloc=function(t){return new er(new ArrayBuffer(t))},er.ofString=function(t,e){if(e==nr.RawNative){for(var n=new Uint8Array(t.length<<1),i=0,r=t.length;i<r;){var s=i++,a=J.fastCodeAt(t,s);n[s<<1]=255&a,n[s<<1|1]=a>>8}return new er(n.buffer)}for(var o=[],l=0;l<t.length;){var u=J.fastCodeAt(t,l++);55296<=u&&u<=56319&&(u=u-55232<<10|1023&J.fastCodeAt(t,l++)),u<=127?o.push(u):(u<=2047?o.push(192|u>>6):(u<=65535?o.push(224|u>>12):(o.push(240|u>>18),o.push(128|u>>12&63)),o.push(128|u>>6&63)),o.push(128|63&u))}return new er(new Uint8Array(o).buffer)},er.ofData=function(t){var e=t.hxBytes;return null!=e?e:new er(t)},er.prototype={length:null,b:null,data:null,get:function(t){return this.b[t]},set:function(t,e){this.b[t]=e},blit:function(t,e,n,i){if(t<0||n<0||i<0||t+i>this.length||n+i>e.length)throw new us(pr.OutsideBounds);0==n&&i==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(n,n+i),t)},sub:function(t,e){if(t<0||e<0||t+e>this.length)throw new us(pr.OutsideBounds);return new er(this.b.buffer.slice(t+this.b.byteOffset,t+this.b.byteOffset+e))},initData:function(){null==this.data&&(this.data=new DataView(this.b.buffer,this.b.byteOffset,this.b.byteLength))},setInt32:function(t,e){this.initData(),this.data.setInt32(t,e,!0)},getString:function(t,e,n){if(t<0||e<0||t+e>this.length)throw new us(pr.OutsideBounds);null==n&&(n=nr.UTF8);var i="",r=this.b,s=t,a=t+e;switch(n._hx_index){case 0:for(;s<a;){var o=r[s++];if(o<128){if(0==o)break;i+=String.fromCodePoint(o)}else if(o<224){var l=(63&o)<<6|127&r[s++];i+=String.fromCodePoint(l)}else if(o<240){var u=(31&o)<<12|(127&r[s++])<<6|127&r[s++];i+=String.fromCodePoint(u)}else{var h=(15&o)<<18|(127&r[s++])<<12|(127&r[s++])<<6|127&r[s++];i+=String.fromCodePoint(h)}}break;case 1:for(;s<a;){var _=r[s++]|r[s++]<<8;i+=String.fromCodePoint(_)}}return i},toString:function(){return this.getString(0,this.length)},getData:function(){return this.b.bufferValue},__class__:er};var nr=w["haxe.io.Encoding"]={__ename__:"haxe.io.Encoding",__constructs__:["UTF8","RawNative"],UTF8:{_hx_index:0,__enum__:"haxe.io.Encoding",toString:i},RawNative:{_hx_index:1,__enum__:"haxe.io.Encoding",toString:i}},ir=function(){this.h={}};(n["haxe.ds.IntMap"]=ir).__name__="haxe.ds.IntMap",ir.__interfaces__=[Qi],ir.prototype={h:null,set:function(t,e){this.h[t]=e},get:function(t){return this.h[t]},exists:function(t){return this.h.hasOwnProperty(t)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return ut.iter(t)},__class__:ir};var rr=function(){this.length=0};(n["haxe.ds.List"]=rr).__name__="haxe.ds.List",rr.prototype={h:null,q:null,length:null,add:function(t){var e=new sr(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},iterator:function(){return new ar(this.h)},__class__:rr};var sr=function(t,e){this.item=t,this.next=e};(n["haxe.ds._List.ListNode"]=sr).__name__="haxe.ds._List.ListNode",sr.prototype={item:null,next:null,__class__:sr};var ar=function(t){this.head=t};(n["haxe.ds._List.ListIterator"]=ar).__name__="haxe.ds._List.ListIterator",ar.prototype={head:null,hasNext:function(){return null!=this.head},next:function(){var t=this.head.item;return this.head=this.head.next,t},__class__:ar};var or=function(){this.h={__keys__:{}}};(n["haxe.ds.ObjectMap"]=or).__name__="haxe.ds.ObjectMap",or.__interfaces__=[Qi],or.assignId=function(t){return t.__id__=++or.count},or.getId=function(t){return t.__id__},or.prototype={h:null,set:function(t,e){var n=or.getId(t)||or.assignId(t);this.h[n]=e,this.h.__keys__[n]=t},get:function(t){return this.h[or.getId(t)]},keys:function(){var t=[];for(var e in this.h.__keys__)this.h.hasOwnProperty(e)&&t.push(this.h.__keys__[e]);return ut.iter(t)},__class__:or};var lr=function(t,e){this.map=t,this.keys=e,this.index=0,this.count=e.length};(n["haxe.ds._StringMap.StringMapIterator"]=lr).__name__="haxe.ds._StringMap.StringMapIterator",lr.prototype={map:null,keys:null,index:null,count:null,hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:lr};var ur=function(){this.h={}};(n["haxe.ds.StringMap"]=ur).__name__="haxe.ds.StringMap",ur.__interfaces__=[Qi],ur.prototype={h:null,rh:null,isReserved:function(t){return null!=Po[t]},set:function(t,e){this.isReserved(t)?this.setReserved(t,e):this.h[t]=e},get:function(t){return this.isReserved(t)?this.getReserved(t):this.h[t]},setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},remove:function(t){return this.isReserved(t)?(t="$"+t,!(null==this.rh||!this.rh.hasOwnProperty(t))&&(delete this.rh[t],!0)):!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){return ut.iter(this.arrayKeys())},arrayKeys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(e);if(null!=this.rh)for(var e in this.rh)36==e.charCodeAt(0)&&t.push(e.substr(1));return t},iterator:function(){return new lr(this,this.arrayKeys())},__class__:ur};var hr=function(){this.pos=0,this.size=0};(n["haxe.io.BytesBuffer"]=hr).__name__="haxe.io.BytesBuffer",hr.prototype={buffer:null,view:null,u8:null,pos:null,size:null,addByte:function(t){this.pos==this.size&&this.grow(1),this.view.setUint8(this.pos++,t)},grow:function(t){for(var e=this.pos+t,n=0==this.size?16:this.size;n<e;)n=3*n>>1;var i=new ArrayBuffer(n),r=new Uint8Array(i);0<this.size&&r.set(this.u8),this.size=n,this.buffer=i,this.u8=r,this.view=new DataView(this.buffer)},getBytes:function(){if(0==this.size)return er.alloc(0);var t=new er(this.buffer);return t.length=this.pos,t},__class__:hr};var _r=function(){};(n["haxe.io.Input"]=_r).__name__="haxe.io.Input",_r.prototype={bigEndian:null,readByte:function(){throw new us("Not implemented")},readBytes:function(t,e,n){var i=n,r=t.b;if(e<0||n<0||e+n>t.length)throw new us(pr.OutsideBounds);try{for(;0<i;)r[e]=this.readByte(),++e,--i}catch(t){var s=t instanceof us?t.val:t;if(!(s instanceof dr))throw t}return n-i},set_bigEndian:function(t){return this.bigEndian=t},readFullBytes:function(t,e,n){for(;0<n;){var i=this.readBytes(t,e,n);if(0==i)throw new us(pr.Blocked);e+=i,n-=i}},read:function(t){for(var e=er.alloc(t),n=0;0<t;){var i=this.readBytes(e,n,t);if(0==i)throw new us(pr.Blocked);n+=i,t-=i}return e},readFloat:function(){return gr.i32ToFloat(this.readInt32())},readInt8:function(){var t=this.readByte();return 128<=t?t-256:t},readInt16:function(){var t=this.readByte(),e=this.readByte(),n=this.bigEndian?e|t<<8:t|e<<8;return 0!=(32768&n)?n-65536:n},readUInt16:function(){var t=this.readByte(),e=this.readByte();return this.bigEndian?e|t<<8:t|e<<8},readInt32:function(){var t=this.readByte(),e=this.readByte(),n=this.readByte(),i=this.readByte();return this.bigEndian?i|n<<8|e<<16|t<<24:t|e<<8|n<<16|i<<24},readString:function(t,e){var n=er.alloc(t);return this.readFullBytes(n,0,t),n.getString(0,t,e)},__class__:_r,__properties__:{set_bigEndian:"set_bigEndian"}};var cr=function(t,e,n){if(null==e&&(e=0),null==n&&(n=t.length-e),e<0||n<0||e+n>t.length)throw new us(pr.OutsideBounds);this.b=t.b,this.pos=e,this.len=n,this.totlen=n};(n["haxe.io.BytesInput"]=cr).__name__="haxe.io.BytesInput",cr.__super__=_r,cr.prototype=r(_r.prototype,{b:null,pos:null,len:null,totlen:null,get_position:function(){return this.pos},get_length:function(){return this.totlen},set_position:function(t){return t<0?t=0:t>this.get_length()&&(t=this.get_length()),this.len=this.totlen-t,this.pos=t},readByte:function(){if(0==this.len)throw new us(new dr);return this.len--,this.b[this.pos++]},readBytes:function(t,e,n){if(e<0||n<0||e+n>t.length)throw new us(pr.OutsideBounds);if(0==this.len&&0<n)throw new us(new dr);this.len<n&&(n=this.len);for(var i=this.b,r=t.b,s=0,a=n;s<a;){var o=s++;r[e+o]=i[this.pos+o]}return this.pos+=n,this.len-=n,n},__class__:cr,__properties__:r(_r.prototype.__properties__,{get_length:"get_length",set_position:"set_position",get_position:"get_position"})});var dr=function(){};(n["haxe.io.Eof"]=dr).__name__="haxe.io.Eof",dr.prototype={toString:function(){return"Eof"},__class__:dr};var pr=w["haxe.io.Error"]={__ename__:"haxe.io.Error",__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:{_hx_index:0,__enum__:"haxe.io.Error",toString:i},Overflow:{_hx_index:1,__enum__:"haxe.io.Error",toString:i},OutsideBounds:{_hx_index:2,__enum__:"haxe.io.Error",toString:i},Custom:(S=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:i}},S.__params__=["e"],S)},gr=function(){};(n["haxe.io.FPHelper"]=gr).__name__="haxe.io.FPHelper",gr.i32ToFloat=function(t){return gr.helper.setInt32(0,t,!0),gr.helper.getFloat32(0,!0)};var fr={};(n["haxe.io._UInt8Array.UInt8Array_Impl_"]=fr).__name__="haxe.io._UInt8Array.UInt8Array_Impl_",fr.fromBytes=function(t,e,n){return null==e&&(e=0),null==n&&(n=t.length-e),new Uint8Array(t.getData(),e,n)};var mr=function(t){t(),zs.notifyOnFrames(mr.render),Ws.addTimeTask(mr.update,0,os.get_delta())};(n["iron.App"]=mr).__name__="iron.App",mr.w=function(){return _.w()},mr.h=function(){return _.h()},mr.x=function(){return _.x()},mr.y=function(){return _.y()},mr.init=function(t){new mr(t)},mr.update=function(){if(null!=br.active&&br.active.ready&&!mr.pauseUpdates){os.update(),br.active.updateFrame();for(var t=0,e=mr.traitUpdates.length;t<e;){if(0<mr.traitInits.length){for(var n=0,i=mr.traitInits;n<i.length;){var r=i[n];if(++n,!(0<mr.traitInits.length))break;r()}mr.traitInits.splice(0,mr.traitInits.length)}mr.traitUpdates[t](),e<=mr.traitUpdates.length?++t:e=mr.traitUpdates.length}for(t=0,e=mr.traitLateUpdates.length;t<e;)mr.traitLateUpdates[t](),e<=mr.traitLateUpdates.length?++t:e=mr.traitLateUpdates.length;if(null!=mr.onEndFrames)for(var s=0,a=mr.onEndFrames;s<a.length;){var o=a[s];++s,o()}-1==mr.lastw&&(mr.lastw=mr.w(),mr.lasth=mr.h()),mr.lastw==mr.w()&&mr.lasth==mr.h()||null!=br.active&&null!=br.active.camera&&br.active.camera.buildProjection(),mr.lastw=mr.w(),mr.lasth=mr.h()}},mr.render=function(t){var e=t[0];if(mr.framebuffer=e,null!=br.active&&br.active.ready){if(0<mr.traitInits.length){for(var n=0,i=mr.traitInits;n<i.length;){var r=i[n];if(++n,!(0<mr.traitInits.length))break;r()}mr.traitInits.splice(0,mr.traitInits.length)}br.active.renderFrame(e.get_g4());for(var s=0,a=mr.traitRenders;s<a.length;){var o=a[s];if(++s,!(0<mr.traitRenders.length))break;o(e.get_g4())}mr.render2D(e)}else mr.render2D(e)},mr.render2D=function(t){if(0<mr.traitRenders2D.length){t.get_g2().begin(!1);for(var e=0,n=mr.traitRenders2D;e<n.length;){var i=n[e];if(++e,!(0<mr.traitRenders2D.length))break;i(t.get_g2())}t.get_g2().end()}},mr.notifyOnInit=function(t){mr.traitInits.push(t)},mr.removeInit=function(t){ut.remove(mr.traitInits,t)},mr.notifyOnUpdate=function(t){mr.traitUpdates.push(t)},mr.removeUpdate=function(t){ut.remove(mr.traitUpdates,t)},mr.notifyOnLateUpdate=function(t){mr.traitLateUpdates.push(t)},mr.removeLateUpdate=function(t){ut.remove(mr.traitLateUpdates,t)},mr.removeRender=function(t){ut.remove(mr.traitRenders,t)},mr.notifyOnRender2D=function(t){mr.traitRenders2D.push(t)},mr.removeRender2D=function(t){ut.remove(mr.traitRenders2D,t)},mr.notifyOnReset=function(t){null==mr.onResets&&(mr.onResets=[]),mr.onResets.push(t)},mr.notifyOnEndFrame=function(t){null==mr.onEndFrames&&(mr.onEndFrames=[]),mr.onEndFrames.push(t)},mr.prototype={__class__:mr};var vr=function(){this.depthToRenderTarget=new ur,this.renderTargets=new ur,this.commands=null,this.loading=0,this.paused=!1,this.drawOrder=1,this.lastFrameTime=0,this.viewportScaled=!1,this.scissorSet=!1,this.lastH=0,this.lastW=0,this.isProbe=!1,this.isProbeCube=!1,this.isProbePlanar=!1,this.currentLightIndex=0,this.currentTarget=null,this.frameTime=0,this.frameScissorH=0,this.frameScissorW=0,this.frameScissorY=0,this.frameScissorX=0,this.frameScissor=!1};(n["iron.RenderPath"]=vr).__name__="iron.RenderPath",vr.setActive=function(t){vr.active=t},vr.sortMeshesDistance=function(t){t.sort(function(t,e){return t.cameraDistance>=e.cameraDistance?1:-1})},vr.sortMeshesShader=function(t){t.sort(function(t,e){return t.materials[0].name>=e.materials[0].name?1:-1})},vr.prototype={frameScissor:null,frameScissorX:null,frameScissorY:null,frameScissorW:null,frameScissorH:null,frameTime:null,currentTarget:null,currentFace:null,currentLightIndex:null,isProbePlanar:null,isProbeCube:null,isProbe:null,currentW:null,currentH:null,currentD:null,lastW:null,lastH:null,bindParams:null,meshesSorted:null,scissorSet:null,viewportScaled:null,currentG:null,frameG:null,lastFrameTime:null,drawOrder:null,paused:null,get_ready:function(){return 0==this.loading},loading:null,commands:null,renderTargets:null,depthToRenderTarget:null,getLight:function(t){return 0<br.active.lights.length?br.active.lights[t]:null},renderFrame:function(t){if(this.get_ready()&&!this.paused&&0!=mr.w()&&0!=mr.h()){0<this.lastW&&(this.lastW!=mr.w()||this.lastH!=mr.h())&&this.resize(),this.lastW=mr.w(),this.lastH=mr.h(),this.frameTime=os.time()-this.lastFrameTime,this.lastFrameTime=os.time();var e=br.active.camera;this.isProbePlanar=null!=e&&null!=e.renderTarget,this.isProbeCube=null!=e&&null!=e.renderTargetCube,this.isProbe=this.isProbePlanar||this.isProbeCube,this.isProbePlanar?this.frameG=e.renderTarget.get_g4():this.isProbeCube?this.frameG=e.renderTargetCube.get_g4():this.frameG=t,this.currentG=this.frameG,this.currentW=mr.w(),this.currentH=mr.h(),this.currentD=1,this.currentFace=-1,this.meshesSorted=!1;for(var n=this.currentLightIndex=0,i=br.active.lights;n<i.length;){var r=i[n];++n,r.visible&&r.buildMatrix(br.active.camera)}this.commands()}},setTarget:function(t,e,n){if(null==n&&(n=1),""==t)this.currentG=this.frameG,this.currentD=1,this.currentTarget=null,this.currentFace=-1,this.isProbeCube?(this.currentW=br.active.camera.renderTargetCube.get_width(),this.currentH=br.active.camera.renderTargetCube.get_width(),this.begin(this.currentG,null,br.active.camera.currentFace)):(this.currentW=mr.w(),this.currentH=mr.h(),this.frameScissor&&this.setFrameScissor(),this.begin(this.currentG),this.isProbe||(this.setCurrentViewport(mr.w(),mr.h()),this.setCurrentScissor(mr.w(),mr.h())));else{var i=this.renderTargets.get(t);this.currentTarget=i;var r=null;if(null!=e){r=[];for(var s=0;s<e.length;){var a=e[s];++s;var o=this.renderTargets.get(a);r.push(o.image)}}this.currentG=i.isCubeMap?i.cubeMap.get_g4():i.image.get_g4(),this.currentW=i.isCubeMap?i.cubeMap.get_width():i.image.get_width(),this.currentH=i.isCubeMap?i.cubeMap.get_height():i.image.get_height(),i.is3D&&(this.currentD=i.image.get_depth()),this.begin(this.currentG,r,this.currentFace)}if(1!=n){this.viewportScaled=!0;var l=pt.int(this.currentW*n),u=pt.int(this.currentH*n);this.currentG.viewport(0,u,l,u),this.currentG.scissor(0,u,l,u)}else this.viewportScaled&&(this.viewportScaled=!1,this.setCurrentViewport(this.currentW,this.currentH),this.setCurrentScissor(this.currentW,this.currentH));this.bindParams=null},begin:function(t,e,n){null==n&&(n=-1),0<=n?t.beginFace(5-n):t.begin(e)},end:function(t){t.end(),this.scissorSet&&(t.disableScissor(),this.scissorSet=!1),this.bindParams=null},setCurrentViewport:function(t,e){this.currentG.viewport(mr.x(),this.currentH-e-mr.y(),t,e)},setCurrentScissor:function(t,e){this.currentG.scissor(mr.x(),this.currentH-e-mr.y(),t,e),this.scissorSet=!0},setFrameScissor:function(){this.frameG.scissor(this.frameScissorX,this.currentH-(this.frameScissorH-this.frameScissorY),this.frameScissorW,this.frameScissorH)},clearTarget:function(t,e){if(-1==t)if(null!=br.active.world)t=br.active.world.raw.background_color;else if(null!=br.active.camera){var n=br.active.camera.data.raw.clear_color;null!=n&&(t=Cs.fromFloats(n[0],n[1],n[2]))}this.currentG.clear(t,e,null)},drawMeshes:function(t){var e=this.getLight(this.currentLightIndex);if((null==e||e.visible||!(0<this.currentLightIndex))&&(!("shadowmap"==t)||null!=e&&e.data.raw.cast_shadow&&0!=e.data.raw.strength)){0<=this.currentFace&&null!=e&&e.setCubeFace(5-this.currentFace,br.active.camera);var n=this.currentG;this.submitDraw(t),this.end(n)}},submitDraw:function(t){var e=this.getLight(this.currentLightIndex),n=br.active.camera,i=br.active.meshes,r=this.currentG;if(Pr.lastPipeline=null,!this.meshesSorted&&null!=n){for(var s=n.transform.worldx(),a=n.transform.worldy(),o=n.transform.worldz(),l=0;l<i.length;){var u=i[l];++l,u.computeCameraDistance(s,a,o)}1==this.drawOrder?vr.sortMeshesShader(i):vr.sortMeshesDistance(i),this.meshesSorted=!0}for(var h=0;h<i.length;){var _=i[h];++h,_.render(r,t,n,e,this.bindParams)}},resize:function(){for(var t=this.renderTargets.iterator();t.hasNext();){var e=t.next();0==e.raw.width&&(e.image.unload(),e.image=this.createImage(e.raw,e.depthStencil),""!=e.depthStencilFrom&&e.image.setDepthStencilFrom(this.depthToRenderTarget.get(e.depthStencilFrom).image))}},createImage:function(t,e){var n=0==t.width?mr.w():t.width,i=0==t.height?mr.h():t.height,r=null!=t.depth?t.depth:0;if(null!=t.displayp&&(i<n?(n=pt.int(n*(t.displayp/i)),i=t.displayp):(i=pt.int(i*(t.displayp/n)),n=t.displayp)),null!=t.scale&&(n=pt.int(n*t.scale),i=pt.int(i*t.scale),r=pt.int(r*t.scale)),null!=t.depth&&1<t.depth){var s=xs.create3D(n,i,r,null!=t.format?this.getTextureFormat(t.format):za.RGBA32);return t.mipmaps&&s.generateMipmaps(1e3),s}return null!=t.is_image&&t.is_image?xs.create(n,i,null!=t.format?this.getTextureFormat(t.format):za.RGBA32):xs.createRenderTarget(n,i,null!=t.format?this.getTextureFormat(t.format):za.RGBA32,e)},getTextureFormat:function(t){switch(t){case"A16":return za.A16;case"A32":return za.A32;case"A8":return za.L8;case"DEPTH16":return za.DEPTH16;case"R16":return za.A16;case"R32":return za.A32;case"R8":return za.L8;case"RGBA128":return za.RGBA128;case"RGBA32":return za.RGBA32;case"RGBA64":return za.RGBA64;default:return za.RGBA32}},__class__:vr,__properties__:{get_ready:"get_ready"}};var yr=function(){this.is_image=null,this.depth=null,this.mipmaps=null,this.displayp=null,this.scale=null,this.format=null};(n["iron.RenderTargetRaw"]=yr).__name__="iron.RenderTargetRaw",yr.prototype={width:null,height:null,format:null,scale:null,displayp:null,mipmaps:null,depth:null,is_image:null,__class__:yr};var wr=function(t){this.isCubeMap=!1,this.is3D=!1,this.cubeMap=null,this.image=null,this.depthStencilFrom="",this.raw=t};(n["iron.RenderTarget"]=wr).__name__="iron.RenderTarget",wr.prototype={raw:null,depthStencil:null,depthStencilFrom:null,image:null,cubeMap:null,is3D:null,isCubeMap:null,__class__:wr};var br=function(){this.traitRemoves=[],this.traitInits=[],this.groups=null,this.uid=br.uidCounter++,this.meshes=[],this.lights=[],this.cameras=[],this.speakers=[],this.empties=[],this.animations=[],this.armatures=[],this.embedded=new ur,this.root=new Rr,this.root.name="Root",this.traitInits=[],this.traitRemoves=[],null==br.global&&(br.global=new Rr)};(n["iron.Scene"]=br).__name__="iron.Scene",br.create=function(r,s){br.active=new br,br.active.ready=!1,br.active.raw=r,Cr.getWorld(r.name,r.world_ref,function(t){br.active.world=t,br.active.addScene(r.name,null,function(t){0==br.active.cameras.length&&Ji.trace('No camera found for scene "'+r.name+'"',{fileName:"Sources/iron/Scene.hx",lineNumber:91,className:"iron.Scene",methodName:"create"}),br.active.camera=br.active.getCamera(r.camera_ref),br.active.ready=!0;for(var e=0,n=br.active.traitInits;e<n.length;){var i=n[e];++e,i()}br.active.traitInits=[],br.active.sceneParent=t,s(t)})})},br.setActive=function(t,e){br.framePassed&&(br.framePassed=!1,null!=br.active&&br.active.remove(),Cr.getSceneRaw(t,function(t){br.create(t,function(t){null!=e&&e(t)})}))},br.generateTransform=function(t,e){e.world=null!=t.transform?bi.fromFloat32Array(t.transform.values):bi.identity(),e.world.decompose(e.loc,e.rot,e.scale),null!=t.local_only&&(e.localOnly=t.local_only),null!=e.object.parent&&e.update()},br.createTraits=function(t,e){if(null!=t)for(var n=0;n<t.length;){var i=t[n];if(++n,"Script"==i.type){var r=[];if(null!=i.parameters)for(var s=0,a=i.parameters;s<a.length;){var o=a[s];++s,r.push(br.parseArg(o))}var l=br.createTraitClassInstance(i.class_name,r);if(null==l){Ji.trace("Error: Trait '"+i.class_name+"' referenced in object '"+e.name+"' not found",{fileName:"Sources/iron/Scene.hx",lineNumber:617,className:"iron.Scene",methodName:"createTraits"});continue}if(null!=i.props)for(var u=0,h=pt.int(i.props.length/2);u<h;){var _=u++,c=i.props[2*_],d=i.props[2*_+1];""!=d&&ft.setProperty(l,c,br.parseArg(d))}e.addTrait(l)}}},br.parseArg=function(t){if("true"==t)return!0;if("false"==t)return!1;if("null"==t)return null;if("'"==t.charAt(0))return J.replace(t,"'","");if('"'==t.charAt(0))return J.replace(t,'"',"");if("["==t.charAt(0)){t=J.replace(t,"[",""),t=J.replace(t,"]","");for(var e=[],n=(t=J.replace(t," ","")).split(","),i=0;i<n.length;){var r=n[i];++i,e.push(br.parseArg(r))}return e}var s=pt.parseFloat(t),a=pt.parseInt(t);return s==a?a:s},br.createConstraints=function(t,e){if(null!=t){e.constraints=[];for(var n=0;n<t.length;){var i=t[n];++n;var r=new Vr(i);e.constraints.push(r)}}},br.createTraitClassInstance=function(t,e){var n=q.resolveClass(t);return null==n?null:q.createInstance(n,e)},br.prototype={uid:null,raw:null,root:null,sceneParent:null,camera:null,world:null,meshes:null,lights:null,cameras:null,speakers:null,empties:null,animations:null,armatures:null,groups:null,embedded:null,ready:null,traitInits:null,traitRemoves:null,remove:function(){for(var t=0,e=this.traitRemoves;t<e.length;){var n=e[t];++t,n()}for(var i=0,r=this.meshes;i<r.length;){var s=r[i];++i,s.remove()}for(var a=0,o=this.lights;a<o.length;){var l=o[a];++a,l.remove()}for(var u=0,h=this.cameras;u<h.length;){var _=h[u];++u,_.remove()}for(var c=0,d=this.speakers;c<d.length;){var p=d[c];++c,p.remove()}for(var g=0,f=this.empties;g<f.length;){var m=f[g];++g,m.remove()}this.groups=null,this.root.remove()},updateFrame:function(){if(this.ready){for(var t=0,e=this.animations;t<e.length;){var n=e[t];++t,n.update(os.get_delta())}for(var i=0,r=this.empties;i<r.length;){var s=r[i];++i,null!=s&&null!=s.parent&&s.transform.update()}}},renderFrame:function(t){this.ready&&null!=vr.active&&(br.framePassed=!0,null!=this.camera?this.camera.renderFrame(t):vr.active.renderFrame(t))},addObject:function(t){var e=new Rr;return null!=t?t.addChild(e):this.root.addChild(e),e},getChild:function(t){return this.root.getChild(t)},getTrait:function(t){return 0<this.root.children.length?this.root.children[0].getTrait(t):null},getCamera:function(t){for(var e=0,n=this.cameras;e<n.length;){var i=n[e];if(++e,i.name==t)return i}return null},addMeshObject:function(t,e,n){var i=new Pr(t,e);return null!=n?n.addChild(i):this.root.addChild(i),i},addLightObject:function(t,e){var n=new Hr(t);return null!=e?e.addChild(n):this.root.addChild(n),n},addCameraObject:function(t,e){var n=new Dr(t);return null!=e?e.addChild(n):this.root.addChild(n),n},addSpeakerObject:function(t,e){var n=new Zr(t);return null!=e?e.addChild(n):this.root.addChild(n),n},addScene:function(t,e,n){var d=this;null==e&&((e=this.addObject()).name=t),Cr.getSceneRaw(t,function(c){br.createTraits(c.traits,e),d.loadEmbeddedData(c.embedded_datas,function(){var u=0,h=d.getObjectsCount(c.objects),_=null;_=function(t,e,n,i){if(null!=e)for(var r=0,s=e.length;r<s;){var a=[e[r++]];if(null==a[0].spawn||0!=a[0].spawn){var o=a[0],l=function(e){return function(t){null!=t&&_(t,e[0].children,e[0],i),(u+=1)==h&&i()}}(a);d.createObject(o,c,t,n,l)}else(u+=1)==h&&i()}},null==c.objects||0==c.objects.length?n(e):_(e,c.objects,null,function(){n(e)})})})},getObjectsCount:function(t,e){if(null==e&&(e=!0),null==t)return 0;for(var n=t.length,i=0;i<t.length;){var r=t[i];++i,e&&null!=r.spawn&&0==r.spawn||null!=r.children&&(n+=this.getObjectsCount(r.children))}return n},spawnObject:function(t,e,n,a){null==a&&(a=!0);var i=this,o=0,r=this.getObj(this.raw,t),l=a?this.getObjectsCount([r],!1):1,u=null;(u=function(r,t,e,s){i.createObject(r,i.raw,t,e,function(t){if(a&&null!=r.children)for(var e=0,n=r.children;e<n.length;){var i=n[e];++e,u(i,t,r,s)}(o+=1)==l&&null!=s&&s(t)})})(r,e,null,n)},getObj:function(t,e){return this.traverseObjs(t.objects,e)},traverseObjs:function(t,e){for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i;if(null!=i.children){var r=this.traverseObjs(i.children,e);if(null!=r)return r}}return null},createObject:function(_,t,c,d,p){var g=this,f=t.name;if("camera_object"==_.type)Cr.getCamera(f,_.data_ref,function(t){var e=g.addCameraObject(t,c);g.returnObject(e,_,p)});else if("light_object"==_.type)Cr.getLight(f,_.data_ref,function(t){var e=g.addLightObject(t,c);g.returnObject(e,_,p)});else if("mesh_object"==_.type)if(null==_.material_refs||0==_.material_refs.length){var e=this.addObject(c);this.returnObject(e,_,p)}else for(var m=new Array(_.material_refs.length),a=0,n=0,i=_.material_refs.length;n<i;){var r=[n++],s=_.material_refs[r[0]],o=function(s){return function(t){if(m[s[0]]=t,(a+=1)==_.material_refs.length){var e=_.data_ref.split("/"),l="",u="";if(2==e.length?(l=e[0],u=e[1]):(l=f,u=_.data_ref),null!=d&&null!=d.bone_actions)for(var h=[],n=0,i=d.bone_actions;n<i.length;){var r=i[n];++n,Cr.getSceneRaw(r,function(t){if(h.push(t),h.length==d.bone_actions.length){for(var e=null,n=0,i=g.armatures;n<i.length;){var r=i[n];if(++n,r.uid==c.uid){e=r;break}}if(null==e){for(var s=0,a=g.armatures;s<a.length;){var o=a[s];if(++s,o.name==c.name){c.name+="."+c.uid;break}}e=new xr(c.uid,c.name,h),g.armatures.push(e)}g.returnMeshObject(l,u,f,e,m,c,_,p)}})}else g.returnMeshObject(l,u,f,null,m,c,_,p)}}}(r);Cr.getMaterial(f,s,o)}else if("speaker_object"==_.type){var l=this.addSpeakerObject(Cr.getSpeakerRawByName(t.speaker_datas,_.data_ref),c);this.returnObject(l,_,p)}else if("object"==_.type){var u=this.addObject(c);this.returnObject(u,_,function(e){if(null!=_.group_ref){var n=0,i=g.getGroupObjectRefs(_.group_ref);if(0==i.length)p(e);else for(var t=0;t<i.length;){var r=i[t];++t,g.spawnObject(r,e,function(t){(n+=1)==i.length&&p(e)})}}else p(e)})}else p(null)},getGroupObjectRefs:function(t){for(var e=0,n=this.raw.groups;e<n.length;){var i=n[e];if(++e,i.name==t)return i.object_refs}return null},returnMeshObject:function(t,e,i,r,s,a,o,l){var u=this;Cr.getMesh(t,e,function(t){if(t.isSkinned){var e=t.geom;null!=r?e.addArmature(r):e.addAction(t.format.objects,"none")}var n=u.addMeshObject(t,s,a);null!=o.tilesheet_ref&&hs.__cast(n,Pr).setupTilesheet(i,o.tilesheet_ref,o.tilesheet_action_ref),u.returnObject(n,o,l)})},returnObject:function(n,i,r){var s=this;if(null!=n&&null!=i.object_actions){for(var a=[];a.length<i.object_actions.length;)a.push(null);for(var o=0,t=0,e=i.object_actions.length;t<e;){var l=[t++],u=i.object_actions[l[0]];"null"!=u?Cr.getSceneRaw(u,function(e){return function(t){a[e[0]]=t,(o+=1)==i.object_actions.length&&s.returnObjectLoaded(n,i,a,r)}}(l)):o+=1}}else this.returnObjectLoaded(n,i,null,r)},returnObjectLoaded:function(t,e,n,i){if(null!=t){if(t.raw=e,t.name=e.name,null!=e.visible&&(t.visible=e.visible),null!=e.visible_mesh&&(t.visibleMesh=e.visible_mesh),null!=e.visible_shadow&&(t.visibleShadow=e.visible_shadow),br.createConstraints(e.constraints,t),br.generateTransform(e,t.transform),t.setupAnimation(n),null!=e.groups){null==this.groups&&(this.groups=new ur);for(var r=0,s=e.groups;r<s.length;){var a=s[r];++r;var o=this.groups.get(a);null==o&&(o=[],this.groups.set(a,o)),o.push(t)}}br.createTraits(e.traits,t)}i(t)},loadEmbeddedData:function(n,i){var r=this;if(null!=n)for(var s=0,t=0;t<n.length;){var e=[n[t]];++t,Cr.getImage(e[0],function(e){return function(t){r.embedded.set(e[0],t),(s+=1)==n.length&&i()}}(e))}else i()},notifyOnInit:function(t){this.ready?t():this.traitInits.push(t)},__class__:br};var xr=function(t,e,n){this.actions=[],this.uid=t,this.name=e;for(var i=0;i<n.length;){var r=n[i];++i;for(var s=0,a=r.objects;s<a.length;){var o=a[s];++s,xr.setParents(o)}var l=[[]];xr.traverseBones(r.objects,function(e){return function(t){e[0].push(t)}}(l)),this.actions.push({name:r.name,bones:l[0],mats:null})}};(n["iron.data.Armature"]=xr).__name__="iron.data.Armature",xr.setParents=function(t){if(null!=t.children)for(var e=0,n=t.children;e<n.length;){var i=n[e];++e,i.parent=t,xr.setParents(i)}},xr.traverseBones=function(t,e){for(var n=0,i=t.length;n<i;){var r=n++;xr.traverseBonesStep(t[r],e)}},xr.traverseBonesStep=function(t,e){if("bone_object"==t.type&&e(t),null!=t.children)for(var n=0,i=t.children.length;n<i;){var r=n++;xr.traverseBonesStep(t.children[r],e)}},xr.prototype={uid:null,name:null,actions:null,__class__:xr};var Sr=function(t,e){this.raw=t,this.name=t.name,e(this)};(n["iron.data.CameraData"]=Sr).__name__="iron.data.CameraData",Sr.parse=function(t,n,i){Cr.getSceneRaw(t,function(t){var e=Cr.getCameraRawByName(t.camera_datas,n);null==e&&(Ji.trace('Camera data "'+n+'" not found!',{fileName:"Sources/iron/data/CameraData.hx",lineNumber:20,className:"iron.data.CameraData",methodName:"parse"}),i(null)),new Sr(e,i)})},Sr.prototype={name:null,raw:null,__class__:Sr};var Cr=function(){};(n["iron.data.Data"]=Cr).__name__="iron.data.Data",Cr.getMesh=function(t,e,n){var r=t+e,i=Cr.cachedMeshes.get(r);if(null==i){var s=Cr.loadingMeshes.get(r);null==s?(Cr.loadingMeshes.set(r,[n]),Mr.parse(t,e,function(t){Cr.cachedMeshes.set(r,t),t.handle=r;for(var e=0,n=Cr.loadingMeshes.get(r);e<n.length;){var i=n[e];++e,i(t)}Cr.loadingMeshes.remove(r)})):s.push(n)}else n(i)},Cr.getLight=function(t,e,n){var r=t+e,i=Cr.cachedLights.get(r);if(null==i){var s=Cr.loadingLights.get(r);null==s?(Cr.loadingLights.set(r,[n]),Ir.parse(t,e,function(t){Cr.cachedLights.set(r,t);for(var e=0,n=Cr.loadingLights.get(r);e<n.length;){var i=n[e];++e,i(t)}Cr.loadingLights.remove(r)})):s.push(n)}else n(i)},Cr.getCamera=function(t,e,n){var r=t+e,i=Cr.cachedCameras.get(r);if(null==i){var s=Cr.loadingCameras.get(r);null==s?(Cr.loadingCameras.set(r,[n]),Sr.parse(t,e,function(t){Cr.cachedCameras.set(r,t);for(var e=0,n=Cr.loadingCameras.get(r);e<n.length;){var i=n[e];++e,i(t)}Cr.loadingCameras.remove(r)})):s.push(n)}else n(i)},Cr.getMaterial=function(t,e,n){var r=t+e,i=Cr.cachedMaterials.get(r);if(null==i){var s=Cr.loadingMaterials.get(r);null==s?(Cr.loadingMaterials.set(r,[n]),Tr.parse(t,e,function(t){Cr.cachedMaterials.set(r,t);for(var e=0,n=Cr.loadingMaterials.get(r);e<n.length;){var i=n[e];++e,i(t)}Cr.loadingMaterials.remove(r)})):s.push(n)}else n(i)},Cr.getWorld=function(t,e,n){if(null!=e){var r=t+e,i=Cr.cachedWorlds.get(r);if(null==i){var s=Cr.loadingWorlds.get(r);null==s?(Cr.loadingWorlds.set(r,[n]),Ar.parse(t,e,function(t){Cr.cachedWorlds.set(r,t);for(var e=0,n=Cr.loadingWorlds.get(r);e<n.length;){var i=n[e];++e,i(t)}Cr.loadingWorlds.remove(r)})):s.push(n)}else n(i)}else n(null)},Cr.getShader=function(t,e,n,i){var r=e;null!=i&&(r+="2");var s=Cr.cachedShaders.get(r);if(null==s){var a=Cr.loadingShaders.get(r);null==a?(Cr.loadingShaders.set(r,[n]),Or.parse(t,e,function(t){Cr.cachedShaders.set(r,t);for(var e=0,n=Cr.loadingShaders.get(r);e<n.length;){var i=n[e];++e,i(t)}Cr.loadingShaders.remove(r)},i)):a.push(n)}else n(s)},Cr.getSceneRaw=function(i,t){var e=Cr.cachedSceneRaws.get(i);if(null==e){var n=Cr.loadingSceneRaws.get(i);if(null==n){Cr.loadingSceneRaws.set(i,[t]);var r=J.endsWith(i,".zip"),s=J.endsWith(i,".json"),a=r||s||J.endsWith(i,".arm")?"":".arm";Cr.getBlob(i+a,function(t){var e=null;if(s){var n=t.toString();e="{"==n.charAt(0)?JSON.parse(n):Kr.decode(t.toBytes())}else e=Kr.decode(t.toBytes());Cr.returnSceneRaw(i,e)})}else n.push(t)}else t(e)},Cr.returnSceneRaw=function(t,e){Cr.cachedSceneRaws.set(t,e);for(var n=0,i=Cr.loadingSceneRaws.get(t);n<i.length;){var r=i[n];++n,r(e)}Cr.loadingSceneRaws.remove(t)},Cr.getMeshRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},Cr.getLightRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},Cr.getCameraRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},Cr.getMaterialRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},Cr.getWorldRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},Cr.getShaderRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},Cr.getSpeakerRawByName=function(t,e){if(""==e)return t[0];for(var n=0;n<t.length;){var i=t[n];if(++n,i.name==e)return i}return null},Cr.getBlob=function(r,t){var e=Cr.cachedBlobs.get(r);if(null==e){var n=Cr.loadingBlobs.get(r);if(null==n){Cr.loadingBlobs.set(r,[t]);var i="/"==r.charAt(0)||":"==r.charAt(1)?r:Cr.dataPath+r;ys.loadBlobFromPath(i,function(t){Cr.cachedBlobs.set(r,t);for(var e=0,n=Cr.loadingBlobs.get(r);e<n.length;){var i=n[e];++e,i(t)}Cr.loadingBlobs.remove(r),Cr.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:430,className:"iron.data.Data",methodName:"getBlob"})}else n.push(t)}else t(e)},Cr.getImage=function(r,t,e,n){null==n&&(n="RGBA32"),null==e&&(e=!1);var i=Cr.cachedImages.get(r);if(null==i){var s=Cr.loadingImages.get(r);if(null==s){Cr.loadingImages.set(r,[t]);var a="/"==r.charAt(0)||":"==r.charAt(1)?r:Cr.dataPath+r;ys.loadImageFromPath(a,e,function(t){Cr.cachedImages.set(r,t);for(var e=0,n=Cr.loadingImages.get(r);e<n.length;){var i=n[e];++e,i(t)}Cr.loadingImages.remove(r),Cr.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:455,className:"iron.data.Data",methodName:"getImage"})}else s.push(t)}else t(i)},Cr.getSound=function(t,e){e(null)},Cr.getFont=function(r,t){var e=Cr.cachedFonts.get(r);if(null==e){var n=Cr.loadingFonts.get(r);if(null==n){Cr.loadingFonts.set(r,[t]);var i="/"==r.charAt(0)||":"==r.charAt(1)?r:Cr.dataPath+r;ys.loadFontFromPath(i,function(t){Cr.cachedFonts.set(r,t);for(var e=0,n=Cr.loadingFonts.get(r);e<n.length;){var i=n[e];++e,i(t)}Cr.loadingFonts.remove(r),Cr.assetsLoaded++},null,{fileName:"Sources/iron/data/Data.hx",lineNumber:546,className:"iron.data.Data",methodName:"getFont"})}else n.push(t)}else t(e)};var kr=function(t,e,n,i,r,s,a,o,l,u,h,_,c){this.mats=null,this.actions=null,this.skeletonBoneLens=null,this.skeletonBoneRefs=null,this.skeletonTransformsI=null,this.skinBoneWeights=null,this.skinBoneIndices=null,this.skinBoneCounts=null,this.instanceCount=0,this.instanced=!1,this.instancedVB=null,this.numTris=0,this.ready=!1,this.name="",this.count=-1,this.start=0,this.vertexBufferMap=new ur,null==h&&(h=Xa.StaticUsage),this.indices=t,this.materialIndices=e,this.usage=h,this.positions=n,this.normals=i,this.uvs=r,this.uvs1=s,this.cols=a,this.tangents=o,this.bones=l,this.weights=u,this.instancedData=_,this.instancedType=c,this.struct=kr.getVertexStructure(null!=n,null!=i,null!=r,null!=s,null!=a,null!=o,null!=l,null!=u),this.structLength=pt.int(this.struct.byteSize()/4),this.structStr="";for(var d=0,p=this.struct.elements;d<p.length;){var g=p[d];++d,this.structStr+=g.name}};(n["iron.data.Geometry"]=kr).__name__="iron.data.Geometry",kr.getVertexStructure=function(t,e,n,i,r,s,a,o){null==o&&(o=!1),null==a&&(a=!1),null==s&&(s=!1),null==r&&(r=!1),null==i&&(i=!1),null==n&&(n=!1),null==e&&(e=!1),null==t&&(t=!1);var l=new Ka;return t&&l.add("pos",2),e&&l.add("nor",2),n&&l.add("tex",1),i&&l.add("tex1",1),r&&l.add("col",2),s&&l.add("tang",2),a&&l.add("bone",3),o&&l.add("weight",3),l},kr.buildVertices=function(t,e,n,i,r,s,a,o,l,u,h){null==h&&(h=!1),null==u&&(u=0);for(var _=-1+u,c=0,d=pt.int(e.length/3);c<d;){var p=c++;t[++_]=e[3*p],t[++_]=e[3*p+1],t[++_]=e[3*p+2],null!=n&&(t[++_]=n[3*p],t[++_]=n[3*p+1],t[++_]=n[3*p+2]),null!=i?(t[++_]=i[2*p],t[++_]=i[2*p+1]):h&&(t[++_]=0,t[++_]=0),null!=r&&(t[++_]=r[2*p],t[++_]=r[2*p+1]),null!=s&&(t[++_]=s[3*p],t[++_]=s[3*p+1],t[++_]=s[3*p+2]),null!=a&&(t[++_]=a[3*p],t[++_]=a[3*p+1],t[++_]=a[3*p+2]),null!=o&&(t[++_]=o[4*p],t[++_]=o[4*p+1],t[++_]=o[4*p+2],t[++_]=o[4*p+3]),null!=l&&(t[++_]=l[4*p],t[++_]=l[4*p+1],t[++_]=l[4*p+2],t[++_]=l[4*p+3])}},kr.prototype={vertexBuffer:null,vertexBufferMap:null,indexBuffers:null,start:null,count:null,name:null,ready:null,vertices:null,indices:null,numTris:null,materialIndices:null,struct:null,structLength:null,structStr:null,usage:null,instancedVB:null,instanced:null,instanceCount:null,positions:null,normals:null,uvs:null,uvs1:null,cols:null,tangents:null,bones:null,weights:null,instancedData:null,instancedType:null,skinBoneCounts:null,skinBoneIndices:null,skinBoneWeights:null,skeletonTransformsI:null,skeletonBoneRefs:null,skeletonBoneLens:null,actions:null,mats:null,setupInstanced:function(t,e,n){this.instanced=!0,this.instanceCount=pt.int(t.length/3);var i=new Ka;i.instanced=!0,i.add("ipos",2),2!=e&&4!=e||i.add("irot",2),3!=e&&4!=e||i.add("iscl",2),this.instancedVB=new ja(this.instanceCount,i,n,1);for(var r=this.instancedVB.lock(),s=0,a=r.length;s<a;){var o=s++;r[o]=t[o]}this.instancedVB.unlock()},hasAttrib:function(t,e){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return!0}return!1},get:function(t){for(var e="",n=0;n<t.length;){var i=t[n];++n,e+=i.name}var r=this.vertexBufferMap.get(e);if(null==r){var s=this.hasAttrib("pos",t),a=this.hasAttrib("nor",t),o=this.hasAttrib("tex",t),l=this.hasAttrib("tex1",t),u=this.hasAttrib("col",t),h=this.hasAttrib("tang",t),_=this.hasAttrib("bone",t),c=this.hasAttrib("weight",t),d=kr.getVertexStructure(s,a,o,l,u,h,_,c);r=new ja(pt.int(this.positions.length/3),d,this.usage),this.vertices=r.lock(),kr.buildVertices(this.vertices,s?this.positions:null,a?this.normals:null,o?this.uvs:null,l?this.uvs1:null,u?this.cols:null,h?this.tangents:null,_?this.bones:null,c?this.weights:null,0,o&&null==this.uvs),r.unlock(),this.vertexBufferMap.set(e,r),o&&null==this.uvs&&Ji.trace("Armory Warning: Geometry "+this.name+" is missing UV map",{fileName:"Sources/iron/data/Geometry.hx",lineNumber:322,className:"iron.data.Geometry",methodName:"get"}),u&&null==this.cols&&Ji.trace("Armory Warning: Geometry "+this.name+" is missing vertex colors",{fileName:"Sources/iron/data/Geometry.hx",lineNumber:323,className:"iron.data.Geometry",methodName:"get"})}return r},build:function(){if(!this.ready){this.vertexBuffer=new ja(pt.int(this.positions.length/3),this.struct,this.usage),this.vertices=this.vertexBuffer.lock(),kr.buildVertices(this.vertices,this.positions,this.normals,this.uvs,this.uvs1,this.cols,this.tangents,this.bones,this.weights),this.vertexBuffer.unlock(),this.vertexBufferMap.set(this.structStr,this.vertexBuffer),this.indexBuffers=[];for(var t=0,e=this.indices;t<e.length;){var n=e[t];if(++t,0!=n.length){var i=new Ba(n.length,this.usage);this.numTris+=pt.int(n.length/3),i._data=n,i.unlock(),this.indexBuffers.push(i)}}null!=this.instancedData&&this.setupInstanced(this.instancedData,this.instancedType,this.usage),this.ready=!0}},addArmature:function(t){for(var e=0,n=t.actions;e<n.length;){var i=n[e];++e,this.addAction(i.bones,i.name)}},addAction:function(t,e){if(null!=t&&(null==this.actions&&(this.actions=new ur,this.mats=new ur),null==this.actions.get(e))){for(var n=[],i=0,r=this.skeletonBoneRefs;i<r.length;){var s=r[i];++i;for(var a=0;a<t.length;){var o=t[a];++a,o.name==s&&n.push(o)}}this.actions.set(e,n);for(var l=[],u=0;u<n.length;){var h=n[u];++u,l.push(bi.fromFloat32Array(h.transform.values))}this.mats.set(e,l)}},initSkeletonTransforms:function(t){this.skeletonTransformsI=[];for(var e=0;e<t.length;){var n=t[e];++e;var i=bi.fromFloat32Array(n);this.skeletonTransformsI.push(i)}},__class__:kr};var Ir=function(t,e){this.colorTexture=null;var n=this;this.raw=t,this.name=t.name,null!=t.color_texture?Cr.getImage(t.color_texture,function(t){n.colorTexture=t,e(n)}):e(this)};(n["iron.data.LightData"]=Ir).__name__="iron.data.LightData",Ir.typeToInt=function(t){switch(t){case"area":return 3;case"point":return 1;case"spot":return 2;case"sun":default:return 0}},Ir.parse=function(t,n,i){Cr.getSceneRaw(t,function(t){var e=Cr.getLightRawByName(t.light_datas,n);null==e&&(Ji.trace('Light data "'+n+'" not found!',{fileName:"Sources/iron/data/LightData.hx",lineNumber:40,className:"iron.data.LightData",methodName:"parse"}),i(null)),new Ir(e,i)})},Ir.prototype={name:null,raw:null,colorTexture:null,__class__:Ir};var Tr=function(a,o,t){null==t&&(t=""),this.contexts=null;var l=this;this.uid=++Tr.uidCounter,this.raw=a,this.name=a.name;var e=a.shader.split("/"),n="",i="";2==e.length?(n=e[0],i=e[1]):(n=t,i=a.shader),Cr.getShader(n,i,function(t){for(l.shader=t,l.contexts=[];l.contexts.length<a.contexts.length;)l.contexts.push(null);for(var n=0,e=0,i=a.contexts.length;e<i;){var r=[e++],s=a.contexts[r[0]];new Nr(s,function(e){return function(t){l.contexts[e[0]]=t,(n+=1)==a.contexts.length&&o(l)}}(r))}},a.override_context)};(n["iron.data.MaterialData"]=Tr).__name__="iron.data.MaterialData",Tr.parse=function(n,i,r){Cr.getSceneRaw(n,function(t){var e=Cr.getMaterialRawByName(t.material_datas,i);null==e&&(Ji.trace('Material data "'+i+'" not found!',{fileName:"Sources/iron/data/MaterialData.hx",lineNumber:58,className:"iron.data.MaterialData",methodName:"parse"}),r(null)),new Tr(e,r,n)})},Tr.prototype={uid:null,name:null,raw:null,shader:null,contexts:null,getContext:function(t){for(var e=0,n=this.contexts;e<n.length;){var i=n[e];if(++e,ut.substr(i.raw.name,0,t.length)==t)return i}return null},__class__:Tr};var Nr=function(u,h){this.id=0,this.textures=null;var _=this;if(this.raw=u,this.id=Nr.num++,null!=u.bind_textures&&0<u.bind_textures.length){var t=new Array(u.bind_textures.length);this.textures=t;for(var c=0,e=0,n=u.bind_textures.length;e<n;){var i=[e++],r=[u.bind_textures[i[0]]];""!=r[0].file?Cr.getImage(r[0].file,function(o,l){return function(i){if(_.textures[l[0]]=i,c+=1,null!=o[0].mipmaps){for(var r=[];r.length<o[0].mipmaps.length;)r.push(null);for(var s=0,t=0,e=o[0].mipmaps.length;t<e;){var n=[t++],a=o[0].mipmaps[n[0]];Cr.getImage(a,function(e,n){return function(t){r[e[0]]=t,(s+=1)==n[0].mipmaps.length&&(i.setMipmaps(r),n[0].mipmaps=null,n[0].generate_mipmaps=!1,c==u.bind_textures.length&&h(_))}}(n,o))}}else 1==o[0].generate_mipmaps&&null!=i&&(i.generateMipmaps(1e3),o[0].mipmaps=null,o[0].generate_mipmaps=!1),c==u.bind_textures.length&&h(_)}}(r,i),!1,null!=r[0].format?r[0].format:"RGBA32"):(c+=1)==u.bind_textures.length&&h(this)}}else h(this)};(n["iron.data.MaterialContext"]=Nr).__name__="iron.data.MaterialContext",Nr.prototype={raw:null,textures:null,id:null,setTextureParameters:function(t,e,n,i){n.setTextureParameters(t,i,this.raw.bind_textures[e])},__class__:Nr};var Mr=function(t,e){this.refcount=0,this.raw=t,this.name=t.name;for(var n=[],i=[],r=0,s=t.index_arrays;r<s.length;){var a=s[r];++r,n.push(a.values),i.push(a.material)}var o=this.getVertexArrayValues("pos"),l=this.getVertexArrayValues("nor"),u=this.getVertexArrayValues("tex"),h=this.getVertexArrayValues("tex1"),_=this.getVertexArrayValues("col"),c=this.getVertexArrayValues("tang");this.isSkinned=null!=t.skin;var d=Xa.StaticUsage;null!=t.dynamic_usage&&1==t.dynamic_usage&&(d=Xa.DynamicUsage);var p=d,g=null,f=null;if(this.isSkinned){var m=4*pt.int(o.length/3);g=new Float32Array(m),f=new Float32Array(m);for(var v=0,y=0,w=0,b=pt.int(o.length/3);w<b;){for(var x=w++,S=t.skin.bone_count_array[x],C=v,k=v+S;C<k;){var I=C++;g[y]=t.skin.bone_index_array[I],f[y]=t.skin.bone_weight_array[I],++y}for(var T=S;T<4;){T++;g[y]=0,f[y]=0,++y}v+=S}}this.geom=new kr(n,i,o,l,u,h,_,c,g,f,p,t.instanced_data,t.instanced_type),this.geom.name=this.name,e(this)};(n["iron.data.MeshData"]=Mr).__name__="iron.data.MeshData",Mr.parse=function(t,i,r){Cr.getSceneRaw(t,function(e){var n=Cr.getMeshRawByName(e.mesh_datas,i);null==n&&(Ji.trace('Mesh data "'+i+'" not found!',{fileName:"Sources/iron/data/MeshData.hx",lineNumber:102,className:"iron.data.MeshData",methodName:"parse"}),r(null)),new Mr(n,function(t){t.format=e,null!=n.skin&&(t.geom.skinBoneCounts=n.skin.bone_count_array,t.geom.skinBoneIndices=n.skin.bone_index_array,t.geom.skinBoneWeights=n.skin.bone_weight_array,t.geom.skeletonBoneRefs=n.skin.bone_ref_array,t.geom.skeletonBoneLens=n.skin.bone_len_array,t.geom.initSkeletonTransforms(n.skin.transformsI)),r(t)})})},Mr.prototype={name:null,raw:null,format:null,geom:null,refcount:null,handle:null,isSkinned:null,getVertexArrayValues:function(t){for(var e=0,n=this.raw.vertex_arrays;e<n.length;){var i=n[e];if(++e,i.attrib==t)return i.values}return null},__class__:Mr};var Or=function(n,i,t){this.contexts=[];var r=this;this.raw=n,this.name=n.name;for(var e=0,s=n.contexts;e<s.length;){s[e];++e,this.contexts.push(null)}for(var a=0,o=0,l=n.contexts.length;o<l;){var u=[o++],h=n.contexts[u[0]];new Er(h,function(e){return function(t){r.contexts[e[0]]=t,(a+=1)==n.contexts.length&&i(r)}}(u),t)}};(n["iron.data.ShaderData"]=Or).__name__="iron.data.ShaderData",Or.parse=function(t,n,i,r){Cr.getSceneRaw(t,function(t){var e=Cr.getShaderRawByName(t.shader_datas,n);null==e&&(Ji.trace('Shader data "'+n+'" not found!',{fileName:"Sources/iron/data/ShaderData.hx",lineNumber:47,className:"iron.data.ShaderData",methodName:"parse"}),i(null)),new Or(e,i,r)})},Or.prototype={name:null,raw:null,contexts:null,getContext:function(t){for(var e=0,n=this.contexts;e<n.length;){var i=n[e];if(++e,i.raw.name==t)return i}return null},__class__:Or};var Er=function(t,e,n){this.instancingType=0,this.raw=t,this.overrideContext=n,"rect"==t.name?(this.structure=Er.getStructureRect(),this.instancingType=0):this.parseVertexStructure(),this.compile(e)};(n["iron.data.ShaderContext"]=Er).__name__="iron.data.ShaderContext",Er.getStructureRect=function(){return null==Er.structureRect&&(Er.structureRect=new Ka,Er.structureRect.add("pos",1)),Er.structureRect},Er.prototype={raw:null,pipeState:null,constants:null,textureUnits:null,paramsSet:null,structure:null,instancingType:null,overrideContext:null,compile:function(t){if(null!=this.pipeState&&this.pipeState.delete(),this.pipeState=new Wa,this.constants=[],this.textureUnits=[],this.paramsSet=[],0<this.instancingType){var e=new Ka;e.add("ipos",2),2!=this.instancingType&&4!=this.instancingType||e.add("irot",2),3!=this.instancingType&&4!=this.instancingType||e.add("iscl",2),e.instanced=!0,this.pipeState.inputLayout=[this.structure,e]}else this.pipeState.inputLayout=[this.structure];if(this.pipeState.depthWrite=this.raw.depth_write,this.pipeState.depthMode=this.getCompareMode(this.raw.compare_mode),null!=this.raw.stencil_mode&&("always"==this.raw.stencil_mode?this.pipeState.stencilMode=xa.Always:"equal"==this.raw.stencil_mode?this.pipeState.stencilMode=xa.Equal:"not_equal"==this.raw.stencil_mode&&(this.pipeState.stencilMode=xa.NotEqual)),null!=this.raw.stencil_pass&&("replace"==this.raw.stencil_pass?this.pipeState.stencilBothPass=Ra.Replace:"keep"==this.raw.stencil_pass&&(this.pipeState.stencilBothPass=Ra.Keep)),null!=this.raw.stencil_fail&&"keep"==this.raw.stencil_fail&&(this.pipeState.stencilDepthFail=Ra.Keep,this.pipeState.stencilFail=Ra.Keep),null!=this.raw.stencil_reference_value&&(this.pipeState.stencilReferenceValue=Da.Static(this.raw.stencil_reference_value)),this.pipeState.cullMode=this.getCullMode(this.raw.cull_mode),null!=this.raw.blend_source&&(this.pipeState.blendSource=this.getBlendingFactor(this.raw.blend_source)),null!=this.raw.blend_destination&&(this.pipeState.blendDestination=this.getBlendingFactor(this.raw.blend_destination)),null!=this.raw.blend_operation&&(this.pipeState.blendOperation=this.getBlendingOperation(this.raw.blend_operation)),null!=this.raw.alpha_blend_source&&(this.pipeState.alphaBlendSource=this.getBlendingFactor(this.raw.alpha_blend_source)),null!=this.raw.alpha_blend_destination&&(this.pipeState.alphaBlendDestination=this.getBlendingFactor(this.raw.alpha_blend_destination)),null!=this.raw.alpha_blend_operation&&(this.pipeState.alphaBlendOperation=this.getBlendingOperation(this.raw.alpha_blend_operation)),null!=this.raw.color_write_red&&this.pipeState.set_colorWriteMaskRed(this.raw.color_write_red),null!=this.raw.color_write_green&&this.pipeState.set_colorWriteMaskGreen(this.raw.color_write_green),null!=this.raw.color_write_blue&&this.pipeState.set_colorWriteMaskBlue(this.raw.color_write_blue),null!=this.raw.color_write_alpha&&this.pipeState.set_colorWriteMaskAlpha(this.raw.color_write_alpha),null!=this.raw.color_writes_red)for(var n=0,i=this.raw.color_writes_red.length;n<i;){var r=n++;this.pipeState.colorWriteMasksRed[r]=this.raw.color_writes_red[r]}if(null!=this.raw.color_writes_green)for(var s=0,a=this.raw.color_writes_green.length;s<a;){var o=s++;this.pipeState.colorWriteMasksGreen[o]=this.raw.color_writes_green[o]}if(null!=this.raw.color_writes_blue)for(var l=0,u=this.raw.color_writes_blue.length;l<u;){var h=l++;this.pipeState.colorWriteMasksBlue[h]=this.raw.color_writes_blue[h]}if(null!=this.raw.color_writes_alpha)for(var _=0,c=this.raw.color_writes_alpha.length;_<c;){var d=_++;this.pipeState.colorWriteMasksAlpha[d]=this.raw.color_writes_alpha[d]}if(null!=this.raw.conservative_raster&&(this.pipeState.conservativeRasterization=this.raw.conservative_raster),this.raw.shader_from_source)this.pipeState.fragmentShader=Ia.fromSource(this.raw.fragment_shader),this.pipeState.vertexShader=Ua.fromSource(this.raw.vertex_shader),this.finishCompile(t);else{var p=J.replace(this.raw.fragment_shader,".","_");this.pipeState.fragmentShader=ft.field(Rs,p);var g=J.replace(this.raw.vertex_shader,".","_");if(this.pipeState.vertexShader=ft.field(Rs,g),null!=this.raw.geometry_shader){var f=J.replace(this.raw.geometry_shader,".","_");this.pipeState.geometryShader=ft.field(Rs,f)}if(null!=this.raw.tesscontrol_shader){var m=J.replace(this.raw.tesscontrol_shader,".","_");this.pipeState.tessellationControlShader=ft.field(Rs,m)}if(null!=this.raw.tesseval_shader){var v=J.replace(this.raw.tesseval_shader,".","_");this.pipeState.tessellationEvaluationShader=ft.field(Rs,v)}this.finishCompile(t)}},finishCompile:function(t){if(null!=this.overrideContext&&null!=this.overrideContext.cull_mode&&(this.pipeState.cullMode=this.getCullMode(this.overrideContext.cull_mode)),this.pipeState.compile(),null!=this.raw.constants)for(var e=0,n=this.raw.constants;e<n.length;){var i=n[e];++e,this.addConstant(i)}if(null!=this.raw.texture_units)for(var r=0,s=this.raw.texture_units;r<s.length;){var a=s[r];++r,this.addTexture(a)}t(this)},sizeToVD:function(t){return 1==t?0:2==t?1:3==t?2:4==t?3:0},parseVertexStructure:function(){this.structure=new Ka;for(var t=!1,e=!1,n=!1,i=0,r=this.raw.vertex_structure;i<r.length;){var s=r[i];++i,"ipos"!=s.name?"irot"!=s.name?"iscl"!=s.name?this.structure.add(s.name,this.sizeToVD(s.size)):n=!0:e=!0:t=!0}!t||e||n?t&&e&&!n?this.instancingType=2:t&&!e&&n?this.instancingType=3:t&&e&&n&&(this.instancingType=4):this.instancingType=1},getCompareMode:function(t){switch(t){case"always":return xa.Always;case"equal":return xa.Equal;case"greater":return xa.Greater;case"greater_equal":return xa.GreaterEqual;case"less":return xa.Less;case"less_equal":return xa.LessEqual;case"never":return xa.Never;case"not_equal":return xa.NotEqual;default:return xa.Less}},getCullMode:function(t){switch(t){case"clockwise":return ka.Clockwise;case"none":return ka.None;default:return ka.CounterClockwise}},getBlendingOperation:function(t){switch(t){case"add":return ba.Add;case"max":return ba.Max;case"min":return ba.Min;case"reverse_subtract":return ba.ReverseSubtract;case"subtract":return ba.Subtract;default:return ba.Add}},getBlendingFactor:function(t){switch(t){case"blend_one":return wa.BlendOne;case"blend_zero":return wa.BlendZero;case"destination_alpha":return wa.DestinationAlpha;case"destination_color":return wa.DestinationColor;case"inverse_destination_alpha":return wa.InverseDestinationAlpha;case"inverse_destination_color":return wa.InverseDestinationColor;case"inverse_source_alpha":return wa.InverseSourceAlpha;case"inverse_source_color":return wa.InverseSourceColor;case"source_alpha":return wa.SourceAlpha;case"source_color":return wa.SourceColor;default:return wa.Undefined}},getTextureAddresing:function(t){switch(t){case"mirror":return Ha.Mirror;case"repeat":return Ha.Repeat;default:return Ha.Clamp}},getTextureFilter:function(t){switch(t){case"linear":return Pa.LinearFilter;case"point":return Pa.PointFilter;default:return Pa.AnisotropicFilter}},getMipmapFilter:function(t){switch(t){case"no":return La.NoMipFilter;case"point":return La.PointMipFilter;default:return La.LinearMipFilter}},addConstant:function(t){this.constants.push(this.pipeState.getConstantLocation(t.name))},addTexture:function(t){var e=this.pipeState.getTextureUnit(t.name);this.textureUnits.push(e),this.paramsSet.push(!1)},setTextureParameters:function(t,e,n){var i=this.textureUnits[e];t.setTextureParameters(i,null==n.u_addressing?Ha.Repeat:this.getTextureAddresing(n.u_addressing),null==n.v_addressing?Ha.Repeat:this.getTextureAddresing(n.v_addressing),null==n.min_filter?Pa.LinearFilter:this.getTextureFilter(n.min_filter),null==n.mag_filter?Pa.LinearFilter:this.getTextureFilter(n.mag_filter),null==n.mipmap_filter?La.NoMipFilter:this.getMipmapFilter(n.mipmap_filter))},__class__:Er};var Ar=function(t,e){var n=this;this.raw=t,this.name=t.name,null!=t.probe?new Br(t.probe,function(t){n.probe=t,n.loadEnvmap(e)}):this.loadEnvmap(e)};(n["iron.data.WorldData"]=Ar).__name__="iron.data.WorldData",Ar.parse=function(t,n,i){Cr.getSceneRaw(t,function(t){var e=Cr.getWorldRawByName(t.world_datas,n);null==e&&(Ji.trace('World data "'+n+'" not found!',{fileName:"Sources/iron/data/WorldData.hx",lineNumber:49,className:"iron.data.WorldData",methodName:"parse"}),i(null)),new Ar(e,i)})},Ar.getEmptyIrradiance=function(){if(null==Ar.emptyIrr){var t=new Float32Array(28);Ar.emptyIrr=t;for(var e=0,n=Ar.emptyIrr.length;e<n;){var i=e++;Ar.emptyIrr[i]=0}}return Ar.emptyIrr},Ar.prototype={name:null,raw:null,envmap:null,probe:null,loadEnvmap:function(e){var n=this;null!=this.raw.envmap?Cr.getImage(this.raw.envmap,function(t){n.envmap=t,e(n)}):e(this)},__class__:Ar};var Br=function(o,l){this.radianceMipmaps=[];var u=this;this.raw=o,this.setIrradiance(function(t){u.irradiance=t,null!=o.radiance?Cr.getImage(o.radiance,function(t){for(u.radiance=t;u.radianceMipmaps.length<o.radiance_mipmaps;)u.radianceMipmaps.push(null);for(var e=o.radiance.substring(o.radiance.length-4),n=o.radiance.substring(0,o.radiance.length-4),i=0,r=0,s=o.radiance_mipmaps;r<s;){var a=[r++];Cr.getImage(n+"_"+a[0]+e,function(e){return function(t){u.radianceMipmaps[e[0]]=t,(i+=1)==o.radiance_mipmaps&&(u.radiance.setMipmaps(u.radianceMipmaps),l(u))}}(a),!0)}}):l(u)})};(n["iron.data.Probe"]=Br).__name__="iron.data.Probe",Br.prototype={raw:null,radiance:null,radianceMipmaps:null,irradiance:null,setIrradiance:function(i){if(null==this.raw.irradiance){for(var t=[.775966,1.16761,1.498638,.133694,.215281,.056659,-.022268,-.019376,-.010651,279e-6,185e-6,0,0,-393e-6,-775e-6,.010973,.027268,.043918,.085267,.07367,.038877,0,0,0,.135177,.115614,.060794],e=new Float32Array(t.length),n=0,r=e.length;n<r;){var s=n++;e[s]=t[s]}i(e)}else{var a=J.endsWith(this.raw.irradiance,".json")?"":".arm";Cr.getBlob(this.raw.irradiance+a,function(t){var e=""==a?JSON.parse(t.toString()):Kr.decode(t.toBytes()),n=new Float32Array(28);n[0]=e.irradiance[0],n[1]=e.irradiance[1],n[2]=e.irradiance[2],n[3]=e.irradiance[3],n[4]=e.irradiance[4],n[5]=e.irradiance[5],n[6]=e.irradiance[6],n[7]=e.irradiance[7],n[8]=e.irradiance[8],n[9]=e.irradiance[9],n[10]=e.irradiance[10],n[11]=e.irradiance[11],n[12]=e.irradiance[12],n[13]=e.irradiance[13],n[14]=e.irradiance[14],n[15]=e.irradiance[15],n[16]=e.irradiance[16],n[17]=e.irradiance[17],n[18]=e.irradiance[18],n[19]=e.irradiance[19],n[20]=e.irradiance[20],n[21]=e.irradiance[21],n[22]=e.irradiance[22],n[23]=e.irradiance[23],n[24]=e.irradiance[24],n[25]=e.irradiance[25],n[26]=e.irradiance[26],n[27]=0,i(n)})}},__class__:Br};var Lr=function(t,e,n,i,r,s,a,o,l){this.self=new Yr(t,e,n,i,r,s,a,o,l)};(n["iron.math.Mat3"]=Lr).__name__="iron.math.Mat3",Lr.identity=function(){return new Lr(1,0,0,0,1,0,0,0,1)},Lr.prototype={self:null,setFrom4:function(t){this.set__00(t.get__00()),this.set__01(t.get__01()),this.set__02(t.get__02()),this.set__10(t.get__10()),this.set__11(t.get__11()),this.set__12(t.get__12()),this.set__20(t.get__20()),this.set__21(t.get__21()),this.set__22(t.get__22())},set__00:function(t){return this.self._00=t},set__01:function(t){return this.self._01=t},set__02:function(t){return this.self._02=t},set__10:function(t){return this.self._10=t},set__11:function(t){return this.self._11=t},set__12:function(t){return this.self._12=t},set__20:function(t){return this.self._20=t},set__21:function(t){return this.self._21=t},set__22:function(t){return this.self._22=t},__class__:Lr,__properties__:{set__22:"set__22",set__21:"set__21",set__20:"set__20",set__12:"set__12",set__11:"set__11",set__10:"set__10",set__02:"set__02",set__01:"set__01",set__00:"set__00"}};var Fr=function(){};(n["iron.math.Math"]=Fr).__name__="iron.math.Math",Fr.__properties__={get_NaN:"get_NaN"},Fr.get_NaN=function(){return NaN},Fr.asin=function(t){return Math.asin(t)},Fr.atan2=function(t,e){return Math.atan2(t,e)},Fr.cos=function(t){return Math.cos(t)},Fr.sin=function(t){return Math.sin(t)},Fr.sqrt=function(t){return Math.sqrt(t)},Fr.tan=function(t){return Math.tan(t)},Fr.isNaN=function(t){return isNaN(t)},Fr.clamp=function(t,e,n){return t<e?e:n<t?n:t},Fr.fract=function(t){return t-pt.int(t)};var Wr=function(){this.markerEvents=null,this.lastFrameIndex=-1,this.blendFactor=0,this.blendAction="",this.blendCurrent=0,this.blendTime=0,this.paused=!1,this.onComplete=null,this.frameIndex=0,this.loop=!0,this.speed=1,this.time=0,this.action="",br.active.animations.push(this),this.frameTime=br.active.raw.frame_time,this.play()};(n["iron.object.Animation"]=Wr).__name__="iron.object.Animation",Wr.prototype={isSkinned:null,isSampled:null,action:null,time:null,speed:null,loop:null,frameIndex:null,onComplete:null,paused:null,frameTime:null,blendTime:null,blendCurrent:null,blendAction:null,blendFactor:null,lastFrameIndex:null,markerEvents:null,play:function(t,e,n,i,r){null==r&&(r=!0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=""),0<n?(this.blendTime=n,this.blendCurrent=0,this.blendAction=this.action):this.frameIndex=-1,this.action=t,this.onComplete=e,this.speed=i,this.loop=r,this.paused=!1},blend:function(t,e,n){this.blendTime=1,this.blendFactor=n},pause:function(){this.paused=!0},resume:function(){this.paused=!1},remove:function(){ut.remove(br.active.animations,this)},update:function(t){this.paused||0==this.speed||(this.time+=t*this.speed,0<this.blendTime&&0==this.blendFactor&&(this.blendCurrent+=t,this.blendCurrent>=this.blendTime&&(this.blendTime=0)))},isTrackEnd:function(t){return 0<this.speed?this.frameIndex>=t.frames.length-1:this.frameIndex<=0},checkFrameIndex:function(t){return 0<this.speed?this.frameIndex+1<t.length&&this.time>t[this.frameIndex+1]*this.frameTime:-1<this.frameIndex-1&&this.time<t[this.frameIndex-1]*this.frameTime},rewind:function(t){this.frameIndex=0<this.speed?0:t.frames.length-1,this.time=t.frames[this.frameIndex]*this.frameTime},updateTrack:function(t){if(null!=t){var e=t.tracks[0];-1==this.frameIndex&&this.rewind(e);for(var n=0<this.speed?1:-1;this.checkFrameIndex(e.frames);)this.frameIndex+=n;if(null!=this.markerEvents&&null!=t.marker_names&&this.frameIndex!=this.lastFrameIndex){for(var i=0,r=t.marker_frames.length;i<r;){var s=i++;if(this.frameIndex==t.marker_frames[s])for(var a=this.markerEvents.get(t.marker_names[s]),o=0;o<a.length;){var l=a[o];++o,l()}}this.lastFrameIndex=this.frameIndex}this.isTrackEnd(e)&&(this.loop||0<this.blendTime?this.rewind(e):(this.frameIndex-=n,this.paused=!0),null!=this.onComplete&&0==this.blendTime&&this.onComplete())}},updateAnimSampled:function(t,e){if(null!=t){var n=t.tracks[0],i=0<this.speed?1:-1,r=this.time,s=this.frameIndex,a=n.frames[s]*this.frameTime,o=(r-a)/(n.frames[s+i]*this.frameTime-a);Wr.m1.setF32(n.values,16*s),Wr.m2.setF32(n.values,16*(s+i)),Wr.m1.decompose(Wr.vpos,Wr.q1,Wr.vscl),Wr.m2.decompose(Wr.vpos2,Wr.q2,Wr.vscl2),Wr.vp.lerp(Wr.vpos,Wr.vpos2,o),Wr.vs.lerp(Wr.vscl,Wr.vscl2,o),Wr.q3.lerp(Wr.q1,Wr.q2,o),e.fromQuat(Wr.q3),e.scale(Wr.vs),e.set__30(Wr.vp.x),e.set__31(Wr.vp.y),e.set__32(Wr.vp.z)}},notifyOnMarker:function(t,e){null==this.markerEvents&&(this.markerEvents=new ur);var n=this.markerEvents.get(t);null==n&&(n=[],this.markerEvents.set(t,n)),n.push(e)},currentFrame:function(){return pt.int(this.time/this.frameTime)},__class__:Wr};var Rr=function(){this.isEmpty=!1,this.properties=null,this.culledShadow=!1,this.culledMesh=!1,this.culled=!1,this.visibleShadow=!0,this.visibleMesh=!0,this.visible=!0,this.animation=null,this.lods=null,this.children=[],this.parent=null,this.traits=[],this.constraints=null,this.name="",this.raw=null,this.uid=Rr.uidCounter++,this.urandom=Rr.seededRandom(),this.transform=new jr(this),this.isEmpty=q.getClass(this)==Rr,this.isEmpty&&null!=br.active&&br.active.empties.push(this)};(n["iron.object.Object"]=Rr).__name__="iron.object.Object",Rr.seededRandom=function(){return Rr.seed=(9301*Rr.seed+49297)%233280,Rr.seed/233280},Rr.prototype={uid:null,urandom:null,raw:null,name:null,transform:null,constraints:null,traits:null,parent:null,children:null,lods:null,animation:null,visible:null,visibleMesh:null,visibleShadow:null,culled:null,culledMesh:null,culledShadow:null,properties:null,isEmpty:null,addChild:function(t,e){null==e&&(e=!1),t.parent!=this&&(this.children.push(t),t.parent=this,e&&t.transform.applyParentInverse())},removeChild:function(t,e){null==e&&(e=!1),e&&t.transform.applyParent(),t.parent=null,t.transform.buildMatrix(),ut.remove(this.children,t)},remove:function(){for(this.isEmpty&&null!=br.active&&ut.remove(br.active.empties,this),null!=this.animation&&this.animation.remove();0<this.children.length;)this.children[0].remove();for(;0<this.traits.length;)this.traits[0].remove();null!=this.parent&&(ut.remove(this.parent.children,this),this.parent=null)},getChild:function(t){if(this.name==t)return this;for(var e=0,n=this.children;e<n.length;){var i=n[e];++e;var r=i.getChild(t);if(null!=r)return r}return null},addTrait:function(t){if(this.traits.push(t),t.object=this,null!=t._add){for(var e=0,n=t._add;e<n.length;){var i=n[e];++e,i()}t._add=null}},removeTrait:function(t){if(null!=t._init){for(var e=0,n=t._init;e<n.length;){var i=n[e];++e,mr.removeInit(i)}t._init=null}if(null!=t._update){for(var r=0,s=t._update;r<s.length;){var a=s[r];++r,mr.removeUpdate(a)}t._update=null}if(null!=t._lateUpdate){for(var o=0,l=t._lateUpdate;o<l.length;){var u=l[o];++o,mr.removeLateUpdate(u)}t._lateUpdate=null}if(null!=t._render){for(var h=0,_=t._render;h<_.length;){var c=_[h];++h,mr.removeRender(c)}t._render=null}if(null!=t._render2D){for(var d=0,p=t._render2D;d<p.length;){var g=p[d];++d,mr.removeRender2D(g)}t._render2D=null}if(null!=t._remove){for(var f=0,m=t._remove;f<m.length;){var v=m[f];++f,v()}t._remove=null}ut.remove(this.traits,t)},getTrait:function(t){for(var e=0,n=this.traits;e<n.length;){var i=n[e];if(++e,q.getClass(i)==t)return i}return null},getParentArmature:function(t){return null},setupAnimation:function(t){null!=t&&(this.animation=new zr(this,t))},__class__:Rr};var Dr=function(t){this.currentFace=0,this.renderTargetCube=null,this.renderTarget=null,this.frustumPlanes=null,this.prevV=null,Rr.call(this),this.data=t,this.buildProjection(),this.V=bi.identity(),this.VP=bi.identity(),t.raw.frustum_culling&&(this.frustumPlanes=[],this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr)),br.active.cameras.push(this)};(n["iron.object.CameraObject"]=Dr).__name__="iron.object.CameraObject",Dr.buildViewFrustum=function(t,e){var n=t.get__03()+t.get__00(),i=t.get__13()+t.get__10(),r=t.get__23()+t.get__20(),s=t.get__33()+t.get__30();e[0].setComponents(n,i,r,s);var a=t.get__03()-t.get__00(),o=t.get__13()-t.get__10(),l=t.get__23()-t.get__20(),u=t.get__33()-t.get__30();e[1].setComponents(a,o,l,u);var h=t.get__03()-t.get__01(),_=t.get__13()-t.get__11(),c=t.get__23()-t.get__21(),d=t.get__33()-t.get__31();e[2].setComponents(h,_,c,d);var p=t.get__03()+t.get__01(),g=t.get__13()+t.get__11(),f=t.get__23()+t.get__21(),m=t.get__33()+t.get__31();e[3].setComponents(p,g,f,m);var v=t.get__02(),y=t.get__12(),w=t.get__22(),b=t.get__32();e[4].setComponents(v,y,w,b);var x=t.get__03()-t.get__02(),S=t.get__13()-t.get__12(),C=t.get__23()-t.get__22(),k=t.get__33()-t.get__32();e[5].setComponents(x,S,C,k);for(var I=0;I<e.length;){var T=e[I];++I,T.normalize()}},Dr.sphereInFrustum=function(t,e,n,i,r,s){null==s&&(s=0),null==r&&(r=0),null==i&&(i=0),null==n&&(n=1);for(var a=e.radius*n,o=0;o<t.length;){var l=t[o];if(++o,Dr.sphereCenter.set(e.worldx()+i,e.worldy()+r,e.worldz()+s),l.distanceToSphere(Dr.sphereCenter,a)+2*a<0)return!1}return!0},Dr.setCubeFace=function(t,e,n){switch(Dr.vcenter.setFrom(e),n){case 0:Dr.vcenter.addf(1,0,0),Dr.vup.set(0,-1,0);break;case 1:Dr.vcenter.addf(-1,0,0),Dr.vup.set(0,-1,0);break;case 2:Dr.vcenter.addf(0,1,0),Dr.vup.set(0,0,1);break;case 3:Dr.vcenter.addf(0,-1,0),Dr.vup.set(0,0,-1);break;case 4:Dr.vcenter.addf(0,0,1),Dr.vup.set(0,-1,0);break;case 5:Dr.vcenter.addf(0,0,-1),Dr.vup.set(0,-1,0)}t.setLookAt(e,Dr.vcenter,Dr.vup)},Dr.__super__=Rr,Dr.prototype=r(Rr.prototype,{data:null,P:null,V:null,prevV:null,VP:null,frustumPlanes:null,renderTarget:null,renderTargetCube:null,currentFace:null,buildProjection:function(t){if(null!=this.data.raw.ortho)this.P=bi.ortho(this.data.raw.ortho[0],this.data.raw.ortho[1],this.data.raw.ortho[2],this.data.raw.ortho[3],this.data.raw.near_plane,this.data.raw.far_plane);else{null==t&&(t=mr.w()/mr.h());var e=null!=this.data.raw.aspect?this.data.raw.aspect:t;this.P=bi.persp(this.data.raw.fov,e,this.data.raw.near_plane,this.data.raw.far_plane)}},remove:function(){ut.remove(br.active.cameras,this),Rr.prototype.remove.call(this)},renderFrame:function(t){this.buildMatrix(),null==this.prevV&&(this.prevV=bi.identity(),this.prevV.setFrom(this.V)),vr.active.renderFrame(t),this.prevV.setFrom(this.V)},buildMatrix:function(){this.transform.buildMatrix();var t=this.transform.world.getScale();1==t.x&&1==t.y&&1==t.z||(Dr.temp.set(1/t.x,1/t.y,1/t.z),this.transform.world.scale(Dr.temp)),this.V.getInverse(this.transform.world),this.VP.multmats(this.P,this.V),this.data.raw.frustum_culling&&Dr.buildViewFrustum(this.VP,this.frustumPlanes)},rightWorld:function(){return new wi(this.transform.world.get__00(),this.transform.world.get__01(),this.transform.world.get__02())},upWorld:function(){return new wi(this.transform.world.get__10(),this.transform.world.get__11(),this.transform.world.get__12())},lookWorld:function(){return new wi(-this.transform.world.get__20(),-this.transform.world.get__21(),-this.transform.world.get__22())},__class__:Dr});var Gr=function(){this.constant=0,this.normal=new wi(1,0,0)};(n["iron.object.FrustumPlane"]=Gr).__name__="iron.object.FrustumPlane",Gr.prototype={normal:null,constant:null,normalize:function(){var t=1/this.normal.length();this.normal.mult(t),this.constant*=t},distanceToSphere:function(t,e){return this.normal.dot(t)+this.constant-e},setComponents:function(t,e,n,i){this.normal.set(t,e,n),this.constant=i},__class__:Gr};var Vr=function(t){this.target=null,this.raw=t};(n["iron.object.Constraint"]=Vr).__name__="iron.object.Constraint",Vr.prototype={raw:null,target:null,apply:function(t){if(null==this.target&&null!=this.raw.target&&(this.target=br.active.getChild(this.raw.target).transform),"COPY_LOCATION"==this.raw.type){if(this.raw.use_x&&(t.world.set__30(this.target.loc.x),this.raw.use_offset)){var e=t.world;e.set__30(e.get__30()+t.loc.x)}if(this.raw.use_y&&(t.world.set__31(this.target.loc.y),this.raw.use_offset)){var n=t.world;n.set__31(n.get__31()+t.loc.y)}if(this.raw.use_z&&(t.world.set__32(this.target.loc.z),this.raw.use_offset)){var i=t.world;i.set__32(i.get__32()+t.loc.z)}}},__class__:Vr};var Hr=function(t){this.frustumPlanes=null,this.VP=bi.identity(),this.P=null,this.V=bi.identity(),this.camSlicedP=null,Rr.call(this);var e=(this.data=t).raw.type,n=t.raw.fov;"sun"==e?(null==Hr.corners&&(Hr.corners=[],Hr.corners.push(new wi),Hr.corners.push(new wi),Hr.corners.push(new wi),Hr.corners.push(new wi),Hr.corners.push(new wi),Hr.corners.push(new wi),Hr.corners.push(new wi),Hr.corners.push(new wi)),this.P=bi.identity()):"point"==e||"area"==e?this.P=bi.persp(n,1,t.raw.near_plane,t.raw.far_plane):"spot"==e&&(this.P=bi.persp(n,1,t.raw.near_plane,t.raw.far_plane)),br.active.lights.push(this)};(n["iron.object.LightObject"]=Hr).__name__="iron.object.LightObject",Hr.setCorners=function(){Hr.corners[0].set(-1,-1,1),Hr.corners[1].set(-1,-1,-1),Hr.corners[2].set(-1,1,1),Hr.corners[3].set(-1,1,-1),Hr.corners[4].set(1,-1,1),Hr.corners[5].set(1,-1,-1),Hr.corners[6].set(1,1,1),Hr.corners[7].set(1,1,-1)},Hr.__super__=Rr,Hr.prototype=r(Rr.prototype,{camSlicedP:null,data:null,V:null,P:null,VP:null,frustumPlanes:null,remove:function(){null!=br.active&&ut.remove(br.active.lights,this),Rr.prototype.remove.call(this)},buildMatrix:function(t){this.transform.buildMatrix(),"sun"==this.data.raw.type?this.setCascade(t,0):(this.V.getInverse(this.transform.world),this.updateViewFrustum(t))},setCascade:function(t,e){if(Hr.m.setFrom(t.V),null==this.camSlicedP){var n=t.data.raw.ortho;if(null==n){var i=t.data.raw.fov,r=this.data.raw.near_plane,s=this.data.raw.far_plane,a=null!=t.data.raw.aspect?t.data.raw.aspect:mr.w()/mr.h();this.camSlicedP=bi.persp(i,a,r,s)}else this.camSlicedP=bi.ortho(n[0],n[1],n[2],n[3],this.data.raw.near_plane,this.data.raw.far_plane)}Hr.m.multmat(this.camSlicedP),Hr.m.getInverse(Hr.m),this.V.getInverse(this.transform.world),this.V.toRotation(),Hr.m.multmat(this.V),Hr.setCorners();for(var o=0,l=Hr.corners;o<l.length;){var u=l[o];++o,u.applymat4(Hr.m),u.set(u.x/u.w,u.y/u.w,u.z/u.w)}for(var h=Hr.corners[0].x,_=Hr.corners[0].y,c=Hr.corners[0].z,d=Hr.corners[0].x,p=Hr.corners[0].y,g=Hr.corners[0].z,f=0,m=Hr.corners;f<m.length;){var v=m[f];++f,v.x<h&&(h=v.x),v.x>d&&(d=v.x),v.y<_&&(_=v.y),v.y>p&&(p=v.y),v.z<c&&(c=v.z),v.z>g&&(g=v.z)}var y=wi.distance(Hr.corners[0],Hr.corners[7]),w=.5*(y-(d-h)),b=.5*(y-(p-_));h-=w,d+=w,_-=b,p+=b;var x=this.data.raw.shadowmap_size,S=(d-h)/x,C=(p-_)/x,k=(g-c)/x;h=Math.floor(h/S)*S,_=Math.floor(_/C)*C,c=Math.floor(c/k)*k,d=Math.floor(d/S)*S,p=Math.floor(p/C)*C,g=Math.floor(g/k)*k;var I=(d-h)/2*Hr.cascadeBounds,T=(p-_)/2*Hr.cascadeBounds,N=(g-c)/2*Hr.cascadeBounds;this.V.set__30(-(h+I)),this.V.set__31(-(_+T)),this.V.set__32(-(c+N)),Hr.m=bi.ortho(-I,I,-T,T,4*-N,N),this.P.setFrom(Hr.m),this.updateViewFrustum(t)},updateViewFrustum:function(t){this.VP.multmats(this.P,this.V),t.data.raw.frustum_culling&&(null==this.frustumPlanes&&(this.frustumPlanes=[],this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr),this.frustumPlanes.push(new Gr)),Dr.buildViewFrustum(this.VP,this.frustumPlanes))},setCubeFace:function(t,e){Hr.eye.set(this.transform.worldx(),this.transform.worldy(),this.transform.worldz()),Dr.setCubeFace(this.V,Hr.eye,t),this.updateViewFrustum(e)},look:function(){return new wi(this.V.get__02(),this.V.get__12(),this.V.get__22())},__class__:Hr});var Pr=function(t,e){this.force_context=null,this.skip_context=null,this.tilesheet=null,this.frustumCulling=!0,this.screenSize=0,this.data=null,Rr.call(this),this.materials=e,this.setData(t),br.active.meshes.push(this)};(n["iron.object.MeshObject"]=Pr).__name__="iron.object.MeshObject",Pr.__super__=Rr,Pr.prototype=r(Rr.prototype,{data:null,materials:null,cameraDistance:null,screenSize:null,frustumCulling:null,tilesheet:null,skip_context:null,force_context:null,setData:function(t){(this.data=t).refcount++,t.geom.build()},remove:function(){null!=this.tilesheet&&this.tilesheet.remove(),null!=br.active&&ut.remove(br.active.meshes,this),this.data.refcount--,Rr.prototype.remove.call(this)},setupAnimation:function(t){Rr.prototype.setupAnimation.call(this,t)},setupTilesheet:function(t,e,n){this.tilesheet=new Xr(t,e,n)},isLodMaterial:function(){return null!=this.raw&&null!=this.raw.lod_material&&1==this.raw.lod_material},setCulled:function(t,e){return t?this.culledShadow=e:this.culledMesh=e,this.culled=this.culledMesh&&this.culledShadow,e},cullMaterial:function(t){var e=this.materials;if(!this.isLodMaterial()&&!this.validContext(e[0],t))return!0;var n="shadowmap"==t;return this.visibleMesh||n?!this.visibleShadow&&n?this.setCulled(n,!0):this.skipContext(t)?this.setCulled(n,!0):this.setCulled(n,!1):this.setCulled(n,!0)},cullMesh:function(t,e,n){if(null==e)return!1;if(e.data.raw.frustum_culling&&this.frustumCulling){var i=this.data.isSkinned?2:1;"voxel"==t&&(i*=100);var r="shadowmap"==t,s=r?n.frustumPlanes:e.frustumPlanes;if(r&&"sun"!=n.data.raw.type&&(n.transform.radius=n.data.raw.far_plane,!Dr.sphereInFrustum(e.frustumPlanes,n.transform)))return this.setCulled(r,!0);if(!this.data.geom.instanced&&!Dr.sphereInFrustum(s,this.transform,i))return this.setCulled(r,!0)}return this.culled=!1,this.culled},skipContext:function(t){if(this.skip_context==t)return!0;if(null!=this.force_context&&this.force_context!=t)return!0;for(var e=0,n=this.materials;e<n.length;){var i=n[e];if(++e,null!=i.raw.skip_context&&i.raw.skip_context==t)return!0}return"voxel"==t&&1==this.raw.mobile},getContexts:function(t,e,n,i){for(var r=0;r<e.length;){var s=e[r];++r;for(var a=0,o=s.raw.contexts.length;a<o;){var l=a++;if(ut.substr(s.raw.contexts[l].name,0,t.length)==t){n.push(s.contexts[l]),i.push(s.shader.getContext(t));break}}}},render:function(t,e,n,i,r){if(null!=this.data&&this.data.geom.ready&&this.visible&&!this.cullMesh(e,n,i)){this.raw;if(null!=this.tilesheet&&this.tilesheet.update(),!this.cullMaterial(e)){var s=this.materials,a=this;if(null!=this.raw&&null!=this.raw.lods&&0<this.raw.lods.length){if(this.computeScreenSize(n),this.initLods(),"voxel"==e)a=this.lods[this.lods.length-1];else for(var o=0,l=this.raw.lods.length;o<l;){var u=o++;if(this.screenSize>this.raw.lods[u].screen_size)break;a=this.lods[u],this.isLodMaterial()&&(s=a.materials)}if(null==a)return}if(!this.isLodMaterial()||this.validContext(s[0],e)){var h=[],_=[];this.getContexts(e,s,h,_),this.transform.update();for(var c=a.data,d=0,p=c.geom.indexBuffers.length;d<p;){var g=d++,f=c.geom.materialIndices[g];if(!(_.length<=f)){var m=_[f],v=m.raw.vertex_structure;m.pipeState!=Pr.lastPipeline&&(t.setPipeline(m.pipeState),Pr.lastPipeline=m.pipeState,Ur.setContextConstants(t,m,n,i,r)),Ur.setObjectConstants(t,m,this,n,i),f<h.length&&Ur.setMaterialConstants(t,m,h[f]),c.geom.instanced?t.setVertexBuffers([c.geom.get(v),c.geom.instancedVB]):t.setVertexBuffer(c.geom.get(v)),t.setIndexBuffer(c.geom.indexBuffers[g]),c.geom.instanced?t.drawIndexedVerticesInstanced(c.geom.instanceCount,c.geom.start,c.geom.count):t.drawIndexedVertices(c.geom.start,c.geom.count)}}}}}},validContext:function(t,e){return null!=t.getContext(e)},computeCameraDistance:function(t,e,n){this.cameraDistance=wi.distancef(t,e,n,this.transform.worldx(),this.transform.worldy(),this.transform.worldz())},computeScreenSize:function(t){var e=this.transform,n=e.dim.x*e.dim.y*e.dim.z;this.screenSize=n*(1/this.cameraDistance),this.screenSize=1<this.screenSize?1:this.screenSize},initLods:function(){if(null==this.lods){this.lods=[];for(var t=0,e=this.raw.lods;t<e.length;){var n=e[t];++t,""==n.object_ref?this.lods.push(null):this.lods.push(br.active.getChild(n.object_ref))}}},__class__:Pr});var zr=function(t,e){this.bezierFrameIndex=-1,this.s0=0,this.object=t,this.oactions=e,this.isSkinned=!1,Wr.call(this)};(n["iron.object.ObjectAnimation"]=zr).__name__="iron.object.ObjectAnimation",zr.__super__=Wr,zr.prototype=r(Wr.prototype,{object:null,oactions:null,oaction:null,getAction:function(t){for(var e=0,n=this.oactions;e<n.length;){var i=n[e];if(++e,null!=i&&i.objects[0].name==t)return i.objects[0]}return null},play:function(t,e,n,i,r){null==r&&(r=!0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=""),Wr.prototype.play.call(this,t,e,n,i,r),""==this.action&&null!=this.oactions[0]&&(this.action=this.oactions[0].objects[0].name),this.oaction=this.getAction(this.action),null!=this.oaction&&(this.isSampled=null!=this.oaction.sampled&&this.oaction.sampled)},update:function(t){this.object.visible&&!this.object.culled&&null!=this.oaction&&(Wr.prototype.update.call(this,t),this.paused||this.isSkinned||this.updateObjectAnim())},updateObjectAnim:function(){if(this.isSampled){this.updateTrack(this.oaction.anim),this.updateAnimSampled(this.oaction.anim,this.object.transform.world),this.object.transform.world.decompose(this.object.transform.loc,this.object.transform.rot,this.object.transform.scale);for(var t=0,e=this.object.children;t<e.length;){var n=e[t];++t,n.transform.buildMatrix()}}else this.updateAnimNonSampled(this.oaction.anim,this.object.transform),this.object.transform.buildMatrix()},interpolateLinear:function(t,e,n,i,r){var s=(t-e)/(n-e);return(1-s)*i+s*r},s0:null,bezierFrameIndex:null,interpolateBezier:function(t,e,n,i,r,s,a,o,l){this.frameIndex!=this.bezierFrameIndex&&(this.bezierFrameIndex=this.frameIndex,this.s0=(t-e)/(n-e));var u=(n-3*a+3*s-e)*(this.s0*this.s0*this.s0)+3*(a-2*s+e)*(this.s0*this.s0)+3*(s-e)*this.s0+e-t,h=3*(n-3*a+3*s-e)*(this.s0*this.s0)+6*(a-2*s+e)*this.s0+3*(s-e),_=this.s0-u/h;return(1-(this.s0=_))*(1-_)*(1-_)*i+3*_*(1-_)*(1-_)*o+_*_*3*(1-_)*l+_*_*_*r},isTrackEnd:function(t){return 0<this.speed?this.frameIndex>=t.frames.length-2:this.frameIndex<=0},checkFrameIndexT:function(t,e){return 0<this.speed?this.frameIndex<t.length-2&&e>t[this.frameIndex+1]*this.frameTime:1<this.frameIndex&&e>t[this.frameIndex-1]*this.frameTime},updateAnimNonSampled:function(t,e){if(null!=t){var n=t.end*this.frameTime-t.begin*this.frameTime;if(t.has_delta){var i=e;null==i.dloc&&(i.dloc=new wi,i.drot=new xi,i.dscale=new wi),i.dloc.set(0,0,0),i.dscale.set(0,0,0),i._deulerX=i._deulerY=i._deulerZ=0}for(var r=0,s=t.tracks;r<s.length;){var a=s[r];++r,-1==this.frameIndex&&this.rewind(a);for(var o=0<this.speed?1:-1,l=this.time+t.begin*this.frameTime;this.checkFrameIndexT(a.frames,l);)this.frameIndex+=o;if(!(this.frameIndex>=a.frames.length)){if(this.time>n)return null!=this.onComplete&&this.onComplete(),void this.rewind(a);var u=this.frameIndex,h=a.frames[u]*this.frameTime,_=a.frames[u+o]*this.frameTime,c=a.values[u],d=a.values[u+o],p=0;switch(a.curve){case"bezier":var g=a.frames_control_plus[u]*this.frameTime,f=a.frames_control_minus[u+o]*this.frameTime,m=a.values_control_plus[u],v=a.values_control_minus[u+o];p=this.interpolateBezier(l,h,_,c,d,g,f,m,v);break;case"linear":p=this.interpolateLinear(l,h,_,c,d)}switch(a.target){case"dxloc":e.dloc.x=p;break;case"dxrot":e._deulerX=p;break;case"dxscl":e.dscale.x=p;break;case"dyloc":e.dloc.y=p;break;case"dyrot":e._deulerY=p;break;case"dyscl":e.dscale.y=p;break;case"dzloc":e.dloc.z=p;break;case"dzrot":e._deulerZ=p;break;case"dzscl":e.dscale.z=p;break;case"xloc":e.loc.x=p;break;case"xrot":e.setRotation(p,e._eulerY,e._eulerZ);break;case"xscl":e.scale.x=p;break;case"yloc":e.loc.y=p;break;case"yrot":e.setRotation(e._eulerX,p,e._eulerZ);break;case"yscl":e.scale.y=p;break;case"zloc":e.loc.z=p;break;case"zrot":e.setRotation(e._eulerX,e._eulerY,p);break;case"zscl":e.scale.z=p}}}}},__class__:zr});var Zr=function(t){this.paused=!1,this.channels=[],this.sound=null;var e=this;Rr.call(this),this.data=t,br.active.speakers.push(this),""!=t.sound&&Cr.getSound(t.sound,function(t){e.sound=t,mr.notifyOnInit(Fo(e,e.init))})};(n["iron.object.SpeakerObject"]=Zr).__name__="iron.object.SpeakerObject",Zr.__super__=Rr,Zr.prototype=r(Rr.prototype,{data:null,sound:null,channels:null,paused:null,init:function(){this.visible&&this.data.play_on_start&&this.play()},play:function(){if(null!=this.sound&&!this.data.muted)if(this.paused){for(var t=0,e=this.channels;t<e.length;){var n=e[t];++t,n.play()}this.paused=!1}else{var i=Qr.play(this.sound,this.data.loop,this.data.stream);this.channels.push(i),0<this.data.attenuation&&1==this.channels.length&&mr.notifyOnUpdate(Fo(this,this.update))}},pause:function(){for(var t=0,e=this.channels;t<e.length;){var n=e[t];++t,n.pause()}this.paused=!0},stop:function(){for(var t=0,e=this.channels;t<e.length;){var n=e[t];++t,n.stop()}this.channels.splice(0,this.channels.length)},update:function(){if(!this.paused){for(var t=0,e=this.channels;t<e.length;){var n=e[t];++t,n.get_finished()&&ut.remove(this.channels,n)}if(0!=this.channels.length){var i=br.active.camera.transform.world.getLoc(),r=this.transform.world.getLoc(),s=wi.distance(i,r);s*=this.data.attenuation;for(var a=1-Math.min(s/100,1),o=0,l=this.channels;o<l.length;){var u=l[o];++o,u.set_volume(a*this.data.volume)}}else mr.removeUpdate(Fo(this,this.update))}},remove:function(){null!=br.active&&ut.remove(br.active.speakers,this),Rr.prototype.remove.call(this)},__class__:Zr});var Xr=function(t,r,s){this.onActionComplete=null,this.time=0,this.frame=0,this.paused=!1,this.action=null,this.tileY=0,this.tileX=0;var a=this;this.ready=!1,Cr.getSceneRaw(t,function(t){for(var e=0,n=t.tilesheet_datas;e<n.length;){var i=n[e];if(++e,i.name==r){a.raw=i,a.play(s),a.ready=!0;break}}})};(n["iron.object.Tilesheet"]=Xr).__name__="iron.object.Tilesheet",Xr.prototype={tileX:null,tileY:null,raw:null,action:null,ready:null,paused:null,frame:null,time:null,onActionComplete:null,play:function(t,e){this.onActionComplete=e;for(var n=0,i=this.raw.actions;n<i.length;){var r=i[n];if(++n,r.name==t){this.action=r;break}}this.setFrame(this.action.start),this.paused=!1},pause:function(){this.paused=!0},resume:function(){this.paused=!1},remove:function(){},update:function(){!this.ready||this.paused||this.action.start>=this.action.end||(this.time+=os.get_delta(),this.time>=1/this.raw.framerate&&this.setFrame(this.frame+1))},setFrame:function(t){this.frame=t,this.time=0;var e=this.frame%this.raw.tilesx,n=pt.int(this.frame/this.raw.tilesx);this.tileX=e*(1/this.raw.tilesx),this.tileY=n*(1/this.raw.tilesy),this.frame>=this.action.end&&this.action.start<this.action.end&&(null!=this.onActionComplete&&this.onActionComplete(),this.action.loop?this.setFrame(this.action.start):this.paused=!0)},__class__:Xr};var jr=function(t){this.dscale=null,this.drot=null,this.dloc=null,this.boneParent=null,this.appendMats=null,this.prependMats=null,this.localOnly=!1,this.object=t,this.reset()};(n["iron.object.Transform"]=jr).__name__="iron.object.Transform",jr.prototype={world:null,localOnly:null,local:null,loc:null,rot:null,scale:null,dirty:null,object:null,dim:null,radius:null,prependMats:null,appendMats:null,boneParent:null,reset:function(){this.world=bi.identity(),this.local=bi.identity(),this.loc=new wi,this.rot=new xi,this.scale=new wi(1,1,1),this.dim=new wi(2,2,2),this.radius=1,this.dirty=!0},update:function(){this.dirty&&this.buildMatrix()},composeDelta:function(){this.dloc.addvecs(this.loc,this.dloc),this.dscale.addvecs(this.dscale,this.scale),this.drot.fromEuler(this._deulerX,this._deulerY,this._deulerZ),this.drot.multquats(this.rot,this.drot),this.local.compose(this.dloc,this.drot,this.dscale)},buildMatrix:function(){if(null==this.dloc?this.local.compose(this.loc,this.rot,this.scale):this.composeDelta(),null!=this.prependMats){jr.temp.setIdentity();for(var t=0,e=this.prependMats;t<e.length;){var n=e[t];++t,jr.temp.multmat(n)}jr.temp.multmat(this.local),this.local.setFrom(jr.temp)}if(null!=this.appendMats)for(var i=0,r=this.appendMats;i<r.length;){var s=r[i];++i,this.local.multmat(s)}if(null!=this.boneParent&&this.local.multmats(this.boneParent,this.local),null==this.object.parent||this.localOnly?this.world.setFrom(this.local):this.world.multmats3x4(this.local,this.object.parent.transform.world),null!=this.object.constraints)for(var a=0,o=this.object.constraints;a<o.length;){var l=o[a];++a,l.apply(this)}this.computeDim();for(var u=0,h=this.object.children;u<h.length;){var _=h[u];++u,_.transform.buildMatrix()}this.dirty=!1},setMatrix:function(t){this.local.setFrom(t),this.decompose(),this.buildMatrix()},multMatrix:function(t){this.local.multmat(t),this.decompose(),this.buildMatrix()},decompose:function(){this.local.decompose(this.loc,this.rot,this.scale)},setRotation:function(t,e,n){this.rot.fromEuler(t,e,n),this._eulerX=t,this._eulerY=e,this._eulerZ=n,this.dirty=!0},computeRadius:function(){this.radius=Math.sqrt(this.dim.x*this.dim.x+this.dim.y*this.dim.y+this.dim.z*this.dim.z)},computeDim:function(){if(null!=this.object.raw){var t=this.object.raw.dimensions;null==t?this.dim.set(2*this.scale.x,2*this.scale.y,2*this.scale.z):this.dim.set(t[0]*this.scale.x,t[1]*this.scale.y,t[2]*this.scale.z),this.computeRadius()}else this.computeRadius()},applyParentInverse:function(){var t=this.object.parent.transform;t.buildMatrix(),jr.temp.getInverse(t.world),this.local.multmat(jr.temp),this.decompose(),this.buildMatrix()},applyParent:function(){var t=this.object.parent.transform;this.local.multmat(t.world),this.decompose()},overlap:function(t){var e=this;return e.worldx()+e.dim.x/2>t.worldx()-t.dim.x/2&&e.worldx()-e.dim.x/2<t.worldx()+t.dim.x/2&&e.worldy()+e.dim.y/2>t.worldy()-t.dim.y/2&&e.worldy()-e.dim.y/2<t.worldy()+t.dim.y/2&&e.worldz()+e.dim.z/2>t.worldz()-t.dim.z/2&&e.worldz()-e.dim.z/2<t.worldz()+t.dim.z/2},_eulerX:null,_eulerY:null,_eulerZ:null,worldx:function(){return this.world.get__30()},worldy:function(){return this.world.get__31()},worldz:function(){return this.world.get__32()},dloc:null,drot:null,dscale:null,_deulerX:null,_deulerY:null,_deulerZ:null,__class__:jr};var Yr=function(t,e,n,i,r,s,a,o,l){this._00=t,this._10=e,this._20=n,this._01=i,this._11=r,this._21=s,this._02=a,this._12=o,this._22=l};(n["kha.math.FastMatrix3"]=Yr).__name__="kha.math.FastMatrix3",Yr.prototype={_00:null,_10:null,_20:null,_01:null,_11:null,_21:null,_02:null,_12:null,_22:null,__class__:Yr};var Ur=function(){};(n["iron.object.Uniforms"]=Ur).__name__="iron.object.Uniforms",Ur.setContextConstants=function(t,e,n,i,r){if(null!=e.raw.constants)for(var s=0,a=e.raw.constants.length;s<a;){var o=s++,l=e.raw.constants[o];Ur.setContextConstant(t,n,i,e.constants[o],l)}if(null!=r)for(var u=0,h=pt.int(r.length/2);u<h;){var _=2*u++,c=r[_],d=r[_+1],p=!1;"_"==c.charAt(0)&&(p=!0,c=ut.substr(c,1,null));var g=p?vr.active.depthToRenderTarget.get(c):vr.active.renderTargets.get(c);Ur.bindRenderTarget(t,g,e,d,p)}if(null!=e.raw.texture_units)for(var f=0,m=e.raw.texture_units.length;f<m;){var v=f++,y=e.raw.texture_units[v].link;if(null!=y)if("_envmapRadiance"==y){var w=br.active.world;null!=w&&(t.setTexture(e.textureUnits[v],w.probe.radiance),t.setTextureParameters(e.textureUnits[v],Ha.Repeat,Ha.Repeat,Pa.LinearFilter,Pa.LinearFilter,La.LinearMipFilter))}else if("_envmap"==y){var b=br.active.world;null!=b&&t.setTexture(e.textureUnits[v],b.envmap)}else if("_envmapBrdf"==y)t.setTexture(e.textureUnits[v],br.active.embedded.get("brdf.png"));else if("_noise8"==y)t.setTexture(e.textureUnits[v],br.active.embedded.get("noise8.png")),t.setTextureParameters(e.textureUnits[v],Ha.Repeat,Ha.Repeat,Pa.LinearFilter,Pa.LinearFilter,La.NoMipFilter);else if("_noise64"==y)t.setTexture(e.textureUnits[v],br.active.embedded.get("noise64.png")),t.setTextureParameters(e.textureUnits[v],Ha.Repeat,Ha.Repeat,Pa.LinearFilter,Pa.LinearFilter,La.NoMipFilter);else if("_blueNoise64"==y)t.setTexture(e.textureUnits[v],br.active.embedded.get("blue_noise64.png")),t.setTextureParameters(e.textureUnits[v],Ha.Repeat,Ha.Repeat,Pa.LinearFilter,Pa.LinearFilter,La.NoMipFilter);else if("_noise256"==y)t.setTexture(e.textureUnits[v],br.active.embedded.get("noise256.png")),t.setTextureParameters(e.textureUnits[v],Ha.Repeat,Ha.Repeat,Pa.LinearFilter,Pa.LinearFilter,La.NoMipFilter);else if("_lightColorTexture"==y)null!=i&&(t.setTexture(e.textureUnits[v],i.data.colorTexture),t.setTextureParameters(e.textureUnits[v],Ha.Repeat,Ha.Repeat,Pa.LinearFilter,Pa.LinearFilter,La.NoMipFilter));else if("_iesTexture"==y)t.setTexture(e.textureUnits[v],br.active.embedded.get("iestexture.png")),t.setTextureParameters(e.textureUnits[v],Ha.Repeat,Ha.Repeat,Pa.LinearFilter,Pa.LinearFilter,La.NoMipFilter);else;}},Ur.setObjectConstants=function(t,e,n,i,r){if(null!=e.raw.constants)for(var s=0,a=e.raw.constants.length;s<a;){var o=s++,l=e.raw.constants[o];Ur.setObjectConstant(t,n,i,r,e.constants[o],l)}if(null!=Ur.externalTextureLinks&&null!=e.raw.texture_units)for(var u=0,h=e.raw.texture_units.length;u<h;){var _=u++,c=e.raw.texture_units[_].link;if(null!=c)for(var d=0,p=Ur.externalTextureLinks;d<p.length;){var g=p[d];++d;var f=g(n,Ur.currentMat(n),c);if(null!=f){t.setTexture(e.textureUnits[_],f);break}}}},Ur.bindRenderTarget=function(t,e,n,i,r){if(null!=e)for(var s=n.raw.texture_units,a=0,o=s.length;a<o;){var l=a++;if(i==s[l].name){var u=null!=s[l].is_image&&s[l].is_image;1<e.raw.depth&&(t.setTexture3DParameters(n.textureUnits[l],Ha.Clamp,Ha.Clamp,Ha.Clamp,Pa.LinearFilter,Pa.PointFilter,La.LinearMipFilter),n.paramsSet[l]=!0),u?(t.setImageTexture(n.textureUnits[l],e.image),t.setTexture3DParameters(n.textureUnits[l],Ha.Clamp,Ha.Clamp,Ha.Clamp,Pa.LinearFilter,Pa.PointFilter,La.LinearMipFilter),n.paramsSet[l]=!0):e.isCubeMap?r?t.setCubeMapDepth(n.textureUnits[l],e.cubeMap):t.setCubeMap(n.textureUnits[l],e.cubeMap):r?t.setTextureDepth(n.textureUnits[l],e.image):t.setTexture(n.textureUnits[l],e.image),n.paramsSet[l]||null==e.raw.mipmaps||1!=e.raw.mipmaps||u||(t.setTextureParameters(n.textureUnits[l],Ha.Clamp,Ha.Clamp,Pa.LinearFilter,Pa.LinearFilter,La.LinearMipFilter),n.paramsSet[l]=!0),n.paramsSet[l]||(("shadowMap"==i||r)&&(t.setTextureParameters(n.textureUnits[l],Ha.Clamp,Ha.Clamp,Pa.PointFilter,Pa.PointFilter,La.NoMipFilter),n.paramsSet[l]=!0),"shadowMapCube"==i&&(n.paramsSet[l]=!0)),n.paramsSet[l]||(t.setTextureParameters(n.textureUnits[l],Ha.Clamp,Ha.Clamp,Pa.LinearFilter,Pa.LinearFilter,La.NoMipFilter),n.paramsSet[l]=!0)}}},Ur.setContextConstant=function(t,e,n,i,r){if(null==r.link)return!0;if("mat4"==r.type){var s=null;if("_viewMatrix"==r.link)s=e.V;else if("_transposeInverseViewMatrix"==r.link)Ur.helpMat.setFrom(e.V),Ur.helpMat.getInverse(Ur.helpMat),Ur.helpMat.transpose(),s=Ur.helpMat;else if("_inverseViewMatrix"==r.link)Ur.helpMat.getInverse(e.V),s=Ur.helpMat;else if("_transposeViewMatrix"==r.link)Ur.helpMat.setFrom(e.V),Ur.helpMat.transpose3x3(),s=Ur.helpMat;else if("_projectionMatrix"==r.link)s=e.P;else if("_inverseProjectionMatrix"==r.link)Ur.helpMat.getInverse(e.P),s=Ur.helpMat;else if("_inverseViewProjectionMatrix"==r.link)Ur.helpMat.setFrom(e.V),Ur.helpMat.multmat(e.P),Ur.helpMat.getInverse(Ur.helpMat),s=Ur.helpMat;else if("_viewProjectionMatrix"==r.link)s=e.VP;else if("_prevViewProjectionMatrix"==r.link)Ur.helpMat.setFrom(e.prevV),Ur.helpMat.multmat(e.P),s=Ur.helpMat;else if("_lightViewProjectionMatrix"==r.link)null!=n&&(s=n.VP);else if("_biasLightViewProjectionMatrix"==r.link)null!=n&&(Ur.helpMat.setFrom(n.VP),Ur.helpMat.multmat(Ur.biasMat),s=Ur.helpMat);else if("_lightVolumeWorldViewProjectionMatrix"==r.link){if(null!=n){var a=n.transform,o=n.data.raw.type;if("spot"==o){Ur.helpVec.set(a.worldx(),a.worldy(),a.worldz());Ur.helpVec2.set(n.data.raw.far_plane,2*n.data.raw.far_plane,2*n.data.raw.far_plane),Ur.helpMat.compose(Ur.helpVec,Ur.helpQuat,Ur.helpVec2)}else if("point"==o||"area"==o){Ur.helpVec.set(a.worldx(),a.worldy(),a.worldz());Ur.helpVec2.set(n.data.raw.far_plane,2*n.data.raw.far_plane,2*n.data.raw.far_plane),Ur.helpMat.compose(Ur.helpVec,Ur.helpQuat,Ur.helpVec2)}Ur.helpMat.multmat(e.V),Ur.helpMat.multmat(e.P),s=Ur.helpMat}}else if("_skydomeMatrix"==r.link){var l=e.transform;Ur.helpVec.set(l.worldx(),l.worldy(),l.worldz()-3.5);var u=.95*e.data.raw.far_plane;Ur.helpVec2.set(u,u,u),Ur.helpMat.compose(Ur.helpVec,Ur.helpQuat,Ur.helpVec2),Ur.helpMat.multmat(e.V),Ur.helpMat.multmat(e.P),s=Ur.helpMat}else"_lightViewMatrix"==r.link?null!=n&&(s=n.V):"_lightProjectionMatrix"==r.link&&null!=n&&(s=n.P);if(null!=s)return t.setMatrix(i,s.self),!0}else if("vec4"==r.type){Ur.helpVec.set(0,0,0)}else if("vec3"==r.type){var h=null;if(Ur.helpVec.set(0,0,0),"_lightPosition"==r.link)null!=n&&(Ur.helpVec.set(n.transform.worldx(),n.transform.worldy(),n.transform.worldz()),h=Ur.helpVec);else if("_lightDirection"==r.link)null!=n&&(Ur.helpVec=n.look(),h=Ur.helpVec);else if("_lightColor"==r.link){if(null!=n){var _=n.data.raw.strength;Ur.helpVec.set(n.data.raw.color[0]*_,n.data.raw.color[1]*_,n.data.raw.color[2]*_),h=Ur.helpVec}}else if("_lightArea0"==r.link){if(null!=n&&null!=n.data.raw.size){var c=.5*n.data.raw.size,d=.5*n.data.raw.size_y;Ur.helpVec.set(-c,d,0),Ur.helpVec.applymat(n.transform.world),h=Ur.helpVec}}else if("_lightArea1"==r.link){if(null!=n&&null!=n.data.raw.size){var p=.5*n.data.raw.size,g=.5*n.data.raw.size_y;Ur.helpVec.set(p,g,0),Ur.helpVec.applymat(n.transform.world),h=Ur.helpVec}}else if("_lightArea2"==r.link){if(null!=n&&null!=n.data.raw.size){var f=.5*n.data.raw.size,m=.5*n.data.raw.size_y;Ur.helpVec.set(f,-m,0),Ur.helpVec.applymat(n.transform.world),h=Ur.helpVec}}else if("_lightArea3"==r.link){if(null!=n&&null!=n.data.raw.size){var v=.5*n.data.raw.size,y=.5*n.data.raw.size_y;Ur.helpVec.set(-v,-y,0),Ur.helpVec.applymat(n.transform.world),h=Ur.helpVec}}else if("_cameraPosition"==r.link)Ur.helpVec.set(e.transform.worldx(),e.transform.worldy(),e.transform.worldz()),h=Ur.helpVec;else if("_cameraLook"==r.link)Ur.helpVec=e.lookWorld(),h=Ur.helpVec;else if("_cameraUp"==r.link)Ur.helpVec=e.upWorld(),h=Ur.helpVec;else if("_cameraRight"==r.link)Ur.helpVec=e.rightWorld(),h=Ur.helpVec;else if("_backgroundCol"==r.link)null!=e.data.raw.clear_color&&Ur.helpVec.set(e.data.raw.clear_color[0],e.data.raw.clear_color[1],e.data.raw.clear_color[2]),h=Ur.helpVec;else if("_sunDirection"==r.link){var w=br.active.world;null!=w&&(Ur.helpVec.set(w.raw.sun_direction[0],w.raw.sun_direction[1],w.raw.sun_direction[2]),h=Ur.helpVec)}if(null!=h)return t.setFloat3(i,h.x,h.y,h.z),!0}else if("vec2"==r.type){var b=null;if(Ur.helpVec.set(0,0,0),"_vec2x"==r.link)(b=Ur.helpVec).x=1,b.y=0;else if("_vec2xInv"==r.link)(b=Ur.helpVec).x=1/vr.active.currentW,b.y=0;else if("_vec2x2"==r.link)(b=Ur.helpVec).x=2,b.y=0;else if("_vec2x2Inv"==r.link)(b=Ur.helpVec).x=2/vr.active.currentW,b.y=0;else if("_vec2y"==r.link)(b=Ur.helpVec).x=0,b.y=1;else if("_vec2yInv"==r.link)(b=Ur.helpVec).x=0,b.y=1/vr.active.currentH;else if("_vec2y2"==r.link)(b=Ur.helpVec).x=0,b.y=2;else if("_vec2y2Inv"==r.link)(b=Ur.helpVec).x=0,b.y=2/vr.active.currentH;else if("_vec2y3"==r.link)(b=Ur.helpVec).x=0,b.y=3;else if("_vec2y3Inv"==r.link)(b=Ur.helpVec).x=0,b.y=3/vr.active.currentH;else if("_windowSize"==r.link)(b=Ur.helpVec).x=mr.w(),b.y=mr.h();else if("_windowSizeInv"==r.link)(b=Ur.helpVec).x=1/mr.w(),b.y=1/mr.h();else if("_screenSize"==r.link)(b=Ur.helpVec).x=vr.active.currentW,b.y=vr.active.currentH;else if("_screenSizeInv"==r.link)(b=Ur.helpVec).x=1/vr.active.currentW,b.y=1/vr.active.currentH;else if("_aspectRatio"==r.link)(b=Ur.helpVec).x=vr.active.currentH/vr.active.currentW,b.y=vr.active.currentW/vr.active.currentH,b.x=1<b.x?1:b.x,b.y=1<b.y?1:b.y;else if("_cameraPlane"==r.link)(b=Ur.helpVec).x=e.data.raw.near_plane,b.y=e.data.raw.far_plane;else if("_cameraPlaneProj"==r.link){var x=e.data.raw.near_plane,S=e.data.raw.far_plane;(b=Ur.helpVec).x=S/(S-x),b.y=-S*x/(S-x)}else if("_lightPlane"==r.link)null!=n&&((b=Ur.helpVec).x=n.data.raw.near_plane,b.y=n.data.raw.far_plane);else if("_lightPlaneProj"==r.link){if(null!=n){var C=n.data.raw.near_plane,k=n.data.raw.far_plane,I=k+C,T=k-C,N=2*k*C;(b=Ur.helpVec).x=I/T,b.y=N/T}}else"_spotlightData"==r.link?null!=n&&((b=Ur.helpVec).x=n.data.raw.spot_size,b.y=b.x-n.data.raw.spot_blend):"_shadowMapSize"==r.link&&null!=n&&n.data.raw.cast_shadow&&((b=Ur.helpVec).x=b.y=n.data.raw.shadowmap_size);if(null!=b)return t.setFloat2(i,b.x,b.y),!0}else if("float"==r.type){var M=null;if("_time"==r.link?M=os.time():"_deltaTime"==r.link?M=os.get_delta():"_lightRadius"==r.link?M=null==n?0:n.data.raw.far_plane:"_lightShadowsBias"==r.link?M=null==n?0:n.data.raw.shadows_bias:"_lightSize"==r.link?null!=n&&null!=n.data.raw.light_size&&(M=n.data.raw.light_size):"_envmapStrength"==r.link?M=null==br.active.world?0:br.active.world.probe.raw.strength:"_aspectRatioF"==r.link?M=vr.active.currentW/vr.active.currentH:"_aspectRatioWindowF"==r.link?M=mr.w()/mr.h():"_frameScale"==r.link&&(M=vr.active.frameTime/os.get_delta()),null!=M)return t.setFloat(i,M),!0}else if("floats"==r.type){var O=null;if("_envmapIrradiance"==r.link&&(O=null==br.active.world?Ar.getEmptyIrradiance():br.active.world.probe.irradiance),null!=O)return t.setFloats(i,O),!0}else if("int"==r.type){var E=null;if("_lightType"==r.link)E=null==n?0:Ir.typeToInt(n.data.raw.type);else if("_lightIndex"==r.link)E=vr.active.currentLightIndex;else if("_lightCastShadow"==r.link)E=null!=n&&n.data.raw.cast_shadow?n.data.raw.shadowmap_cube?2:1:0;else if("_envmapNumMipmaps"==r.link){var A=br.active.world;E=null!=A?A.probe.raw.radiance_mipmaps+1-2:1}if(null!=E)return t.setInt(i,E),!0}return!1},Ur.setObjectConstant=function(t,e,n,i,r,s){if(null!=s.link)if("mat4"==s.type){var a=null;if("_worldMatrix"==s.link)a=e.transform.world;else if("_inverseWorldMatrix"==s.link)Ur.helpMat.getInverse(e.transform.world),a=Ur.helpMat;else if("_worldViewProjectionMatrix"==s.link)Ur.helpMat.setFrom(e.transform.world),Ur.helpMat.multmat(n.V),Ur.helpMat.multmat(n.P),a=Ur.helpMat;else if("_worldViewProjectionMatrixSphere"==s.link)Ur.helpMat.setFrom(e.transform.world),Ur.helpMat.multmat(n.V),Ur.helpMat.set__00(1),Ur.helpMat.set__10(0),Ur.helpMat.set__20(0),Ur.helpMat.set__01(0),Ur.helpMat.set__11(1),Ur.helpMat.set__21(0),Ur.helpMat.set__02(0),Ur.helpMat.set__12(0),Ur.helpMat.set__22(1),Ur.helpMat.multmat(n.P),a=Ur.helpMat;else if("_worldViewProjectionMatrixCylinder"==s.link)Ur.helpMat.setFrom(e.transform.world),Ur.helpMat.multmat(n.V),Ur.helpMat.set__00(1),Ur.helpMat.set__20(0),Ur.helpMat.set__01(0),Ur.helpMat.set__21(0),Ur.helpMat.set__02(0),Ur.helpMat.set__22(1),Ur.helpMat.multmat(n.P),a=Ur.helpMat;else if("_worldViewMatrix"==s.link)Ur.helpMat.setFrom(e.transform.world),Ur.helpMat.multmat(n.V),a=Ur.helpMat;else if("_lightWorldViewProjectionMatrix"==s.link)null!=i&&(null==e?Ur.helpMat.setIdentity():Ur.helpMat.setFrom(e.transform.world),Ur.helpMat.multmat(i.VP),a=Ur.helpMat);else if("_lightWorldViewProjectionMatrixSphere"==s.link)null!=i&&(Ur.helpMat.setFrom(e.transform.world),Ur.helpMat.multmat(n.V),Ur.helpMat.set__00(1),Ur.helpMat.set__10(0),Ur.helpMat.set__20(0),Ur.helpMat.set__01(0),Ur.helpMat.set__11(1),Ur.helpMat.set__21(0),Ur.helpMat.set__02(0),Ur.helpMat.set__12(0),Ur.helpMat.set__22(1),Ur.helpMat2.getInverse(n.V),Ur.helpMat.multmat(Ur.helpMat2),Ur.helpMat.multmat(i.VP),a=Ur.helpMat);else if("_lightWorldViewProjectionMatrixCylinder"==s.link)null!=i&&(Ur.helpMat.setFrom(e.transform.world),Ur.helpMat.multmat(n.V),Ur.helpMat.set__00(1),Ur.helpMat.set__20(0),Ur.helpMat.set__01(0),Ur.helpMat.set__21(0),Ur.helpMat.set__02(0),Ur.helpMat.set__22(1),Ur.helpMat2.getInverse(n.V),Ur.helpMat.multmat(Ur.helpMat2),Ur.helpMat.multmat(i.VP),a=Ur.helpMat);else if("_biasLightWorldViewProjectionMatrix"==s.link)null!=i&&(null==e?Ur.helpMat.setIdentity():Ur.helpMat.setFrom(e.transform.world),Ur.helpMat.multmat(i.VP),Ur.helpMat.multmat(Ur.biasMat),a=Ur.helpMat);else if(null!=Ur.externalMat4Links)for(var o=0,l=Ur.externalMat4Links;o<l.length;){var u=l[o];if(++o,null!=(a=u(e,Ur.currentMat(e),s.link)))break}if(null==a)return;t.setMatrix(r,a.self)}else if("mat3"==s.type){var h=null;if("_normalMatrix"==s.link&&(Ur.helpMat.setFrom(e.transform.world),Ur.helpMat.getInverse(Ur.helpMat),Ur.helpMat.transpose3x3(),Ur.helpMat3.setFrom4(Ur.helpMat),h=Ur.helpMat3),null==h)return;t.setMatrix3(r,h.self)}else if("vec4"==s.type){var _=null;if(Ur.helpVec.set(0,0,0),null!=Ur.externalVec4Links)for(var c=0,d=Ur.externalVec4Links;c<d.length;){var p=d[c];if(++c,null!=(_=p(e,Ur.currentMat(e),s.link)))break}if(null==_)return;t.setFloat4(r,_.x,_.y,_.z,_.w)}else if("vec3"==s.type){var g=null;if(Ur.helpVec.set(0,0,0),"_dim"==s.link){var f=e.transform.dim,m=e.transform.scale;Ur.helpVec.set(f.x/m.x,f.y/m.y,f.z/m.z),g=Ur.helpVec}else if("_halfDim"==s.link){var v=e.transform.dim,y=e.transform.scale;Ur.helpVec.set(v.x/y.x/2,v.y/y.y/2,v.z/y.z/2),g=Ur.helpVec}else if(null!=Ur.externalVec3Links)for(var w=0,b=Ur.externalVec3Links;w<b.length;){var x=b[w];if(++w,null!=(g=x(e,Ur.currentMat(e),s.link)))break}if(null==g)return;t.setFloat3(r,g.x,g.y,g.z)}else if("vec2"==s.type){var S=null,C=0;if("_tilesheetOffset"==s.link){var k=hs.__cast(e,Pr).tilesheet;S=k.tileX,C=k.tileY}else if(null!=Ur.externalVec2Links)for(var I=0,T=Ur.externalVec2Links;I<T.length;){var N=T[I];++I;var M=N(e,Ur.currentMat(e),s.link);if(null!=M){S=M.x,C=M.y;break}}if(null==S)return;t.setFloat2(r,S,C)}else if("float"==s.type){var O=null;if("_objectInfoIndex"==s.link)O=e.uid;else if("_objectInfoMaterialIndex"==s.link)O=Ur.currentMat(e).uid;else if("_objectInfoRandom"==s.link)O=e.urandom;else if(null!=Ur.externalFloatLinks)for(var E=0,A=Ur.externalFloatLinks;E<A.length;){var B=A[E];++E;var L=B(e,Ur.currentMat(e),s.link);if(null!=L){O=L;break}}if(null==O)return;t.setFloat(r,O)}else if("floats"==s.type){var F=null;if(null==F&&null!=Ur.externalFloatsLinks)for(var W=0,R=Ur.externalFloatsLinks;W<R.length;){var D=R[W];if(++W,null!=(F=D(e,Ur.currentMat(e),s.link)))break}if(null==F)return;t.setFloats(r,F)}else if("int"==s.type){var G=null;if("_uid"==s.link)G=e.uid;else if(null!=Ur.externalIntLinks)for(var V=0,H=Ur.externalIntLinks;V<H.length;){var P=H[V];++V;var z=P(e,Ur.currentMat(e),s.link);if(null!=z){G=z;break}}if(null==G)return;t.setInt(r,G)}},Ur.setMaterialConstants=function(t,e,n){if(null!=n.raw.bind_constants)for(var i=0,r=n.raw.bind_constants.length;i<r;){for(var s=i++,a=n.raw.bind_constants[s],o=-1,l=0,u=e.raw.constants.length;l<u;){var h=l++;if(e.raw.constants[h].name==a.name){o=h;break}}if(-1!=o){var _=e.raw.constants[o];Ur.setMaterialConstant(t,e.constants[o],_,a)}}if(null!=n.textures)for(var c=0,d=n.textures.length;c<d;)for(var p=c++,g=n.raw.bind_textures[p].name,f=0,m=e.textureUnits.length;f<m;){var v=f++;if(g==e.raw.texture_units[v].name){t.setTexture(e.textureUnits[v],n.textures[p]),n.setTextureParameters(t,p,e,v);break}}},Ur.currentMat=function(t){return null!=t&&t instanceof Pr?hs.__cast(t,Pr).materials[0]:null},Ur.setMaterialConstant=function(t,e,n,i){switch(n.type){case"bool":t.setBool(e,i.bool);break;case"float":t.setFloat(e,i.float);break;case"int":t.setInt(e,i.int);break;case"vec2":t.setFloat2(e,i.vec2[0],i.vec2[1]);break;case"vec3":t.setFloat3(e,i.vec3[0],i.vec3[1],i.vec3[2]);break;case"vec4":t.setFloat4(e,i.vec4[0],i.vec4[1],i.vec4[2],i.vec4[3])}};var Kr=function(){};(n["iron.system.ArmPack"]=Kr).__name__="iron.system.ArmPack",Kr.decode=function(t){var e=new cr(t);return e.set_bigEndian(!0),Kr.read(e)},Kr.read=function(t,e,n){null==n&&(n=""),null==e&&(e="");try{var i=t.readByte();switch(i){case 192:return null;case 194:return!1;case 195:return!0;case 196:return t.read(t.readByte());case 197:return t.read(t.readUInt16());case 198:return t.read(t.readInt32());case 202:return t.readFloat();case 204:return t.readByte();case 205:return t.readUInt16();case 206:return t.readInt32();case 208:return t.readInt8();case 209:return t.readInt16();case 210:return t.readInt32();case 217:return t.readString(t.readByte());case 218:return t.readString(t.readUInt16());case 219:return t.readString(t.readInt32());case 220:return Kr.readArray(t,t.readUInt16(),e,n);case 221:return Kr.readArray(t,t.readInt32(),e,n);case 222:return Kr.readMap(t,t.readUInt16(),e,n);case 223:return Kr.readMap(t,t.readInt32(),e,n);default:if(i<128)return i;if(i<144)return Kr.readMap(t,15&i,e,n);if(i<160)return Kr.readArray(t,15&i,e,n);if(i<192)return t.readString(31&i);if(223<i)return-256|i}}catch(t){var r=t instanceof us?t.val:t;if(!(r instanceof dr))throw t}return null},Kr.readArray=function(t,e,n,i){null==i&&(i=""),null==n&&(n="");var r=t.readByte(),s=t;if(s.set_position(s.get_position()-1),202==r){var a=t;a.set_position(a.get_position()+1);for(var o=new Float32Array(e),l=0,u=e;l<u;){o[l++]=t.readFloat()}return o}if(210==r){var h=t;h.set_position(h.get_position()+1);for(var _=new Uint32Array(e),c=0,d=e;c<d;){_[c++]=t.readInt32()}return _}for(var p=[],g=0,f=e;g<f;){g++;p.push(Kr.read(t,n,i))}return p},Kr.readMap=function(t,e,n,i){null==i&&(i=""),null==n&&(n="");for(var r={},s=0,a=e;s<a;){s++;var o=pt.string(Kr.read(t)),l=Kr.read(t,o,n);ft.setField(r,o,l)}return r};var Qr=function(){};(n["iron.system.Audio"]=Qr).__name__="iron.system.Audio",Qr.play=function(t,e,n){return null==n&&(n=!1),null==e&&(e=!1),null};var Jr=function(){};(n["iron.system.Input"]=Jr).__name__="iron.system.Input",Jr.reset=function(){Jr.occupied=!1,null!=Jr.mouse&&Jr.mouse.reset(),null!=Jr.pen&&Jr.pen.reset(),null!=Jr.keyboard&&Jr.keyboard.reset();for(var t=0,e=Jr.gamepads;t<e.length;){var n=e[t];++t,n.reset()}},Jr.endFrame=function(){null!=Jr.mouse&&Jr.mouse.endFrame(),null!=Jr.pen&&Jr.pen.endFrame(),null!=Jr.keyboard&&Jr.keyboard.endFrame();for(var t=0,e=Jr.gamepads;t<e.length;){var n=e[t];++t,n.endFrame()}if(null!=Jr.virtualButtons)for(var i=Jr.virtualButtons.iterator();i.hasNext();){var r=i.next();r.started=r.released=!1}},Jr.getMouse=function(){return Jr.registered||Jr.register(),null==Jr.mouse&&(Jr.mouse=new ts),Jr.mouse},Jr.getSurface=function(){return Jr.registered||Jr.register(),Jr.getMouse()},Jr.getKeyboard=function(){return Jr.registered||Jr.register(),null==Jr.keyboard&&(Jr.keyboard=new ns),Jr.keyboard},Jr.getGamepad=function(t){if(null==t&&(t=0),4<=t)return null;for(Jr.registered||Jr.register();Jr.gamepads.length<=t;)Jr.gamepads.push(new rs(Jr.gamepads.length));return Jr.gamepads[t].connected?Jr.gamepads[t]:null},Jr.getSensor=function(){return Jr.registered||Jr.register(),null==Jr.sensor&&(Jr.sensor=new ss),Jr.sensor},Jr.getVirtualButton=function(t){return Jr.registered||Jr.register(),null==Jr.virtualButtons?null:Jr.virtualButtons.get(t)},Jr.register=function(){Jr.registered=!0,mr.notifyOnEndFrame(Jr.endFrame),mr.notifyOnReset(Jr.reset)};var qr=function(){this.down=!1,this.released=!1,this.started=!1};(n["iron.system.VirtualButton"]=qr).__name__="iron.system.VirtualButton",qr.prototype={started:null,released:null,down:null,__class__:qr};var $r=function(){this.virtualButtons=null};(n["iron.system.VirtualInput"]=$r).__name__="iron.system.VirtualInput",$r.prototype={virtualButtons:null,downVirtual:function(t){if(null!=this.virtualButtons){var e=this.virtualButtons.get(t);null!=e&&(e.down=!0,e.started=!0)}},upVirtual:function(t){if(null!=this.virtualButtons){var e=this.virtualButtons.get(t);null!=e&&(e.down=!1,e.released=!0)}},__class__:$r};var ts=function(){this.lastY=-1,this.lastX=-1,this.hidden=!1,this.locked=!1,this.wheelDelta=0,this.movementY=0,this.movementX=0,this.moved=!1,this.y=0,this.x=0,this.buttonsReleased=[!1,!1,!1],this.buttonsStarted=[!1,!1,!1],this.buttonsDown=[!1,!1,!1],$r.call(this),to.get().notify(Fo(this,this.downListener),Fo(this,this.upListener),Fo(this,this.moveListener),Fo(this,this.wheelListener))};(n["iron.system.Mouse"]=ts).__name__="iron.system.Mouse",ts.__super__=$r,ts.prototype=r($r.prototype,{buttonsDown:null,buttonsStarted:null,buttonsReleased:null,x:null,y:null,moved:null,movementX:null,movementY:null,wheelDelta:null,locked:null,hidden:null,lastX:null,lastY:null,endFrame:function(){var t=this.buttonsStarted[1]=this.buttonsStarted[2]=!1;this.buttonsStarted[0]=t;var e=this.buttonsReleased[1]=this.buttonsReleased[2]=!1;this.buttonsReleased[0]=e,this.moved=!1,this.movementX=0,this.movementY=0,this.wheelDelta=0},reset:function(){var t=this.buttonsDown[1]=this.buttonsDown[2]=!1;this.buttonsDown[0]=t,this.endFrame()},buttonIndex:function(t){return"left"==t?0:"right"==t?1:2},down:function(t){return null==t&&(t="left"),this.buttonsDown[this.buttonIndex(t)]},started:function(t){return null==t&&(t="left"),this.buttonsStarted[this.buttonIndex(t)]},released:function(t){return null==t&&(t="left"),this.buttonsReleased[this.buttonIndex(t)]},lock:function(){to.get().canLock()&&(to.get().lock(),this.locked=!0,this.hidden=!0)},unlock:function(){to.get().canLock()&&(to.get().unlock(),this.locked=!1,this.hidden=!1)},hide:function(){to.get().hideSystemCursor(),this.hidden=!0},show:function(){to.get().showSystemCursor(),this.hidden=!1},downListener:function(t,e,n){this.buttonsDown[t]=!0,this.buttonsStarted[t]=!0,this.x=e-mr.x(),this.y=n-mr.y(),0==t&&(this.lastX=e,this.lastY=n),this.downVirtual(ts.buttons[t])},upListener:function(t,e,n){this.buttonsDown[t]=!1,this.buttonsReleased[t]=!0,this.x=e-mr.x(),this.y=n-mr.y(),this.upVirtual(ts.buttons[t])},moveListener:function(t,e,n,i){-1==this.lastX&&-1==this.lastY&&(this.lastX=t,this.lastY=e),this.locked?(this.movementX=n,this.movementY=i):(this.movementX=t-this.lastX,this.movementY=e-this.lastY),this.lastX=t,this.lastY=e,this.x=t-mr.x(),this.y=e-mr.y(),this.moved=!0},wheelListener:function(t){this.wheelDelta=t},__class__:ts});var es=function(){this.lastY=-1,this.lastX=-1,this.pressure=0,this.movementY=0,this.movementX=0,this.moved=!1,this.y=0,this.x=0,this.buttonsReleased=[!1],this.buttonsStarted=[!1],this.buttonsDown=[!1],$r.call(this),no.get().notify(Fo(this,this.downListener),Fo(this,this.upListener),Fo(this,this.moveListener))};(n["iron.system.Pen"]=es).__name__="iron.system.Pen",es.__super__=$r,es.prototype=r($r.prototype,{buttonsDown:null,buttonsStarted:null,buttonsReleased:null,x:null,y:null,moved:null,movementX:null,movementY:null,pressure:null,lastX:null,lastY:null,endFrame:function(){this.buttonsStarted[0]=!1,this.buttonsReleased[0]=!1,this.moved=!1,this.movementX=0,this.movementY=0},reset:function(){this.buttonsDown[0]=!1,this.endFrame()},downListener:function(t,e,n){this.buttonsDown[0]=!0,this.buttonsStarted[0]=!0,this.x=t-mr.x(),this.y=e-mr.y(),this.pressure=n},upListener:function(t,e,n){this.buttonsDown[0]=!1,this.buttonsReleased[0]=!0,this.x=t-mr.x(),this.y=e-mr.y(),this.pressure=n},moveListener:function(t,e,n){-1==this.lastX&&-1==this.lastY&&(this.lastX=t,this.lastY=e),this.movementX=t-this.lastX,this.movementY=e-this.lastY,this.lastX=t,this.lastY=e,this.x=t-mr.x(),this.y=e-mr.y(),this.moved=!0,this.pressure=n},__class__:es});var ns=function(){this.keysFrame=[],this.keysReleased=new ur,this.keysStarted=new ur,this.keysDown=new ur,$r.call(this),this.reset(),$a.get().notify(Fo(this,this.downListener),Fo(this,this.upListener),Fo(this,this.pressListener))};(n["iron.system.Keyboard"]=ns).__name__="iron.system.Keyboard",ns.keyCode=function(t){return 32==t?"space":8==t?"backspace":9==t?"tab":13==t?"enter":16==t?"shift":17==t?"control":18==t?"alt":27==t?"escape":46==t?"delete":38==t?"up":40==t?"down":37==t?"left":39==t?"right":1==t?"back":48==t?"0":49==t?"1":50==t?"2":51==t?"3":52==t?"4":53==t?"5":54==t?"6":55==t?"7":56==t?"8":57==t?"9":112==t?"f1":113==t?"f2":114==t?"f3":115==t?"f4":116==t?"f5":117==t?"f6":118==t?"f7":119==t?"f8":120==t?"f9":121==t?"f10":122==t?"f11":123==t?"f12":String.fromCodePoint(t).toLowerCase()},ns.__super__=$r,ns.prototype=r($r.prototype,{keysDown:null,keysStarted:null,keysReleased:null,keysFrame:null,endFrame:function(){if(0<this.keysFrame.length){for(var t=0,e=this.keysFrame;t<e.length;){var n=e[t];++t,this.keysStarted.set(n,!1),this.keysReleased.set(n,!1)}this.keysFrame.splice(0,this.keysFrame.length)}},reset:function(){for(var t=0,e=ns.keys;t<e.length;){var n=e[t];++t,this.keysDown.set(n,!1),this.keysStarted.set(n,!1),this.keysReleased.set(n,!1)}this.endFrame()},down:function(t){return this.keysDown.get(t)},started:function(t){return this.keysStarted.get(t)},released:function(t){return this.keysReleased.get(t)},downListener:function(t){var e=ns.keyCode(t);this.keysFrame.push(e),this.keysStarted.set(e,!0),this.keysDown.set(e,!0),this.downVirtual(e)},upListener:function(t){var e=ns.keyCode(t);this.keysFrame.push(e),this.keysReleased.set(e,!0),this.keysDown.set(e,!1),this.upVirtual(e)},pressListener:function(t){},__class__:ns});var is=function(){this.movementY=0,this.movementX=0,this.moved=!1,this.lastY=0,this.lastX=0,this.y=0,this.x=0};(n["iron.system.GamepadStick"]=is).__name__="iron.system.GamepadStick",is.prototype={x:null,y:null,lastX:null,lastY:null,moved:null,movementX:null,movementY:null,__class__:is};var rs=function(t,e){null==e&&(e=!1),this.num=0,this.connected=!1,this.rightStick=new is,this.leftStick=new is,this.buttonsFrame=[],this.buttonsReleased=[],this.buttonsStarted=[],this.buttonsDown=[],$r.call(this);for(var n=0,i=rs.buttons;n<i.length;){i[n];++n,this.buttonsDown.push(0),this.buttonsStarted.push(!1),this.buttonsReleased.push(!1)}this.num=t,this.reset(),e?this.connected=!0:this.connect()};(n["iron.system.Gamepad"]=rs).__name__="iron.system.Gamepad",rs.__super__=$r,rs.prototype=r($r.prototype,{buttonsDown:null,buttonsStarted:null,buttonsReleased:null,buttonsFrame:null,leftStick:null,rightStick:null,connected:null,num:null,connect:function(){var t=Ja.get(this.num);null!=t&&(this.connected=!0,t.notify(Fo(this,this.axisListener),Fo(this,this.buttonListener)))},endFrame:function(){if(0<this.buttonsFrame.length){for(var t=0,e=this.buttonsFrame;t<e.length;){var n=e[t];++t,this.buttonsStarted[n]=!1,this.buttonsReleased[n]=!1}this.buttonsFrame.splice(0,this.buttonsFrame.length)}this.leftStick.moved=!1,this.leftStick.movementX=0,this.leftStick.movementY=0,this.rightStick.moved=!1,this.rightStick.movementX=0,this.rightStick.movementY=0},reset:function(){for(var t=0,e=this.buttonsDown.length;t<e;){var n=t++;this.buttonsDown[n]=0,this.buttonsStarted[n]=!1,this.buttonsReleased[n]=!1}this.endFrame()},buttonIndex:function(t){for(var e=0,n=rs.buttons.length;e<n;){var i=e++;if(rs.buttons[i]==t)return i}return 0},down:function(t){return this.buttonsDown[this.buttonIndex(t)]},started:function(t){return this.buttonsStarted[this.buttonIndex(t)]},released:function(t){return this.buttonsReleased[this.buttonIndex(t)]},axisListener:function(t,e){var n=t<=1?this.leftStick:this.rightStick;0==t||2==t?(n.lastX=n.x,n.x=e,n.movementX=n.x-n.lastX):1!=t&&3!=t||(n.lastY=n.y,n.y=e,n.movementY=n.y-n.lastY),n.moved=!0},buttonListener:function(t,e){this.buttonsFrame.push(t),0<(this.buttonsDown[t]=e)?this.buttonsStarted[t]=!0:this.buttonsReleased[t]=!0,0==e?this.upVirtual(rs.buttons[t]):1==e&&this.downVirtual(rs.buttons[t])},__class__:rs});var ss=function(){this.z=0,this.y=0,this.x=0,io.get(ro.Accelerometer).notify(Fo(this,this.listener))};(n["iron.system.Sensor"]=ss).__name__="iron.system.Sensor",ss.prototype={x:null,y:null,z:null,listener:function(t,e,n){this.x=t,this.y=e,this.z=n},__class__:ss};var as=function(){};(n["iron.system.Storage"]=as).__name__="iron.system.Storage",as.__properties__={get_data:"get_data"},as.init=function(){as.file=Hs.defaultFile(),null!=as.file&&(as._data=as.file.readObject(),null==as._data&&(as._data={}),as.save())},as.save=function(){null!=as.file&&as.file.writeObject(as._data)},as.get_data=function(){return null==as.file&&as.init(),as._data};var os=function(){};(n["iron.system.Time"]=os).__name__="iron.system.Time",os.__properties__={get_delta:"get_delta"},os.get_delta=function(){return.016666666666666666*os.scale},os.time=function(){return Ws.time()},os.realTime=function(){return Ws.realTime()},os.update=function(){os.realDelta=os.realTime()-os.last,os.last=os.realTime()};var ls=function(){};(n["iron.system.Tween"]=ls).__name__="iron.system.Tween",ls.register=function(){ls.registered=!0,mr.notifyOnUpdate(ls.update),mr.notifyOnReset(function(){mr.notifyOnUpdate(ls.update),ls.reset()})},ls.to=function(t){if(ls.registered||ls.register(),t._time=0,t.isPlaying=!(null!=t.delay&&0<t.delay),null==t.ease&&(t.ease=0),null!=t.target&&null!=t.props){t._comps=[],t._x=[],t._y=[],t._z=[],t._w=[],t._normalize=[];for(var e=0,n=ft.fields(t.props);e<n.length;){var i=n[e];++e;var r=ft.getProperty(t.target,i);r instanceof wi||r instanceof xi?(t._comps.push(4),t._x.push(r.x),t._y.push(r.y),t._z.push(r.z),t._w.push(r.w),t._normalize.push(r instanceof xi)):(t._comps.push(1),t._x.push(r),t._y.push(0),t._z.push(0),t._w.push(0))}}return ls.anims.push(t),t},ls.timer=function(t,e){return ls.to({target:null,props:null,duration:0,delay:t,done:e})},ls.reset=function(){ls.anims=[]},ls.update=function(){for(var t=os.get_delta(),e=ls.anims.length;0<e--&&0<ls.anims.length;){var n=ls.anims[e];if(!(0<n.delay&&(n.delay-=t,0<n.delay))){if(n._time+=t,n.isPlaying=n._time<n.duration,null!=n.target){n.target instanceof jr&&(n.target.dirty=!0);for(var i=ft.fields(n.props),r=0,s=i.length;r<s;){var a=r++,o=i[a],l=n._time/n.duration;if(1<l&&(l=1),1==n._comps[a]){var u=n._x[a],h=u+(ft.getProperty(n.props,o)-u)*ls.eases[n.ease](l);ft.setProperty(n.target,o,h)}else{var _=ft.getProperty(n.props,o),c=ft.getProperty(_,"x"),d=ft.getProperty(_,"y"),p=ft.getProperty(_,"z"),g=ft.getProperty(_,"w");if(n._normalize[a])n._x[a]*c+n._y[a]*d+n._z[a]*p+n._w[a]*g<0&&(c=-c,d=-d,p=-p,g=-g);var f=n._x[a]+(c-n._x[a])*ls.eases[n.ease](l),m=n._y[a]+(d-n._y[a])*ls.eases[n.ease](l),v=n._z[a]+(p-n._z[a])*ls.eases[n.ease](l),y=n._w[a]+(g-n._w[a])*ls.eases[n.ease](l);if(n._normalize[a]){var w=Math.sqrt(f*f+m*m+v*v+y*y);0<w&&(f*=w=1/w,m*=w,v*=w,y*=w)}var b=ft.getProperty(n.target,o);ft.setProperty(b,"x",f),ft.setProperty(b,"y",m),ft.setProperty(b,"z",v),ft.setProperty(b,"w",y)}}}n.isPlaying?null!=n.tick&&n.tick():(ls.anims.splice(e,1),--e,n.isPlaying=!1,null!=n.done&&n.done())}}},ls.easeLinear=function(t){return t},ls.easeSineIn=function(t){return 0==t?0:1==t?1:1-Math.cos(t*Math.PI/2)},ls.easeSineOut=function(t){return 0==t?0:1==t?1:Math.sin(t*(.5*Math.PI))},ls.easeSineInOut=function(t){return 0==t?0:1==t?1:-.5*(Math.cos(Math.PI*t)-1)},ls.easeQuadIn=function(t){return t*t},ls.easeQuadOut=function(t){return-t*(t-2)},ls.easeQuadInOut=function(t){return t<.5?2*t*t:--t*t*-2+1},ls.easeCubicIn=function(t){return t*t*t},ls.easeCubicOut=function(t){return--t*t*t+1},ls.easeCubicInOut=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},ls.easeQuartIn=function(t){return(t*=t)*t},ls.easeQuartOut=function(t){return 1-(t=--t*t)*t},ls.easeQuartInOut=function(t){return(t*=2)<1?.5*(t*=t)*t:-.5*((t=(t-=2)*t)*t-2)},ls.easeQuintIn=function(t){return t*(t*=t)*t},ls.easeQuintOut=function(t){return--t*(t*=t)*t+1},ls.easeQuintInOut=function(t){return(t*=2)<1?.5*t*(t*=t)*t:.5*(t-=2)*(t*=t)*t+1},ls.easeExpoIn=function(t){return 0==t?0:Math.pow(2,10*(t-1))},ls.easeExpoOut=function(t){return 1==t?1:1-Math.pow(2,-10*t)},ls.easeExpoInOut=function(t){return 0==t?0:1==t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},ls.easeCircIn=function(t){return-(Math.sqrt(1-t*t)-1)},ls.easeCircOut=function(t){return Math.sqrt(1-(t-1)*(t-1))},ls.easeCircInOut=function(t){return t<=.5?(Math.sqrt(1-t*t*4)-1)/-2:(Math.sqrt(1-(2*t-2)*(2*t-2))+1)/2},ls.easeBackIn=function(t){return 0==t?0:1==t?1:t*t*(2.70158*t-1.70158)},ls.easeBackOut=function(t){return 0==t?0:1==t?1:--t*t*(2.70158*t+1.70158)+1},ls.easeBackInOut=function(t){return 0==t?0:1==t?1:(t*=2)<1?t*t*(3.5949095*t-2.5949095)*.5:.5*((t-=2)*t*(3.5949095*t+2.5949095)+2)};var us=function(t){Error.call(this),this.val=t,Error.captureStackTrace&&Error.captureStackTrace(this,us)};(n["js._Boot.HaxeError"]=us).__name__="js._Boot.HaxeError",us.wrap=function(t){return t instanceof Error?t:new us(t)},us.__super__=Error,us.prototype=r(Error.prototype,{val:null,__class__:us});var hs=function(){};(n["js.Boot"]=hs).__name__="js.Boot",hs.isClass=function(t){return t.__name__},hs.isEnum=function(t){return t.__ename__},hs.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var n=hs.__nativeClassName(t);return null!=n?hs.__resolveNativeClass(n):null},hs.__string_rec=function(t,e){if(null==t)return"null";if(5<=e.length)return"<...>";var n=typeof t;switch("function"==n&&(hs.isClass(t)||hs.isEnum(t))&&(n="object"),n){case"function":return"<function>";case"object":if(t.__enum__){var i=w[t.__enum__],r=i.__constructs__[t._hx_index],s=i[r];if(s.__params__){e+="\t";for(var a=r+"(",o=[],l=0,u=s.__params__;l<u.length;){var h=u[l];++l,o.push(hs.__string_rec(t[h],e))}return a+o.join(",")+")"}return r}if(t instanceof Array){var _="[";e+="\t";for(var c=0,d=t.length;c<d;){var p=c++;_+=(0<p?",":"")+hs.__string_rec(t[p],e)}return _+="]"}var g;try{g=t.toString}catch(t){t instanceof us&&t.val;return"???"}if(null!=g&&g!=Object.toString&&"function"==typeof g){var f=t.toString();if("[object Object]"!=f)return f}var m=null,v="{\n";e+="\t";var y=null!=t.hasOwnProperty;for(var m in t)y&&!t.hasOwnProperty(m)||"prototype"!=m&&"__class__"!=m&&"__super__"!=m&&"__interfaces__"!=m&&"__properties__"!=m&&(2!=v.length&&(v+=", \n"),v+=e+m+" : "+hs.__string_rec(t[m],e));return v+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},hs.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var n=t.__interfaces__;if(null!=n)for(var i=0,r=n.length;i<r;){var s=n[i++];if(s==e||hs.__interfLoop(s,e))return!0}return hs.__interfLoop(t.__super__,e)},hs.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case Go:return"boolean"==typeof t;case Ro:return!0;case Do:return"number"==typeof t;case Wo:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(hs.__interfLoop(hs.getClass(t),e))return!0}else if("object"==typeof e&&hs.__isNativeObj(e)&&t instanceof e)return!0;return e==Vo&&null!=t.__name__||(e==Ho&&null!=t.__ename__||w[t.__enum__]==e)}},hs.__cast=function(t,e){if(hs.__instanceof(t,e))return t;throw new us("Cannot cast "+pt.string(t)+" to "+pt.string(e))},hs.__nativeClassName=function(t){var e=hs.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},hs.__isNativeObj=function(t){return null!=hs.__nativeClassName(t)},hs.__resolveNativeClass=function(t){return e[t]};var _s=function(){};(n["js.Browser"]=_s).__name__="js.Browser",_s.getLocalStorage=function(){try{var t=window.localStorage;if(t.getItem(""),0==t.length){var e="_hx_"+Math.random();t.setItem(e,e),t.removeItem(e)}return t}catch(t){t instanceof us&&t.val;return null}};var cs=function(){};(n["js.Lib"]=cs).__name__="js.Lib",cs.__properties__={get_undefined:"get_undefined"},cs.get_undefined=function(){};var ds=function(){};(n["js.html._ArrayBuffer.ArrayBufferCompat"]=ds).__name__="js.html._ArrayBuffer.ArrayBufferCompat",ds.sliceImpl=function(t,e){var n=new Uint8Array(this,t,null==e?null:e-t),i=new Uint8Array(n.byteLength);return i.set(n),i.buffer};var ps=function(){this.names=[]};(n["kha._Assets.ImageList"]=ps).__name__="kha._Assets.ImageList",ps.prototype={get:function(t){return ft.field(this,t)},names:null,__class__:ps};var gs=function(){this.names=[]};(n["kha._Assets.SoundList"]=gs).__name__="kha._Assets.SoundList",gs.prototype={get:function(t){return ft.field(this,t)},names:null,__class__:gs};var fs=function(){this.names=[]};(n["kha._Assets.BlobList"]=fs).__name__="kha._Assets.BlobList",fs.prototype={get:function(t){return ft.field(this,t)},names:null,__class__:fs};var ms=function(){this.names=["font_default"],this.font_defaultDescription={name:"font_default",files:["font_default.ttf"],type:"font"},this.font_defaultName="font_default",this.font_default=null};(n["kha._Assets.FontList"]=ms).__name__="kha._Assets.FontList",ms.prototype={get:function(t){return ft.field(this,t)},font_default:null,font_defaultName:null,font_defaultDescription:null,font_defaultLoad:function(e,t){ys.loadFont("font_default",function(t){e()},ys.reporter(t,{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:142,className:"kha._Assets.FontList",methodName:"font_defaultLoad"}),{fileName:"kha/internal/AssetsBuilder.hx",lineNumber:142,className:"kha._Assets.FontList",methodName:"font_defaultLoad"})},font_defaultUnload:function(){this.font_default.unload(),this.font_default=null},names:null,__class__:ms};var vs=function(){this.names=[]};(n["kha._Assets.VideoList"]=vs).__name__="kha._Assets.VideoList",vs.prototype={get:function(t){return ft.field(this,t)},names:null,__class__:vs};var ys=function(){};(n["kha.Assets"]=ys).__name__="kha.Assets",ys.__properties__={get_videoFormats:"get_videoFormats",get_fontFormats:"get_fontFormats",get_soundFormats:"get_soundFormats",get_imageFormats:"get_imageFormats"},ys.loadEverything=function(t,e,n,i){for(var r=0,s=0,a=q.getInstanceFields(fs);s<a.length;){var o=a[s];++s,J.endsWith(o,"Load")&&(r+=1)}for(var l=0,u=q.getInstanceFields(ps);l<u.length;){var h=u[l];++l,J.endsWith(h,"Load")&&(r+=1)}for(var _=0,c=q.getInstanceFields(gs);_<c.length;){var d=c[_];++_,J.endsWith(d,"Load")&&(r+=1)}for(var p=0,g=q.getInstanceFields(ms);p<g.length;){var f=g[p];++p,J.endsWith(f,"Load")&&(r+=1)}for(var m=0,v=q.getInstanceFields(vs);m<v.length;){var y=v[m];++m,J.endsWith(y,"Load")&&(r+=1)}if(0!=r){for(var w=r,b=function(){w-=1,ys.progress=1-w/r,0==w&&t()},x=0,S=q.getInstanceFields(fs);x<S.length;){var C=S[x];if(++x,J.endsWith(C,"Load")){var k=ut.substr(C,0,C.length-4),I=ft.field(ys.blobs,k+"Description");null==e||e(I)?ft.field(ys.blobs,C)(b,function(t){ys.reporter(i,{fileName:"kha/Assets.hx",lineNumber:134,className:"kha.Assets",methodName:"loadEverything"}),b()}):b()}}for(var T=0,N=q.getInstanceFields(ps);T<N.length;){var M=N[T];if(++T,J.endsWith(M,"Load")){var O=ut.substr(M,0,M.length-4),E=ft.field(ys.images,O+"Description");null==e||e(E)?ft.field(ys.images,M)(b,function(t){ys.reporter(i,{fileName:"kha/Assets.hx",lineNumber:150,className:"kha.Assets",methodName:"loadEverything"}),b()}):b()}}for(var A=0,B=q.getInstanceFields(gs);A<B.length;){var L=[B[A]];if(++A,J.endsWith(L[0],"Load")){var F=ut.substr(L[0],0,L[0].length-4),W=[ft.field(ys.sounds,F+"Description")];null==e||e(W[0])?ft.field(ys.sounds,L[0])(function(t,e){return function(){null==n||n(t[0])?ft.field(ys.sounds,e[0].substring(0,e[0].length-4)).uncompress(b):b()}}(W,L),ys.reporter(i,{fileName:"kha/Assets.hx",lineNumber:172,className:"kha.Assets",methodName:"loadEverything"})):b()}}for(var R=0,D=q.getInstanceFields(ms);R<D.length;){var G=D[R];if(++R,J.endsWith(G,"Load")){var V=ut.substr(G,0,G.length-4),H=ft.field(ys.fonts,V+"Description");null==e||e(H)?ft.field(ys.fonts,G)(b,function(t){ys.reporter(i,{fileName:"kha/Assets.hx",lineNumber:185,className:"kha.Assets",methodName:"loadEverything"}),b()}):b()}}for(var P=0,z=q.getInstanceFields(vs);P<z.length;){var Z=z[P];if(++P,J.endsWith(Z,"Load")){var X=ut.substr(Z,0,Z.length-4),j=ft.field(ys.videos,X+"Description");null==e||e(j)?ft.field(ys.videos,Z)(b,function(t){ys.reporter(i,{fileName:"kha/Assets.hx",lineNumber:200,className:"kha.Assets",methodName:"loadEverything"}),b()}):b()}}}else t()},ys.loadImage=function(e,n,t,i){var r=ft.field(ys.images,e+"Description");Bs.loadImageFromDescription(r,function(t){ft.setField(ys.images,e,t),n(t)},ys.reporter(t,i))},ys.loadImageFromPath=function(t,e,n,i,r){var s={files:[t],readable:e};Bs.loadImageFromDescription(s,n,ys.reporter(i,r))},ys.get_imageFormats=function(){return Bs.getImageFormats()},ys.loadBlob=function(e,n,t,i){var r=ft.field(ys.blobs,e+"Description");Bs.loadBlobFromDescription(r,function(t){ft.setField(ys.blobs,e,t),n(t)},ys.reporter(t,i))},ys.loadBlobFromPath=function(t,e,n,i){var r={files:[t]};Bs.loadBlobFromDescription(r,e,ys.reporter(n,i))},ys.loadSound=function(e,n,t,i){var r=ft.field(ys.sounds,e+"Description");Bs.loadSoundFromDescription(r,function(t){ft.setField(ys.sounds,e,t),n(t)},ys.reporter(t,i))},ys.loadSoundFromPath=function(t,e,n,i){var r={files:[t]};Bs.loadSoundFromDescription(r,e,ys.reporter(n,i))},ys.get_soundFormats=function(){return Bs.getSoundFormats()},ys.loadFont=function(e,n,t,i){var r=ft.field(ys.fonts,e+"Description");Bs.loadFontFromDescription(r,function(t){ft.setField(ys.fonts,e,t),n(t)},ys.reporter(t,i))},ys.loadFontFromPath=function(t,e,n,i){var r={files:[t]};Bs.loadFontFromDescription(r,e,ys.reporter(n,i))},ys.get_fontFormats=function(){return["ttf"]},ys.loadVideo=function(e,n,t,i){var r=ft.field(ys.videos,e+"Description");Bs.loadVideoFromDescription(r,function(t){ft.setField(ys.videos,e,t),n(t)},ys.reporter(t,i))},ys.loadVideoFromPath=function(t,e,n,i){var r={files:[t]};Bs.loadVideoFromDescription(r,e,ys.reporter(n,i))},ys.get_videoFormats=function(){return Bs.getVideoFormats()},ys.reporter=function(t,e){if(null!=t)return t;var n=Ji.trace,i=e;return function(t){n(t,i)}};var ws=function(){};(n["kha.Canvas"]=ws).__name__="kha.Canvas",ws.prototype={get_g4:null,get_height:null,get_width:null,__class__:ws,__properties__:{get_width:"get_width",get_height:"get_height",get_g4:"get_g4"}};var bs=function(){};(n["kha.Resource"]=bs).__name__="kha.Resource";var xs=function(){};(n["kha.Image"]=xs).__name__="kha.Image",xs.__interfaces__=[bs,ws],xs.__properties__={get_nonPow2Supported:"get_nonPow2Supported"},xs.create=function(t,e,n,i){return null==n&&(n=za.RGBA32),null==i&&(i=Xa.StaticUsage),null==Xs.gl?new Ss(t,e,n,!1):new Ys(t,e,n,!1,0,1)},xs.create3D=function(t,e,n,i,r){return null},xs.createRenderTarget=function(t,e,n,i,r,s){return null==s&&(s=0),null==r&&(r=1),null==i&&(i=0),null==n&&(n=za.RGBA32),null==Xs.gl?new Ss(t,e,n,!0):new Ys(t,e,n,!0,i,r)},xs.fromImage=function(t,e){if(null==Xs.gl){var n=new Ss(t.width,t.height,za.RGBA32,!1);return n.image=t,n.createTexture(),n}var i=new Ys(t.width,t.height,za.RGBA32,!1,0,1);return i.image=t,i.createTexture(),i},xs.fromBytes=function(t,e,n,i,r){if(null==i&&(i=za.RGBA32),null==r&&(r=Xa.StaticUsage),null!=Xs.gl){var s=new Ys(e,n,i,!1,0,1);return s.image=s.bytesToArray(t),s.createTexture(),s}return null},xs.fromVideo=function(t){if(null==Xs.gl){var e=new Ss(t.element.videoWidth,t.element.videoHeight,za.RGBA32,!1);return e.video=t.element,e.createTexture(),e}var n=new Ys(t.element.videoWidth,t.element.videoHeight,za.RGBA32,!1,0,1);return n.video=t.element,n.createTexture(),n},xs.get_nonPow2Supported=function(){return null!=Xs.gl},xs.prototype={unload:function(){},lock:function(t){return null==t&&(t=0),null},unlock:function(){},generateMipmaps:function(t){},setMipmaps:function(t){},setDepthStencilFrom:function(t){},get_width:function(){return 0},get_height:function(){return 0},get_depth:function(){return 1},get_realWidth:function(){return 0},get_realHeight:function(){return 0},get_g2:function(){return null},get_g4:function(){return null},__class__:xs,__properties__:{get_g4:"get_g4",get_g2:"get_g2",get_realHeight:"get_realHeight",get_realWidth:"get_realWidth",get_depth:"get_depth",get_height:"get_height",get_width:"get_width"}};var Ss=function(t,e,n,i){this.g2canvas=null,this.myWidth=t,this.myHeight=e,this.format=n,this.renderTarget=i,this.image=null,this.video=null,i&&this.createTexture()};(n["kha.CanvasImage"]=Ss).__name__="kha.CanvasImage",Ss.init=function(){var t=window.document.createElement("canvas");null!=t&&(Ss.context=t.getContext("2d"),t.width=2048,t.height=2048,Ss.context.globalCompositeOperation="copy")},Ss.__super__=xs,Ss.prototype=r(xs.prototype,{image:null,video:null,data:null,myWidth:null,myHeight:null,format:null,renderTarget:null,frameBuffer:null,g2canvas:null,get_g2:function(){if(null==this.g2canvas){var t=window.document.createElement("canvas"),e=(this.image=t).getContext("2d");t.width=this.get_width(),t.height=this.get_height(),this.g2canvas=new ho(e)}return this.g2canvas},get_g4:function(){return null},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},texture:null,createTexture:function(){null!=Xs.gl&&(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.texture),Xs.gl.texParameteri(3553,10240,9729),Xs.gl.texParameteri(3553,10241,9729),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),this.renderTarget?(this.frameBuffer=Xs.gl.createFramebuffer(),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,3553,this.texture,0),Xs.gl.bindFramebuffer(36160,null)):null!=this.video?Xs.gl.texImage2D(3553,0,6408,6408,5121,this.video):Xs.gl.texImage2D(3553,0,6408,6408,5121,this.image),Xs.gl.bindTexture(3553,null))},bytes:null,lock:function(t){return null==t&&(t=0),this.bytes=er.alloc(this.format==za.RGBA32?4*this.get_width()*this.get_height():this.get_width()*this.get_height()),this.bytes},unlock:function(){if(null!=Xs.gl){if(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.texture),Xs.gl.texParameteri(3553,10240,9729),Xs.gl.texParameteri(3553,10241,9729),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),Xs.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,new Uint8Array(this.bytes.getData())),1282==Xs.gl.getError()){for(var t=er.alloc(this.get_width()*this.get_height()*4),e=0,n=this.get_height();e<n;)for(var i=e++,r=0,s=this.get_width();r<s;){var a=r++,o=this.bytes.get(i*this.get_width()+a);t.set(i*this.get_width()*4+4*a,o),t.set(i*this.get_width()*4+4*a+1,o),t.set(i*this.get_width()*4+4*a+2,o),t.set(i*this.get_width()*4+4*a+3,255)}Xs.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,new Uint8Array(t.getData()))}Xs.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){this.image=null,this.video=null,this.data=null},__class__:Ss});var Cs=t.kha._Color.Color_Impl_={};(n["kha._Color.Color_Impl_"]=Cs).__name__="kha._Color.Color_Impl_",Cs.fromBytes=function(t,e,n,i){return null==i&&(i=255),Cs._new(i<<24|t<<16|e<<8|n)},Cs.fromFloats=function(t,e,n,i){return null==i&&(i=1),Cs._new(pt.int(255*i)<<24|pt.int(255*t)<<16|pt.int(255*e)<<8|pt.int(255*n))},Cs._new=function(t){return t};var ks=function(){};(n["kha.CompilerDefines"]=ks).__name__="kha.CompilerDefines";var Is=function(){};(n["kha.Display"]=Is).__name__="kha.Display",Is.__properties__={get_all:"get_all",get_primary:"get_primary"},Is.get_primary=function(){return Is.instance},Is.get_all=function(){return[Is.get_primary()]},Is.prototype={get_width:function(){return window.screen.width},get_height:function(){return window.screen.height},get_frequency:function(){return 60},__class__:Is,__properties__:{get_frequency:"get_frequency",get_height:"get_height",get_width:"get_width"}};var Ts=function(){};(n["kha.DisplayMode"]=Ts).__name__="kha.DisplayMode";var Ns=function(t,e,n,i,r){this.window=t,this.graphics1=e,this.graphics2=n,this.graphics4=i,this.graphics5=r};(n["kha.Framebuffer"]=Ns).__name__="kha.Framebuffer",Ns.__interfaces__=[ws],Ns.prototype={window:null,graphics1:null,graphics2:null,graphics4:null,graphics5:null,init:function(t,e,n,i){this.graphics1=t,this.graphics2=e,this.graphics4=n,this.graphics5=i},get_g2:function(){return this.graphics2},get_g4:function(){return this.graphics4},get_width:function(){return zs.windowWidth(this.window)},get_height:function(){return zs.windowHeight(this.window)},__class__:Ns,__properties__:{get_height:"get_height",get_width:"get_width",get_g4:"get_g4",get_g2:"get_g2"}};var Ms=function(t,e,n,i,r,s){null==s&&(s=1),null==r&&(r=8),null==i&&(i=16),null==n&&(n=32),null==e&&(e=!0),null==t&&(t=60),this.samplesPerPixel=1,this.stencilBufferBits=8,this.depthBufferBits=16,this.colorBufferBits=32,this.verticalSync=!0,this.frequency=60,this.frequency=t,this.verticalSync=e,this.colorBufferBits=n,this.depthBufferBits=i,this.stencilBufferBits=r,this.samplesPerPixel=s};(n["kha.FramebufferOptions"]=Ms).__name__="kha.FramebufferOptions",Ms.prototype={frequency:null,verticalSync:null,colorBufferBits:null,depthBufferBits:null,stencilBufferBits:null,samplesPerPixel:null,__class__:Ms};var Os=function(){};(n["kha.AlignedQuad"]=Os).__name__="kha.AlignedQuad",Os.prototype={x0:null,y0:null,s0:null,t0:null,x1:null,y1:null,s1:null,t1:null,xadvance:null,__class__:Os};var Es=function(t,e,n,i,r,s,a,o){this.mySize=t,this.width=r,this.height=s,this.chars=a,this.baseline=e;for(var l=0;l<a.length;){var u=a[l];++l,u.yoff+=this.baseline}this.texture=xs.create(r,s,za.L8);for(var h=this.texture.lock(),_=0,c=0,d=s;c<d;){c++;for(var p=0,g=r;p<g;){p++;h.set(_,o.readU8(_)),++_}}this.texture.unlock()};(n["kha.KravurImage"]=Es).__name__="kha.KravurImage",Es.prototype={mySize:null,chars:null,texture:null,width:null,height:null,baseline:null,getTexture:function(){return this.texture},getBakedQuad:function(t,e,n,i){if(e>=this.chars.length)return null;var r=1/this.width,s=1/this.height,a=this.chars[e];if(null==a)return null;var o=Math.round(n+a.xoff),l=Math.round(i+a.yoff);return t.x0=o,t.y0=l,t.x1=o+a.x1-a.x0,t.y1=l+a.y1-a.y0,t.s0=a.x0*r,t.t0=a.y0*s,t.s1=a.x1*r,t.t1=a.y1*s,t.xadvance=a.xadvance,t},getCharWidth:function(t){if(0==this.chars.length)return 0;var e=Es.charBlocks[0];if(t<e)return this.chars[0].xadvance;for(var n=1,i=pt.int(Es.charBlocks.length/2);n<i;){var r=n++,s=Es.charBlocks[2*r-1],a=Es.charBlocks[2*r];a-1<t&&(e+=a-1-s)}return t-e>=this.chars.length?this.chars[0].xadvance:this.chars[t-e].xadvance},getHeight:function(){return this.mySize},stringWidth:function(t){for(var e=0,n=0,i=t.length;n<i;){var r=n++;e+=this.getCharWidth(ut.cca(t,r))}return e},charactersWidth:function(t,e,n){for(var i=0,r=e,s=e+n;r<s;){var a=r++;i+=this.getCharWidth(t[a])}return i},getBaselinePosition:function(){return this.baseline},__class__:Es};var As=function(t){this.images=new ir,this.blob=t};(n["kha.Kravur"]=As).__name__="kha.Kravur",As.__interfaces__=[bs],As.prototype={oldGlyphs:null,blob:null,images:null,_get:function(t){var e=ra.fontGlyphs;if(e!=this.oldGlyphs){this.oldGlyphs=e;for(var n=(Es.charBlocks=[e[0]])[0]+1,i=1,r=e.length;i<r;){var s=i++;e[s]!=n?(Es.charBlocks.push(e[s-1]),Es.charBlocks.push(e[s]),n=e[s]+1):++n}Es.charBlocks.push(e[e.length-1])}var a=1e4*t+e.length;if(!this.images.exists(a)){for(var o=64,l=32,u=new Array(e.length),h=0,_=u.length;h<_;){u[h++]=new ca}for(var c=null,d=-1;d<=0;)l<o?l*=2:o*=2,c=ao.alloc(o*l),d=ya.stbtt_BakeFontBitmap(this.blob,0,t,c,o,l,e,u);var p=new da;ya.stbtt_InitFont(p,this.blob,0);var g=ya.stbtt_GetFontVMetrics(p),f=ya.stbtt_ScaleForPixelHeight(p,t),m=Math.round(g.ascent*f),v=Math.round(g.descent*f),y=Math.round(g.lineGap*f),w=new Es(pt.int(t),m,v,y,o,l,u,c);return this.images.set(a,w),w}return this.images.get(a)},height:function(t){return this._get(t).getHeight()},width:function(t,e){return this._get(t).stringWidth(e)},unload:function(){this.blob=null,this.images=null},__class__:As};var Bs=function(){};(n["kha.LoaderImpl"]=Bs).__name__="kha.LoaderImpl",Bs.getImageFormats=function(){return["png","jpg","hdr"]},Bs.loadImageFromDescription=function(e,i,n){var r=ft.hasField(e,"readable")&&e.readable;if(J.endsWith(e.files[0],".hdr"))Bs.loadBlobFromDescription(e,function(t){var e=oo.parse(t.toBytes()),n=xs.fromBytes(er.ofData(e.data.buffer),e.width,e.height,za.RGBA128,r?Xa.DynamicUsage:Xa.StaticUsage);i(n)},n);else{var s=window.document.createElement("img");s.onerror=function(t){n({url:e.files[0],error:t})},s.onload=function(t){var e=xs.fromImage(s,r);i(e)},s.src=e.files[0],s.crossOrigin=""}},Bs.getSoundFormats=function(){var t=window.document.createElement("audio"),e=[];return""!=t.canPlayType("audio/mp4")&&e.push("mp4"),""!=t.canPlayType("audio/mp3")&&e.push("mp3"),(Xs._hasWebAudio||""!=t.canPlayType("audio/ogg"))&&e.push("ogg"),e},Bs.loadSoundFromDescription=function(t,e,n){if(Xs._hasWebAudio){var i=window.document.createElement("audio");if(""!=i.canPlayType("audio/mp4"))for(var r=0,s=t.files.length;r<s;){var a=r++,o=t.files[a];if(J.endsWith(o,".mp4"))return void new vo(o,e,n)}if(""!=i.canPlayType("audio/mp3"))for(var l=0,u=t.files.length;l<u;){var h=l++,_=t.files[h];if(J.endsWith(_,".mp3"))return void new vo(_,e,n)}for(var c=0,d=t.files.length;c<d;){var p=c++,g=t.files[p];if(J.endsWith(g,".ogg"))return void new vo(g,e,n)}}else if(Xs.mobile){var f=window.document.createElement("audio");if(""!=f.canPlayType("audio/mp4"))for(var m=0,v=t.files.length;m<v;){var y=m++,w=t.files[y];if(J.endsWith(w,".mp4"))return void new go(w,e,n)}if(""!=f.canPlayType("audio/mp3"))for(var b=0,x=t.files.length;b<x;){var S=b++,C=t.files[S];if(J.endsWith(C,".mp3"))return void new go(C,e,n)}for(var k=0,I=t.files.length;k<I;){var T=k++,N=t.files[T];if(J.endsWith(N,".ogg"))return void new go(N,e,n)}}else new fo(t.files,e,n)},Bs.getVideoFormats=function(){return["mp4","webm"]},Bs.loadVideoFromDescription=function(t,e,n){mo.fromFile(t.files,e)},Bs.loadRemote=function(o,l,u){var h=new XMLHttpRequest;h.open("GET",o.files[0],!0),h.responseType="arraybuffer",h.onreadystatechange=function(){if(4==h.readyState)if(200<=h.status&&h.status<400||0==h.status&&""==h.statusText){var t=null,e=h.response;if(null!=e){var n=new Uint8Array(e);t=er.ofData(n)}else{if(null==h.responseBody)return void u({url:o.files[0]});var i=VBArray(h.responseBody).toArray();t=er.alloc(i.length);for(var r=0,s=i.length;r<s;){var a=r++;t.set(a,i[a])}}l(new ao(t))}else u({url:o.files[0]})},h.send(null)},Bs.loadBlobFromDescription=function(t,e,n){Bs.loadRemote(t,e,n)},Bs.loadFontFromDescription=function(t,e,n){Bs.loadBlobFromDescription(t,function(t){e(new As(t))},n)};var Ls=function(){};(n["kha.TimeTask"]=Ls).__name__="kha.TimeTask",Ls.prototype={task:null,start:null,period:null,duration:null,next:null,id:null,groupId:null,active:null,paused:null,__class__:Ls};var Fs=function(t,e,n){this.task=t,this.priority=e,this.id=n,this.active=!0,this.paused=!1};(n["kha.FrameTask"]=Fs).__name__="kha.FrameTask",Fs.prototype={task:null,priority:null,id:null,active:null,paused:null,__class__:Fs};var Ws=function(){};(n["kha.Scheduler"]=Ws).__name__="kha.Scheduler",Ws.init=function(){Ws.deltas=[];for(var t=0,e=Ws.DIF_COUNT;t<e;){var n=t++;Ws.deltas[n]=0}Ws.stopped=!0,Ws.frame_tasks_sorted=!0,Ws.current=Ws.lastTime=Ws.realTime(),Ws.currentFrameTaskId=0,Ws.currentTimeTaskId=0,Ws.currentGroupId=0,Ws.timeTasks=[],Ws.pausedTimeTasks=[],Ws.outdatedTimeTasks=[],Ws.timeTasksScratchpad=[],Ws.frameTasks=[],Ws.toDeleteFrame=[]},Ws.start=function(t){null==t&&(t=!1),Ws.vsync=Us.get(0).get_vSynced();var e=Is.get_primary().get_frequency();57<=e&&e<=63&&(e=60),Ws.onedifhz=1/e,Ws.stopped=!1,Ws.resetTime(),Ws.lastTime=Ws.realTime()-Ws.startTime;for(var n=0,i=Ws.DIF_COUNT;n<i;){var r=n++;Ws.deltas[r]=0}if(t){for(var s=0,a=Ws.timeTasks;s<a.length;){var o=a[s];++s,o.paused=!1}for(var l=0,u=Ws.frameTasks;l<u.length;){var h=u[l];++l,h.paused=!1}}},Ws.executeFrame=function(){var t=Ws.realTime()-Ws.startTime-Ws.lastTime,e=Ws.current;if(0<=t){if(null==To.the())if(t>Ws.maxframetime)Ws.startTime+=t-Ws.maxframetime,e+=t=Ws.maxframetime;else if(Ws.vsync){for(var n=Ws.onedifhz;n<t-Ws.onedifhz;)n+=Ws.onedifhz;t=n;for(var i=0,r=Ws.DIF_COUNT-2;i<r;){var s=i++;t+=Ws.deltas[s],Ws.deltas[s]=Ws.deltas[s+1]}t+=Ws.deltas[Ws.DIF_COUNT-2],t/=Ws.DIF_COUNT,Ws.deltas[Ws.DIF_COUNT-2]=n,e+=t}else{for(var a=0,o=Ws.DIF_COUNT-1;a<o;){var l=a++;Ws.deltas[l]=Ws.deltas[l+1]}Ws.deltas[Ws.DIF_COUNT-1]=t;for(var u=0,h=0,_=Ws.DIF_COUNT;h<_;){var c=h++;u+=Ws.deltas[c]}e+=u/=Ws.DIF_COUNT}else e+=t;Ws.lastTime=e,Ws.stopped||(Ws.current=e);for(var d=0,p=Ws.pausedTimeTasks;d<p.length;){var g=p[d];++d,g.next+=t}if(Ws.stopped)for(var f=0,m=Ws.timeTasks;f<m.length;){var v=m[f];++f,v.next+=t}Ws.executeTimeTasks(e);for(var y=0,w=Ws.outdatedTimeTasks;y<w.length;){var b=w[y];++y,b.next<e-10&&Ws.timeTasksScratchpad.push(b)}for(var x=0,S=Ws.timeTasksScratchpad;x<S.length;){var C=S[x];++x,ut.remove(Ws.outdatedTimeTasks,C)}for(;0<Ws.timeTasksScratchpad.length;)ut.remove(Ws.timeTasksScratchpad,Ws.timeTasksScratchpad[0])}Ws.sortFrameTasks();for(var k=0,I=Ws.frameTasks;k<I.length;){var T=I[k];++k,Ws.stopped||T.paused||!T.active||T.task()||(T.active=!1)}for(var N=0,M=Ws.frameTasks;N<M.length;){var O=M[N];++N,O.active||Ws.toDeleteFrame.push(O)}for(;0<Ws.toDeleteFrame.length;)ut.remove(Ws.frameTasks,Ws.toDeleteFrame.pop())},Ws.executeTimeTasks=function(t){for(;0<Ws.timeTasks.length&&(Ws.activeTimeTask=Ws.timeTasks[0],Ws.activeTimeTask.next<=t);)Ws.activeTimeTask.next+=Ws.activeTimeTask.period,ut.remove(Ws.timeTasks,Ws.activeTimeTask),Ws.activeTimeTask.active&&Ws.activeTimeTask.task()?0<Ws.activeTimeTask.period&&(0==Ws.activeTimeTask.duration||Ws.activeTimeTask.duration>=Ws.activeTimeTask.start+Ws.activeTimeTask.next)?Ws.insertSorted(Ws.timeTasks,Ws.activeTimeTask):Ws.archiveTimeTask(Ws.activeTimeTask,t):(Ws.activeTimeTask.active=!1,Ws.archiveTimeTask(Ws.activeTimeTask,t));Ws.activeTimeTask=null},Ws.archiveTimeTask=function(t,e){},Ws.time=function(){return Ws.current},Ws.realTime=function(){return zs.get_time()},Ws.resetTime=function(){var t=zs.get_time(),e=t-Ws.startTime;Ws.startTime=t;for(var n=0,i=Ws.timeTasks;n<i.length;){var r=i[n];++n,r.start-=e,r.next-=e}for(var s=0,a=Ws.DIF_COUNT;s<a;){var o=s++;Ws.deltas[o]=0}Ws.current=0,Ws.lastTime=0},Ws.addBreakableTimeTaskToGroup=function(t,e,n,i,r){null==r&&(r=0),null==i&&(i=0);var s=new Ls;return s.active=!0,s.task=e,s.id=++Ws.currentTimeTaskId,s.groupId=t,s.start=Ws.current+n,(s.period=0)!=i&&(s.period=i),(s.duration=0)!=r&&(s.duration=s.start+r),s.next=s.start,Ws.insertSorted(Ws.timeTasks,s),s.id},Ws.addTimeTaskToGroup=function(t,e,n,i,r){return null==r&&(r=0),null==i&&(i=0),Ws.addBreakableTimeTaskToGroup(t,function(){return e(),!0},n,i,r)},Ws.addTimeTask=function(t,e,n,i){return null==i&&(i=0),null==n&&(n=0),Ws.addTimeTaskToGroup(0,t,e,n,i)},Ws.insertSorted=function(t,e){for(var n=0,i=t.length;n<i;){var r=n++;if(t[r].next>e.next)return void t.splice(r,0,e)}t.push(e)},Ws.sortFrameTasks=function(){Ws.frame_tasks_sorted||(Ws.frameTasks.sort(function(t,e){return t.priority>e.priority?1:t.priority<e.priority?-1:0}),Ws.frame_tasks_sorted=!0)};w["kha.ScreenRotation"]={__ename__:"kha.ScreenRotation",__constructs__:["RotationNone","Rotation90","Rotation180","Rotation270"],RotationNone:{_hx_index:0,__enum__:"kha.ScreenRotation",toString:i},Rotation90:{_hx_index:1,__enum__:"kha.ScreenRotation",toString:i},Rotation180:{_hx_index:2,__enum__:"kha.ScreenRotation",toString:i},Rotation270:{_hx_index:3,__enum__:"kha.ScreenRotation",toString:i}};var Rs=function(){};(n["kha.Shaders"]=Rs).__name__="kha.Shaders",Rs.init=function(){var t=[],e=ft.field(Rs,"Material_mesh_vertData0"),n=tr.run(e);t.push(ao.fromBytes(n));var i=ft.field(Rs,"Material_mesh_vertData1"),r=tr.run(i);t.push(ao.fromBytes(r));var s=ft.field(Rs,"Material_mesh_vertData2"),a=tr.run(s);t.push(ao.fromBytes(a)),Rs.Material_mesh_vert=new Ua(t,["Material_mesh.vert.essl","Material_mesh-relaxed.vert.essl","Material_mesh-webgl2.vert.essl"]);var o=[],l=ft.field(Rs,"Material_mesh_fragData0"),u=tr.run(l);o.push(ao.fromBytes(u));var h=ft.field(Rs,"Material_mesh_fragData1"),_=tr.run(h);o.push(ao.fromBytes(_));var c=ft.field(Rs,"Material_mesh_fragData2"),d=tr.run(c);o.push(ao.fromBytes(d)),Rs.Material_mesh_frag=new Ia(o,["Material_mesh.frag.essl","Material_mesh-relaxed.frag.essl","Material_mesh-webgl2.frag.essl"]);var p=[],g=ft.field(Rs,"painter_image_fragData0"),f=tr.run(g);p.push(ao.fromBytes(f));var m=ft.field(Rs,"painter_image_fragData1"),v=tr.run(m);p.push(ao.fromBytes(v));var y=ft.field(Rs,"painter_image_fragData2"),w=tr.run(y);p.push(ao.fromBytes(w)),Rs.painter_image_frag=new Ia(p,["painter-image.frag.essl","painter-image-relaxed.frag.essl","painter-image-webgl2.frag.essl"]);var b=[],x=ft.field(Rs,"painter_colored_vertData0"),S=tr.run(x);b.push(ao.fromBytes(S));var C=ft.field(Rs,"painter_colored_vertData1"),k=tr.run(C);b.push(ao.fromBytes(k));var I=ft.field(Rs,"painter_colored_vertData2"),T=tr.run(I);b.push(ao.fromBytes(T)),Rs.painter_colored_vert=new Ua(b,["painter-colored.vert.essl","painter-colored-relaxed.vert.essl","painter-colored-webgl2.vert.essl"]);var N=[],M=ft.field(Rs,"painter_image_vertData0"),O=tr.run(M);N.push(ao.fromBytes(O));var E=ft.field(Rs,"painter_image_vertData1"),A=tr.run(E);N.push(ao.fromBytes(A));var B=ft.field(Rs,"painter_image_vertData2"),L=tr.run(B);N.push(ao.fromBytes(L)),Rs.painter_image_vert=new Ua(N,["painter-image.vert.essl","painter-image-relaxed.vert.essl","painter-image-webgl2.vert.essl"]);var F=[],W=ft.field(Rs,"painter_colored_fragData0"),R=tr.run(W);F.push(ao.fromBytes(R));var D=ft.field(Rs,"painter_colored_fragData1"),G=tr.run(D);F.push(ao.fromBytes(G));var V=ft.field(Rs,"painter_colored_fragData2"),H=tr.run(V);F.push(ao.fromBytes(H)),Rs.painter_colored_frag=new Ia(F,["painter-colored.frag.essl","painter-colored-relaxed.frag.essl","painter-colored-webgl2.frag.essl"]);var P=[],z=ft.field(Rs,"painter_text_vertData0"),Z=tr.run(z);P.push(ao.fromBytes(Z));var X=ft.field(Rs,"painter_text_vertData1"),j=tr.run(X);P.push(ao.fromBytes(j));var Y=ft.field(Rs,"painter_text_vertData2"),U=tr.run(Y);P.push(ao.fromBytes(U)),Rs.painter_text_vert=new Ua(P,["painter-text.vert.essl","painter-text-relaxed.vert.essl","painter-text-webgl2.vert.essl"]);var K=[],Q=ft.field(Rs,"painter_text_fragData0"),J=tr.run(Q);K.push(ao.fromBytes(J));var q=ft.field(Rs,"painter_text_fragData1"),$=tr.run(q);K.push(ao.fromBytes($));var tt=ft.field(Rs,"painter_text_fragData2"),et=tr.run(tt);K.push(ao.fromBytes(et)),Rs.painter_text_frag=new Ia(K,["painter-text.frag.essl","painter-text-relaxed.frag.essl","painter-text-webgl2.frag.essl"]);var nt=[],it=ft.field(Rs,"painter_video_fragData0"),rt=tr.run(it);nt.push(ao.fromBytes(rt));var st=ft.field(Rs,"painter_video_fragData1"),at=tr.run(st);nt.push(ao.fromBytes(at));var ot=ft.field(Rs,"painter_video_fragData2"),lt=tr.run(ot);nt.push(ao.fromBytes(lt)),Rs.painter_video_frag=new Ia(nt,["painter-video.frag.essl","painter-video-relaxed.frag.essl","painter-video-webgl2.frag.essl"]);var ut=[],ht=ft.field(Rs,"painter_video_vertData0"),_t=tr.run(ht);ut.push(ao.fromBytes(_t));var ct=ft.field(Rs,"painter_video_vertData1"),dt=tr.run(ct);ut.push(ao.fromBytes(dt));var pt=ft.field(Rs,"painter_video_vertData2"),gt=tr.run(pt);ut.push(ao.fromBytes(gt)),Rs.painter_video_vert=new Ua(ut,["painter-video.vert.essl","painter-video-relaxed.vert.essl","painter-video-webgl2.vert.essl"])};var Ds=function(){};(n["kha.Sound"]=Ds).__name__="kha.Sound",Ds.__interfaces__=[bs],Ds.prototype={compressedData:null,uncompressedData:null,uncompress:function(t){},__class__:Ds};var Gs=function(){};(n["kha.StorageFile"]=Gs).__name__="kha.StorageFile",Gs.prototype={read:function(){return null},write:function(t){},writeString:function(t){var e=er.ofString(t);this.write(ao.fromBytes(e))},readString:function(){var t=this.read();return null==t?null:t.toString()},writeObject:function(t){this.writeString(qi.run(t))},readObject:function(){var t=this.readString();if(null==t)return null;try{return tr.run(t)}catch(t){t instanceof us&&t.val;return null}},__class__:Gs};var Vs=function(t){this.name=t};(n["kha.LocalStorageFile"]=Vs).__name__="kha.LocalStorageFile",Vs.encode=function(t){for(var e,n,i=[0,10,13,61],r="",s=new Uint8Array(t),a=0,o=s.length;a<o;){n=s[a++],l.has(i,e=(n+42)%256)?(e=(e+64)%256,r+="="+String.fromCodePoint(e)):r+=String.fromCodePoint(e)}return r},Vs.decode=function(t){for(var e,n=new hr,i=!1,r=0,s=t.length;r<s;){var a=r++;13!=(e=J.fastCodeAt(t,a))&&10!=e&&(61!=e||i?(i&&(i=!1,e-=64),e<42&&0<e?n.addByte(e+214):n.addByte(e-42)):i=!0)}return n.getBytes()},Vs.__super__=Gs,Vs.prototype=r(Gs.prototype,{name:null,read:function(){var t=_s.getLocalStorage();if(null==t)return null;var e=t.getItem(zs.get_title()+"_"+this.name);return null==e?null:ao.fromBytes(Vs.decode(e))},write:function(t){var e=_s.getLocalStorage();null!=e&&e.setItem(zs.get_title()+"_"+this.name,Vs.encode(t.bytes.getData()))},__class__:Vs});var Hs=function(){};(n["kha.Storage"]=Hs).__name__="kha.Storage",Hs.namedFile=function(t){return new Vs(t)},Hs.defaultFile=function(){return Hs.namedFile("default.kha")};var Ps=function(t,e,n,i,r){null==n&&(n=-1),null==e&&(e=-1),null==t&&(t="Kha"),this.framebuffer=null,this.window=null,this.height=-1,this.width=-1,this.title="Kha",this.title=t,this.window=null==i?new Ks(null,null,null,null,null,null,null,null,null):i,0<e?(this.window.width=e,this.width=e):this.width=this.window.width,0<n?(this.window.height=n,this.height=n):this.height=this.window.height,null==this.window.title&&(this.window.title=t),this.framebuffer=null==r?new Ms(null,null,null,null,null,null):r};(n["kha.SystemOptions"]=Ps).__name__="kha.SystemOptions",Ps.prototype={title:null,width:null,height:null,window:null,framebuffer:null,__class__:Ps};var zs=function(){};(n["kha.System"]=zs).__name__="kha.System",zs.__properties__={get_time:"get_time",get_title:"get_title"},zs.start=function(t,e){zs.theTitle=t.title,Xs.init(t,e)},zs.get_title=function(){return zs.theTitle},zs.notifyOnFrames=function(t){zs.renderListeners.push(t)},zs.notifyOnCutCopyPaste=function(t,e,n){zs.cutListener=t,zs.copyListener=e,zs.pasteListener=n},zs.render=function(t){for(var e=0,n=zs.renderListeners;e<n.length;){var i=n[e];++e,i(t)}},zs.foreground=function(){for(var t=0,e=zs.foregroundListeners;t<e.length;){var n=e[t];++t,n()}},zs.background=function(){for(var t=0,e=zs.backgroundListeners;t<e.length;){var n=e[t];++t,n()}},zs.shutdown=function(){for(var t=0,e=zs.shutdownListeners;t<e.length;){var n=e[t];++t,n()}},zs.get_time=function(){return Xs.getTime()},zs.windowWidth=function(t){return null==t&&(t=0),Us.get(t).get_width()},zs.windowHeight=function(t){return null==t&&(t=0),Us.get_all()[t].get_height()},zs.stop=function(){return Xs.requestShutdown()};var Zs=function(){this.axes=[],this.buttons=[]};(n["kha.GamepadStates"]=Zs).__name__="kha.GamepadStates",Zs.prototype={axes:null,buttons:null,__class__:Zs};var Xs=function(){};(n["kha.SystemImpl"]=Xs).__name__="kha.SystemImpl",Xs.init=function(t,e){Xs.options=t,Xs.mobile=Xs.isMobile(),Xs.ios=Xs.isIOS(),Xs.chrome=Xs.isChrome(),Xs.firefox=Xs.isFirefox(),Xs.ie=Xs.isIE(),Xs.initSecondStep(e)},Xs.initSecondStep=function(t){Xs.init2(Xs.options.window.width,Xs.options.window.height),t(Xs.window),Xs.ios?window.ondevicemotion=function(t){io._changed(0,-t.accelerationIncludingGravity.x,-t.accelerationIncludingGravity.y,-t.accelerationIncludingGravity.z)}:window.ondevicemotion=function(t){io._changed(0,t.accelerationIncludingGravity.x,t.accelerationIncludingGravity.y,t.accelerationIncludingGravity.z)},window.ondeviceorientation=function(t){io._changed(1,t.beta,t.gamma,t.alpha)}},Xs.isMobile=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("Android")||0<=t.indexOf("webOS")||0<=t.indexOf("BlackBerry")||0<=t.indexOf("Windows Phone")||!!Xs.isIOS()},Xs.isIOS=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("iPhone")||0<=t.indexOf("iPad")||0<=t.indexOf("iPod")},Xs.isChrome=function(){return 0<=window.navigator.userAgent.indexOf("Chrome")},Xs.isFirefox=function(){return 0<=window.navigator.userAgent.indexOf("Firefox")},Xs.isIE=function(){var t=window.navigator.userAgent;return 0<=t.indexOf("MSIE ")||0<=t.indexOf("Trident/")},Xs.setCanvas=function(t){Xs.khanvas=t},Xs.getTime=function(){return(window.performance?window.performance:window.Date).now()/1e3},Xs.requestShutdown=function(){return window.close(),!0},Xs.init2=function(t,e,n){if(Xs.keyboard=new $a,Xs.mouse=new eo,Xs.surface=new so,Xs.gamepads=[],Xs.gamepadStates=[],Xs.gamepads[0]=new Ja(0),Xs.gamepadStates[0]=new Zs,Xs.gamepads[1]=new Ja(1),Xs.gamepadStates[1]=new Zs,Xs.gamepads[2]=new Ja(2),Xs.gamepadStates[2]=new Zs,Xs.gamepads[3]=new Ja(3),Xs.gamepadStates[3]=new Zs,window.addEventListener("gamepadconnected",function(t){Ja.sendConnectEvent(t.gamepad.index)}),window.addEventListener("gamepaddisconnected",function(t){Ja.sendDisconnectEvent(t.gamepad.index)}),Xs.ie){Xs.pressedKeys=[];for(var i=0;i<256;){i++;Xs.pressedKeys.push(!1)}for(var r=0;r<256;){r++;Xs.pressedKeys.push(null)}}window.document.addEventListener("copy",function(t){var e=t;if(null!=zs.copyListener){var n=zs.copyListener();null!=n&&e.clipboardData.setData("text/plain",n),e.preventDefault()}}),window.document.addEventListener("cut",function(t){var e=t;if(null!=zs.cutListener){var n=zs.cutListener();null!=n&&e.clipboardData.setData("text/plain",n),e.preventDefault()}}),window.document.addEventListener("paste",function(t){var e=t;if(null!=zs.pasteListener){var n=e.clipboardData.getData("text/plain");zs.pasteListener(n),e.preventDefault()}}),Ss.init(),Ws.init(),Xs.loadFinished(t,e)},Xs.getMouse=function(t){return 0!=t?null:Xs.mouse},Xs.getKeyboard=function(t){return 0!=t?null:Xs.keyboard},Xs.checkGamepad=function(t){for(var e=0,n=t.axes.length;e<n;){var i=e++;if(null!=t.axes[i]){var r=t.axes[i];i%2==1&&(r=-r),Xs.gamepadStates[t.index].axes[i]!=r&&(Xs.gamepadStates[t.index].axes[i]=r,Xs.gamepads[t.index].sendAxisEvent(i,r))}}for(var s=0,a=t.buttons.length;s<a;){var o=s++;null!=t.buttons[o]&&Xs.gamepadStates[t.index].buttons[o]!=t.buttons[o].value&&(Xs.gamepadStates[t.index].buttons[o]=t.buttons[o].value,Xs.gamepads[t.index].sendButtonEvent(o,t.buttons[o].value))}t.axes.length<=4&&7<t.buttons.length&&(Xs.gamepadStates[t.index].axes[4]=t.buttons[6].value,Xs.gamepads[t.index].sendAxisEvent(4,t.buttons[6].value),Xs.gamepadStates[t.index].axes[5]=t.buttons[7].value,Xs.gamepads[t.index].sendAxisEvent(5,t.buttons[7].value))},Xs.loadFinished=function(t,e){var l=Xs.khanvas;null==l&&(l=window.document.getElementById(ks.canvas_id));var n=!(l.style.cursor="default");try{Xs.gl=l.getContext("webgl2",{alpha:!1,antialias:1<Xs.options.framebuffer.samplesPerPixel,stencil:!0}),Xs.gl.pixelStorei(37441,1),Xs.halfFloat={HALF_FLOAT_OES:5131},Xs.depthTexture={UNSIGNED_INT_24_8_WEBGL:34042},Xs.drawBuffers={COLOR_ATTACHMENT0_WEBGL:36064},Xs.elementIndexUint=!0,Xs.gl.getExtension("EXT_color_buffer_float"),Xs.gl.getExtension("OES_texture_float_linear"),Xs.gl.getExtension("OES_texture_half_float_linear"),Xs.anisotropicFilter=Xs.gl.getExtension("EXT_texture_filter_anisotropic"),null==Xs.anisotropicFilter&&(Xs.anisotropicFilter=Xs.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),n=!0,Xs.gl2=!0,Rs.init()}catch(t){t instanceof us&&t.val;Ji.trace("Could not initialize WebGL 2, falling back to WebGL.",{fileName:"kha/SystemImpl.hx",lineNumber:335,className:"kha.SystemImpl",methodName:"loadFinished"})}if(!Xs.gl2)try{Xs.gl=l.getContext("experimental-webgl",{alpha:!1,antialias:1<Xs.options.framebuffer.samplesPerPixel,stencil:!0}),Xs.gl.pixelStorei(37441,1),Xs.gl.getExtension("OES_texture_float"),Xs.gl.getExtension("OES_texture_float_linear"),Xs.halfFloat=Xs.gl.getExtension("OES_texture_half_float"),Xs.gl.getExtension("OES_texture_half_float_linear"),Xs.depthTexture=Xs.gl.getExtension("WEBGL_depth_texture"),Xs.gl.getExtension("EXT_shader_texture_lod"),Xs.gl.getExtension("OES_standard_derivatives"),Xs.anisotropicFilter=Xs.gl.getExtension("EXT_texture_filter_anisotropic"),null==Xs.anisotropicFilter&&(Xs.anisotropicFilter=Xs.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic")),Xs.drawBuffers=Xs.gl.getExtension("WEBGL_draw_buffers"),Xs.elementIndexUint=Xs.gl.getExtension("OES_element_index_uint"),n=!0,Rs.init()}catch(t){t instanceof us&&t.val;Ji.trace("Could not initialize WebGL, falling back to <canvas>.",{fileName:"kha/SystemImpl.hx",lineNumber:357,className:"kha.SystemImpl",methodName:"loadFinished"})}if(Xs.setCanvas(l),Xs.window=new Us(t,e,l),n){var i=new wo;Xs.frame=new Ns(0,null,null,i),Xs.frame.init(new sa(Xs.frame),new bo(Xs.frame),i)}else{_o.Kravur=As,As=_o;var r=new ho(l.getContext("2d"));Xs.frame=new Ns(0,null,r,null),Xs.frame.init(new sa(Xs.frame),r,null)}!Xs.mobile&&Js._init()?(Xs._hasWebAudio=!0,qs._init()):Xs.mobile?(Xs._hasWebAudio=!1,co._init(),qs=co):(Xs._hasWebAudio=!1,uo._compile(),qs=uo),So.instance=new Co,Ws.start();var s=window,u=s.requestAnimationFrame;null==u&&(u=s.mozRequestAnimationFrame),null==u&&(u=s.webkitRequestAnimationFrame),null==u&&(u=s.msRequestAnimationFrame);var h=null;h=function(t){var e=window;null==u?e.setTimeout(h,16.666666666666668):u(h);var n=Xs.getGamepads();if(null!=n)for(var i=0,r=n.length;i<r;){var s=n[i++];null!=s&&Xs.checkGamepad(s)}if(Ws.executeFrame(),l.getContext){var a=l.clientWidth,o=l.clientHeight;l.width==a&&l.height==o||(l.width=a,l.height=o),zs.render([Xs.frame]),null!=Xs.gl&&(Xs.gl.clearColor(1,1,1,1),Xs.gl.colorMask(!1,!1,!1,!0),Xs.gl.clear(16384),Xs.gl.colorMask(!0,!0,!0,!0))}},null==u?s.setTimeout(h,16.666666666666668):u(h),l.focus(),l.oncontextmenu=function(t){t.stopPropagation(),t.preventDefault()},l.onmousedown=Xs.mouseDown,l.onmousemove=Xs.mouseMove,null!=Xs.keyboard&&(l.onkeydown=Xs.keyDown,l.onkeyup=Xs.keyUp,l.onkeypress=Xs.keyPress),l.onblur=Xs.onBlur,l.onfocus=Xs.onFocus,l.onmousewheel=l.onwheel=Xs.mouseWheel,l.onmouseleave=Xs.mouseLeave,l.addEventListener("wheel mousewheel",Xs.mouseWheel,!1),l.addEventListener("touchstart",Xs.touchDown,!1),l.addEventListener("touchend",Xs.touchUp,!1),l.addEventListener("touchmove",Xs.touchMove,!1),l.addEventListener("touchcancel",Xs.touchCancel,!1),window.addEventListener("unload",function(){zs.shutdown()})},Xs.lockMouse=function(){Fo(S=Xs.khanvas,S.requestPointerLock)?Xs.khanvas.requestPointerLock():Xs.khanvas.mozRequestPointerLock?Xs.khanvas.mozRequestPointerLock():Xs.khanvas.webkitRequestPointerLock&&Xs.khanvas.webkitRequestPointerLock()},Xs.unlockMouse=function(){document.exitPointerLock?document.exitPointerLock():document.mozExitPointerLock?document.mozExitPointerLock():document.webkitExitPointerLock&&document.webkitExitPointerLock()},Xs.canLockMouse=function(){return"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document},Xs.setMouseXY=function(t){var e=Xs.khanvas.getBoundingClientRect(),n=Xs.khanvas.clientLeft,i=Xs.khanvas.clientTop;Xs.mouseX=pt.int((t.clientX-e.left-n)*Xs.khanvas.width/(e.width-2*n)),Xs.mouseY=pt.int((t.clientY-e.top-i)*Xs.khanvas.height/(e.height-2*i))},Xs.unlockiOSSound=function(){if(Xs.ios&&!Xs.iosSoundEnabled){var t=co._context.createBuffer(1,1,22050),e=co._context.createBufferSource();e.buffer=t,e.connect(co._context.destination),e.start(),e.stop(),Xs.iosSoundEnabled=!0}},Xs.unlockSound=function(){if(!Xs.soundEnabled){var t=Js._context;null==t&&(t=qs._context),null!=t&&t.resume().then(function(t){Xs.soundEnabled=!0}).catch(function(t){Ji.trace(t,{fileName:"kha/SystemImpl.hx",lineNumber:597,className:"kha.SystemImpl",methodName:"unlockSound"})})}Xs.unlockiOSSound()},Xs.mouseLeave=function(){Xs.mouse.sendLeaveEvent(0)},Xs.mouseWheel=function(t){return Xs.insideInputEvent=!0,Xs.unlockSound(),t.preventDefault(),0==t.deltaMode?t.deltaY<0?Xs.mouse.sendWheelEvent(0,-1):0<t.deltaY&&Xs.mouse.sendWheelEvent(0,1):1==t.deltaMode&&(Xs.minimumScroll=pt.int(Math.min(Xs.minimumScroll,Math.abs(t.deltaY))),Xs.mouse.sendWheelEvent(0,pt.int(t.deltaY/Xs.minimumScroll))),Xs.insideInputEvent=!1},Xs.mouseDown=function(t){Xs.insideInputEvent=!0,Xs.unlockSound(),Xs.setMouseXY(t),1==t.which?(t.ctrlKey?(Xs.leftMouseCtrlDown=!0,Xs.mouse.sendDownEvent(0,1,Xs.mouseX,Xs.mouseY)):(Xs.leftMouseCtrlDown=!1,Xs.mouse.sendDownEvent(0,0,Xs.mouseX,Xs.mouseY)),null!=Xs.khanvas.setCapture?Xs.khanvas.setCapture():Xs.khanvas.ownerDocument.addEventListener("mousemove",Xs.documentMouseMove,!0),Xs.khanvas.ownerDocument.addEventListener("mouseup",Xs.mouseLeftUp)):2==t.which?(Xs.mouse.sendDownEvent(0,2,Xs.mouseX,Xs.mouseY),Xs.khanvas.ownerDocument.addEventListener("mouseup",Xs.mouseMiddleUp)):3==t.which&&(Xs.mouse.sendDownEvent(0,1,Xs.mouseX,Xs.mouseY),Xs.khanvas.ownerDocument.addEventListener("mouseup",Xs.mouseRightUp)),Xs.insideInputEvent=!1},Xs.mouseLeftUp=function(t){Xs.unlockSound(),1==t.which&&(Xs.insideInputEvent=!0,Xs.khanvas.ownerDocument.removeEventListener("mouseup",Xs.mouseLeftUp),null!=Xs.khanvas.releaseCapture?Xs.khanvas.ownerDocument.releaseCapture():Xs.khanvas.ownerDocument.removeEventListener("mousemove",Xs.documentMouseMove,!0),Xs.leftMouseCtrlDown?Xs.mouse.sendUpEvent(0,1,Xs.mouseX,Xs.mouseY):Xs.mouse.sendUpEvent(0,0,Xs.mouseX,Xs.mouseY),Xs.leftMouseCtrlDown=!1,Xs.insideInputEvent=!1)},Xs.mouseMiddleUp=function(t){Xs.unlockSound(),2==t.which&&(Xs.insideInputEvent=!0,Xs.khanvas.ownerDocument.removeEventListener("mouseup",Xs.mouseMiddleUp),Xs.mouse.sendUpEvent(0,2,Xs.mouseX,Xs.mouseY),Xs.insideInputEvent=!1)},Xs.mouseRightUp=function(t){Xs.unlockSound(),3==t.which&&(Xs.insideInputEvent=!0,Xs.khanvas.ownerDocument.removeEventListener("mouseup",Xs.mouseRightUp),Xs.mouse.sendUpEvent(0,1,Xs.mouseX,Xs.mouseY),Xs.insideInputEvent=!1)},Xs.documentMouseMove=function(t){t.stopPropagation(),Xs.mouseMove(t)},Xs.mouseMove=function(t){Xs.insideInputEvent=!0,Xs.unlockSound();var e=Xs.mouseX,n=Xs.mouseY;Xs.setMouseXY(t);var i=t.movementX,r=t.movementY;null==t.movementX&&(i=null!=t.mozMovementX?t.mozMovementX:null!=t.webkitMovementX?t.webkitMovementX:Xs.mouseX-e,r=null!=t.mozMovementY?t.mozMovementY:null!=t.webkitMovementY?t.webkitMovementY:Xs.mouseY-n),Xs.firefox&&(i=pt.int(i*window.devicePixelRatio),r=pt.int(r*window.devicePixelRatio)),Xs.mouse.sendMoveEvent(0,Xs.mouseX,Xs.mouseY,i,r),Xs.insideInputEvent=!1},Xs.setTouchXY=function(t){var e=Xs.khanvas.getBoundingClientRect(),n=Xs.khanvas.clientLeft,i=Xs.khanvas.clientTop;Xs.touchX=pt.int((t.clientX-e.left-n)*Xs.khanvas.width/(e.width-2*n)),Xs.touchY=pt.int((t.clientY-e.top-i)*Xs.khanvas.height/(e.height-2*i))},Xs.touchDown=function(t){Xs.insideInputEvent=!0,Xs.unlockSound(),t.stopPropagation(),t.preventDefault();for(var e=0,n=t.changedTouches;e<n.length;){var i=n[e];++e;var r=i.identifier;Xs.ios&&(-1==(r=Xs.iosTouchs.indexOf(-1))&&(r=Xs.iosTouchs.length),Xs.iosTouchs[r]=i.identifier),Xs.setTouchXY(i),Xs.mouse.sendDownEvent(0,0,Xs.touchX,Xs.touchY),Xs.surface.sendTouchStartEvent(r,Xs.touchX,Xs.touchY)}Xs.insideInputEvent=!1},Xs.touchUp=function(t){Xs.insideInputEvent=!0,Xs.unlockSound();for(var e=0,n=t.changedTouches;e<n.length;){var i=n[e];++e;var r=i.identifier;Xs.ios&&(r=Xs.iosTouchs.indexOf(r),Xs.iosTouchs[r]=-1),Xs.setTouchXY(i),Xs.mouse.sendUpEvent(0,0,Xs.touchX,Xs.touchY),Xs.surface.sendTouchEndEvent(r,Xs.touchX,Xs.touchY)}Xs.insideInputEvent=!1},Xs.touchMove=function(t){Xs.insideInputEvent=!0,Xs.unlockSound();for(var e=0,n=0,i=t.changedTouches;n<i.length;){var r=i[n];if(++n,Xs.setTouchXY(r),0==e){var s=Xs.touchX-Xs.lastFirstTouchX,a=Xs.touchY-Xs.lastFirstTouchY;Xs.lastFirstTouchX=Xs.touchX,Xs.lastFirstTouchY=Xs.touchY,Xs.mouse.sendMoveEvent(0,Xs.touchX,Xs.touchY,s,a)}var o=r.identifier;Xs.ios&&(o=Xs.iosTouchs.indexOf(o)),Xs.surface.sendMoveEvent(o,Xs.touchX,Xs.touchY),++e}Xs.insideInputEvent=!1},Xs.touchCancel=function(t){Xs.insideInputEvent=!0,Xs.unlockSound();for(var e=0,n=t.changedTouches;e<n.length;){var i=n[e];++e;var r=i.identifier;Xs.ios&&(r=Xs.iosTouchs.indexOf(r)),Xs.setTouchXY(i),Xs.mouse.sendUpEvent(0,0,Xs.touchX,Xs.touchY),Xs.surface.sendTouchEndEvent(r,Xs.touchX,Xs.touchY)}Xs.iosTouchs=[],Xs.insideInputEvent=!1},Xs.onBlur=function(){zs.background()},Xs.onFocus=function(){zs.foreground()},Xs.keyDown=function(t){if((t.keyCode<112||123<t.keyCode)&&null!=t.key&&1!=t.key.length&&t.preventDefault(),t.stopPropagation(),Xs.ie){if(Xs.pressedKeys[t.keyCode])return void t.preventDefault();Xs.pressedKeys[t.keyCode]=!0}else if(t.repeat)return void t.preventDefault();Xs.keyboard.sendDownEvent(t.keyCode)},Xs.keyUp=function(t){t.preventDefault(),t.stopPropagation(),Xs.ie&&(Xs.pressedKeys[t.keyCode]=!1),Xs.keyboard.sendUpEvent(t.keyCode)},Xs.keyPress=function(t){if(0!=t.which){t.preventDefault(),t.stopPropagation();var e=t.which;Xs.keyboard.sendPressEvent(String.fromCodePoint(e))}},Xs.getGamepads=function(){return Xs.chrome&&So.instance.IsVrEnabled()?null:navigator.getGamepads?window.navigator.getGamepads():null},Xs.getPen=function(t){return null};var js=function(){};(n["kha.Video"]=js).__name__="kha.Video",js.__interfaces__=[bs],js.prototype={__class__:js};var Ys=function(t,e,n,i,r,s){this.depthTexture=null,this.texture=null,this.renderBuffer=null,this.frameBuffer=null,this.myWidth=t,this.myHeight=e,this.format=n,this.renderTarget=i,this.samples=s,this.image=null,this.video=null,this.depthStencilFormat=r,Ys.init(),i&&this.createTexture()};(n["kha.WebGLImage"]=Ys).__name__="kha.WebGLImage",Ys.init=function(){null==Ys.context&&(Ys.canvas=window.document.createElement("canvas"),null!=Ys.canvas&&(Ys.context=Ys.canvas.getContext("2d"),Ys.canvas.width=4096,Ys.canvas.height=4096,Ys.context.globalCompositeOperation="copy"))},Ys.formatByteSize=function(t){switch(t._hx_index){case 0:return 4;case 1:return 1;case 2:return 16;case 3:return 2;case 4:return 8;case 5:return 4;case 6:return 2}},Ys.__super__=xs,Ys.prototype=r(xs.prototype,{image:null,video:null,myWidth:null,myHeight:null,format:null,renderTarget:null,samples:null,frameBuffer:null,renderBuffer:null,texture:null,depthTexture:null,graphics2:null,graphics4:null,depthStencilFormat:null,get_g2:function(){return null==this.graphics2&&(this.graphics2=new bo(this)),this.graphics2},get_g4:function(){return null==this.graphics4&&(this.graphics4=new wo(this)),this.graphics4},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_realWidth:function(){return this.myWidth},get_realHeight:function(){return this.myHeight},createTexture:function(){if(null!=Xs.gl){if(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.texture),Xs.gl.texParameteri(3553,10240,9729),Xs.gl.texParameteri(3553,10241,9729),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),this.renderTarget){switch(this.frameBuffer=Xs.gl.createFramebuffer(),Xs.gl.bindFramebuffer(36160,this.frameBuffer),this.format._hx_index){case 0:Xs.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null);break;case 2:Xs.gl.texImage2D(3553,0,Xs.gl2?34836:6408,this.get_realWidth(),this.get_realHeight(),0,6408,5126,null);break;case 3:Xs.gl.texImage2D(3553,0,Xs.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null);break;case 4:Xs.gl.texImage2D(3553,0,Xs.gl2?34842:6408,this.get_realWidth(),this.get_realHeight(),0,6408,Xs.halfFloat.HALF_FLOAT_OES,null);break;case 5:Xs.gl.texImage2D(3553,0,Xs.gl2?33326:6406,this.get_realWidth(),this.get_realHeight(),0,Xs.gl2?6403:6406,5126,null);break;case 6:Xs.gl.texImage2D(3553,0,Xs.gl2?33325:6406,this.get_realWidth(),this.get_realHeight(),0,Xs.gl2?6403:6406,Xs.halfFloat.HALF_FLOAT_OES,null);break;default:Xs.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null)}if(this.format==za.DEPTH16){if(Xs.gl.texParameteri(3553,10240,9728),Xs.gl.texParameteri(3553,10241,9728),Xs.gl.framebufferTexture2D(36160,36096,3553,this.texture,0),!Xs.gl2){var t=Xs.gl.createTexture();Xs.gl.bindTexture(3553,t),Xs.gl.texImage2D(3553,0,6408,this.get_realWidth(),this.get_realHeight(),0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,3553,t,0),Xs.gl.bindTexture(3553,this.texture)}}else Xs.gl.framebufferTexture2D(36160,36064,3553,this.texture,0);this.initDepthStencilBuffer(this.depthStencilFormat),36053!=Xs.gl.checkFramebufferStatus(36160)&&Ji.trace("WebGL error: Framebuffer incomplete",{fileName:"kha/WebGLImage.hx",lineNumber:225,className:"kha.WebGLImage",methodName:"createTexture"}),Xs.gl.bindRenderbuffer(36161,null),Xs.gl.bindFramebuffer(36160,null)}else if(null!=this.video)Xs.gl.texImage2D(3553,0,6408,6408,5121,this.video);else switch(this.format._hx_index){case 0:this.image instanceof Uint8Array?Xs.gl.texImage2D(3553,0,6408,this.myWidth,this.myHeight,0,6408,5121,this.image):Xs.gl.texImage2D(3553,0,6408,6408,5121,this.image);break;case 1:Xs.gl.texImage2D(3553,0,6409,this.myWidth,this.myHeight,0,6409,5121,this.image);break;case 2:Xs.gl.texImage2D(3553,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,this.image);break;case 4:Xs.gl.texImage2D(3553,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,this.image);break;case 5:Xs.gl.texImage2D(3553,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,Xs.gl2?6403:6406,5126,this.image);break;case 6:Xs.gl.texImage2D(3553,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,Xs.gl2?6403:6406,Xs.halfFloat.HALF_FLOAT_OES,this.image);break;default:Xs.gl.texImage2D(3553,0,6408,6408,5121,this.image)}Xs.gl.bindTexture(3553,null)}},initDepthStencilBuffer:function(t){switch(t){case 0:break;case 1:case 5:null==Xs.depthTexture?(this.renderBuffer=Xs.gl.createRenderbuffer(),Xs.gl.bindRenderbuffer(36161,this.renderBuffer),Xs.gl.renderbufferStorage(36161,33189,this.get_realWidth(),this.get_realHeight()),Xs.gl.framebufferRenderbuffer(36160,36096,36161,this.renderBuffer)):(this.depthTexture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.depthTexture),1==t?Xs.gl.texImage2D(3553,0,Xs.gl2?33190:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5125,null):Xs.gl.texImage2D(3553,0,Xs.gl2?33189:6402,this.get_realWidth(),this.get_realHeight(),0,6402,5123,null),Xs.gl.texParameteri(3553,10240,9728),Xs.gl.texParameteri(3553,10241,9728),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,36096,3553,this.depthTexture,0));break;case 2:case 3:case 4:null==Xs.depthTexture?(this.renderBuffer=Xs.gl.createRenderbuffer(),Xs.gl.bindRenderbuffer(36161,this.renderBuffer),Xs.gl.renderbufferStorage(36161,34041,this.get_realWidth(),this.get_realHeight()),Xs.gl.framebufferRenderbuffer(36160,33306,36161,this.renderBuffer)):(this.depthTexture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.depthTexture),Xs.gl.texImage2D(3553,0,Xs.gl2?35056:34041,this.get_realWidth(),this.get_realHeight(),0,34041,Xs.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),Xs.gl.texParameteri(3553,10240,9728),Xs.gl.texParameteri(3553,10241,9728),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,33306,3553,this.depthTexture,0))}},set:function(t){Xs.gl.activeTexture(33984+t),Xs.gl.bindTexture(3553,this.texture),null!=this.video&&Xs.gl.texImage2D(3553,0,6408,6408,5121,this.video)},setDepth:function(t){Xs.gl.activeTexture(33984+t),Xs.gl.bindTexture(3553,this.depthTexture)},setDepthStencilFrom:function(t){Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,36096,3553,hs.__cast(t,Ys).depthTexture,0)},bytesToArray:function(t){switch(this.format._hx_index){case 0:case 1:return new Uint8Array(t.getData());case 2:case 4:case 5:case 6:return new Float32Array(t.getData());default:return new Uint8Array(t.getData())}},bytes:null,lock:function(t){return null==t&&(t=0),this.bytes=er.alloc(Ys.formatByteSize(this.format)*this.get_width()*this.get_height()),this.bytes},unlock:function(){if(null!=Xs.gl){switch(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(3553,this.texture),Xs.gl.texParameteri(3553,10240,9729),Xs.gl.texParameteri(3553,10241,9729),Xs.gl.texParameteri(3553,10242,33071),Xs.gl.texParameteri(3553,10243,33071),this.format._hx_index){case 0:Xs.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes));break;case 1:if(Xs.gl.texImage2D(3553,0,6409,this.get_width(),this.get_height(),0,6409,5121,this.bytesToArray(this.bytes)),1282==Xs.gl.getError()){for(var t=er.alloc(this.get_width()*this.get_height()*4),e=0,n=this.get_height();e<n;)for(var i=e++,r=0,s=this.get_width();r<s;){var a=r++,o=this.bytes.get(i*this.get_width()+a);t.set(i*this.get_width()*4+4*a,o),t.set(i*this.get_width()*4+4*a+1,o),t.set(i*this.get_width()*4+4*a+2,o),t.set(i*this.get_width()*4+4*a+3,255)}Xs.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(t))}break;case 2:Xs.gl.texImage2D(3553,0,Xs.gl2?34836:6408,this.get_width(),this.get_height(),0,6408,5126,this.bytesToArray(this.bytes));break;case 4:Xs.gl.texImage2D(3553,0,Xs.gl2?34842:6408,this.get_width(),this.get_height(),0,6408,Xs.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;case 5:Xs.gl.texImage2D(3553,0,Xs.gl2?33326:6406,this.get_width(),this.get_height(),0,Xs.gl2?6403:6406,5126,this.bytesToArray(this.bytes));break;case 6:Xs.gl.texImage2D(3553,0,Xs.gl2?33325:6406,this.get_width(),this.get_height(),0,Xs.gl2?6403:6406,Xs.halfFloat.HALF_FLOAT_OES,this.bytesToArray(this.bytes));break;default:Xs.gl.texImage2D(3553,0,6408,this.get_width(),this.get_height(),0,6408,5121,this.bytesToArray(this.bytes))}Xs.gl.bindTexture(3553,null),this.bytes=null}},unload:function(){null!=this.texture&&Xs.gl.deleteTexture(this.texture),null!=this.depthTexture&&Xs.gl.deleteTexture(this.depthTexture),null!=this.frameBuffer&&Xs.gl.deleteFramebuffer(this.frameBuffer),null!=this.renderBuffer&&Xs.gl.deleteRenderbuffer(this.renderBuffer)},generateMipmaps:function(t){Xs.gl.bindTexture(3553,this.texture),Xs.gl.generateMipmap(3553)},setMipmaps:function(t){if(Xs.gl.bindTexture(3553,this.texture),this.format==za.RGBA128)for(var e=0,n=t.length;e<n;){var i=e++;Xs.gl.texImage2D(3553,i+1,Xs.gl2?34836:6408,t[i].get_width(),t[i].get_height(),0,6408,5126,hs.__cast(t[i],Ys).image)}else if(this.format==za.RGBA64)for(var r=0,s=t.length;r<s;){var a=r++;Xs.gl.texImage2D(3553,a+1,Xs.gl2?34842:6408,t[a].get_width(),t[a].get_height(),0,6408,Xs.halfFloat.HALF_FLOAT_OES,hs.__cast(t[a],Ys).image)}else for(var o=0,l=t.length;o<l;){var u=o++;Xs.gl.texImage2D(3553,u+1,6408,6408,5121,hs.__cast(t[u],Ys).image)}},__class__:Ys});var Us=function(t,e,n){this.canvas=n,this.defaultWidth=t,this.defaultHeight=e,Us.windows.push(this)};(n["kha.Window"]=Us).__name__="kha.Window",Us.__properties__={get_all:"get_all"},Us.get=function(t){return Us.windows[t]},Us.get_all=function(){return Us.windows},Us.prototype={canvas:null,defaultWidth:null,defaultHeight:null,get_width:function(){return 0==this.canvas.width?this.defaultWidth:this.canvas.width},get_height:function(){return 0==this.canvas.height?this.defaultHeight:this.canvas.height},get_vSynced:function(){return!0},__class__:Us,__properties__:{get_vSynced:"get_vSynced",get_height:"get_height",get_width:"get_width"}};var Ks=function(t,e,n,i,r,s,a,o,l){null==l&&(l=0),null==a&&(a=!0),null==r&&(r=600),null==i&&(i=800),null==n&&(n=-1),null==e&&(e=-1),this.mode=0,this.windowFeatures=7,this.visible=!0,this.display=null,this.height=600,this.width=800,this.y=-1,this.x=-1,this.title=null,this.title=t,this.x=e,this.y=n,this.width=i,this.height=r,this.display=null==s?Is.get_primary():s,this.visible=a,this.windowFeatures=null==o?7:o,this.mode=l};(n["kha.WindowOptions"]=Ks).__name__="kha.WindowOptions",Ks.prototype={title:null,x:null,y:null,width:null,height:null,display:null,visible:null,windowFeatures:null,mode:null,__class__:Ks};var Qs=function(){};(n["kha.audio1.AudioChannel"]=Qs).__name__="kha.audio1.AudioChannel",Qs.prototype={play:null,pause:null,stop:null,set_volume:null,get_finished:null,__class__:Qs,__properties__:{get_finished:"get_finished",set_volume:"set_volume"}};var Js=function(){};(n["kha.audio2.Audio"]=Js).__name__="kha.audio2.Audio",Js.initContext=function(){try{return void(Js._context=new AudioContext)}catch(t){t instanceof us&&t.val}try{return void(this._context=new webkitAudioContext)}catch(t){t instanceof us&&t.val}},Js._init=function(){if(Js.initContext(),null==Js._context)return!1;return Js.buffer=new ta(8192,2,pt.int(Js._context.sampleRate)),Js.processingNode=Js._context.createScriptProcessor(2048,0,2),Js.processingNode.onaudioprocess=function(t){var e=t.outputBuffer.getChannelData(0),n=t.outputBuffer.getChannelData(1);if(null!=Js.audioCallback){Js.audioCallback(2*t.outputBuffer.length,Js.buffer);for(var i=0,r=t.outputBuffer.length;i<r;){var s=i++;e[s]=Js.buffer.data[Js.buffer.readLocation],Js.buffer.readLocation+=1,n[s]=Js.buffer.data[Js.buffer.readLocation],Js.buffer.readLocation+=1,Js.buffer.readLocation>=Js.buffer.size&&(Js.buffer.readLocation=0)}}else for(var a=0,o=t.outputBuffer.length;a<o;){var l=a++;e[l]=0,n[l]=0}},Js.processingNode.connect(Js._context.destination),!0};var qs=function(){};(n["kha.audio2.Audio1"]=qs).__name__="kha.audio2.Audio1",qs._init=function(){var t=new Array(16);qs.soundChannels=t;var e=new Array(16);qs.streamChannels=e;var n=new Array(16);qs.internalSoundChannels=n;var i=new Array(16);qs.internalStreamChannels=i;var r=new Float32Array(512);qs.sampleCache1=r;var s=new Float32Array(512);qs.sampleCache2=s,Js.audioCallback=qs.mix},qs.max=function(t,e){return e<t?t:e},qs.min=function(t,e){return t<e?t:e},qs.mix=function(t,e){if(qs.sampleCache1.length<t){var n=new Float32Array(t);qs.sampleCache1=n;var i=new Float32Array(t);qs.sampleCache2=i}for(var r=0,s=t;r<s;){var a=r++;qs.sampleCache2[a]=0}qs.internalSoundChannels[0]=qs.soundChannels[0],qs.internalSoundChannels[1]=qs.soundChannels[1],qs.internalSoundChannels[2]=qs.soundChannels[2],qs.internalSoundChannels[3]=qs.soundChannels[3],qs.internalSoundChannels[4]=qs.soundChannels[4],qs.internalSoundChannels[5]=qs.soundChannels[5],qs.internalSoundChannels[6]=qs.soundChannels[6],qs.internalSoundChannels[7]=qs.soundChannels[7],qs.internalSoundChannels[8]=qs.soundChannels[8],qs.internalSoundChannels[9]=qs.soundChannels[9],qs.internalSoundChannels[10]=qs.soundChannels[10],qs.internalSoundChannels[11]=qs.soundChannels[11],qs.internalSoundChannels[12]=qs.soundChannels[12],qs.internalSoundChannels[13]=qs.soundChannels[13],qs.internalSoundChannels[14]=qs.soundChannels[14],qs.internalSoundChannels[15]=qs.soundChannels[15],qs.internalStreamChannels[0]=qs.streamChannels[0],qs.internalStreamChannels[1]=qs.streamChannels[1],qs.internalStreamChannels[2]=qs.streamChannels[2],qs.internalStreamChannels[3]=qs.streamChannels[3],qs.internalStreamChannels[4]=qs.streamChannels[4],qs.internalStreamChannels[5]=qs.streamChannels[5],qs.internalStreamChannels[6]=qs.streamChannels[6],qs.internalStreamChannels[7]=qs.streamChannels[7],qs.internalStreamChannels[8]=qs.streamChannels[8],qs.internalStreamChannels[9]=qs.streamChannels[9],qs.internalStreamChannels[10]=qs.streamChannels[10],qs.internalStreamChannels[11]=qs.streamChannels[11],qs.internalStreamChannels[12]=qs.streamChannels[12],qs.internalStreamChannels[13]=qs.streamChannels[13],qs.internalStreamChannels[14]=qs.streamChannels[14],qs.internalStreamChannels[15]=qs.streamChannels[15];for(var o=0,l=qs.internalSoundChannels;o<l.length;){var u=l[o];if(++o,null!=u&&!u.get_finished()){u.nextSamples(qs.sampleCache1,t,e.samplesPerSecond);for(var h=0,_=t;h<_;){var c=h++;qs.sampleCache2[c]+=qs.sampleCache1[c]*u.get_volume()}}}for(var d=0,p=qs.internalStreamChannels;d<p.length;){var g=p[d];if(++d,null!=g&&!g.get_finished()){g.nextSamples(qs.sampleCache1,t,e.samplesPerSecond);for(var f=0,m=t;f<m;){var v=f++;qs.sampleCache2[v]+=qs.sampleCache1[v]*g.get_volume()}}}for(var y=0,w=t;y<w;){var b=y++;e.data[e.writeLocation]=qs.max(qs.min(qs.sampleCache2[b],1),-1),e.writeLocation+=1,e.writeLocation>=e.size&&(e.writeLocation=0)}},qs._playAgain=function(t){for(var e=0;e<16;){var n=e++;if(null==qs.soundChannels[n]||qs.soundChannels[n].get_finished()||qs.soundChannels[n]==t){qs.soundChannels[n]=t;break}}};var $s=function(t){this.paused=!1,this.looping=t,this.myVolume=1,this.myPosition=0};(n["kha.audio2.AudioChannel"]=$s).__name__="kha.audio2.AudioChannel",$s.__interfaces__=[Qs],$s.prototype={data:null,myVolume:null,myPosition:null,paused:null,looping:null,nextSamples:function(t,e,n){if(this.paused)for(var i=0,r=e;i<r;){t[i++]=0}else{for(var s=0,a=0;s<e;){for(var o=this.data.length-this.myPosition,l=o<e-s?o:e-s;a<l;)t[s]=this.data[this.myPosition],++this.myPosition,++a,++s;if(!this.looping)break;a=0,this.myPosition>=this.data.length&&(this.myPosition=0)}for(;s<e;)t[s]=0,++s}},play:function(){this.paused=!1,this.get_finished()&&(this.myPosition=0,qs._playAgain(this))},pause:function(){this.paused=!0},stop:function(){this.myPosition=this.data.length},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.myPosition>=this.data.length},__class__:$s,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume"}};var ta=function(t,e,n){this.size=t;var i=new Float32Array(t);this.data=i,this.channels=e,this.samplesPerSecond=n,this.readLocation=0,this.writeLocation=0};(n["kha.audio2.Buffer"]=ta).__name__="kha.audio2.Buffer",ta.prototype={channels:null,samplesPerSecond:null,data:null,size:null,readLocation:null,writeLocation:null,__class__:ta};var ea=function(t,e){this.paused=!1,this.atend=!1,this.myVolume=1,this.loop=e};(n["kha.audio2.StreamChannel"]=ea).__name__="kha.audio2.StreamChannel",ea.__interfaces__=[Qs],ea.prototype={atend:null,loop:null,myVolume:null,paused:null,nextSamples:function(t,e,n){if(this.paused)for(var i=0,r=e;i<r;){t[i++]=0}else;},play:function(){this.paused=!1},pause:function(){this.paused=!0},stop:function(){this.atend=!0},get_volume:function(){return this.myVolume},set_volume:function(t){return this.myVolume=t},get_finished:function(){return this.atend},__class__:ea,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_volume:"get_volume"}};var na=function(){};(n["kha.audio2.ogg.vorbis.data.Header"]=na).__name__="kha.audio2.ogg.vorbis.data.Header";var ia=function(){};(n["kha.graphics1.Graphics"]=ia).__name__="kha.graphics1.Graphics";var ra=function(){this.transformations=[],this.transformations.push(new Yr(1,0,0,0,1,0,0,0,1)),this.opacities=[],this.opacities.push(1),this.myFontSize=12,this.pipe=null};(n["kha.graphics2.Graphics"]=ra).__name__="kha.graphics2.Graphics",ra.prototype={begin:function(t,e){null==t&&(t=!0)},end:function(){},drawImage:function(t,e,n){this.drawSubImage(t,e,n,0,0,t.get_width(),t.get_height())},drawSubImage:function(t,e,n,i,r,s,a){this.drawScaledSubImage(t,i,r,s,a,e,n,s,a)},drawScaledImage:function(t,e,n,i,r){this.drawScaledSubImage(t,0,0,t.get_width(),t.get_height(),e,n,i,r)},drawScaledSubImage:function(t,e,n,i,r,s,a,o,l){},drawRect:function(t,e,n,i,r){null==r&&(r=1)},fillRect:function(t,e,n,i){},drawString:function(t,e,n){},drawLine:function(t,e,n,i,r){null==r&&(r=1)},fillTriangle:function(t,e,n,i,r,s){},set_imageScaleQuality:function(t){return oa.High},get_color:function(){return-16777216},set_color:function(t){return-16777216},get_font:function(){return null},set_font:function(t){return null},get_fontSize:function(){return this.myFontSize},set_fontSize:function(t){return this.myFontSize=t},pushTransformation:function(t){var e=new Yr(1,0,0,0,1,0,0,0,1);e._00=t._00,e._10=t._10,e._20=t._20,e._01=t._01,e._11=t._11,e._21=t._21,e._02=t._02,e._12=t._12,e._22=t._22,this.setTransformation(e),this.transformations.push(e)},popTransformation:function(){var t=this.transformations.pop();return this.setTransformation(this.get_transformation()),t},get_transformation:function(){return this.transformations[this.transformations.length-1]},rotation:function(t,e,n){var i=new Yr(1,0,e,0,1,n,0,0,1),r=new Yr(Math.cos(t),-Math.sin(t),0,Math.sin(t),Math.cos(t),0,0,0,1),s=new Yr(i._00*r._00+i._10*r._01+i._20*r._02,i._00*r._10+i._10*r._11+i._20*r._12,i._00*r._20+i._10*r._21+i._20*r._22,i._01*r._00+i._11*r._01+i._21*r._02,i._01*r._10+i._11*r._11+i._21*r._12,i._01*r._20+i._11*r._21+i._21*r._22,i._02*r._00+i._12*r._01+i._22*r._02,i._02*r._10+i._12*r._11+i._22*r._12,i._02*r._20+i._12*r._21+i._22*r._22),a=new Yr(1,0,-e,0,1,-n,0,0,1),o=new Yr(s._00*a._00+s._10*a._01+s._20*a._02,s._00*a._10+s._10*a._11+s._20*a._12,s._00*a._20+s._10*a._21+s._20*a._22,s._01*a._00+s._11*a._01+s._21*a._02,s._01*a._10+s._11*a._11+s._21*a._12,s._01*a._20+s._11*a._21+s._21*a._22,s._02*a._00+s._12*a._01+s._22*a._02,s._02*a._10+s._12*a._11+s._22*a._12,s._02*a._20+s._12*a._21+s._22*a._22),l=this.get_transformation();return new Yr(o._00*l._00+o._10*l._01+o._20*l._02,o._00*l._10+o._10*l._11+o._20*l._12,o._00*l._20+o._10*l._21+o._20*l._22,o._01*l._00+o._11*l._01+o._21*l._02,o._01*l._10+o._11*l._11+o._21*l._12,o._01*l._20+o._11*l._21+o._21*l._22,o._02*l._00+o._12*l._01+o._22*l._02,o._02*l._10+o._12*l._11+o._22*l._12,o._02*l._20+o._12*l._21+o._22*l._22)},pushRotation:function(t,e,n){this.pushTransformation(this.rotation(t,e,n))},get_opacity:function(){return this.opacities[this.opacities.length-1]},pipe:null,transformations:null,opacities:null,myFontSize:null,setTransformation:function(t){},__class__:ra,__properties__:{get_opacity:"get_opacity",get_transformation:"get_transformation",set_fontSize:"set_fontSize",get_fontSize:"get_fontSize",set_font:"set_font",get_font:"get_font",set_color:"set_color",get_color:"get_color",set_imageScaleQuality:"set_imageScaleQuality"}};var sa=function(t){this.canvas=t};(n["kha.graphics2.Graphics1"]=sa).__name__="kha.graphics2.Graphics1",sa.__interfaces__=[ia],sa.prototype={canvas:null,__class__:sa};var aa=function(){};(n["kha.graphics2.GraphicsExtension"]=aa).__name__="kha.graphics2.GraphicsExtension",aa.fillCircle=function(t,e,n,i,r){if(null==r&&(r=0),null!=Xs.gl){r<=0&&(r=Math.floor(10*Math.sqrt(i)));for(var s=2*Math.PI/r,a=Math.cos(s),o=Math.sin(s),l=i,u=0,h=0,_=r;h<_;){h++;var c=l+e,d=u+n,p=l;l=a*l-o*u,u=a*u+o*p,t.fillTriangle(c,d,l+e,u+n,e,n)}}else{t.fillCircle(e,n,i)}};var oa=w["kha.graphics2.ImageScaleQuality"]={__ename__:"kha.graphics2.ImageScaleQuality",__constructs__:["Low","High"],Low:{_hx_index:0,__enum__:"kha.graphics2.ImageScaleQuality",toString:i},High:{_hx_index:1,__enum__:"kha.graphics2.ImageScaleQuality",toString:i}},la=function(){};(n["kha.graphics2.truetype.VectorOfIntPointer"]=la).__name__="kha.graphics2.truetype.VectorOfIntPointer",la.prototype={value:null,__class__:la};var ua=function(){};(n["kha.graphics2.truetype.Stbtt_temp_rect"]=ua).__name__="kha.graphics2.truetype.Stbtt_temp_rect",ua.prototype={x0:null,y0:null,x1:null,y1:null,__class__:ua};var ha=function(){};(n["kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics"]=ha).__name__="kha.graphics2.truetype.Stbtt_temp_glyph_h_metrics",ha.prototype={advanceWidth:null,leftSideBearing:null,__class__:ha};var _a=function(){};(n["kha.graphics2.truetype.Stbtt_temp_font_v_metrics"]=_a).__name__="kha.graphics2.truetype.Stbtt_temp_font_v_metrics",_a.prototype={ascent:null,descent:null,lineGap:null,__class__:_a};var ca=function(){};(n["kha.graphics2.truetype.Stbtt_bakedchar"]=ca).__name__="kha.graphics2.truetype.Stbtt_bakedchar",ca.prototype={x0:null,y0:null,x1:null,y1:null,xoff:null,yoff:null,xadvance:null,__class__:ca};var da=function(){};(n["kha.graphics2.truetype.Stbtt_fontinfo"]=da).__name__="kha.graphics2.truetype.Stbtt_fontinfo",da.prototype={data:null,fontstart:null,numGlyphs:null,loca:null,head:null,glyf:null,hhea:null,hmtx:null,kern:null,index_map:null,indexToLocFormat:null,__class__:da};var pa=function(){};(n["kha.graphics2.truetype.Stbtt_vertex"]=pa).__name__="kha.graphics2.truetype.Stbtt_vertex",pa.prototype={x:null,y:null,cx:null,cy:null,type:null,__class__:pa};var ga=function(){};(n["kha.graphics2.truetype.Stbtt__bitmap"]=ga).__name__="kha.graphics2.truetype.Stbtt__bitmap",ga.prototype={w:null,h:null,stride:null,pixels:null,pixels_offset:null,__class__:ga};var fa=function(){};(n["kha.graphics2.truetype.Stbtt__edge"]=fa).__name__="kha.graphics2.truetype.Stbtt__edge",fa.prototype={x0:null,y0:null,x1:null,y1:null,invert:null,__class__:fa};var ma=function(){};(n["kha.graphics2.truetype.Stbtt__active_edge"]=ma).__name__="kha.graphics2.truetype.Stbtt__active_edge",ma.prototype={next:null,fx:null,fdx:null,fdy:null,direction:null,sy:null,ey:null,__class__:ma};var va=function(){};(n["kha.graphics2.truetype.Stbtt__point"]=va).__name__="kha.graphics2.truetype.Stbtt__point",va.prototype={x:null,y:null,__class__:va};var ya=function(){};(n["kha.graphics2.truetype.StbTruetype"]=ya).__name__="kha.graphics2.truetype.StbTruetype",ya.STBTT_assert=function(t){if(!t)throw new us("Error")},ya.ttBYTE=function(t,e){return null==e&&(e=0),t.readU8(e)},ya.ttCHAR=function(t,e){null==e&&(e=0);var n=t.readU8(e);return 128<=n?n-256:n},ya.ttUSHORT=function(t,e){null==e&&(e=0);var n=t.readU8(e);return t.readU8(e+1)|n<<8},ya.ttSHORT=function(t,e){null==e&&(e=0);var n=t.readU8(e),i=t.readU8(e+1)|n<<8;return 0!=(32768&i)?i-65536:i},ya.ttULONG=function(t,e){return null==e&&(e=0),ya.ttLONG(t,e)},ya.ttLONG=function(t,e){null==e&&(e=0);var n=t.readU8(e),i=t.readU8(e+1),r=t.readU8(e+2);return t.readU8(e+3)|r<<8|i<<16|n<<24},ya.stbtt_tag4=function(t,e,n,i,r,s){return t.readU8(e)==n&&t.readU8(e+1)==i&&t.readU8(e+2)==r&&t.readU8(e+3)==s},ya.stbtt_tag=function(t,e,n){return ya.stbtt_tag4(t,e,ut.cca(n,0),ut.cca(n,1),ut.cca(n,2),ut.cca(n,3))},ya.stbtt__find_table=function(t,e,n){for(var i=e+12,r=0,s=ya.ttUSHORT(t,e+4);r<s;){var a=i+16*r++;if(ya.stbtt_tag(t,a,n))return ya.ttULONG(t,a+8)}return 0},ya.stbtt_InitFont=function(t,e,n){t.data=e,t.fontstart=n;var i=ya.stbtt__find_table(e,n,"cmap");if(t.loca=ya.stbtt__find_table(e,n,"loca"),t.head=ya.stbtt__find_table(e,n,"head"),t.glyf=ya.stbtt__find_table(e,n,"glyf"),t.hhea=ya.stbtt__find_table(e,n,"hhea"),t.hmtx=ya.stbtt__find_table(e,n,"hmtx"),t.kern=ya.stbtt__find_table(e,n,"kern"),0==i||0==t.loca||0==t.head||0==t.glyf||0==t.hhea||0==t.hmtx)return!1;var r=ya.stbtt__find_table(e,n,"maxp");t.numGlyphs=0!=r?ya.ttUSHORT(e,r+4):65535;for(var s=ya.ttUSHORT(e,i+2),a=t.index_map=0,o=s;a<o;){var l=i+4+8*a++;switch(ya.ttUSHORT(e,l)){case 0:t.index_map=i+ya.ttULONG(e,l+4);break;case 3:switch(ya.ttUSHORT(e,l+2)){case 1:case 10:t.index_map=i+ya.ttULONG(e,l+4)}}}return 0!=t.index_map&&(t.indexToLocFormat=ya.ttUSHORT(e,t.head+50),!0)},ya.stbtt_FindGlyphIndex=function(t,e){var n=t.data,i=t.index_map,r=ya.ttUSHORT(n,i);if(0==r)return e<ya.ttUSHORT(n,i+2)-6?ya.ttBYTE(n,i+6+e):0;if(6==r){var s=ya.ttUSHORT(n,i+6),a=ya.ttUSHORT(n,i+8);return s<=e&&e<s+a?ya.ttUSHORT(n,i+10+2*(e-s)):0}if(2==r)return ya.STBTT_assert(!1),0;if(4==r){var o=ya.ttUSHORT(n,i+6)>>1,l=ya.ttUSHORT(n,i+8)>>1,u=ya.ttUSHORT(n,i+10),h=ya.ttUSHORT(n,i+12)>>1,_=i+14,c=_;if(65535<e)return 0;for(e>=ya.ttUSHORT(n,c+2*h)&&(c+=2*h),c-=2;0!=u;){l>>=1,ya.ttUSHORT(n,c+2*l)<e&&(c+=2*l),--u}var d=(c+=2)-_>>1;ya.STBTT_assert(e<=ya.ttUSHORT(n,_+2*d));var p=ya.ttUSHORT(n,i+14+2*o+2+2*d);if(e<p)return 0;var g=ya.ttUSHORT(n,i+14+6*o+2+2*d);return 0==g?e+ya.ttSHORT(n,i+14+4*o+2+2*d):ya.ttUSHORT(n,g+2*(e-p)+i+14+6*o+2+2*d)}if(12==r||13==r){for(var f=0,m=ya.ttULONG(n,i+12);f<m;){var v=f+(m-f>>1),y=ya.ttULONG(n,i+16+12*v),w=ya.ttULONG(n,i+16+12*v+4);if(e<y)m=v;else{if(!(w<e)){var b=ya.ttULONG(n,i+16+12*v+8);return 12==r?b+e-y:b}f=v+1}}return 0}return ya.STBTT_assert(!1),0},ya.stbtt_setvertex=function(t,e,n,i,r,s){t.type=e,t.x=n,t.y=i,t.cx=r,t.cy=s},ya.stbtt__GetGlyfOffset=function(t,e){var n,i;return e>=t.numGlyphs?-1:2<=t.indexToLocFormat?-1:(0==t.indexToLocFormat?(n=t.glyf+2*ya.ttUSHORT(t.data,t.loca+2*e),i=t.glyf+2*ya.ttUSHORT(t.data,t.loca+2*e+2)):(n=t.glyf+ya.ttULONG(t.data,t.loca+4*e),i=t.glyf+ya.ttULONG(t.data,t.loca+4*e+4)),n==i?-1:n)},ya.stbtt_GetGlyphBox=function(t,e,n){var i=ya.stbtt__GetGlyfOffset(t,e);return!(i<0)&&(n.x0=ya.ttSHORT(t.data,i+2),n.y0=ya.ttSHORT(t.data,i+4),n.x1=ya.ttSHORT(t.data,i+6),n.y1=ya.ttSHORT(t.data,i+8),!0)},ya.stbtt__close_shape=function(t,e,n,i,r,s,a,o,l,u){return i?(n&&ya.stbtt_setvertex(t[e++],3,l+a>>1,u+o>>1,l,u),ya.stbtt_setvertex(t[e++],3,r,s,a,o)):n?ya.stbtt_setvertex(t[e++],3,r,s,l,u):ya.stbtt_setvertex(t[e++],2,r,s,0,0),e},ya.copyVertices=function(t,e,n,i){for(var r=0,s=i;r<s;){var a=r++;e[n+a]=t[a]}},ya.stbtt_GetGlyphShape=function(t,e){var n,i=t.data,r=null,s=0,a=ya.stbtt__GetGlyfOffset(t,e);if(a<0)return null;var o=ya.ttSHORT(i,a);if(0<o){var l,u=0,h=0,_=0,c=!1,d=!1,p=0;n=i.sub(a+10,i.get_length()-(a+10));var g=ya.ttUSHORT(i,a+10+2*o),f=i.sub(a+10+2*o+2+g,i.get_length()-(a+10+2*o+2+g)),m=1+ya.ttUSHORT(n,2*o-2),v=m+2*o;if(null==(r=new Array(v)))return null;for(var y=0,w=r.length;y<w;){r[y++]=new pa}var b=_=0;l=v-m;for(var x=0,S=m;x<S;){var C=x++;0==b?0!=(8&(u=f.readU8(p++)))&&(b=f.readU8(p++)):--b,r[l+C].type=u}for(var k=0,I=0,T=m;I<T;){var N=I++;if(0!=(2&(u=r[l+N].type))){var M=f.readU8(p++);k+=0!=(16&u)?M:-M}else if(0==(16&u)){var O=f.readU8(p),E=f.readU8(p+1)|O<<8;k+=0!=(32768&E)?E-65536:E,p+=2}r[l+N].x=k}for(var A=0,B=0,L=m;B<L;){var F=B++;if(0!=(4&(u=r[l+F].type))){var W=f.readU8(p++);A+=0!=(32&u)?W:-W}else if(0==(32&u)){var R=f.readU8(p),D=f.readU8(p+1)|R<<8;A+=0!=(32768&D)?D-65536:D,p+=2}r[l+F].y=A}for(var G=s=0,V=G,H=V,P=H,z=P,Z=z,X=0;X<m;)u=r[l+X].type,k=r[l+X].x,A=r[l+X].y,_==X?(0!=X&&(s=ya.stbtt__close_shape(r,s,c,d,Z,z,V,G,P,H)),(d=0==(1&u))?(V=k,G=A,0==(1&r[l+X+1].type)?(Z=k+r[l+X+1].x>>1,z=A+r[l+X+1].y>>1):(Z=r[l+X+1].x,z=r[l+X+1].y,++X)):(Z=k,z=A),ya.stbtt_setvertex(r[s++],1,Z,z,0,0),c=!1,_=1+ya.ttUSHORT(n,2*h),++h):0==(1&u)?(c&&ya.stbtt_setvertex(r[s++],3,P+k>>1,H+A>>1,P,H),P=k,H=A,c=!0):(c?ya.stbtt_setvertex(r[s++],3,k,A,P,H):ya.stbtt_setvertex(r[s++],2,k,A,0,0),c=!1),++X;s=ya.stbtt__close_shape(r,s,c,d,Z,z,V,G,P,H)}else if(-1==o){var j=1,Y=i.sub(a+10,i.get_length()-(a+10)),U=0;for(s=0,r=null;0!=j;){var K,Q,J=null,q=1,$=0,tt=0,et=1,nt=0,it=0,rt=ya.ttSHORT(Y,U);U+=2;var st=ya.ttSHORT(Y,U);U+=2,0!=(2&rt)?0!=(1&rt)?(nt=ya.ttSHORT(Y,U),U+=2,it=ya.ttSHORT(Y,U),U+=2):(nt=ya.ttCHAR(Y,U),++U,it=ya.ttCHAR(Y,U),++U):ya.STBTT_assert(!1),0!=(8&rt)?(q=et=ya.ttSHORT(Y,U)/16384,U+=2,$=tt=0):0!=(64&rt)?(q=ya.ttSHORT(Y,U)/16384,U+=2,$=tt=0,et=ya.ttSHORT(Y,U)/16384,U+=2):0!=(128&rt)&&(q=ya.ttSHORT(Y,U)/16384,U+=2,$=ya.ttSHORT(Y,U)/16384,U+=2,tt=ya.ttSHORT(Y,U)/16384,U+=2,et=ya.ttSHORT(Y,U)/16384,U+=2);var at=Math.sqrt(q*q+$*$),ot=Math.sqrt(tt*tt+et*et);if(0<(K=null==(Q=ya.stbtt_GetGlyphShape(t,st))?0:Q.length)){for(var lt=0,ut=K;lt<ut;){var ht=Q[lt++],_t=ht.x,ct=ht.y;ht.x=pt.int(at*(q*_t+tt*ct+nt)),ht.y=pt.int(ot*($*_t+et*ct+it)),_t=ht.cx,ct=ht.cy,ht.cx=pt.int(at*(q*_t+tt*ct+nt)),ht.cy=pt.int(ot*($*_t+et*ct+it))}if(null==(J=new Array(s+K)))return null;0<s&&ya.copyVertices(r,J,0,s),ya.copyVertices(Q,J,s,K),r=J,s+=K}j=32&rt}}else o<0&&ya.STBTT_assert(!1);if(null==r)return null;if(ya.STBTT_assert(r.length>=s),s<r.length){var dt=new Array(s);return ya.copyVertices(r,dt,0,s),dt}return r},ya.stbtt_GetGlyphHMetrics=function(t,e){var n=ya.ttUSHORT(t.data,t.hhea+34),i=new ha;return e<n?(i.advanceWidth=ya.ttSHORT(t.data,t.hmtx+4*e),i.leftSideBearing=ya.ttSHORT(t.data,t.hmtx+4*e+2)):(i.advanceWidth=ya.ttSHORT(t.data,t.hmtx+4*(n-1)),i.leftSideBearing=ya.ttSHORT(t.data,t.hmtx+4*n+2*(e-n))),i},ya.stbtt_GetFontVMetrics=function(t){var e=new _a;return e.ascent=ya.ttSHORT(t.data,t.hhea+4),e.descent=ya.ttSHORT(t.data,t.hhea+6),e.lineGap=ya.ttSHORT(t.data,t.hhea+8),e},ya.stbtt_ScaleForPixelHeight=function(t,e){return e/(ya.ttSHORT(t.data,t.hhea+4)-ya.ttSHORT(t.data,t.hhea+6))},ya.stbtt_GetGlyphBitmapBoxSubpixel=function(t,e,n,i,r,s){var a=new ua;if(ya.stbtt_GetGlyphBox(t,e,a)){var o=a.x0,l=a.x1,u=a.y0,h=a.y1;a.x0=Math.floor(o*n+r),a.y0=Math.floor(-h*i+s),a.x1=Math.ceil(l*n+r),a.y1=Math.ceil(-u*i+s)}else a.x0=0,a.y0=0,a.x1=0,a.y1=0;return a},ya.stbtt_GetGlyphBitmapBox=function(t,e,n,i){return ya.stbtt_GetGlyphBitmapBoxSubpixel(t,e,n,i,0,0)},ya.stbtt__new_active=function(t,e,n,i){var r=new ma,s=(t[e].x1-t[e].x0)/(t[e].y1-t[e].y0);return null==r||(r.fdx=s,r.fdy=0!=s?1/s:0,r.fx=t[e].x0+s*(i-t[e].y0),r.fx-=n,r.direction=t[e].invert?1:-1,r.sy=t[e].y0,r.ey=t[e].y1,r.next=null),r},ya.stbtt__handle_clipped_edge=function(t,e,n,i,r,s,a,o){if(s!=o&&(ya.STBTT_assert(s<o),ya.STBTT_assert(i.sy<=i.ey),!(s>i.ey||o<i.sy)))if(s<i.sy&&(r+=(a-r)*(i.sy-s)/(o-s),s=i.sy),o>i.ey&&(a+=(a-r)*(i.ey-o)/(o-s),o=i.ey),r==n?ya.STBTT_assert(a<=n+1):r==n+1?ya.STBTT_assert(n<=a):r<=n?ya.STBTT_assert(a<=n):n+1<=r?ya.STBTT_assert(n+1<=a):ya.STBTT_assert(n<=a&&a<=n+1),r<=n&&a<=n){var l=e+n,u=t;u[l]=u[l]+i.direction*(o-s)}else if(!(n+1<=r&&n+1<=a)){ya.STBTT_assert(n<=r&&r<=n+1&&n<=a&&a<=n+1);var h=e+n,_=t;_[h]=_[h]+i.direction*(o-s)*(1-(r-n+(a-n))/2)}},ya.stbtt__fill_active_edges_new=function(t,e,n,i,r,s){for(var a=s+1;null!=r;){if(ya.STBTT_assert(r.ey>=s),0==r.fdx){var o=r.fx;o<i&&(0<=o?(ya.stbtt__handle_clipped_edge(t,0,pt.int(o),r,o,s,o,a),ya.stbtt__handle_clipped_edge(e,n-1,pt.int(o+1),r,o,s,o,a)):ya.stbtt__handle_clipped_edge(e,n-1,0,r,o,s,o,a))}else{var l,u,h,_,c=r.fx,d=r.fdx,p=c+d,g=r.fdy;if(ya.STBTT_assert(r.sy<=a&&r.ey>=s),r.sy>s?(l=c+d*(r.sy-s),h=r.sy):(l=c,h=s),r.ey<a?(u=c+d*(r.ey-s),_=r.ey):(u=p,_=a),0<=l&&0<=u&&l<i&&u<i)if(pt.int(l)==pt.int(u)){var f=pt.int(l),m=_-h;ya.STBTT_assert(0<=f&&f<i);var v=f,y=t;y[v]=y[v]+r.direction*(1-(l-f+(u-f))/2)*m;var w=n+f,b=e;b[w]=b[w]+r.direction*m}else{if(u<l){var x=h=a-(h-s);h=_=a-(_-s),_=x,x=u,u=l,l=x,d=-d,g=-g,x=c,c=p,p=x}var S=pt.int(l),C=pt.int(u),k=(S+1-c)*g+s,I=r.direction,T=I*(k-h),N=S,M=t;M[N]=M[N]+T*(1-(l-S+(S+1-S))/2);for(var O=I*g,E=S+1,A=C;E<A;){var B=E++,L=t;L[B]=L[B]+(T+O/2),T+=O}k+=g*(C-(S+1)),ya.STBTT_assert(Math.abs(T)<=1.01);var F=C,W=t;W[F]=W[F]+(T+I*(1-(C-C+(u-C))/2)*(_-k));var R=n+C,D=e;D[R]=D[R]+I*(_-h)}else for(var G=0,V=i;G<V;){var H=G++,P=s,z=H,Z=H+1,X=p,j=a,Y=(H-c)/d+s,U=(H+1-c)/d+s;c<z&&Z<X?(ya.stbtt__handle_clipped_edge(t,0,H,r,c,P,z,Y),ya.stbtt__handle_clipped_edge(t,0,H,r,z,Y,Z,U),ya.stbtt__handle_clipped_edge(t,0,H,r,Z,U,X,j)):X<z&&Z<c?(ya.stbtt__handle_clipped_edge(t,0,H,r,c,P,Z,U),ya.stbtt__handle_clipped_edge(t,0,H,r,Z,U,z,Y),ya.stbtt__handle_clipped_edge(t,0,H,r,z,Y,X,j)):c<z&&z<X?(ya.stbtt__handle_clipped_edge(t,0,H,r,c,P,z,Y),ya.stbtt__handle_clipped_edge(t,0,H,r,z,Y,X,j)):X<z&&z<c?(ya.stbtt__handle_clipped_edge(t,0,H,r,c,P,z,Y),ya.stbtt__handle_clipped_edge(t,0,H,r,z,Y,X,j)):c<Z&&Z<X?(ya.stbtt__handle_clipped_edge(t,0,H,r,c,P,Z,U),ya.stbtt__handle_clipped_edge(t,0,H,r,Z,U,X,j)):X<Z&&Z<c?(ya.stbtt__handle_clipped_edge(t,0,H,r,c,P,Z,U),ya.stbtt__handle_clipped_edge(t,0,H,r,Z,U,X,j)):ya.stbtt__handle_clipped_edge(t,0,H,r,c,P,X,j)}}r=r.next}},ya.stbtt__rasterize_sorted_edges=function(t,e,n,i,r,s){var a,o,l=null,u=0,h=0;64<t.w?a=new Array(2*t.w+1):a=new Array(129);var _=a;o=t.w;var c=s;for(e[h+n].y0=s+t.h+1;u<t.h;){for(var d=c+0,p=c+1,g=l,f=null,m=0,v=t.w;m<v;){a[m++]=0}for(var y=0,w=t.w+1;y<w;){_[o+y++]=0}for(;null!=g;){var b=g;b.ey<=d?(null==f?l=b.next:f.next=b.next,g=b.next,ya.STBTT_assert(0!=b.direction),b.direction=0):g=(f=g).next}for(;e[h].y0<=p;){if(e[h].y0!=e[h].y1){var x=ya.stbtt__new_active(e,h,r,d);ya.STBTT_assert(x.ey>=d),x.next=l,l=x}++h}null!=l&&ya.stbtt__fill_active_edges_new(a,_,o+1,t.w,l,d);for(var S=0,C=0,k=t.w;C<k;){var I=C++;S+=_[o+I];var T=a[I]+S;T=255*Math.abs(T)+.5;var N=pt.int(T);255<N&&(N=255),t.pixels.writeU8(t.pixels_offset+u*t.stride+I,N)}for(f=null,g=l;null!=g;){var M=g;M.fx+=M.fdx,g=(f=g).next}++c,++u}},ya.STBTT__COMPARE=function(t,e){return t.y0<e.y0},ya.stbtt__sort_edges_ins_sort=function(t,e){for(var n,i=1,r=e;i<r;){var s=i++,a=t[s],o=a;for(n=s;0<n;){var l=t[n-1];if(!ya.STBTT__COMPARE(o,l))break;t[n]=t[n-1],--n}s!=n&&(t[n]=a)}},ya.stbtt__sort_edges_quicksort=function(t,e,n){for(;12<n;){var i,r=n>>1,s=ya.STBTT__COMPARE(t[e],t[e+r]),a=ya.STBTT__COMPARE(t[e+r],t[e+n-1]);if(s!=a){var o=ya.STBTT__COMPARE(t[e],t[e+n-1])==a?0:n-1;i=t[e+o],t[e+o]=t[e+r],t[e+r]=i}i=t[e],t[e]=t[e+r],t[e+r]=i;for(var l=1,u=n-1;;){for(;ya.STBTT__COMPARE(t[e+l],t[e]);)++l;for(;ya.STBTT__COMPARE(t[e],t[e+u]);)--u;if(u<=l)break;i=t[e+l],t[e+l]=t[e+u],t[e+u]=i,++l,--u}u<n-l?(ya.stbtt__sort_edges_quicksort(t,e,u),e+=l,n-=l):(ya.stbtt__sort_edges_quicksort(t,e+l,n-l),n=u)}},ya.stbtt__sort_edges=function(t,e){ya.stbtt__sort_edges_quicksort(t,0,e),ya.stbtt__sort_edges_ins_sort(t,e)},ya.stbtt__rasterize=function(t,e,n,i,r,s,a,o,l,u,h){for(var _,c=h?-s:s,d=0,p=0,g=i;p<g;){d+=n[p++]}var f=new Array(d+1);if(null!=f){for(var m=0,v=f.length;m<v;){f[m++]=new fa}for(var y=d=0,w=0,b=i;w<b;){var x=w++,S=e,C=0+y;y+=n[x],_=n[x]-1;for(var k=0,I=n[x];k<I;){var T=k++,N=T,M=_;S[C+_].y!=S[C+T].y?(f[d].invert=!1,(h?S[C+_].y>S[C+T].y:S[C+_].y<S[C+T].y)&&(f[d].invert=!0,N=_,M=T),f[d].x0=S[C+N].x*r+a,f[d].y0=1*(S[C+N].y*c+o),f[d].x1=S[C+M].x*r+a,f[d].y1=1*(S[C+M].y*c+o),++d,_=T):_=T}}ya.stbtt__sort_edges(f,d),ya.stbtt__rasterize_sorted_edges(t,f,d,1,l,u)}},ya.stbtt__add_point=function(t,e,n,i){null!=t&&(t[e].x=n,t[e].y=i)},ya.stbtt__tesselate_curve=function(t,e,n,i,r,s,a,o,l,u){var h=(n+2*r+a)/4,_=(i+2*s+o)/4,c=(n+a)/2-h,d=(i+o)/2-_;return 16<u||(l<c*c+d*d?(ya.stbtt__tesselate_curve(t,e,n,i,(n+r)/2,(i+s)/2,h,_,l,u+1),ya.stbtt__tesselate_curve(t,e,h,_,(r+a)/2,(s+o)/2,a,o,l,u+1)):(ya.stbtt__add_point(t,e.value,a,o),e.value+=1)),1},ya.stbtt_FlattenCurves=function(t,e,n,i,r){for(var s=null,a=0,o=n*n,l=0,u=0,h=0,_=e;h<_;){1==t[h++].type&&++l}if(0==(r.value=l))return null;var c=new Array(l);if(i.value=c,null==i.value)return r.value=0,null;for(var d=0;d<2;){var p=0,g=0;if(1==d++){if(null==(s=new Array(a)))return i.value=null,r.value=0,null;for(var f=0,m=s.length;f<m;){s[f++]=new va}}l=-1;for(var v=a=0,y=e;v<y;){var w=v++;switch(t[w].type){case 1:0<=l&&(i.value[l]=a-u),++l,u=a,p=t[w].x,g=t[w].y,ya.stbtt__add_point(s,a++,p,g);break;case 2:p=t[w].x,g=t[w].y,ya.stbtt__add_point(s,a++,p,g);break;case 3:var b={value:a};ya.stbtt__tesselate_curve(s,b,p,g,t[w].cx,t[w].cy,t[w].x,t[w].y,o,0),a=b.value,p=t[w].x,g=t[w].y}}i.value[l]=a-u}return s},ya.stbtt_Rasterize=function(t,e,n,i,r,s,a,o,l,u,h){var _,c=s<r?s:r,d=0,p={value:d},g=new la,f=ya.stbtt_FlattenCurves(n,i,e/c,g,p);d=p.value,_=g.value,null!=f&&ya.stbtt__rasterize(t,f,_,d,r,s,a,o,l,u,h)},ya.stbtt_MakeGlyphBitmapSubpixel=function(t,e,n,i,r,s,a,o,l,u,h){var _,c,d=ya.stbtt_GetGlyphShape(t,h),p=null==d?0:d.length,g=new ga,f=ya.stbtt_GetGlyphBitmapBoxSubpixel(t,h,a,o,l,u);_=f.x0,c=f.y0,g.pixels=e,g.pixels_offset=n,g.w=i,g.h=r,g.stride=s,0!=g.w&&0!=g.h&&ya.stbtt_Rasterize(g,.35,d,p,a,o,l,u,_,c,!0)},ya.stbtt_MakeGlyphBitmap=function(t,e,n,i,r,s,a,o,l){ya.stbtt_MakeGlyphBitmapSubpixel(t,e,n,i,r,s,a,o,0,0,l)},ya.stbtt_BakeFontBitmap=function(t,e,n,i,r,s,a,o){var l=new da;if(!ya.stbtt_InitFont(l,t,e))return-1;for(var u=0,h=r*s;u<h;){var _=u++;i.writeU8(_,0)}for(var c=1,d=c,p=1,g=ya.stbtt_ScaleForPixelHeight(l,n),f=0,m=0;m<a.length;){var v=a[m];++m;var y=ya.stbtt_FindGlyphIndex(l,v),w=ya.stbtt_GetGlyphHMetrics(l,y),b=w.advanceWidth,x=(w.leftSideBearing,ya.stbtt_GetGlyphBitmapBox(l,y,g,g)),S=x.x0,C=x.y0,k=x.x1-S,I=x.y1-C;if(r<=d+k+1&&(c=p,d=1),s<=c+I+1)return-f;ya.STBTT_assert(d+k<r),ya.STBTT_assert(c+I<s),ya.stbtt_MakeGlyphBitmap(l,i,d+c*r,k,I,r,g,g,y),o[f].x0=d,o[f].y0=c,o[f].x1=d+k,o[f].y1=c+I,o[f].xadvance=g*b,o[f].xoff=S,o[f].yoff=C,d=d+k+1,p<c+I+1&&(p=c+I+1),++f}return p};var wa=w["kha.graphics4.BlendingFactor"]={__ename__:"kha.graphics4.BlendingFactor",__constructs__:["Undefined","BlendOne","BlendZero","SourceAlpha","DestinationAlpha","InverseSourceAlpha","InverseDestinationAlpha","SourceColor","DestinationColor","InverseSourceColor","InverseDestinationColor"],Undefined:{_hx_index:0,__enum__:"kha.graphics4.BlendingFactor",toString:i},BlendOne:{_hx_index:1,__enum__:"kha.graphics4.BlendingFactor",toString:i},BlendZero:{_hx_index:2,__enum__:"kha.graphics4.BlendingFactor",toString:i},SourceAlpha:{_hx_index:3,__enum__:"kha.graphics4.BlendingFactor",toString:i},DestinationAlpha:{_hx_index:4,__enum__:"kha.graphics4.BlendingFactor",toString:i},InverseSourceAlpha:{_hx_index:5,__enum__:"kha.graphics4.BlendingFactor",toString:i},InverseDestinationAlpha:{_hx_index:6,__enum__:"kha.graphics4.BlendingFactor",toString:i},SourceColor:{_hx_index:7,__enum__:"kha.graphics4.BlendingFactor",toString:i},DestinationColor:{_hx_index:8,__enum__:"kha.graphics4.BlendingFactor",toString:i},InverseSourceColor:{_hx_index:9,__enum__:"kha.graphics4.BlendingFactor",toString:i},InverseDestinationColor:{_hx_index:10,__enum__:"kha.graphics4.BlendingFactor",toString:i}},ba=w["kha.graphics4.BlendingOperation"]={__ename__:"kha.graphics4.BlendingOperation",__constructs__:["Add","Subtract","ReverseSubtract","Min","Max"],Add:{_hx_index:0,__enum__:"kha.graphics4.BlendingOperation",toString:i},Subtract:{_hx_index:1,__enum__:"kha.graphics4.BlendingOperation",toString:i},ReverseSubtract:{_hx_index:2,__enum__:"kha.graphics4.BlendingOperation",toString:i},Min:{_hx_index:3,__enum__:"kha.graphics4.BlendingOperation",toString:i},Max:{_hx_index:4,__enum__:"kha.graphics4.BlendingOperation",toString:i}},xa=w["kha.graphics4.CompareMode"]={__ename__:"kha.graphics4.CompareMode",__constructs__:["Always","Never","Equal","NotEqual","Less","LessEqual","Greater","GreaterEqual"],Always:{_hx_index:0,__enum__:"kha.graphics4.CompareMode",toString:i},Never:{_hx_index:1,__enum__:"kha.graphics4.CompareMode",toString:i},Equal:{_hx_index:2,__enum__:"kha.graphics4.CompareMode",toString:i},NotEqual:{_hx_index:3,__enum__:"kha.graphics4.CompareMode",toString:i},Less:{_hx_index:4,__enum__:"kha.graphics4.CompareMode",toString:i},LessEqual:{_hx_index:5,__enum__:"kha.graphics4.CompareMode",toString:i},Greater:{_hx_index:6,__enum__:"kha.graphics4.CompareMode",toString:i},GreaterEqual:{_hx_index:7,__enum__:"kha.graphics4.CompareMode",toString:i}},Sa=function(){};(n["kha.graphics4.ConstantLocation"]=Sa).__name__="kha.graphics4.ConstantLocation";var Ca=function(t,e,n,i){this.isDepthAttachment=!1,this.depthTexture=null,this.texture=null,this.frameBuffer=null,this.myWidth=t,this.myHeight=t,this.format=e,this.renderTarget=n,this.depthStencilFormat=i,n&&this.createTexture()};(n["kha.graphics4.CubeMap"]=Ca).__name__="kha.graphics4.CubeMap",Ca.__interfaces__=[bs,ws],Ca.prototype={myWidth:null,myHeight:null,format:null,renderTarget:null,depthStencilFormat:null,graphics4:null,frameBuffer:null,texture:null,depthTexture:null,isDepthAttachment:null,createTexture:function(){if(null!=Xs.gl){if(this.texture=Xs.gl.createTexture(),Xs.gl.bindTexture(34067,this.texture),Xs.gl.texParameteri(34067,10240,9729),Xs.gl.texParameteri(34067,10241,9729),Xs.gl.texParameteri(34067,10242,33071),Xs.gl.texParameteri(34067,10243,33071),this.renderTarget){switch(this.frameBuffer=Xs.gl.createFramebuffer(),Xs.gl.bindFramebuffer(36160,this.frameBuffer),this.format._hx_index){case 0:Xs.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null);break;case 2:Xs.gl.texImage2D(34069,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34070,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34071,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34072,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34073,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null),Xs.gl.texImage2D(34074,0,Xs.gl2?34836:6408,this.myWidth,this.myHeight,0,6408,5126,null);break;case 3:Xs.gl.texImage2D(34069,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34070,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34071,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34072,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34073,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texImage2D(34074,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null);break;case 4:Xs.gl.texImage2D(34069,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34070,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34071,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34072,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34073,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34074,0,Xs.gl2?34842:6408,this.myWidth,this.myHeight,0,6408,Xs.halfFloat.HALF_FLOAT_OES,null);break;case 5:Xs.gl.texImage2D(34069,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34070,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34071,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34072,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34073,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null),Xs.gl.texImage2D(34074,0,Xs.gl2?33326:6406,this.myWidth,this.myHeight,0,6406,5126,null);break;case 6:Xs.gl.texImage2D(34069,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34070,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34071,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34072,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34073,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null),Xs.gl.texImage2D(34074,0,Xs.gl2?33325:6406,this.myWidth,this.myHeight,0,6406,Xs.halfFloat.HALF_FLOAT_OES,null);break;default:Xs.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null)}if(this.format==za.DEPTH16&&(Xs.gl.texParameteri(34067,10240,9728),Xs.gl.texParameteri(34067,10241,9728),this.isDepthAttachment=!0,!Xs.gl2)){var t=Xs.gl.createTexture();Xs.gl.bindTexture(34067,t),Xs.gl.texImage2D(34069,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34069,t,0),Xs.gl.texImage2D(34070,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34070,t,0),Xs.gl.texImage2D(34071,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34071,t,0),Xs.gl.texImage2D(34072,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34072,t,0),Xs.gl.texImage2D(34073,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34073,t,0),Xs.gl.texImage2D(34074,0,6408,this.myWidth,this.myHeight,0,6408,5121,null),Xs.gl.framebufferTexture2D(36160,36064,34074,t,0),Xs.gl.bindTexture(34067,this.texture)}this.initDepthStencilBuffer(this.depthStencilFormat),Xs.gl.bindFramebuffer(36160,null)}Xs.gl.bindTexture(34067,null)}},initDepthStencilBuffer:function(t){switch(t){case 0:break;case 1:case 5:this.depthTexture=Xs.gl.createTexture(),Xs.gl.bindTexture(34067,this.depthTexture),1==t?Xs.gl.texImage2D(34067,0,Xs.gl2?33190:6402,this.myWidth,this.myHeight,0,6402,5125,null):Xs.gl.texImage2D(34067,0,Xs.gl2?33189:6402,this.myWidth,this.myHeight,0,6402,5123,null),Xs.gl.texParameteri(34067,10240,9728),Xs.gl.texParameteri(34067,10241,9728),Xs.gl.texParameteri(34067,10242,33071),Xs.gl.texParameteri(34067,10243,33071),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,36096,34067,this.depthTexture,0);break;case 2:case 3:case 4:this.depthTexture=Xs.gl.createTexture(),Xs.gl.bindTexture(34067,this.depthTexture),Xs.gl.texImage2D(34067,0,Xs.gl2?35056:34041,this.myWidth,this.myHeight,0,34041,Xs.depthTexture.UNSIGNED_INT_24_8_WEBGL,null),Xs.gl.texParameteri(34067,10240,9728),Xs.gl.texParameteri(34067,10241,9728),Xs.gl.texParameteri(34067,10242,33071),Xs.gl.texParameteri(34067,10243,33071),Xs.gl.bindFramebuffer(36160,this.frameBuffer),Xs.gl.framebufferTexture2D(36160,33306,34067,this.depthTexture,0)}},set:function(t){Xs.gl.activeTexture(33984+t),Xs.gl.bindTexture(34067,this.texture)},setDepth:function(t){Xs.gl.activeTexture(33984+t),Xs.gl.bindTexture(34067,this.depthTexture)},get_width:function(){return this.myWidth},get_height:function(){return this.myHeight},get_g4:function(){return null==this.graphics4&&(this.graphics4=new wo(this)),this.graphics4},__class__:Ca,__properties__:{get_g4:"get_g4",get_height:"get_height",get_width:"get_width"}};var ka=w["kha.graphics4.CullMode"]={__ename__:"kha.graphics4.CullMode",__constructs__:["Clockwise","CounterClockwise","None"],Clockwise:{_hx_index:0,__enum__:"kha.graphics4.CullMode",toString:i},CounterClockwise:{_hx_index:1,__enum__:"kha.graphics4.CullMode",toString:i},None:{_hx_index:2,__enum__:"kha.graphics4.CullMode",toString:i}},Ia=function(t,e){this.sources=[];for(var n=0;n<t.length;){var i=t[n];++n,this.sources.push(i.toString())}this.type=35632,this.shader=null,this.files=e};(n["kha.graphics4.FragmentShader"]=Ia).__name__="kha.graphics4.FragmentShader",Ia.fromSource=function(t){var e=new Ia([],["runtime-string"]);return e.sources.push(t),e},Ia.prototype={sources:null,type:null,shader:null,files:null,__class__:Ia};var Ta=function(){};(n["kha.graphics4.GeometryShader"]=Ta).__name__="kha.graphics4.GeometryShader";var Na=function(){};(n["kha.graphics4.Graphics"]=Na).__name__="kha.graphics4.Graphics",Na.prototype={begin:null,beginFace:null,end:null,clear:null,viewport:null,scissor:null,disableScissor:null,setVertexBuffer:null,setVertexBuffers:null,setIndexBuffer:null,setTexture:null,setTextureDepth:null,setImageTexture:null,setTextureParameters:null,setTexture3DParameters:null,setCubeMap:null,setCubeMapDepth:null,renderTargetsInvertedY:null,setPipeline:null,setBool:null,setInt:null,setFloat:null,setFloat2:null,setFloat3:null,setFloat4:null,setFloats:null,setMatrix:null,setMatrix3:null,drawIndexedVertices:null,drawIndexedVerticesInstanced:null,__class__:Na};var Ma=function(t){this.myPipeline=null,this.bilinearMipmaps=!1,this.bilinear=!1,this.g=t,Ma.bufferIndex=0,Ma.initShaders(),this.initBuffers(),this.projectionLocation=Ma.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Ma.shaderPipeline.getTextureUnit("tex")};(n["kha.graphics4.ImageShaderPainter"]=Ma).__name__="kha.graphics4.ImageShaderPainter",Ma.initShaders=function(){null==Ma.structure&&(Ma.structure=Aa.createImageVertexStructure()),null==Ma.shaderPipeline&&(Ma.shaderPipeline=Aa.createImagePipeline(Ma.structure),Ma.shaderPipeline.compile())},Ma.prototype={projectionMatrix:null,bilinear:null,bilinearMipmaps:null,g:null,myPipeline:null,projectionLocation:null,textureLocation:null,get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ma.rectVertexBuffer){Ma.rectVertexBuffer=new ja(6e3,Ma.structure,Xa.DynamicUsage),Ma.rectVertices=Ma.rectVertexBuffer.lock(),Ma.indexBuffer=new Ba(9e3,Xa.StaticUsage);for(var t=Ma.indexBuffer.lock(),e=0;e<1500;){var n=e++;t[3*n*2]=4*n,t[3*n*2+1]=4*n+1,t[3*n*2+2]=4*n+2,t[3*n*2+3]=4*n,t[3*n*2+4]=4*n+2,t[3*n*2+5]=4*n+3}Ma.indexBuffer.unlock()}},setRectVertices:function(t,e,n,i,r,s,a,o){var l=9*Ma.bufferIndex*4;Ma.rectVertices[l]=t,Ma.rectVertices[l+1]=e,Ma.rectVertices[l+2]=-5,Ma.rectVertices[l+9]=n,Ma.rectVertices[l+10]=i,Ma.rectVertices[l+11]=-5,Ma.rectVertices[l+18]=r,Ma.rectVertices[l+19]=s,Ma.rectVertices[l+20]=-5,Ma.rectVertices[l+27]=a,Ma.rectVertices[l+28]=o,Ma.rectVertices[l+29]=-5},setRectTexCoords:function(t,e,n,i){var r=9*Ma.bufferIndex*4;Ma.rectVertices[r+3]=t,Ma.rectVertices[r+4]=i,Ma.rectVertices[r+12]=t,Ma.rectVertices[r+13]=e,Ma.rectVertices[r+21]=n,Ma.rectVertices[r+22]=e,Ma.rectVertices[r+30]=n,Ma.rectVertices[r+31]=i},setRectColor:function(t,e,n,i){var r=9*Ma.bufferIndex*4;Ma.rectVertices[r+5]=t,Ma.rectVertices[r+6]=e,Ma.rectVertices[r+7]=n,Ma.rectVertices[r+8]=i,Ma.rectVertices[r+14]=t,Ma.rectVertices[r+15]=e,Ma.rectVertices[r+16]=n,Ma.rectVertices[r+17]=i,Ma.rectVertices[r+23]=t,Ma.rectVertices[r+24]=e,Ma.rectVertices[r+25]=n,Ma.rectVertices[r+26]=i,Ma.rectVertices[r+32]=t,Ma.rectVertices[r+33]=e,Ma.rectVertices[r+34]=n,Ma.rectVertices[r+35]=i},drawBuffer:function(){Ma.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Ma.rectVertexBuffer),this.g.setIndexBuffer(Ma.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ma.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,Ma.lastTexture),this.g.setTextureParameters(this.textureLocation,Ha.Clamp,Ha.Clamp,this.bilinear?Pa.LinearFilter:Pa.PointFilter,this.bilinear?Pa.LinearFilter:Pa.PointFilter,this.bilinearMipmaps?La.LinearMipFilter:La.NoMipFilter),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Ma.bufferIndex*3),this.g.setTexture(this.textureLocation,null),Ma.bufferIndex=0,Ma.rectVertices=Ma.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},drawImage:function(t,e,n,i,r,s,a,o,l,u,h){var _=t;(1500<=Ma.bufferIndex+1||null!=Ma.lastTexture&&_!=Ma.lastTexture)&&this.drawBuffer(),this.setRectColor(.00392156862745098*((16711680&h)>>>16),.00392156862745098*((65280&h)>>>8),.00392156862745098*(255&h),.00392156862745098*(h>>>24)*u),this.setRectTexCoords(0,0,_.get_width()/_.get_realWidth(),_.get_height()/_.get_realHeight()),this.setRectVertices(e,n,i,r,s,a,o,l),++Ma.bufferIndex,Ma.lastTexture=_},drawImage2:function(t,e,n,i,r,s,a,o,l,u,h,_,c,d,p){var g=t;(1500<=Ma.bufferIndex+1||null!=Ma.lastTexture&&g!=Ma.lastTexture)&&this.drawBuffer(),this.setRectTexCoords(e/g.get_realWidth(),n/g.get_realHeight(),(e+i)/g.get_realWidth(),(n+r)/g.get_realHeight()),this.setRectColor(.00392156862745098*((16711680&p)>>>16),.00392156862745098*((65280&p)>>>8),.00392156862745098*(255&p),.00392156862745098*(p>>>24)*d),this.setRectVertices(s,a,o,l,u,h,_,c),++Ma.bufferIndex,Ma.lastTexture=g},end:function(){0<Ma.bufferIndex&&this.drawBuffer(),Ma.lastTexture=null},__class__:Ma,__properties__:{get_pipeline:"get_pipeline"}};var Oa=function(t){this.myPipeline=null,this.g=t,Oa.bufferIndex=0,Oa.triangleBufferIndex=0,Oa.initShaders(),this.initBuffers(),this.projectionLocation=Oa.shaderPipeline.getConstantLocation("projectionMatrix")};(n["kha.graphics4.ColoredShaderPainter"]=Oa).__name__="kha.graphics4.ColoredShaderPainter",Oa.initShaders=function(){null==Oa.structure&&(Oa.structure=Aa.createColoredVertexStructure()),null==Oa.shaderPipeline&&(Oa.shaderPipeline=Aa.createColoredPipeline(Oa.structure),Oa.shaderPipeline.compile())},Oa.prototype={projectionMatrix:null,g:null,myPipeline:null,projectionLocation:null,get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Oa.rectVertexBuffer){Oa.rectVertexBuffer=new ja(400,Oa.structure,Xa.DynamicUsage),Oa.rectVertices=Oa.rectVertexBuffer.lock(),Oa.indexBuffer=new Ba(600,Xa.StaticUsage);for(var t=Oa.indexBuffer.lock(),e=0;e<100;){var n=e++;t[3*n*2]=4*n,t[3*n*2+1]=4*n+1,t[3*n*2+2]=4*n+2,t[3*n*2+3]=4*n,t[3*n*2+4]=4*n+2,t[3*n*2+5]=4*n+3}Oa.indexBuffer.unlock(),Oa.triangleVertexBuffer=new ja(300,Oa.structure,Xa.DynamicUsage),Oa.triangleVertices=Oa.triangleVertexBuffer.lock(),Oa.triangleIndexBuffer=new Ba(300,Xa.StaticUsage);for(var i=Oa.triangleIndexBuffer.lock(),r=0;r<100;){var s=r++;i[3*s]=3*s,i[3*s+1]=3*s+1,i[3*s+2]=3*s+2}Oa.triangleIndexBuffer.unlock()}},setRectVertices:function(t,e,n,i,r,s,a,o){var l=7*Oa.bufferIndex*4;Oa.rectVertices[l]=t,Oa.rectVertices[l+1]=e,Oa.rectVertices[l+2]=-5,Oa.rectVertices[l+7]=n,Oa.rectVertices[l+8]=i,Oa.rectVertices[l+9]=-5,Oa.rectVertices[l+14]=r,Oa.rectVertices[l+15]=s,Oa.rectVertices[l+16]=-5,Oa.rectVertices[l+21]=a,Oa.rectVertices[l+22]=o,Oa.rectVertices[l+23]=-5},setRectColors:function(t,e){var n=7*Oa.bufferIndex*4,i=t*(.00392156862745098*(e>>>24));Oa.rectVertices[n+3]=.00392156862745098*((16711680&e)>>>16),Oa.rectVertices[n+4]=.00392156862745098*((65280&e)>>>8),Oa.rectVertices[n+5]=.00392156862745098*(255&e),Oa.rectVertices[n+6]=i,Oa.rectVertices[n+10]=.00392156862745098*((16711680&e)>>>16),Oa.rectVertices[n+11]=.00392156862745098*((65280&e)>>>8),Oa.rectVertices[n+12]=.00392156862745098*(255&e),Oa.rectVertices[n+13]=i,Oa.rectVertices[n+17]=.00392156862745098*((16711680&e)>>>16),Oa.rectVertices[n+18]=.00392156862745098*((65280&e)>>>8),Oa.rectVertices[n+19]=.00392156862745098*(255&e),Oa.rectVertices[n+20]=i,Oa.rectVertices[n+24]=.00392156862745098*((16711680&e)>>>16),Oa.rectVertices[n+25]=.00392156862745098*((65280&e)>>>8),Oa.rectVertices[n+26]=.00392156862745098*(255&e),Oa.rectVertices[n+27]=i},setTriVertices:function(t,e,n,i,r,s){var a=7*Oa.triangleBufferIndex*3;Oa.triangleVertices[a]=t,Oa.triangleVertices[a+1]=e,Oa.triangleVertices[a+2]=-5,Oa.triangleVertices[a+7]=n,Oa.triangleVertices[a+8]=i,Oa.triangleVertices[a+9]=-5,Oa.triangleVertices[a+14]=r,Oa.triangleVertices[a+15]=s,Oa.triangleVertices[a+16]=-5},setTriColors:function(t,e){var n=7*Oa.triangleBufferIndex*3,i=t*(.00392156862745098*(e>>>24));Oa.triangleVertices[n+3]=.00392156862745098*((16711680&e)>>>16),Oa.triangleVertices[n+4]=.00392156862745098*((65280&e)>>>8),Oa.triangleVertices[n+5]=.00392156862745098*(255&e),Oa.triangleVertices[n+6]=i,Oa.triangleVertices[n+10]=.00392156862745098*((16711680&e)>>>16),Oa.triangleVertices[n+11]=.00392156862745098*((65280&e)>>>8),Oa.triangleVertices[n+12]=.00392156862745098*(255&e),Oa.triangleVertices[n+13]=i,Oa.triangleVertices[n+17]=.00392156862745098*((16711680&e)>>>16),Oa.triangleVertices[n+18]=.00392156862745098*((65280&e)>>>8),Oa.triangleVertices[n+19]=.00392156862745098*(255&e),Oa.triangleVertices[n+20]=i},drawBuffer:function(t){t||this.endTris(!0),Oa.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Oa.rectVertexBuffer),this.g.setIndexBuffer(Oa.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Oa.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,2*Oa.bufferIndex*3),Oa.bufferIndex=0,Oa.rectVertices=Oa.rectVertexBuffer.lock()},drawTriBuffer:function(t){t||this.endRects(!0),Oa.triangleVertexBuffer.unlock(),this.g.setVertexBuffer(Oa.triangleVertexBuffer),this.g.setIndexBuffer(Oa.triangleIndexBuffer),this.g.setPipeline(null==this.get_pipeline()?Oa.shaderPipeline:this.get_pipeline()),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.drawIndexedVertices(0,3*Oa.triangleBufferIndex),Oa.triangleBufferIndex=0,Oa.triangleVertices=Oa.triangleVertexBuffer.lock()},fillRect:function(t,e,n,i,r,s,a,o,l,u){0<Oa.triangleBufferIndex&&this.drawTriBuffer(!0),100<=Oa.bufferIndex+1&&this.drawBuffer(!1),this.setRectColors(t,e),this.setRectVertices(n,i,r,s,a,o,l,u),++Oa.bufferIndex},fillTriangle:function(t,e,n,i,r,s,a,o){0<Oa.bufferIndex&&this.drawBuffer(!0),100<=Oa.triangleBufferIndex+1&&this.drawTriBuffer(!1),this.setTriColors(t,e),this.setTriVertices(n,i,r,s,a,o),++Oa.triangleBufferIndex},endTris:function(t){0<Oa.triangleBufferIndex&&this.drawTriBuffer(t)},endRects:function(t){0<Oa.bufferIndex&&this.drawBuffer(t)},end:function(){this.endTris(!1),this.endRects(!1)},__class__:Oa,__properties__:{get_pipeline:"get_pipeline"}};var Ea=function(t){this.bakedQuadCache=new Os,this.bilinear=!1,this.myPipeline=null,this.g=t,Ea.bufferIndex=0,Ea.initShaders(),this.initBuffers(),this.projectionLocation=Ea.shaderPipeline.getConstantLocation("projectionMatrix"),this.textureLocation=Ea.shaderPipeline.getTextureUnit("tex")};(n["kha.graphics4.TextShaderPainter"]=Ea).__name__="kha.graphics4.TextShaderPainter",Ea.initShaders=function(){null==Ea.structure&&(Ea.structure=Aa.createTextVertexStructure()),null==Ea.shaderPipeline&&(Ea.shaderPipeline=Aa.createTextPipeline(Ea.structure),Ea.shaderPipeline.compile())},Ea.findIndex=function(t){ra.fontGlyphs;for(var e=Es.charBlocks,n=0,i=0,r=pt.int(e.length/2);i<r;){var s=i++,a=e[2*s],o=e[2*s+1];if(a<=t&&t<=o)return n+t-a;n+=o-a+1}return 0},Ea.prototype={projectionMatrix:null,font:null,g:null,myPipeline:null,projectionLocation:null,textureLocation:null,fontSize:null,bilinear:null,get_pipeline:function(){return this.myPipeline},setProjection:function(t){this.projectionMatrix=t},initBuffers:function(){if(null==Ea.rectVertexBuffer){Ea.rectVertexBuffer=new ja(400,Ea.structure,Xa.DynamicUsage),Ea.rectVertices=Ea.rectVertexBuffer.lock(),Ea.indexBuffer=new Ba(600,Xa.StaticUsage);for(var t=Ea.indexBuffer.lock(),e=0;e<100;){var n=e++;t[3*n*2]=4*n,t[3*n*2+1]=4*n+1,t[3*n*2+2]=4*n+2,t[3*n*2+3]=4*n,t[3*n*2+4]=4*n+2,t[3*n*2+5]=4*n+3}Ea.indexBuffer.unlock()}},setRectVertices:function(t,e,n,i,r,s,a,o){var l=9*Ea.bufferIndex*4;Ea.rectVertices[l]=t,Ea.rectVertices[l+1]=e,Ea.rectVertices[l+2]=-5,Ea.rectVertices[l+9]=n,Ea.rectVertices[l+10]=i,Ea.rectVertices[l+11]=-5,Ea.rectVertices[l+18]=r,Ea.rectVertices[l+19]=s,Ea.rectVertices[l+20]=-5,Ea.rectVertices[l+27]=a,Ea.rectVertices[l+28]=o,Ea.rectVertices[l+29]=-5},setRectTexCoords:function(t,e,n,i){var r=9*Ea.bufferIndex*4;Ea.rectVertices[r+3]=t,Ea.rectVertices[r+4]=i,Ea.rectVertices[r+12]=t,Ea.rectVertices[r+13]=e,Ea.rectVertices[r+21]=n,Ea.rectVertices[r+22]=e,Ea.rectVertices[r+30]=n,Ea.rectVertices[r+31]=i},setRectColors:function(t,e){var n=9*Ea.bufferIndex*4,i=t*(.00392156862745098*(e>>>24));Ea.rectVertices[n+5]=.00392156862745098*((16711680&e)>>>16),Ea.rectVertices[n+6]=.00392156862745098*((65280&e)>>>8),Ea.rectVertices[n+7]=.00392156862745098*(255&e),Ea.rectVertices[n+8]=i,Ea.rectVertices[n+14]=.00392156862745098*((16711680&e)>>>16),Ea.rectVertices[n+15]=.00392156862745098*((65280&e)>>>8),Ea.rectVertices[n+16]=.00392156862745098*(255&e),Ea.rectVertices[n+17]=i,Ea.rectVertices[n+23]=.00392156862745098*((16711680&e)>>>16),Ea.rectVertices[n+24]=.00392156862745098*((65280&e)>>>8),Ea.rectVertices[n+25]=.00392156862745098*(255&e),Ea.rectVertices[n+26]=i,Ea.rectVertices[n+32]=.00392156862745098*((16711680&e)>>>16),Ea.rectVertices[n+33]=.00392156862745098*((65280&e)>>>8),Ea.rectVertices[n+34]=.00392156862745098*(255&e),Ea.rectVertices[n+35]=i},drawBuffer:function(){Ea.rectVertexBuffer.unlock(),this.g.setVertexBuffer(Ea.rectVertexBuffer),this.g.setIndexBuffer(Ea.indexBuffer),this.g.setPipeline(null==this.get_pipeline()?Ea.shaderPipeline:this.get_pipeline()),this.g.setTexture(this.textureLocation,Ea.lastTexture),this.g.setMatrix(this.projectionLocation,this.projectionMatrix),this.g.setTextureParameters(this.textureLocation,Ha.Clamp,Ha.Clamp,this.bilinear?Pa.LinearFilter:Pa.PointFilter,this.bilinear?Pa.LinearFilter:Pa.PointFilter,La.NoMipFilter),this.g.drawIndexedVertices(0,2*Ea.bufferIndex*3),this.g.setTexture(this.textureLocation,null),Ea.bufferIndex=0,Ea.rectVertices=Ea.rectVertexBuffer.lock()},setBilinearFilter:function(t){this.end(),this.bilinear=t},setFont:function(t){this.font=hs.__cast(t,As)},text:null,startString:function(t){this.text=t},charCodeAt:function(t){return ut.cca(this.text,t)},stringLength:function(){return this.text.length},endString:function(){this.text=null},bakedQuadCache:null,drawString:function(t,e,n,i,r,s){var a=this.font._get(this.fontSize),o=a.getTexture();null!=Ea.lastTexture&&o!=Ea.lastTexture&&this.drawBuffer(),Ea.lastTexture=o;var l=i,u=r;this.startString(t);for(var h=0,_=this.stringLength();h<_;){var c=h++,d=a.getBakedQuad(this.bakedQuadCache,Ea.findIndex(this.charCodeAt(c)),l,u);if(null!=d){100<=Ea.bufferIndex+1&&this.drawBuffer(),this.setRectColors(e,n),this.setRectTexCoords(d.s0*o.get_width()/o.get_realWidth(),d.t0*o.get_height()/o.get_realHeight(),d.s1*o.get_width()/o.get_realWidth(),d.t1*o.get_height()/o.get_realHeight());var p=new ko(d.x0,d.y1),g=s._02*p.x+s._12*p.y+s._22,f=(s._00*p.x+s._10*p.y+s._20)/g,m=(s._01*p.x+s._11*p.y+s._21)/g,v=new ko(f,m),y=new ko(d.x0,d.y0),w=s._02*y.x+s._12*y.y+s._22,b=(s._00*y.x+s._10*y.y+s._20)/w,x=(s._01*y.x+s._11*y.y+s._21)/w,S=new ko(b,x),C=new ko(d.x1,d.y0),k=s._02*C.x+s._12*C.y+s._22,I=(s._00*C.x+s._10*C.y+s._20)/k,T=(s._01*C.x+s._11*C.y+s._21)/k,N=new ko(I,T),M=new ko(d.x1,d.y1),O=s._02*M.x+s._12*M.y+s._22,E=(s._00*M.x+s._10*M.y+s._20)/O,A=(s._01*M.x+s._11*M.y+s._21)/O,B=new ko(E,A);this.setRectVertices(v.x,v.y,S.x,S.y,N.x,N.y,B.x,B.y),l+=d.xadvance,++Ea.bufferIndex}}this.endString()},end:function(){0<Ea.bufferIndex&&this.drawBuffer(),Ea.lastTexture=null},__class__:Ea,__properties__:{get_pipeline:"get_pipeline"}};var Aa=function(t){this.myImageScaleQuality=oa.High,ra.call(this),this.set_color(-1),this.canvas=t,this.g=t.get_g4(),this.imagePainter=new Ma(this.g),this.coloredPainter=new Oa(this.g),this.textPainter=new Ea(this.g),this.textPainter.fontSize=this.get_fontSize(),this.projectionMatrix=new yi(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this.setProjection(),null==Aa.videoPipeline&&(Aa.videoPipeline=Aa.createImagePipeline(Aa.createImageVertexStructure()),Aa.videoPipeline.fragmentShader=Rs.painter_video_frag,Aa.videoPipeline.vertexShader=Rs.painter_video_vert,Aa.videoPipeline.compile())};(n["kha.graphics4.Graphics2"]=Aa).__name__="kha.graphics4.Graphics2",Aa.upperPowerOfTwo=function(t){return--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,++t},Aa.createImageVertexStructure=function(){var t=new Ka;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Aa.createImagePipeline=function(t){var e=new Wa;return e.fragmentShader=Rs.painter_image_frag,e.vertexShader=Rs.painter_image_vert,e.inputLayout=[t],e.blendSource=wa.BlendOne,e.blendDestination=wa.InverseSourceAlpha,e.alphaBlendSource=wa.BlendOne,e.alphaBlendDestination=wa.InverseSourceAlpha,e},Aa.createColoredVertexStructure=function(){var t=new Ka;return t.add("vertexPosition",2),t.add("vertexColor",3),t},Aa.createColoredPipeline=function(t){var e=new Wa;return e.fragmentShader=Rs.painter_colored_frag,e.vertexShader=Rs.painter_colored_vert,e.inputLayout=[t],e.blendSource=wa.SourceAlpha,e.blendDestination=wa.InverseSourceAlpha,e.alphaBlendSource=wa.SourceAlpha,e.alphaBlendDestination=wa.InverseSourceAlpha,e},Aa.createTextVertexStructure=function(){var t=new Ka;return t.add("vertexPosition",2),t.add("texPosition",1),t.add("vertexColor",3),t},Aa.createTextPipeline=function(t){var e=new Wa;return e.fragmentShader=Rs.painter_text_frag,e.vertexShader=Rs.painter_text_vert,e.inputLayout=[t],e.blendSource=wa.SourceAlpha,e.blendDestination=wa.InverseSourceAlpha,e.alphaBlendSource=wa.SourceAlpha,e.alphaBlendDestination=wa.InverseSourceAlpha,e},Aa.__super__=ra,Aa.prototype=r(ra.prototype,{myColor:null,myFont:null,projectionMatrix:null,imagePainter:null,coloredPainter:null,textPainter:null,canvas:null,g:null,setProjection:function(){var t=this.canvas.get_width(),e=this.canvas.get_height();if(this.canvas instanceof Ns){var n=this.projectionMatrix,i=yi.orthogonalProjection(0,t,e,0,.1,1e3);n._00=i._00,n._10=i._10,n._20=i._20,n._30=i._30,n._01=i._01,n._11=i._11,n._21=i._21,n._31=i._31,n._02=i._02,n._12=i._12,n._22=i._22,n._32=i._32,n._03=i._03,n._13=i._13,n._23=i._23,n._33=i._33}else if(xs.get_nonPow2Supported()||(t=Aa.upperPowerOfTwo(t),e=Aa.upperPowerOfTwo(e)),this.g.renderTargetsInvertedY()){var r=this.projectionMatrix,s=yi.orthogonalProjection(0,t,0,e,.1,1e3);r._00=s._00,r._10=s._10,r._20=s._20,r._30=s._30,r._01=s._01,r._11=s._11,r._21=s._21,r._31=s._31,r._02=s._02,r._12=s._12,r._22=s._22,r._32=s._32,r._03=s._03,r._13=s._13,r._23=s._23,r._33=s._33}else{var a=this.projectionMatrix,o=yi.orthogonalProjection(0,t,e,0,.1,1e3);a._00=o._00,a._10=o._10,a._20=o._20,a._30=o._30,a._01=o._01,a._11=o._11,a._21=o._21,a._31=o._31,a._02=o._02,a._12=o._12,a._22=o._22,a._32=o._32,a._03=o._03,a._13=o._13,a._23=o._23,a._33=o._33}this.imagePainter.setProjection(this.projectionMatrix),this.coloredPainter.setProjection(this.projectionMatrix),this.textPainter.setProjection(this.projectionMatrix)},drawImage:function(t,e,n){this.coloredPainter.end(),this.textPainter.end();var i=e+t.get_width(),r=n+t.get_height(),s=this.get_transformation(),a=new ko(e,r),o=s._02*a.x+s._12*a.y+s._22,l=(s._00*a.x+s._10*a.y+s._20)/o,u=(s._01*a.x+s._11*a.y+s._21)/o,h=new ko(l,u),_=this.get_transformation(),c=new ko(e,n),d=_._02*c.x+_._12*c.y+_._22,p=(_._00*c.x+_._10*c.y+_._20)/d,g=(_._01*c.x+_._11*c.y+_._21)/d,f=new ko(p,g),m=this.get_transformation(),v=new ko(i,n),y=m._02*v.x+m._12*v.y+m._22,w=(m._00*v.x+m._10*v.y+m._20)/y,b=(m._01*v.x+m._11*v.y+m._21)/y,x=new ko(w,b),S=this.get_transformation(),C=new ko(i,r),k=S._02*C.x+S._12*C.y+S._22,I=(S._00*C.x+S._10*C.y+S._20)/k,T=(S._01*C.x+S._11*C.y+S._21)/k,N=new ko(I,T);this.imagePainter.drawImage(t,h.x,h.y,f.x,f.y,x.x,x.y,N.x,N.y,this.get_opacity(),this.get_color())},drawScaledSubImage:function(t,e,n,i,r,s,a,o,l){this.coloredPainter.end(),this.textPainter.end();var u=this.get_transformation(),h=new ko(s,a+l),_=u._02*h.x+u._12*h.y+u._22,c=(u._00*h.x+u._10*h.y+u._20)/_,d=(u._01*h.x+u._11*h.y+u._21)/_,p=new ko(c,d),g=this.get_transformation(),f=new ko(s,a),m=g._02*f.x+g._12*f.y+g._22,v=(g._00*f.x+g._10*f.y+g._20)/m,y=(g._01*f.x+g._11*f.y+g._21)/m,w=new ko(v,y),b=this.get_transformation(),x=new ko(s+o,a),S=b._02*x.x+b._12*x.y+b._22,C=(b._00*x.x+b._10*x.y+b._20)/S,k=(b._01*x.x+b._11*x.y+b._21)/S,I=new ko(C,k),T=this.get_transformation(),N=new ko(s+o,a+l),M=T._02*N.x+T._12*N.y+T._22,O=(T._00*N.x+T._10*N.y+T._20)/M,E=(T._01*N.x+T._11*N.y+T._21)/M,A=new ko(O,E);this.imagePainter.drawImage2(t,e,n,i,r,p.x,p.y,w.x,w.y,I.x,I.y,A.x,A.y,this.get_opacity(),this.get_color())},get_color:function(){return this.myColor},set_color:function(t){return this.myColor=t},drawRect:function(t,e,n,i,r){null==r&&(r=1),this.imagePainter.end(),this.textPainter.end();var s=this.get_transformation(),a=new ko(t-r/2,e+r/2),o=s._02*a.x+s._12*a.y+s._22,l=(s._00*a.x+s._10*a.y+s._20)/o,u=(s._01*a.x+s._11*a.y+s._21)/o,h=new ko(l,u),_=this.get_transformation(),c=new ko(t-r/2,e-r/2),d=_._02*c.x+_._12*c.y+_._22,p=(_._00*c.x+_._10*c.y+_._20)/d,g=(_._01*c.x+_._11*c.y+_._21)/d,f=new ko(p,g),m=this.get_transformation(),v=new ko(t+n+r/2,e-r/2),y=m._02*v.x+m._12*v.y+m._22,w=(m._00*v.x+m._10*v.y+m._20)/y,b=(m._01*v.x+m._11*v.y+m._21)/y,x=new ko(w,b),S=this.get_transformation(),C=new ko(t+n+r/2,e+r/2),k=S._02*C.x+S._12*C.y+S._22,I=(S._00*C.x+S._10*C.y+S._20)/k,T=(S._01*C.x+S._11*C.y+S._21)/k,N=new ko(I,T);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h.x,h.y,f.x,f.y,x.x,x.y,N.x,N.y);var M=this.get_transformation(),O=new ko(t-r/2,e+i-r/2),E=M._02*O.x+M._12*O.y+M._22,A=(M._00*O.x+M._10*O.y+M._20)/E,B=(M._01*O.x+M._11*O.y+M._21)/E;h=new ko(A,B);var L=this.get_transformation(),F=new ko(t-r/2,e+r/2),W=L._02*F.x+L._12*F.y+L._22,R=(L._00*F.x+L._10*F.y+L._20)/W,D=(L._01*F.x+L._11*F.y+L._21)/W;f=new ko(R,D);var G=this.get_transformation(),V=new ko(t+r/2,e+r/2),H=G._02*V.x+G._12*V.y+G._22,P=(G._00*V.x+G._10*V.y+G._20)/H,z=(G._01*V.x+G._11*V.y+G._21)/H;x=new ko(P,z);var Z=this.get_transformation(),X=new ko(t+r/2,e+i-r/2),j=Z._02*X.x+Z._12*X.y+Z._22,Y=(Z._00*X.x+Z._10*X.y+Z._20)/j,U=(Z._01*X.x+Z._11*X.y+Z._21)/j;N=new ko(Y,U),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h.x,h.y,f.x,f.y,x.x,x.y,N.x,N.y);var K=this.get_transformation(),Q=new ko(t-r/2,e+i+r/2),J=K._02*Q.x+K._12*Q.y+K._22,q=(K._00*Q.x+K._10*Q.y+K._20)/J,$=(K._01*Q.x+K._11*Q.y+K._21)/J;h=new ko(q,$);var tt=this.get_transformation(),et=new ko(t-r/2,e+i-r/2),nt=tt._02*et.x+tt._12*et.y+tt._22,it=(tt._00*et.x+tt._10*et.y+tt._20)/nt,rt=(tt._01*et.x+tt._11*et.y+tt._21)/nt;f=new ko(it,rt);var st=this.get_transformation(),at=new ko(t+n+r/2,e+i-r/2),ot=st._02*at.x+st._12*at.y+st._22,lt=(st._00*at.x+st._10*at.y+st._20)/ot,ut=(st._01*at.x+st._11*at.y+st._21)/ot;x=new ko(lt,ut);var ht=this.get_transformation(),_t=new ko(t+n+r/2,e+i+r/2),ct=ht._02*_t.x+ht._12*_t.y+ht._22,dt=(ht._00*_t.x+ht._10*_t.y+ht._20)/ct,pt=(ht._01*_t.x+ht._11*_t.y+ht._21)/ct;N=new ko(dt,pt),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h.x,h.y,f.x,f.y,x.x,x.y,N.x,N.y);var gt=this.get_transformation(),ft=new ko(t+n-r/2,e+i-r/2),mt=gt._02*ft.x+gt._12*ft.y+gt._22,vt=(gt._00*ft.x+gt._10*ft.y+gt._20)/mt,yt=(gt._01*ft.x+gt._11*ft.y+gt._21)/mt;h=new ko(vt,yt);var wt=this.get_transformation(),bt=new ko(t+n-r/2,e+r/2),xt=wt._02*bt.x+wt._12*bt.y+wt._22,St=(wt._00*bt.x+wt._10*bt.y+wt._20)/xt,Ct=(wt._01*bt.x+wt._11*bt.y+wt._21)/xt;f=new ko(St,Ct);var kt=this.get_transformation(),It=new ko(t+n+r/2,e+r/2),Tt=kt._02*It.x+kt._12*It.y+kt._22,Nt=(kt._00*It.x+kt._10*It.y+kt._20)/Tt,Mt=(kt._01*It.x+kt._11*It.y+kt._21)/Tt;x=new ko(Nt,Mt);var Ot=this.get_transformation(),Et=new ko(t+n+r/2,e+i-r/2),At=Ot._02*Et.x+Ot._12*Et.y+Ot._22,Bt=(Ot._00*Et.x+Ot._10*Et.y+Ot._20)/At,Lt=(Ot._01*Et.x+Ot._11*Et.y+Ot._21)/At;N=new ko(Bt,Lt),this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),h.x,h.y,f.x,f.y,x.x,x.y,N.x,N.y)},fillRect:function(t,e,n,i){this.imagePainter.end(),this.textPainter.end();var r=this.get_transformation(),s=new ko(t,e+i),a=r._02*s.x+r._12*s.y+r._22,o=(r._00*s.x+r._10*s.y+r._20)/a,l=(r._01*s.x+r._11*s.y+r._21)/a,u=new ko(o,l),h=this.get_transformation(),_=new ko(t,e),c=h._02*_.x+h._12*_.y+h._22,d=(h._00*_.x+h._10*_.y+h._20)/c,p=(h._01*_.x+h._11*_.y+h._21)/c,g=new ko(d,p),f=this.get_transformation(),m=new ko(t+n,e),v=f._02*m.x+f._12*m.y+f._22,y=(f._00*m.x+f._10*m.y+f._20)/v,w=(f._01*m.x+f._11*m.y+f._21)/v,b=new ko(y,w),x=this.get_transformation(),S=new ko(t+n,e+i),C=x._02*S.x+x._12*S.y+x._22,k=(x._00*S.x+x._10*S.y+x._20)/C,I=(x._01*S.x+x._11*S.y+x._21)/C,T=new ko(k,I);this.coloredPainter.fillRect(this.get_opacity(),this.get_color(),u.x,u.y,g.x,g.y,b.x,b.y,T.x,T.y)},drawString:function(t,e,n){this.imagePainter.end(),this.coloredPainter.end(),this.textPainter.drawString(t,this.get_opacity(),this.get_color(),e,n,this.get_transformation())},get_font:function(){return this.myFont},set_font:function(t){return this.textPainter.setFont(t),this.myFont=t},set_fontSize:function(t){return ra.prototype.set_fontSize.call(this,this.textPainter.fontSize=t)},drawLine:function(t,e,n,i,r){var s;null==r&&(r=1),this.imagePainter.end(),this.textPainter.end(),(s=i==e?new ko(0,-1):new ko(1,-(n-t)/(i-e))).set_length(r);var a=new ko(t+.5*s.x,e+.5*s.y),o=new ko(n+.5*s.x,i+.5*s.y),l=new ko(a.x-s.x,a.y-s.y),u=new ko(o.x-s.x,o.y-s.y),h=this.get_transformation(),_=h._02*a.x+h._12*a.y+h._22,c=(h._00*a.x+h._10*a.y+h._20)/_,d=(h._01*a.x+h._11*a.y+h._21)/_;a=new ko(c,d);var p=this.get_transformation(),g=p._02*o.x+p._12*o.y+p._22,f=(p._00*o.x+p._10*o.y+p._20)/g,m=(p._01*o.x+p._11*o.y+p._21)/g;o=new ko(f,m);var v=this.get_transformation(),y=v._02*l.x+v._12*l.y+v._22,w=(v._00*l.x+v._10*l.y+v._20)/y,b=(v._01*l.x+v._11*l.y+v._21)/y;l=new ko(w,b);var x=this.get_transformation(),S=x._02*u.x+x._12*u.y+x._22,C=(x._00*u.x+x._10*u.y+x._20)/S,k=(x._01*u.x+x._11*u.y+x._21)/S;u=new ko(C,k),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),a.x,a.y,o.x,o.y,l.x,l.y),this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),l.x,l.y,o.x,o.y,u.x,u.y)},fillTriangle:function(t,e,n,i,r,s){this.imagePainter.end(),this.textPainter.end();var a=this.get_transformation(),o=new ko(t,e),l=a._02*o.x+a._12*o.y+a._22,u=(a._00*o.x+a._10*o.y+a._20)/l,h=(a._01*o.x+a._11*o.y+a._21)/l,_=new ko(u,h),c=this.get_transformation(),d=new ko(n,i),p=c._02*d.x+c._12*d.y+c._22,g=(c._00*d.x+c._10*d.y+c._20)/p,f=(c._01*d.x+c._11*d.y+c._21)/p,m=new ko(g,f),v=this.get_transformation(),y=new ko(r,s),w=v._02*y.x+v._12*y.y+v._22,b=(v._00*y.x+v._10*y.y+v._20)/w,x=(v._01*y.x+v._11*y.y+v._21)/w,S=new ko(b,x);this.coloredPainter.fillTriangle(this.get_opacity(),this.get_color(),_.x,_.y,m.x,m.y,S.x,S.y)},myImageScaleQuality:null,set_imageScaleQuality:function(t){return this.imagePainter.setBilinearFilter(t==oa.High),this.textPainter.setBilinearFilter(t==oa.High),this.myImageScaleQuality=t},begin:function(t,e){null==t&&(t=!0),this.g.begin(),t&&this.clear(e),this.setProjection()},clear:function(t){this.flush(),this.g.clear(null==t?-16777216:t)},flush:function(){this.imagePainter.end(),this.textPainter.end(),this.coloredPainter.end()},end:function(){this.flush(),this.g.end()},__class__:Aa});var Ba=function(t,e,n){null==n&&(n=!1),this.usage=e,this.mySize=t,this.buffer=Xs.gl.createBuffer();var i=new Uint32Array(t);this._data=i};(n["kha.graphics4.IndexBuffer"]=Ba).__name__="kha.graphics4.IndexBuffer",Ba.prototype={buffer:null,_data:null,mySize:null,usage:null,lock:function(t,e){return null==t&&(t=0),null==e&&(e=this.mySize),this._data.subarray(t,t+e)},unlock:function(){Xs.gl.bindBuffer(34963,this.buffer);var t=null==Xs.elementIndexUint?new Uint16Array(this._data):this._data;Xs.gl.bufferData(34963,t,this.usage==Xa.DynamicUsage?35048:35044)},set:function(){Xs.gl.bindBuffer(34963,this.buffer)},count:function(){return this.mySize},__class__:Ba};var La=w["kha.graphics4.MipMapFilter"]={__ename__:"kha.graphics4.MipMapFilter",__constructs__:["NoMipFilter","PointMipFilter","LinearMipFilter"],NoMipFilter:{_hx_index:0,__enum__:"kha.graphics4.MipMapFilter",toString:i},PointMipFilter:{_hx_index:1,__enum__:"kha.graphics4.MipMapFilter",toString:i},LinearMipFilter:{_hx_index:2,__enum__:"kha.graphics4.MipMapFilter",toString:i}},Fa=function(){this.inputLayout=null,this.vertexShader=null,this.fragmentShader=null,this.geometryShader=null,this.tessellationControlShader=null,this.tessellationEvaluationShader=null,this.cullMode=ka.None,this.depthWrite=!1,this.depthMode=xa.Always,this.stencilMode=xa.Always,this.stencilBothPass=Ra.Keep,this.stencilDepthFail=Ra.Keep,this.stencilFail=Ra.Keep,this.stencilReferenceValue=Da.Static(0),this.stencilReadMask=255,this.stencilWriteMask=255,this.blendSource=wa.BlendOne,this.blendDestination=wa.BlendZero,this.blendOperation=ba.Add,this.alphaBlendSource=wa.BlendOne,this.alphaBlendDestination=wa.BlendZero,this.alphaBlendOperation=ba.Add,this.colorWriteMasksRed=[],this.colorWriteMasksGreen=[],this.colorWriteMasksBlue=[],this.colorWriteMasksAlpha=[],this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksRed.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksGreen.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksBlue.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.colorWriteMasksAlpha.push(!0),this.conservativeRasterization=!1};(n["kha.graphics4.PipelineStateBase"]=Fa).__name__="kha.graphics4.PipelineStateBase",Fa.prototype={inputLayout:null,vertexShader:null,fragmentShader:null,geometryShader:null,tessellationControlShader:null,tessellationEvaluationShader:null,cullMode:null,depthWrite:null,depthMode:null,stencilMode:null,stencilBothPass:null,stencilDepthFail:null,stencilFail:null,stencilReferenceValue:null,stencilReadMask:null,stencilWriteMask:null,blendSource:null,blendDestination:null,blendOperation:null,alphaBlendSource:null,alphaBlendDestination:null,alphaBlendOperation:null,colorWriteMasksRed:null,colorWriteMasksGreen:null,colorWriteMasksBlue:null,colorWriteMasksAlpha:null,get_colorWriteMaskRed:function(){return this.colorWriteMasksRed[0]},set_colorWriteMaskRed:function(t){return this.colorWriteMasksRed[0]=t},get_colorWriteMaskGreen:function(){return this.colorWriteMasksGreen[0]},set_colorWriteMaskGreen:function(t){return this.colorWriteMasksGreen[0]=t},get_colorWriteMaskBlue:function(){return this.colorWriteMasksBlue[0]},set_colorWriteMaskBlue:function(t){return this.colorWriteMasksBlue[0]=t},get_colorWriteMaskAlpha:function(){return this.colorWriteMasksAlpha[0]},set_colorWriteMaskAlpha:function(t){return this.colorWriteMasksAlpha[0]=t},conservativeRasterization:null,__class__:Fa,__properties__:{set_colorWriteMaskAlpha:"set_colorWriteMaskAlpha",get_colorWriteMaskAlpha:"get_colorWriteMaskAlpha",set_colorWriteMaskBlue:"set_colorWriteMaskBlue",get_colorWriteMaskBlue:"get_colorWriteMaskBlue",set_colorWriteMaskGreen:"set_colorWriteMaskGreen",get_colorWriteMaskGreen:"get_colorWriteMaskGreen",set_colorWriteMaskRed:"set_colorWriteMaskRed",get_colorWriteMaskRed:"get_colorWriteMaskRed"}};var Wa=function(){this.program=null,Fa.call(this),this.textures=[],this.textureValues=[]};(n["kha.graphics4.PipelineState"]=Wa).__name__="kha.graphics4.PipelineState",Wa.__super__=Fa,Wa.prototype=r(Fa.prototype,{program:null,textures:null,textureValues:null,delete:function(){null!=this.program&&Xs.gl.deleteProgram(this.program)},compile:function(){null!=this.program&&Xs.gl.deleteProgram(this.program),this.program=Xs.gl.createProgram(),this.compileShader(this.vertexShader),this.compileShader(this.fragmentShader),Xs.gl.attachShader(this.program,this.vertexShader.shader),Xs.gl.attachShader(this.program,this.fragmentShader.shader);for(var t=0,e=0,n=this.inputLayout;e<n.length;){var i=n[e];++e;for(var r=0,s=i.elements;r<s.length;){var a=s[r];++r,Xs.gl.bindAttribLocation(this.program,t,a.name),4==a.data?t+=4:++t}}if(Xs.gl.linkProgram(this.program),!Xs.gl.getProgramParameter(this.program,35714))throw new us("Could not link the shader program:\n"+Xs.gl.getProgramInfoLog(this.program))},set:function(){Xs.gl.useProgram(this.program);for(var t=0,e=this.textureValues.length;t<e;){var n=t++;Xs.gl.uniform1i(this.textureValues[n],n)}Xs.gl.colorMask(this.get_colorWriteMaskRed(),this.get_colorWriteMaskGreen(),this.get_colorWriteMaskBlue(),this.get_colorWriteMaskAlpha())},compileShader:function(t){if(null==t.shader){for(var e=Xs.gl.createShader(t.type),n=0!=Xs.gl.getShaderPrecisionFormat(35632,36338).precision,i=t.files,r=0,s=i.length;r<s;){var a=r++;if(Xs.gl2){if(0<=i[a].indexOf("-webgl2")||0<=i[a].indexOf("runtime-string")){Xs.gl.shaderSource(e,t.sources[a]);break}}else{if(!n&&(0<=i[a].indexOf("-relaxed")||0<=i[a].indexOf("runtime-string"))){Xs.gl.shaderSource(e,t.sources[a]);break}if(n&&(i[a].indexOf("-relaxed")<0||0<=i[a].indexOf("runtime-string"))){Xs.gl.shaderSource(e,t.sources[a]);break}}}if(Xs.gl.compileShader(e),!Xs.gl.getShaderParameter(e,35713))throw new us("Could not compile shader:\n"+Xs.gl.getShaderInfoLog(e));t.shader=e}},getConstantLocation:function(t){var e=Xs.gl.getUniformLocation(this.program,t);null==e&&Ji.trace("Warning: Uniform "+t+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:92,className:"kha.graphics4.PipelineState",methodName:"getConstantLocation"});for(var n=5126,i=0,r=Xs.gl.getProgramParameter(this.program,35718);i<r;){var s=i++,a=Xs.gl.getActiveUniform(this.program,s);if(a.name==t||a.name==t+"[0]"){n=a.type;break}}return new yo(e,n)},getTextureUnit:function(t){var e=this.findTexture(t);if(e<0){var n=Xs.gl.getUniformLocation(this.program,t);null==n&&Ji.trace("Warning: Sampler "+t+" not found.",{fileName:"kha/graphics4/PipelineState.hx",lineNumber:111,className:"kha.graphics4.PipelineState",methodName:"getTextureUnit"}),e=this.textures.length,this.textureValues.push(n),this.textures.push(t)}return new xo(e)},findTexture:function(t){for(var e=0,n=this.textures.length;e<n;){var i=e++;if(this.textures[i]==t)return i}return-1},__class__:Wa});var Ra=w["kha.graphics4.StencilAction"]={__ename__:"kha.graphics4.StencilAction",__constructs__:["Keep","Zero","Replace","Increment","IncrementWrap","Decrement","DecrementWrap","Invert"],Keep:{_hx_index:0,__enum__:"kha.graphics4.StencilAction",toString:i},Zero:{_hx_index:1,__enum__:"kha.graphics4.StencilAction",toString:i},Replace:{_hx_index:2,__enum__:"kha.graphics4.StencilAction",toString:i},Increment:{_hx_index:3,__enum__:"kha.graphics4.StencilAction",toString:i},IncrementWrap:{_hx_index:4,__enum__:"kha.graphics4.StencilAction",toString:i},Decrement:{_hx_index:5,__enum__:"kha.graphics4.StencilAction",toString:i},DecrementWrap:{_hx_index:6,__enum__:"kha.graphics4.StencilAction",toString:i},Invert:{_hx_index:7,__enum__:"kha.graphics4.StencilAction",toString:i}},Da=w["kha.graphics4.StencilValue"]={__ename__:"kha.graphics4.StencilValue",__constructs__:["Dynamic","Static"],Dynamic:{_hx_index:0,__enum__:"kha.graphics4.StencilValue",toString:i},Static:(S=function(t){return{_hx_index:1,value:t,__enum__:"kha.graphics4.StencilValue",toString:i}},S.__params__=["value"],S)},Ga=function(){};(n["kha.graphics4.TessellationControlShader"]=Ga).__name__="kha.graphics4.TessellationControlShader";var Va=function(){};(n["kha.graphics4.TessellationEvaluationShader"]=Va).__name__="kha.graphics4.TessellationEvaluationShader";var Ha=w["kha.graphics4.TextureAddressing"]={__ename__:"kha.graphics4.TextureAddressing",__constructs__:["Repeat","Mirror","Clamp"],Repeat:{_hx_index:0,__enum__:"kha.graphics4.TextureAddressing",toString:i},Mirror:{_hx_index:1,__enum__:"kha.graphics4.TextureAddressing",toString:i},Clamp:{_hx_index:2,__enum__:"kha.graphics4.TextureAddressing",toString:i}},Pa=w["kha.graphics4.TextureFilter"]={__ename__:"kha.graphics4.TextureFilter",__constructs__:["PointFilter","LinearFilter","AnisotropicFilter"],PointFilter:{_hx_index:0,__enum__:"kha.graphics4.TextureFilter",toString:i},LinearFilter:{_hx_index:1,__enum__:"kha.graphics4.TextureFilter",toString:i},AnisotropicFilter:{_hx_index:2,__enum__:"kha.graphics4.TextureFilter",toString:i}},za=w["kha.graphics4.TextureFormat"]={__ename__:"kha.graphics4.TextureFormat",__constructs__:["RGBA32","L8","RGBA128","DEPTH16","RGBA64","A32","A16"],RGBA32:{_hx_index:0,__enum__:"kha.graphics4.TextureFormat",toString:i},L8:{_hx_index:1,__enum__:"kha.graphics4.TextureFormat",toString:i},RGBA128:{_hx_index:2,__enum__:"kha.graphics4.TextureFormat",toString:i},DEPTH16:{_hx_index:3,__enum__:"kha.graphics4.TextureFormat",toString:i},RGBA64:{_hx_index:4,__enum__:"kha.graphics4.TextureFormat",toString:i},A32:{_hx_index:5,__enum__:"kha.graphics4.TextureFormat",toString:i},A16:{_hx_index:6,__enum__:"kha.graphics4.TextureFormat",toString:i}},Za=function(){};(n["kha.graphics4.TextureUnit"]=Za).__name__="kha.graphics4.TextureUnit";var Xa=w["kha.graphics4.Usage"]={__ename__:"kha.graphics4.Usage",__constructs__:["StaticUsage","DynamicUsage","ReadableUsage"],StaticUsage:{_hx_index:0,__enum__:"kha.graphics4.Usage",toString:i},DynamicUsage:{_hx_index:1,__enum__:"kha.graphics4.Usage",toString:i},ReadableUsage:{_hx_index:2,__enum__:"kha.graphics4.Usage",toString:i}},ja=function(t,e,n,i,r){null==r&&(r=!1),null==i&&(i=0),this.usage=n,this.instanceDataStepRate=i,this.mySize=t;for(var s=this.myStride=0,a=e.elements;s<a.length;){var o=a[s];switch(++s,o.data){case 0:this.myStride+=4;break;case 1:this.myStride+=8;break;case 2:this.myStride+=12;break;case 3:this.myStride+=16;break;case 4:this.myStride+=64}}this.buffer=Xs.gl.createBuffer();var l=new Float32Array(pt.int(t*this.myStride/4));this._data=l,this.sizes=[],this.offsets=[],this.sizes[e.elements.length-1]=0;for(var u=this.offsets[e.elements.length-1]=0,h=0,_=0,c=e.elements;_<c.length;){var d,p=c[_];switch(++_,p.data){case 0:d=1;break;case 1:d=2;break;case 2:d=3;break;case 3:d=4;break;case 4:d=16}switch(this.sizes[h]=d,this.offsets[h]=u,p.data){case 0:u+=4;break;case 1:u+=8;break;case 2:u+=12;break;case 3:u+=16;break;case 4:u+=64}++h}};(n["kha.graphics4.VertexBuffer"]=ja).__name__="kha.graphics4.VertexBuffer",ja.prototype={buffer:null,_data:null,mySize:null,myStride:null,sizes:null,offsets:null,usage:null,instanceDataStepRate:null,lock:function(t,e){return null==t&&(t=0),null==e&&(e=this.mySize),this._data.subarray(t*this.stride(),(t+e)*this.stride())},unlock:function(){Xs.gl.bindBuffer(34962,this.buffer),Xs.gl.bufferData(34962,this._data,this.usage==Xa.DynamicUsage?35048:35044)},stride:function(){return this.myStride},set:function(t){var e=!!Xs.gl2||Xs.gl.getExtension("ANGLE_instanced_arrays");Xs.gl.bindBuffer(34962,this.buffer);for(var n=0,i=0,r=this.sizes.length;i<r;){var s=i++;if(4<this.sizes[s])for(var a=this.sizes[s],o=0;0<a;)Xs.gl.enableVertexAttribArray(t+n),Xs.gl.vertexAttribPointer(t+n,4,5126,!1,this.myStride,this.offsets[s]+o),e&&(Xs.gl2?Xs.gl.vertexAttribDivisor(t+n,this.instanceDataStepRate):e.vertexAttribDivisorANGLE(t+n,this.instanceDataStepRate)),a-=4,o+=16,++n;else Xs.gl.enableVertexAttribArray(t+n),Xs.gl.vertexAttribPointer(t+n,this.sizes[s],5126,!1,this.myStride,this.offsets[s]),e&&(Xs.gl2?Xs.gl.vertexAttribDivisor(t+n,this.instanceDataStepRate):e.vertexAttribDivisorANGLE(t+n,this.instanceDataStepRate)),++n}return n},__class__:ja};var Ya=function(t,e){this.name=t,this.data=e};(n["kha.graphics4.VertexElement"]=Ya).__name__="kha.graphics4.VertexElement",Ya.prototype={name:null,data:null,__class__:Ya};var Ua=function(t,e){this.sources=[];for(var n=0;n<t.length;){var i=t[n];++n,this.sources.push(i.toString())}this.type=35633,this.shader=null,this.files=e};(n["kha.graphics4.VertexShader"]=Ua).__name__="kha.graphics4.VertexShader",Ua.fromSource=function(t){var e=new Ua([],["runtime-string"]);return e.sources.push(t),e},Ua.prototype={sources:null,type:null,shader:null,files:null,__class__:Ua};var Ka=function(){this.elements=[],this.instanced=!1};(n["kha.graphics4.VertexStructure"]=Ka).__name__="kha.graphics4.VertexStructure",Ka.prototype={elements:null,instanced:null,add:function(t,e){this.elements.push(new Ya(t,e))},size:function(){return this.elements.length},byteSize:function(){for(var t=0,e=0,n=this.elements.length;e<n;){var i=e++;t+=this.dataByteSize(this.elements[i].data)}return t},dataByteSize:function(t){switch(t){case 0:return 4;case 1:return 8;case 2:return 12;case 3:return 16;case 4:return 64}},get:function(t){return this.elements[t]},__class__:Ka};var Qa=function(){};(n["kha.graphics5.Graphics"]=Qa).__name__="kha.graphics5.Graphics";var Ja=t.kha.input.Gamepad=function(t,e){null==e&&(e="unknown"),null==t&&(t=0),this.index=t,this.axisListeners=[],this.buttonListeners=[],Ja.instances[t]=this};(n["kha.input.Gamepad"]=Ja).__name__="kha.input.Gamepad",Ja.get=function(t){return null==t&&(t=0),t>=Ja.instances.length?null:Ja.instances[t]},Ja.sendConnectEvent=function(t){Ja.instances[t].connected=!0;for(var e=0,n=Ja.connectListeners;e<n.length;){var i=n[e];++e,i(t)}},Ja.sendDisconnectEvent=function(t){Ja.instances[t].connected=!1;for(var e=0,n=Ja.disconnectListeners;e<n.length;){var i=n[e];++e,i(t)}},Ja.prototype={index:null,notify:function(t,e){null!=t&&this.axisListeners.push(t),null!=e&&this.buttonListeners.push(e)},axisListeners:null,buttonListeners:null,connected:null,sendAxisEvent:function(t,e){for(var n=0,i=this.axisListeners;n<i.length;){var r=i[n];++n,r(t,e)}},sendButtonEvent:function(t,e){for(var n=0,i=this.buttonListeners;n<i.length;){var r=i[n];++n,r(t,e)}},__class__:Ja};var qa=function(){this.__id=Io.nextId++,this._inputBuffer=er.alloc(1)};(n["kha.netsync.Controller"]=qa).__name__="kha.netsync.Controller",qa.prototype={__id:null,_inputBufferIndex:null,_inputBuffer:null,_id:function(){return this.__id},__class__:qa};var $a=t.kha.input.Keyboard=function(){qa.call(this),this.downListeners=[],this.upListeners=[],this.pressListeners=[],$a.instance=this};(n["kha.input.Keyboard"]=$a).__name__="kha.input.Keyboard",$a.get=function(t){return null==t&&(t=0),Xs.getKeyboard(t)},$a.__super__=qa,$a.prototype=r(qa.prototype,{notify:function(t,e,n){null!=t&&this.downListeners.push(t),null!=e&&this.upListeners.push(e),null!=n&&this.pressListeners.push(n)},show:function(){},hide:function(){},downListeners:null,upListeners:null,pressListeners:null,sendDownEvent:function(t){if(null!=To.the()){var e=er.alloc(5);e.setInt32(0,0),e.set(4,t),To.the().sendControllerUpdate(this._id(),e)}for(var n=0,i=this.downListeners;n<i.length;){var r=i[n];++n,r(t)}},sendUpEvent:function(t){if(null!=To.the()){var e=er.alloc(5);e.setInt32(0,1),e.set(4,t),To.the().sendControllerUpdate(this._id(),e)}for(var n=0,i=this.upListeners;n<i.length;){var r=i[n];++n,r(t)}},sendPressEvent:function(t){if(null!=To.the()){var e=er.alloc(5);e.setInt32(0,2),e.set(4,ut.cca(t,0)),To.the().sendControllerUpdate(this._id(),e)}for(var n=0,i=this.pressListeners;n<i.length;){var r=i[n];++n,r(t)}},__class__:$a});var to=t.kha.input.Mouse=function(){qa.call(this),to.instance=this};(n["kha.input.Mouse"]=to).__name__="kha.input.Mouse",to.get=function(t){return null==t&&(t=0),Xs.getMouse(t)},to.__super__=qa,to.prototype=r(qa.prototype,{notify:function(t,e,n,i,r){this.notifyWindowed(0,t,e,n,i,r)},notifyWindowed:function(t,e,n,i,r,s){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=n){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(n)}if(null!=i){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(i)}if(null!=r){for(null==this.windowWheelListeners&&(this.windowWheelListeners=[]);this.windowWheelListeners.length<=t;)this.windowWheelListeners.push([]);this.windowWheelListeners[t].push(r)}if(null!=s){for(null==this.windowLeaveListeners&&(this.windowLeaveListeners=[]);this.windowLeaveListeners.length<=t;)this.windowLeaveListeners.push([]);this.windowLeaveListeners[t].push(s)}},lock:function(){},unlock:function(){},canLock:function(){return!1},hideSystemCursor:function(){},showSystemCursor:function(){},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,windowWheelListeners:null,windowLeaveListeners:null,sendLeaveEvent:function(t){if(null!=To.the()){var e=er.alloc(8);e.setInt32(0,0),e.setInt32(4,t),To.the().sendControllerUpdate(this._id(),e)}if(null!=this.windowLeaveListeners)for(var n=0,i=this.windowLeaveListeners[t];n<i.length;){var r=i[n];++n,r()}},sendDownEvent:function(t,e,n,i){if(null!=To.the()){var r=er.alloc(20);r.setInt32(0,1),r.setInt32(4,t),r.setInt32(8,e),r.setInt32(12,n),r.setInt32(16,i),To.the().sendControllerUpdate(this._id(),r)}if(null!=this.windowDownListeners)for(var s=0,a=this.windowDownListeners[t];s<a.length;){var o=a[s];++s,o(e,n,i)}},sendUpEvent:function(t,e,n,i){if(null!=To.the()){var r=er.alloc(20);r.setInt32(0,2),r.setInt32(4,t),r.setInt32(8,e),r.setInt32(12,n),r.setInt32(16,i),To.the().sendControllerUpdate(this._id(),r)}if(null!=this.windowUpListeners)for(var s=0,a=this.windowUpListeners[t];s<a.length;){var o=a[s];++s,o(e,n,i)}},sendMoveEvent:function(t,e,n,i,r){if(null!=To.the()){var s=er.alloc(24);s.setInt32(0,3),s.setInt32(4,t),s.setInt32(8,e),s.setInt32(12,n),s.setInt32(16,i),s.setInt32(20,r),To.the().sendControllerUpdate(this._id(),s)}if(null!=this.windowMoveListeners)for(var a=0,o=this.windowMoveListeners[t];a<o.length;){var l=o[a];++a,l(e,n,i,r)}},sendWheelEvent:function(t,e){if(null!=To.the()){var n=er.alloc(12);n.setInt32(0,4),n.setInt32(4,t),n.setInt32(8,e),To.the().sendControllerUpdate(this._id(),n)}if(null!=this.windowWheelListeners)for(var i=0,r=this.windowWheelListeners[t];i<r.length;){var s=r[i];++i,s(e)}},__class__:to});var eo=function(){to.call(this)};(n["kha.input.MouseImpl"]=eo).__name__="kha.input.MouseImpl",eo.__super__=to,eo.prototype=r(to.prototype,{lock:function(){Xs.lockMouse()},unlock:function(){Xs.unlockMouse()},canLock:function(){return Xs.canLockMouse()},hideSystemCursor:function(){Xs.khanvas.style.cursor="none"},showSystemCursor:function(){Xs.khanvas.style.cursor="default"},__class__:eo});var no=function(){no.instance=this};(n["kha.input.Pen"]=no).__name__="kha.input.Pen",no.get=function(t){return null==t&&(t=0),Xs.getPen(t)},no.prototype={notify:function(t,e,n){this.notifyWindowed(0,t,e,n)},notifyWindowed:function(t,e,n,i){if(null!=e){for(null==this.windowDownListeners&&(this.windowDownListeners=[]);this.windowDownListeners.length<=t;)this.windowDownListeners.push([]);this.windowDownListeners[t].push(e)}if(null!=n){for(null==this.windowUpListeners&&(this.windowUpListeners=[]);this.windowUpListeners.length<=t;)this.windowUpListeners.push([]);this.windowUpListeners[t].push(n)}if(null!=i){for(null==this.windowMoveListeners&&(this.windowMoveListeners=[]);this.windowMoveListeners.length<=t;)this.windowMoveListeners.push([]);this.windowMoveListeners[t].push(i)}},windowDownListeners:null,windowUpListeners:null,windowMoveListeners:null,__class__:no};var io=function(){this.listeners=[]};(n["kha.input.Sensor"]=io).__name__="kha.input.Sensor",io.get=function(t){switch(t._hx_index){case 0:return io.accelerometer;case 1:return io.gyroscope}},io._changed=function(t,e,n,i){for(var r=0,s=io.get(0==t?ro.Accelerometer:ro.Gyroscope).listeners;r<s.length;){var a=s[r];++r,a(e,n,i)}},io.prototype={listeners:null,notify:function(t){this.listeners.push(t)},__class__:io};var ro=w["kha.input.SensorType"]={__ename__:"kha.input.SensorType",__constructs__:["Accelerometer","Gyroscope"],Accelerometer:{_hx_index:0,__enum__:"kha.input.SensorType",toString:i},Gyroscope:{_hx_index:1,__enum__:"kha.input.SensorType",toString:i}},so=t.kha.input.Surface=function(){this.touchStartListeners=[],this.touchEndListeners=[],this.moveListeners=[],so.instance=this};(n["kha.input.Surface"]=so).__name__="kha.input.Surface",so.prototype={touchStartListeners:null,touchEndListeners:null,moveListeners:null,sendTouchStartEvent:function(t,e,n){for(var i=0,r=this.touchStartListeners;i<r.length;){var s=r[i];++i,s(t,e,n)}},sendTouchEndEvent:function(t,e,n){for(var i=0,r=this.touchEndListeners;i<r.length;){var s=r[i];++i,s(t,e,n)}},sendMoveEvent:function(t,e,n){for(var i=0,r=this.moveListeners;i<r.length;){var s=r[i];++i,s(t,e,n)}},__class__:so};var ao=function(t){this.bytes=t};(n["kha.internal.BytesBlob"]=ao).__name__="kha.internal.BytesBlob",ao.__interfaces__=[bs],ao.fromBytes=function(t){return new ao(t)},ao.alloc=function(t){return new ao(er.alloc(t))},ao.readF32=function(t){var e=0==(-2147483648&t)?1:-1,n=t>>23&255,i=8388607&t;switch(n){case 0:return 0;case 255:return 0!=i?NaN:0<e?1/0:-1/0;default:return e*((i+8388608)/8388608)*Math.pow(2,n-127)}},ao.bit=function(t,e){if(1==(t>>>e&1)){return 0,!0}return 0,!1},ao.toText=function(t,e){for(var n="",i=0,r=e;i<r;){var s=i++;n+=String.fromCodePoint(t[s])}return n},ao.prototype={bytes:null,sub:function(t,e){return new ao(this.bytes.sub(t,e))},length:null,get_length:function(){return this.bytes.length},writeU8:function(t,e){this.bytes.set(t,e)},readU8:function(t){var e=this.bytes.get(t);return++t,e},readS8:function(t){var e=this.bytes.get(t);return++t,(0==(128&e)?1:-1)*(e&=127)},readU16BE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1);return t+=2,256*e+n},readU16LE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1);return t+=2,256*n+e},readU32LE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=this.bytes.get(t+2),r=this.bytes.get(t+3);return t+=4,e+256*n+256*i*256+256*r*256*256},readU32BE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=this.bytes.get(t+2),r=this.bytes.get(t+3);return t+=4,r+256*i+256*n*256+256*e*256*256},readS16BE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1);t+=2;var i=0==(128&e)?1:-1;return e&=127,-1==i?256*e-32767+n:256*e+n},readS16LE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=0==(128&n)?1:-1;return n&=127,t+=2,-1==i?256*n-32767+e:256*n+e},readS32LE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=this.bytes.get(t+2),r=this.bytes.get(t+3),s=0==(128&r)?1:-1;return r&=127,t+=4,-1==s?-2147483647+e+256*n+256*i*256+256*r*256*256:e+256*n+256*i*256+256*r*256*256},readS32BE:function(t){var e=this.bytes.get(t),n=this.bytes.get(t+1),i=this.bytes.get(t+2),r=this.bytes.get(t+3),s=0==(128&e)?1:-1;return e&=127,t+=4,-1==s?-2147483647+r+256*i+256*n*256+256*e*256*256:r+256*i+256*n*256+256*e*256*256},readF32LE:function(t){return ao.readF32(this.readS32LE(t))},readF32BE:function(t){return ao.readF32(this.readS32BE(t))},toString:function(){return this.bytes.toString()},readUtf8Char:function(t){if(t.value>=this.get_length())return-1;var e=this.readU8(t.value);++t.value;var n=0;if(ao.bit(e,7))if(ao.bit(e,7)&&ao.bit(e,6)&&!ao.bit(e,5)){var i=31&e,r=this.readU8(t.value);++t.value,n=i<<6|63&r}else ao.bit(e,7)&&ao.bit(e,6)&&ao.bit(e,5)&&!ao.bit(e,4)?t.value+=2:ao.bit(e,7)&&ao.bit(e,6)&&ao.bit(e,5)&&ao.bit(e,4)&&!ao.bit(e,3)&&(t.value+=3);else n=e;return n},readUtf8Block:function(t,e){var n=0;if(e.value>=this.get_length())return"";for(;n<2e3;){var i=this.readUtf8Char(e);if(i<0)break;t[n]=i,++n}return ao.toText(t,n)},readUtf8String:function(){var t=new Array(2e3),e="",n=0;3<=this.get_length()&&239==this.bytes.get(0)&&187==this.bytes.get(1)&&191==this.bytes.get(2)&&(n=3);for(var i={value:n};i.value<this.get_length();)e+=this.readUtf8Block(t,i);return e},toBytes:function(){return this.bytes},unload:function(){this.bytes=null},__class__:ao,__properties__:{get_length:"get_length"}};var oo=function(){};(n["kha.internal.HdrFormat"]=oo).__name__="kha.internal.HdrFormat",oo.readBuf=function(t){for(var e=0;t[e++]=255&oo.buffer[oo.fileOffset],++oo.fileOffset<oo.bufferLength&&e<t.length;);return e},oo.readBufOffset=function(t,e,n){for(var i=0;t[e+i++]=255&oo.buffer[oo.fileOffset],++oo.fileOffset<oo.bufferLength&&i<n;);return i},oo.readPixelsRaw=function(t,e,n,i){var r=4*i,s=oo.readBufOffset(e,n,r);s<r&&Ji.trace("Error reading raw pixels: got "+s+" bytes, expected "+r,{fileName:"kha/internal/HdrFormat.hx",lineNumber:43,className:"kha.internal.HdrFormat",methodName:"readPixelsRaw"})},oo.readPixelsRawRLE=function(t,e,n,i,r){var s,a,o,l=new Uint8Array(4),u=null,h=new Uint8Array(2);for(t.length;0<r;){if(oo.readBuf(l)<l.length)return void Ji.trace("Error reading bytes: expected "+l.length,{fileName:"kha/internal/HdrFormat.hx",lineNumber:59,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(2!=l[0]||2!=l[1]||0!=(128&l[2]))return e[n++]=255&l[0],e[n++]=255&l[1],e[n++]=255&l[2],e[n++]=255&l[3],void oo.readPixelsRaw(t,e,n,i*r-1);if(((255&l[2])<<8|255&l[3])!=i)return void Ji.trace("Wrong scanline width "+((255&l[2])<<8|255&l[3])+", expected "+i,{fileName:"kha/internal/HdrFormat.hx",lineNumber:74,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(null==u)u=new Uint8Array(4*i);for(var _=s=0;_<4;){for(a=(_+++1)*i;s<a;){if(oo.readBuf(h)<h.length)return void Ji.trace("Error reading 2-byte buffer",{fileName:"kha/internal/HdrFormat.hx",lineNumber:88,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(128<(255&h[0])){if(0==(o=(255&h[0])-128)||a-s<o)return void Ji.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:95,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});for(;0<o--;)u[s++]=255&h[1]}else{if(0==(o=255&h[0])||a-s<o)return void Ji.trace("Bad scanline data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:106,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});if(u[s++]=255&h[1],0<--o){if(oo.readBufOffset(u,s,o)<o)return void Ji.trace("Error reading non-run data",{fileName:"kha/internal/HdrFormat.hx",lineNumber:112,className:"kha.internal.HdrFormat",methodName:"readPixelsRawRLE"});s+=o}}}}for(var c=0,d=i;c<d;){var p=c++;e[n]=255&u[p],e[n+1]=255&u[p+i],e[n+2]=255&u[p+2*i],e[n+3]=255&u[p+3*i],n+=4}--r}},oo.readLine=function(){for(var t="";;){var e=oo.buffer[oo.fileOffset];if(10==e){++oo.fileOffset;break}if(t+=String.fromCodePoint(e),!(++oo.fileOffset<oo.bufferLength))break}return t},oo.parse=function(t){oo.buffer=fr.fromBytes(t),oo.bufferLength=oo.buffer.length;for(var e=oo.fileOffset=0,n=0,i=!1,r=0;r<20;){r++;var s=oo.readLine();if(oo.formatPattern.match(s))i=!0;else if(oo.exposurePattern.match(s))pt.parseFloat(oo.exposurePattern.matched(1));else if(oo.widthHeightPattern.match(s)){n=pt.parseInt(oo.widthHeightPattern.matched(1)),e=pt.parseInt(oo.widthHeightPattern.matched(2));break}}if(!i)return Ji.trace("File is not run length encoded!",{fileName:"kha/internal/HdrFormat.hx",lineNumber:175,className:"kha.internal.HdrFormat",methodName:"parse"}),null;var a=new Uint8Array(e*n*4),o=e,l=n;oo.readPixelsRawRLE(oo.buffer,a,0,o,l);for(var u=new Float32Array(e*n*4),h=0;h<a.length;){var _=a[h]/255,c=a[h+1]/255,d=a[h+2]/255,p=a[h+3],g=Math.pow(2,p-128);_*=g,c*=g,d*=g,u[h]=_,u[h+1]=c,u[h+2]=d,u[h+3]=1,h+=4}return{width:e,height:n,data:u}};var lo=function(t){this.stopped=!1,this.element=t};(n["kha.js.AEAudioChannel"]=lo).__name__="kha.js.AEAudioChannel",lo.__interfaces__=[Qs],lo.prototype={element:null,stopped:null,play:function(){this.stopped=!1,Xs.mobile?Xs.insideInputEvent?(this.element.play(),Xs.mobileAudioPlaying=!0):Xs.mobileAudioPlaying?this.element.play():lo.todo.push(this):this.element.play()},pause:function(){try{this.element.pause()}catch(t){Ji.trace(t instanceof us?t.val:t,{fileName:"kha/js/AEAudioChannel.hx",lineNumber:39,className:"kha.js.AEAudioChannel",methodName:"pause"})}},stop:function(){try{this.element.pause(),this.element.currentTime=0,this.stopped=!0}catch(t){Ji.trace(t instanceof us?t.val:t,{fileName:"kha/js/AEAudioChannel.hx",lineNumber:50,className:"kha.js.AEAudioChannel",methodName:"stop"})}},get_length:function(){return isFinite(this.element.duration)?this.element.duration:1/0},get_position:function(){return this.element.currentTime},set_volume:function(t){return this.element.volume=t},get_finished:function(){return!!this.stopped||this.get_position()>=this.get_length()},__class__:lo,__properties__:{get_finished:"get_finished",set_volume:"set_volume",get_position:"get_position",get_length:"get_length"}};var uo=function(){};(n["kha.js.AudioElementAudio"]=uo).__name__="kha.js.AudioElementAudio",uo._compile=function(){},uo.play=function(t,e){return null==e&&(e=!1),uo.stream(t,e)},uo.stream=function(t,e){null==e&&(e=!1),t.element.loop=e;var n=new lo(t.element);return n.play(),n};var ho=function(t){this.bakedQuadCache=new Os,ra.call(this),this.canvas=t,(ho.instance=this).myColor=Cs.fromBytes(0,0,0)};(n["kha.js.CanvasGraphics"]=ho).__name__="kha.js.CanvasGraphics",ho.__super__=ra,ho.prototype=r(ra.prototype,{canvas:null,webfont:null,myColor:null,scaleQuality:null,begin:function(t,e){null==t&&(t=!0),t&&this.clear(e)},clear:function(t){null==t&&(t=0),this.canvas.strokeStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",.00392156862745098*(t>>>24)==0?this.canvas.clearRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height):this.canvas.fillRect(0,0,this.canvas.canvas.width,this.canvas.canvas.height),this.set_color(this.myColor)},end:function(){},drawImage:function(t,e,n){this.canvas.globalAlpha=this.get_opacity(),this.canvas.drawImage(hs.__cast(t,Ss).image,e,n),this.canvas.globalAlpha=1},drawScaledSubImage:function(t,e,n,i,r,s,a,o,l){this.canvas.globalAlpha=this.get_opacity();try{if(o<0||l<0){this.canvas.save(),this.canvas.translate(s,a);var u=0,h=0;o<0&&(this.canvas.scale(-1,1),u=-o),l<0&&(this.canvas.scale(1,-1),h=-l),this.canvas.drawImage(hs.__cast(t,Ss).image,e,n,i,r,u,h,o,l),this.canvas.restore()}else this.canvas.drawImage(hs.__cast(t,Ss).image,e,n,i,r,s,a,o,l)}catch(t){t instanceof us&&t.val}this.canvas.globalAlpha=1},set_color:function(t){return this.myColor=t,this.canvas.strokeStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",this.canvas.fillStyle="rgba("+((16711680&t)>>>16)+","+((65280&t)>>>8)+","+(255&t)+","+.00392156862745098*(t>>>24)+")",t},get_color:function(){return this.myColor},set_imageScaleQuality:function(t){return t==oa.Low?(this.canvas.mozImageSmoothingEnabled=!1,this.canvas.webkitImageSmoothingEnabled=!1,this.canvas.msImageSmoothingEnabled=!1,this.canvas.imageSmoothingEnabled=!1):(this.canvas.mozImageSmoothingEnabled=!0,this.canvas.webkitImageSmoothingEnabled=!0,this.canvas.msImageSmoothingEnabled=!0,this.canvas.imageSmoothingEnabled=!0),this.scaleQuality=t},drawRect:function(t,e,n,i,r){null==r&&(r=1),this.canvas.beginPath();var s=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(r),this.canvas.rect(t,e,n,i),this.canvas.stroke(),this.canvas.lineWidth=s},fillRect:function(t,e,n,i){var r=this.get_opacity();this.canvas.globalAlpha=r*(.00392156862745098*(this.myColor>>>24)),this.canvas.fillRect(t,e,n,i),this.canvas.globalAlpha=this.get_opacity()},fillCircle:function(t,e,n){this.canvas.beginPath(),this.canvas.arc(t,e,n,0,2*Math.PI,!1),this.canvas.fill()},bakedQuadCache:null,drawString:function(t,e,n){var i=this.webfont.getImage(this.get_fontSize(),this.myColor);if(0<i.width)for(var r=e,s=n,a=0,o=t.length;a<o;){var l=a++,u=this.webfont.kravur._get(this.get_fontSize()).getBakedQuad(this.bakedQuadCache,ra.fontGlyphs.indexOf(ut.cca(t,l)),r,s);null!=u&&(0<u.s1-u.s0&&0<u.t1-u.t0&&0<u.x1-u.x0&&0<u.y1-u.y0&&this.canvas.drawImage(i,u.s0*i.width,u.t0*i.height,(u.s1-u.s0)*i.width,(u.t1-u.t0)*i.height,u.x0,u.y0,u.x1-u.x0,u.y1-u.y0),r+=u.xadvance)}},set_font:function(t){return this.webfont=hs.__cast(t,_o),this.webfont},get_font:function(){return this.webfont},drawLine:function(t,e,n,i,r){null==r&&(r=1),this.canvas.beginPath();var s=this.canvas.lineWidth;this.canvas.lineWidth=Math.round(r),this.canvas.moveTo(t,e),this.canvas.lineTo(n,i),this.canvas.moveTo(0,0),this.canvas.stroke(),this.canvas.lineWidth=s},fillTriangle:function(t,e,n,i,r,s){this.canvas.beginPath(),this.canvas.closePath(),this.canvas.fill()},setTransformation:function(t){this.canvas.setTransform(t._00,t._01,t._10,t._11,t._20,t._21)},__class__:ho});var _o=function(t){this.images=new ir,this.kravur=new _o.Kravur(t)};(n["kha.js.Font"]=_o).__name__="kha.js.Font",_o.__interfaces__=[bs],_o.fromBytes=function(t){return new _o(ao.fromBytes(t))},_o.prototype={kravur:null,images:null,height:function(t){return this.kravur._get(t).getHeight()},width:function(t,e){return this.kravur._get(t).stringWidth(e)},widthOfCharacters:function(t,e,n,i){return this.kravur._get(t).charactersWidth(e,n,i)},baseline:function(t){return this.kravur._get(t).getBaselinePosition()},getImage:function(t,e){var n=1e4*t+ra.fontGlyphs.length;if(!this.images.exists(n)){var i=this.images,r=new ir;i.set(n,r)}if(!this.images.get(n).exists(e)){var s=this.kravur._get(t),a=window.document.createElement("canvas");a.width=s.width,a.height=s.height;var o=a.getContext("2d");o.fillStyle="black",o.fillRect(0,0,s.width,s.height);for(var l=o.getImageData(0,0,s.width,s.height),u=hs.__cast(s.getTexture(),Ss).bytes,h=0,_=u.length;h<_;){var c=h++;l.data[4*c]=(16711680&e)>>>16,l.data[4*c+1]=(65280&e)>>>8,l.data[4*c+2]=255&e,l.data[4*c+3]=u.get(c)}o.putImageData(l,0,0);var d=window.document.createElement("img");return d.src=a.toDataURL("image/png"),this.images.get(n).set(e,d),d}return this.images.get(n).get(e)},unload:function(){this.kravur=null,this.images=null},__class__:_o};var co=function(){};(n["kha.js.MobileWebAudio"]=co).__name__="kha.js.MobileWebAudio",co._init=function(){try{return void(co._context=new AudioContext)}catch(t){t instanceof us&&t.val}try{return void(this._context=new webkitAudioContext)}catch(t){t instanceof us&&t.val}},co.play=function(t,e){null==e&&(e=!1);var n=new po(t,e);return n.play(),n},co.stream=function(t,e){return null==e&&(e=!1),co.play(t,e)};var po=function(t,e){this.stopped=!1,this.paused=!1,this.buffer=t._buffer,this.loop=e,this.createSource()};(n["kha.js.MobileWebAudioChannel"]=po).__name__="kha.js.MobileWebAudioChannel",po.__interfaces__=[Qs],po.prototype={buffer:null,loop:null,source:null,gain:null,startTime:null,pauseTime:null,paused:null,stopped:null,createSource:function(){var t=this;this.source=co._context.createBufferSource(),this.source.loop=this.loop,this.source.buffer=this.buffer,this.source.onended=function(){t.stopped=!0},this.gain=co._context.createGain(),this.source.connect(this.gain),this.gain.connect(co._context.destination)},play:function(){(this.paused||this.stopped)&&this.createSource(),this.stopped=!1,this.paused?(this.paused=!1,this.startTime=co._context.currentTime-this.pauseTime,this.source.start(0,this.pauseTime)):(this.startTime=co._context.currentTime,this.source.start())},pause:function(){this.pauseTime=co._context.currentTime-this.startTime,this.paused=!0,this.source.stop()},stop:function(){this.paused=!1,this.stopped=!0,this.source.stop()},set_volume:function(t){return this.gain.gain.value=t},get_finished:function(){return this.stopped},__class__:po,__properties__:{get_finished:"get_finished",set_volume:"set_volume"}};var go=function(t,e,n){var i=this;Ds.call(this);var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onerror=function(){n({url:t})},r.onload=function(){i.compressedData=er.ofData(r.response),i.uncompressedData=null,co._context.decodeAudioData(i.compressedData.getData(),function(t){i._buffer=t,e(i)},function(){n({url:t,error:"Audio format not supported"})})},r.send(null)};(n["kha.js.MobileWebAudioSound"]=go).__name__="kha.js.MobileWebAudioSound",go.__super__=Ds,go.prototype=r(Ds.prototype,{_buffer:null,uncompress:function(t){t()},__class__:go});var fo=function(t,e,n){Ds.call(this),this.done=e,this.failed=n,fo.loading.push(this),this.element=window.document.createElement("audio"),this.filenames=[];for(var i=0;i<t.length;){var r=t[i];++i,""!=this.element.canPlayType("audio/ogg")&&J.endsWith(r,".ogg")&&this.filenames.push(r),""!=this.element.canPlayType("audio/mp4")&&J.endsWith(r,".mp4")&&this.filenames.push(r)}this.element.addEventListener("error",Fo(this,this.errorListener),!1),this.element.addEventListener("canplay",Fo(this,this.canPlayThroughListener),!1),this.element.src=this.filenames[0],this.element.preload="auto",this.element.load()};(n["kha.js.Sound"]=fo).__name__="kha.js.Sound",fo.__super__=Ds,fo.prototype=r(Ds.prototype,{filenames:null,done:null,failed:null,element:null,errorListener:function(t){if(4==this.element.error.code)for(var e=0,n=this.filenames.length-1;e<n;){var i=e++;if(this.element.src==this.filenames[i])return void(this.element.src=this.filenames[i+1])}this.failed({url:this.element.src}),this.finishAsset()},canPlayThroughListener:function(t){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",Fo(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",Fo(this,this.canPlayThroughListener),!1),this.done(this),ut.remove(fo.loading,this)},uncompress:function(t){t()},__class__:fo});var mo=function(){js.call(this)};(n["kha.js.Video"]=mo).__name__="kha.js.Video",mo.fromFile=function(t,e){var n=new mo;n.done=e,n.element=window.document.createElement("video"),n.filenames=[];for(var i=0;i<t.length;){var r=t[i];++i,""!=n.element.canPlayType("video/webm")&&J.endsWith(r,".webm")&&n.filenames.push(r),""!=n.element.canPlayType("video/mp4")&&J.endsWith(r,".mp4")&&n.filenames.push(r)}n.element.addEventListener("error",Fo(n,n.errorListener),!1),n.element.addEventListener("canplaythrough",Fo(n,n.canPlayThroughListener),!1),n.element.preload="auto",n.element.src=n.filenames[0]},mo.__super__=js,mo.prototype=r(js.prototype,{filenames:null,element:null,done:null,texture:null,errorListener:function(t){if(4==this.element.error.code)for(var e=0,n=this.filenames.length-1;e<n;){var i=e++;if(this.element.src==this.filenames[i])return void(this.element.src=this.filenames[i+1])}Ji.trace("Error loading "+this.element.src,{fileName:"kha/js/Video.hx",lineNumber:120,className:"kha.js.Video",methodName:"errorListener"}),this.finishAsset()},canPlayThroughListener:function(t){this.finishAsset()},finishAsset:function(){this.element.removeEventListener("error",Fo(this,this.errorListener),!1),this.element.removeEventListener("canplaythrough",Fo(this,this.canPlayThroughListener),!1),null!=Xs.gl&&(this.texture=xs.fromVideo(this)),this.done(this)},__class__:mo});var vo=function(t,e,n){var i=this;Ds.call(this);var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onerror=function(){n({url:t})},r.onload=function(){i.compressedData=er.ofData(r.response),i.uncompressedData=null,e(i)},r.send(null)};(n["kha.js.WebAudioSound"]=vo).__name__="kha.js.WebAudioSound",vo.__super__=Ds,vo.prototype=r(Ds.prototype,{superUncompress:function(t){Ds.prototype.uncompress.call(this,t)},uncompress:function(d){var p=this;Js._context.decodeAudioData(this.compressedData.getData(),function(t){var n=t.getChannelData(0),e=n.length,i=new Float32Array(2*e);if(p.uncompressedData=i,1==t.numberOfChannels){var r=0,s=0,a=2*e,o=function(){};(o=function(){for(var t=r+11025,e=a<t?a:t;r<e;)p.uncompressedData[r]=n[s],p.uncompressedData[r+1]=n[s],r+=2,s+=1;r<a?window.setTimeout(o,0):p.compressedData=null})(),window.setTimeout(d,250)}else{var l=t.getChannelData(1),u=0,h=0,_=2*e,c=function(){};(c=function(){for(var t=u+11025,e=_<t?_:t;u<e;)p.uncompressedData[u]=n[h],p.uncompressedData[u+1]=l[h],u+=2,h+=1;u<_?window.setTimeout(c,0):p.compressedData=null})(),window.setTimeout(d,250)}},function(){p.superUncompress(d)})},__class__:vo});var yo=function(t,e){this.value=t,this.type=e};(n["kha.js.graphics4.ConstantLocation"]=yo).__name__="kha.js.graphics4.ConstantLocation",yo.__interfaces__=[Sa],yo.prototype={value:null,type:null,__class__:yo};var wo=function(t){this.matrix3Cache=new Float32Array(9),this.matrixCache=new Float32Array(16),this.isDepthAttachment=!1,this.isCubeMap=!1,this.colorMaskAlpha=!0,this.colorMaskBlue=!0,this.colorMaskGreen=!0,this.colorMaskRed=!0,this.depthMask=!1,this.depthTest=!1,this.renderTarget=t,this.init(),Xs.gl2?this.instancedExtension=!0:(this.instancedExtension=Xs.gl.getExtension("ANGLE_instanced_arrays"),this.blendMinMaxExtension=Xs.gl.getExtension("EXT_blend_minmax"))};(n["kha.js.graphics4.Graphics"]=wo).__name__="kha.js.graphics4.Graphics",wo.__interfaces__=[Na],wo.getBlendFunc=function(t){switch(t._hx_index){case 1:return 1;case 0:case 2:return 0;case 3:return 770;case 4:return 772;case 5:return 771;case 6:return 773;case 7:return 768;case 8:return 774;case 9:return 769;case 10:return 775}},wo.getBlendOp=function(t){switch(t._hx_index){case 0:return 32774;case 1:return 32778;case 2:return 32779;case 3:return 32775;case 4:return 32776}},wo.prototype={depthTest:null,depthMask:null,colorMaskRed:null,colorMaskGreen:null,colorMaskBlue:null,colorMaskAlpha:null,indicesCount:null,renderTarget:null,renderTargetFrameBuffer:null,renderTargetTexture:null,isCubeMap:null,isDepthAttachment:null,instancedExtension:null,blendMinMaxExtension:null,init:function(){if(null!=this.renderTarget)if(this.isCubeMap=this.renderTarget instanceof Ca,this.isCubeMap){var t=hs.__cast(this.renderTarget,Ca);this.renderTargetFrameBuffer=t.frameBuffer,this.renderTargetTexture=t.texture,this.isDepthAttachment=t.isDepthAttachment}else{var e=hs.__cast(this.renderTarget,Ys);this.renderTargetFrameBuffer=e.frameBuffer,this.renderTargetTexture=e.texture}},begin:function(t){if(Xs.gl.enable(3042),Xs.gl.blendFunc(770,771),null==this.renderTarget)Xs.gl.bindFramebuffer(36160,null),Xs.gl.viewport(0,0,zs.windowWidth(),zs.windowHeight());else if(Xs.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),Xs.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height()),null!=t){Xs.gl.framebufferTexture2D(36160,Xs.drawBuffers.COLOR_ATTACHMENT0_WEBGL,3553,this.renderTargetTexture,0);for(var e=0,n=t.length;e<n;){var i=e++;Xs.gl.framebufferTexture2D(36160,Xs.drawBuffers.COLOR_ATTACHMENT0_WEBGL+i+1,3553,hs.__cast(t[i],Ys).texture,0)}for(var r=[Xs.drawBuffers.COLOR_ATTACHMENT0_WEBGL],s=0,a=t.length;s<a;){var o=s++;r.push(Xs.drawBuffers.COLOR_ATTACHMENT0_WEBGL+o+1)}Xs.gl2?Xs.gl.drawBuffers(r):Xs.drawBuffers.drawBuffersWEBGL(r)}},beginFace:function(t){Xs.gl.enable(3042),Xs.gl.blendFunc(770,771),Xs.gl.bindFramebuffer(36160,this.renderTargetFrameBuffer),Xs.gl.framebufferTexture2D(36160,this.isDepthAttachment?36096:36064,34069+t,this.renderTargetTexture,0),Xs.gl.viewport(0,0,this.renderTarget.get_width(),this.renderTarget.get_height())},end:function(){},clear:function(t,e,n){var i=0;null!=t&&(i|=16384,Xs.gl.colorMask(!0,!0,!0,!0),Xs.gl.clearColor(.00392156862745098*((16711680&t)>>>16),.00392156862745098*((65280&t)>>>8),.00392156862745098*(255&t),.00392156862745098*(t>>>24))),null!=e&&(i|=256,Xs.gl.enable(2929),Xs.gl.depthMask(!0),Xs.gl.clearDepth(e)),null!=n&&(i|=1024,Xs.gl.enable(2960),Xs.gl.stencilMask(255),Xs.gl.clearStencil(n)),Xs.gl.clear(i),Xs.gl.colorMask(this.colorMaskRed,this.colorMaskGreen,this.colorMaskBlue,this.colorMaskAlpha),this.depthTest?Xs.gl.enable(2929):Xs.gl.disable(2929),Xs.gl.depthMask(this.depthMask)},viewport:function(t,e,n,i){null==this.renderTarget?Xs.gl.viewport(t,zs.windowHeight(0)-e-i,n,i):Xs.gl.viewport(t,e,n,i)},scissor:function(t,e,n,i){Xs.gl.enable(3089),null==this.renderTarget?Xs.gl.scissor(t,zs.windowHeight(0)-e-i,n,i):Xs.gl.scissor(t,e,n,i)},disableScissor:function(){Xs.gl.disable(3089)},renderTargetsInvertedY:function(){return!0},setDepthMode:function(t,e){switch(e._hx_index){case 0:t?Xs.gl.enable(2929):Xs.gl.disable(2929),this.depthTest=t,Xs.gl.depthFunc(519);break;case 1:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(512);break;case 2:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(514);break;case 3:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(517);break;case 4:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(513);break;case 5:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(515);break;case 6:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(516);break;case 7:Xs.gl.enable(2929),this.depthTest=!0,Xs.gl.depthFunc(518)}Xs.gl.depthMask(t),this.depthMask=t},setBlendingMode:function(t,e,n,i,r,s){t==wa.BlendOne&&e==wa.BlendZero?Xs.gl.disable(3042):(Xs.gl.enable(3042),Xs.gl.blendFuncSeparate(wo.getBlendFunc(t),wo.getBlendFunc(e),wo.getBlendFunc(i),wo.getBlendFunc(r)),Xs.gl.blendEquationSeparate(wo.getBlendOp(n),wo.getBlendOp(s)))},setVertexBuffer:function(t){hs.__cast(t,ja).set(0)},setVertexBuffers:function(t){for(var e=0,n=0;n<t.length;){var i=t[n];++n,e+=hs.__cast(i,ja).set(e)}},setIndexBuffer:function(t){this.indicesCount=t.count(),hs.__cast(t,Ba).set()},setTexture:function(t,e){null==e?(Xs.gl.activeTexture(33984+hs.__cast(t,xo).value),Xs.gl.bindTexture(3553,null)):hs.__cast(e,Ys).set(hs.__cast(t,xo).value)},setTextureDepth:function(t,e){hs.__cast(e,Ys).setDepth(hs.__cast(t,xo).value)},setImageTexture:function(t,e){},setTextureParameters:function(t,e,n,i,r,s){switch(Xs.gl.activeTexture(33984+hs.__cast(t,xo).value),e._hx_index){case 0:Xs.gl.texParameteri(3553,10242,10497);break;case 1:Xs.gl.texParameteri(3553,10242,33648);break;case 2:Xs.gl.texParameteri(3553,10242,33071)}switch(n._hx_index){case 0:Xs.gl.texParameteri(3553,10243,10497);break;case 1:Xs.gl.texParameteri(3553,10243,33648);break;case 2:Xs.gl.texParameteri(3553,10243,33071)}switch(i._hx_index){case 0:switch(s._hx_index){case 0:Xs.gl.texParameteri(3553,10241,9728);break;case 1:Xs.gl.texParameteri(3553,10241,9984);break;case 2:Xs.gl.texParameteri(3553,10241,9986)}break;case 1:case 2:switch(s._hx_index){case 0:Xs.gl.texParameteri(3553,10241,9729);break;case 1:Xs.gl.texParameteri(3553,10241,9985);break;case 2:Xs.gl.texParameteri(3553,10241,9987)}i==Pa.AnisotropicFilter&&Xs.gl.texParameteri(3553,Xs.anisotropicFilter.TEXTURE_MAX_ANISOTROPY_EXT,4)}switch(r._hx_index){case 0:Xs.gl.texParameteri(3553,10240,9728);break;case 1:case 2:Xs.gl.texParameteri(3553,10240,9729)}},setTexture3DParameters:function(t,e,n,i,r,s,a){},setCubeMap:function(t,e){null==e?(Xs.gl.activeTexture(33984+hs.__cast(t,xo).value),Xs.gl.bindTexture(34067,null)):e.set(hs.__cast(t,xo).value)},setCubeMapDepth:function(t,e){e.setDepth(hs.__cast(t,xo).value)},setCullMode:function(t){switch(t._hx_index){case 0:Xs.gl.enable(2884),Xs.gl.cullFace(1029);break;case 1:Xs.gl.enable(2884),Xs.gl.cullFace(1028);break;case 2:Xs.gl.disable(2884)}},setPipeline:function(t){this.setCullMode(t.cullMode),this.setDepthMode(t.depthWrite,t.depthMode),this.setStencilParameters(t.stencilMode,t.stencilBothPass,t.stencilDepthFail,t.stencilFail,t.stencilReferenceValue,t.stencilReadMask,t.stencilWriteMask),this.setBlendingMode(t.blendSource,t.blendDestination,t.blendOperation,t.alphaBlendSource,t.alphaBlendDestination,t.alphaBlendOperation),t.set(),this.colorMaskRed=t.get_colorWriteMaskRed(),this.colorMaskGreen=t.get_colorWriteMaskGreen(),this.colorMaskBlue=t.get_colorWriteMaskBlue(),this.colorMaskAlpha=t.get_colorWriteMaskAlpha()},setBool:function(t,e){Xs.gl.uniform1i(hs.__cast(t,yo).value,e?1:0)},setInt:function(t,e){Xs.gl.uniform1i(hs.__cast(t,yo).value,e)},setFloat:function(t,e){Xs.gl.uniform1f(hs.__cast(t,yo).value,e)},setFloat2:function(t,e,n){Xs.gl.uniform2f(hs.__cast(t,yo).value,e,n)},setFloat3:function(t,e,n,i){Xs.gl.uniform3f(hs.__cast(t,yo).value,e,n,i)},setFloat4:function(t,e,n,i,r){Xs.gl.uniform4f(hs.__cast(t,yo).value,e,n,i,r)},setFloats:function(t,e){var n=hs.__cast(t,yo);switch(n.type){case 35664:Xs.gl.uniform2fv(n.value,e);break;case 35665:Xs.gl.uniform3fv(n.value,e);break;case 35666:Xs.gl.uniform4fv(n.value,e);break;case 35676:Xs.gl.uniformMatrix4fv(n.value,!1,e);break;default:Xs.gl.uniform1fv(n.value,e)}},matrixCache:null,setMatrix:function(t,e){this.matrixCache[0]=e._00,this.matrixCache[1]=e._01,this.matrixCache[2]=e._02,this.matrixCache[3]=e._03,this.matrixCache[4]=e._10,this.matrixCache[5]=e._11,this.matrixCache[6]=e._12,this.matrixCache[7]=e._13,this.matrixCache[8]=e._20,this.matrixCache[9]=e._21,this.matrixCache[10]=e._22,this.matrixCache[11]=e._23,this.matrixCache[12]=e._30,this.matrixCache[13]=e._31,this.matrixCache[14]=e._32,this.matrixCache[15]=e._33,Xs.gl.uniformMatrix4fv(hs.__cast(t,yo).value,!1,this.matrixCache)},matrix3Cache:null,setMatrix3:function(t,e){this.matrix3Cache[0]=e._00,this.matrix3Cache[1]=e._01,this.matrix3Cache[2]=e._02,this.matrix3Cache[3]=e._10,this.matrix3Cache[4]=e._11,this.matrix3Cache[5]=e._12,this.matrix3Cache[6]=e._20,this.matrix3Cache[7]=e._21,this.matrix3Cache[8]=e._22,Xs.gl.uniformMatrix3fv(hs.__cast(t,yo).value,!1,this.matrix3Cache)},drawIndexedVertices:function(t,e){null==e&&(e=-1),null==t&&(t=0);var n=null==Xs.elementIndexUint?5123:5125,i=5123==n?2:4;Xs.gl.drawElements(4,-1==e?this.indicesCount:e,n,t*i)},convertStencilAction:function(t){switch(t._hx_index){case 0:return 7680;case 1:return 0;case 2:return 7681;case 3:return 7682;case 4:return 34055;case 5:return 7683;case 6:return 34056;case 7:return 5386}},convertCompareMode:function(t){switch(t._hx_index){case 0:return 519;case 1:return 512;case 2:return 514;case 3:return 517;case 4:return 513;case 5:return 515;case 6:return 516;case 7:return 518}},setStencilParameters:function(t,e,n,i,r,s,a){if(null==a&&(a=255),null==s&&(s=255),t==xa.Always&&e==Ra.Keep&&n==Ra.Keep&&i==Ra.Keep)Xs.gl.disable(2960);else{Xs.gl.enable(2960);var o=this.convertCompareMode(t);switch(Xs.gl.stencilMask(a),Xs.gl.stencilOp(this.convertStencilAction(i),this.convertStencilAction(n),this.convertStencilAction(e)),r._hx_index){case 0:Xs.gl.stencilFunc(o,0,s);break;case 1:var l=r.value;Xs.gl.stencilFunc(o,l,s)}}},drawIndexedVerticesInstanced:function(t,e,n){if(null==n&&(n=-1),null==e&&(e=0),this.instancedRenderingAvailable()){var i=null==Xs.elementIndexUint?5123:5125,r=null==Xs.elementIndexUint?2:4;Xs.gl2?Xs.gl.drawElementsInstanced(4,-1==n?this.indicesCount:n,i,e*r,t):this.instancedExtension.drawElementsInstancedANGLE(4,-1==n?this.indicesCount:n,i,e*r,t)}},instancedRenderingAvailable:function(){return this.instancedExtension},__class__:wo};var bo=function(t){Aa.call(this,t)};(n["kha.js.graphics4.Graphics2"]=bo).__name__="kha.js.graphics4.Graphics2",bo.__super__=Aa,bo.prototype=r(Aa.prototype,{begin:function(t,e){null==t&&(t=!0),Xs.gl.colorMask(!0,!0,!0,!0),Xs.gl.disable(2929),Xs.gl.depthFunc(519),Aa.prototype.begin.call(this,t,e)},__class__:bo});var xo=function(t){this.value=t};(n["kha.js.graphics4.TextureUnit"]=xo).__name__="kha.js.graphics4.TextureUnit",xo.__interfaces__=[Za],xo.prototype={value:null,__class__:xo};var So=function(){};(n["kha.vr.VrInterface"]=So).__name__="kha.vr.VrInterface",So.prototype={IsVrEnabled:function(){return!1},__class__:So};var Co=function(){this.vrHeight=0,this.vrWidth=0,this.height=0,this.width=0,this.vrEnabled=!1,So.call(this)};(n["kha.js.vr.VrInterface"]=Co).__name__="kha.js.vr.VrInterface",Co.__super__=So,Co.prototype=r(So.prototype,{vrEnabled:null,vrDisplay:null,frameData:null,width:null,height:null,vrWidth:null,vrHeight:null,getVRDisplays:function(){var i=this;navigator.getVRDisplays().then(function(t){if(0<t.length){i.frameData=new VRFrameData,i.vrDisplay=t[0],i.vrDisplay.depthNear=.1,i.vrDisplay.depthFar=1024;var e=i.vrDisplay.getEyeParameters("left"),n=i.vrDisplay.getEyeParameters("right");i.width=Xs.khanvas.width,i.height=Xs.khanvas.height,i.vrWidth=pt.int(2*Math.max(e.renderWidth,n.renderWidth)),i.vrHeight=pt.int(Math.max(e.renderHeight,n.renderHeight))}else Ji.trace("There are no VR displays connected.",{fileName:"kha/js/vr/VrInterface.hx",lineNumber:59,className:"kha.js.vr.VrInterface",methodName:"getVRDisplays"})})},IsVrEnabled:function(){return this.vrEnabled},__class__:Co});var ko=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};(n["kha.math.FastVector2"]=ko).__name__="kha.math.FastVector2",ko.prototype={x:null,y:null,get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set_length:function(t){var e=this.get_length();if(0==e)return 0;var n=t/e;return this.x*=n,this.y*=n,t},__class__:ko,__properties__:{set_length:"set_length",get_length:"get_length"}};var Io=function(){};(n["kha.netsync.ControllerBuilder"]=Io).__name__="kha.netsync.ControllerBuilder";var To=function(t,e,n){this.controllers=new ir,(To.instance=this).maxPlayers=t,this.address=e,this.port=n};(n["kha.netsync.Session"]=To).__name__="kha.netsync.Session",To.the=function(){return To.instance},To.prototype={controllers:null,maxPlayers:null,address:null,port:null,sendControllerUpdate:function(t,e){if(this.controllers.exists(t)){if(this.controllers.get(t)._inputBuffer.length<this.controllers.get(t)._inputBufferIndex+4+e.length){var n=er.alloc(this.controllers.get(t)._inputBufferIndex+4+e.length);n.blit(0,this.controllers.get(t)._inputBuffer,0,this.controllers.get(t)._inputBufferIndex),this.controllers.get(t)._inputBuffer=n}this.controllers.get(t)._inputBuffer.setInt32(this.controllers.get(t)._inputBufferIndex,e.length),this.controllers.get(t)._inputBuffer.blit(this.controllers.get(t)._inputBufferIndex+4,e,0,e.length),this.controllers.get(t)._inputBufferIndex+=4+e.length}},__class__:To};var No=function(t){this.changed=!1,this.dragY=0,this.dragX=0,this.dragEnabled=!1,this.dragging=!1,this.lastMaxY=0,this.lastMaxX=0,this.layout=0,this.scrollEnabled=!1,this.scrollOffset=0,this.scrolling=!1,this.redraws=2,this.texture=null,this.text="",this.value=0,this.color=-1,this.position=0,this.selected=!1,null!=t&&(null!=t.selected&&(this.selected=t.selected),null!=t.position&&(this.position=t.position),null!=t.value&&(this.value=t.value),null!=t.text&&(this.text=t.text),null!=t.color&&(this.color=t.color),null!=t.layout&&(this.layout=t.layout))};(n["zui.Handle"]=No).__name__="zui.Handle",No.prototype={selected:null,position:null,color:null,value:null,text:null,texture:null,redraws:null,scrolling:null,scrollOffset:null,scrollEnabled:null,layout:null,lastMaxX:null,lastMaxY:null,dragging:null,dragEnabled:null,dragX:null,dragY:null,changed:null,children:null,nest:function(t,e){for(null==this.children&&(this.children=[]);this.children.length<=t;)this.children.push(null);return null==this.children[t]&&(this.children[t]=new No(e)),this.children[t]},__class__:No};var Mo=function(){};(n["zui.Canvas"]=Mo).__name__="zui.Canvas",Mo.draw=function(t,e,n){-1==Mo.screenW&&(Mo.screenW=zs.windowWidth(),Mo.screenH=zs.windowHeight()),Mo.events=[],(Mo._ui=t).begin(n),t.g=n;for(var i=0,r=e.elements;i<r.length;){var s=r[i];++i,null==s.parent&&Mo.drawElement(t,e,s)}return t.end(),Mo.events},Mo.drawElement=function(t,e,n,i,r){if(null==r&&(r=0),null==i&&(i=0),null!=n&&0!=n.visible){t._x=e.x+Mo.scaled(n.x)+Mo.scaled(i),t._y=e.y+Mo.scaled(n.y)+Mo.scaled(r),t._w=Mo.scaled(n.width);var s=Mo.scaled(e.width),a=Mo.scaled(e.height);switch(n.anchor){case 1:t._x-=(s-Mo.screenW)/2;break;case 2:t._x-=s-Mo.screenW;break;case 3:t._y-=(a-Mo.screenH)/2;break;case 4:t._x-=(s-Mo.screenW)/2,t._y-=(a-Mo.screenH)/2;break;case 5:t._x-=s-Mo.screenW,t._y-=(a-Mo.screenH)/2;break;case 6:t._y-=a-Mo.screenH;break;case 7:t._x-=(s-Mo.screenW)/2,t._y-=a-Mo.screenH;break;case 8:t._x-=s-Mo.screenW,t._y-=a-Mo.screenH}var o=null!=n.rotation&&0!=n.rotation;switch(o&&t.g.pushRotation(n.rotation,t._x+Mo.scaled(n.width)/2,t._y+Mo.scaled(n.height)/2),n.type){case 0:var l=t.ops.font,u=t.fontSize,h=t.t.TEXT_COL;null!=n.asset&&J.endsWith(n.asset,".ttf")&&(t.ops.font=Mo.getAsset(e,n.asset)),t.fontSize=Mo.scaled(n.height),t.t.TEXT_COL=n.color,t.text(Mo.getText(e,n)),t.ops.font=l,t.fontSize=u,t.t.TEXT_COL=h;break;case 1:var _=Mo.getAsset(e,n.asset),c=null!=n.asset&&J.endsWith(n.asset,".ttf");if(null!=_&&!c){t.imageScrollAlign=!1;var d=null!=n.color?n.color:-1;if(3==t.image(_,d,Mo.scaled(n.height))){var p=n.event;null!=p&&""!=p&&Mo.events.push(p)}t.imageScrollAlign=!0}break;case 2:var g=t.t.BUTTON_H;if(t.t.BUTTON_H=Mo.scaled(n.height),t.button(Mo.getText(e,n))){var f=n.event;null!=f&&""!=f&&Mo.events.push(f)}t.t.BUTTON_H=g;break;case 3:break;case 6:t.check(Mo.h.nest(n.id),Mo.getText(e,n));break;case 7:t.inlineRadio(Mo.h.nest(n.id),Mo.getText(e,n).split(";"));break;case 8:t.combo(Mo.h.nest(n.id),Mo.getText(e,n).split(";"));break;case 9:var m=t.g.get_color();t.g.set_color(n.color),t.g.fillRect(t._x,t._y,t._w,Mo.scaled(n.height)),t.g.set_color(m);break;case 10:t.slider(Mo.h.nest(n.id),Mo.getText(e,n),0,1,!0);break;case 11:t.textInput(Mo.h.nest(n.id),Mo.getText(e,n))}if(null!=n.children)for(var v=0,y=n.children;v<y.length;){var w=y[v];++v,Mo.drawElement(t,e,Mo.elemById(e,w),n.x+i,n.y+r)}o&&t.g.popTransformation()}},Mo.getText=function(t,e){return e.text},Mo.getAsset=function(t,e){for(var n=0,i=t.assets;n<i.length;){var r=i[n];if(++n,r.name==e)return Mo.assetMap.get(r.id)}return null},Mo.elemById=function(t,e){for(var n=0,i=t.elements;n<i.length;){var r=i[n];if(++n,r.id==e)return r}return null},Mo.scaled=function(t){return pt.int(t*Mo._ui.SCALE)};var Oo=function(){};(n["zui.Ext"]=Oo).__name__="zui.Ext",Oo.colorWheel=function(t,e,n,i,r){null==r&&(r=!1),null==n&&(n=!1),null==i&&(i=t._w),Oo.rgbToHsv(.00392156862745098*((16711680&e.color)>>>16),.00392156862745098*((65280&e.color)>>>8),.00392156862745098*(255&e.color),Oo.ar);var s=Oo.ar[0],a=Oo.ar[1],o=Oo.ar[2],l=.00392156862745098*(e.color>>>24),u=t._x,h=t._y;null!=t.currentWindow&&t.currentWindow.scrollEnabled||(i-=t.SCROLL_W(),u+=t.SCROLL_W()/2),t.image(t.ops.color_wheel,Cs.fromFloats(o,o,o));var _=u+i/2,c=h+(t._y-h)/2,d=.7*i,p=d/2,g=_,f=c+a*p,m=s*(2*Math.PI),v=Math.cos(m)*(g-_)-Math.sin(m)*(f-c)+_,y=Math.sin(m)*(g-_)+Math.cos(m)*(f-c)+c;g=v,f=y,t.g.set_color(-16777216),t.g.fillRect(g-3,f-3,6,6),t.g.set_color(-1),t.g.fillRect(g-2,f-2,4,4),r&&(n?t.row([.3333333333333333,.3333333333333333,.3333333333333333]):t.row([.5,.5]));var w=e.nest(0);w.value=Math.round(100*o)/100,o=t.slider(w,"Value",0,1,!0),n&&(l=t.slider(e.nest(1,{value:Math.round(100*l)/100}),"Alpha",0,1,!0));var b=_+t._windowX,x=c+t._windowY;if(t.inputStarted&&t.getInputInRect(b-p,x-p,d,d)&&(Oo.wheelSelectedHande=e),t.inputReleased&&(Oo.wheelSelectedHande=null),t.inputDown&&Oo.wheelSelectedHande==e){a=Math.min(Oo.dist(b,x,t.inputX,t.inputY),p)/p;var S=Math.atan2(t.inputX-b,t.inputY-x);S<0&&(S=Math.PI+(Math.PI-Math.abs(S))),s=(S=2*Math.PI-S)/(2*Math.PI),e.changed=t.changed=!0}return Oo.hsvToRgb(s,a,o,Oo.ar),e.color=Cs.fromFloats(Oo.ar[0],Oo.ar[1],Oo.ar[2],l),t.text("",2,e.color),e.color},Oo.dist=function(t,e,n,i){var r=t-n,s=e-i;return Math.sqrt(r*r+s*s)},Oo.fract=function(t){return t-pt.int(t)},Oo.mix=function(t,e,n){return t*(1-n)+e*n},Oo.clamp=function(t,e,n){return Math.min(Math.max(t,e),n)},Oo.step=function(t,e){return e<t?0:1},Oo.hsvToRgb=function(t,e,n,i){var r=Math.abs(6*Oo.fract(t+1)-3),s=Math.abs(6*Oo.fract(t+.6666666666666666)-3),a=Math.abs(6*Oo.fract(t+.3333333333333333)-3);i[0]=n*Oo.mix(1,Oo.clamp(r-1,0,1),e),i[1]=n*Oo.mix(1,Oo.clamp(s-1,0,1),e),i[2]=n*Oo.mix(1,Oo.clamp(a-1,0,1),e)},Oo.rgbToHsv=function(t,e,n,i){var r=Oo.mix(n,e,Oo.step(n,e)),s=Oo.mix(e,n,Oo.step(n,e)),a=Oo.mix(-1,0,Oo.step(n,e)),o=Oo.mix(.6666666666666666,-.3333333333333333,Oo.step(n,e)),l=Oo.mix(r,t,Oo.step(r,t)),u=Oo.mix(s,s,Oo.step(r,t)),h=Oo.mix(o,a,Oo.step(r,t)),_=Oo.mix(t,r,Oo.step(r,t)),c=l-Math.min(_,u);i[0]=Math.abs(h+(_-u)/(6*c+1e-10)),i[1]=c/(l+1e-10),i[2]=l};var Eo=function(){this.nodeId=-1,this.lastNodesCount=0,this.handle=new No,this.snapY=0,this.snapX=0,this.snapSocket=0,this.snapToId=-1,this.snapFromId=-1,this.linkDrag=null,this.SCALE=1,this.uih=0,this.uiw=0,this.zoom=1,this.panY=0,this.panX=0,this.nodeSelected=null,this.nodeDrag=null};(n["zui.Nodes"]=Eo).__name__="zui.Nodes",Eo.prototype={nodeDrag:null,nodeSelected:null,panX:null,panY:null,zoom:null,uiw:null,uih:null,SCALE:null,linkDrag:null,snapFromId:null,snapToId:null,snapSocket:null,snapX:null,snapY:null,handle:null,lastNodesCount:null,PAN_X:function(){var t=(1-this.zoom)*this.uiw/2.5;return this.panX*this.SCALE+t},PAN_Y:function(){var t=(1-this.zoom)*this.uih/2.5;return this.panY*this.SCALE+t},LINE_H:function(){return pt.int(22*this.SCALE)},BUTTONS_H:function(t){for(var e=0,n=0,i=t.buttons;n<i.length;){var r=i[n];++n,"RGBA"==r.type?e+=132*this.SCALE:"VECTOR"==r.type?e+=4*this.LINE_H():"RAMP"==r.type?e+=9.5*this.LINE_H():"CURVES"==r.type?e+=8*this.LINE_H():e+=this.LINE_H()}return pt.int(e)},NODE_H:function(t){return pt.int(2*this.LINE_H()+t.inputs.length*this.LINE_H()+t.outputs.length*this.LINE_H()+this.BUTTONS_H(t))},NODE_W:function(){return pt.int(140*this.SCALE)},NODE_X:function(t){return t.x*this.SCALE+this.PAN_X()},NODE_Y:function(t){return t.y*this.SCALE+this.PAN_Y()},SOCKET_Y:function(t){return 2*this.LINE_H()+t*this.LINE_H()},p:function(t){return t*this.SCALE},getNode:function(t,e){for(var n=0;n<t.length;){var i=t[n];if(++n,i.id==e)return i}return null},nodeId:null,getNodeId:function(t){if(-1==this.nodeId)for(var e=0;e<t.length;){var n=t[e];++e,this.nodeId<n.id&&(this.nodeId=n.id)}return++this.nodeId},getLinkId:function(t){for(var e=0,n=0;n<t.length;){var i=t[n];++n,i.id>=e&&(e=i.id+1)}return e},getSocketId:function(t){for(var e=0,n=0;n<t.length;){var i=t[n];++n;for(var r=0,s=i.inputs;r<s.length;){var a=s[r];++r,a.id>=e&&(e=a.id+1)}for(var o=0,l=i.outputs;o<l.length;){var u=l[o];++o,u.id>=e&&(e=u.id+1)}}return e},bakeElements:function(t){t.g.end(),Eo.elementsBaked=!0,Eo.socketImage=xs.createRenderTarget(20,20);var e=Eo.socketImage.get_g2();e.begin(!0,0),e.set_color(-16777216),aa.fillCircle(e,10,10,10),e.set_color(-1),aa.fillCircle(e,10,10,8),e.end(),t.g.begin(!1)},nodeCanvas:function(t,e){Eo.elementsBaked||this.bakeElements(t),this.lastNodesCount>e.nodes.length&&(t.changed=!0),this.lastNodesCount=e.nodes.length;var n=t._windowX,i=t._windowY;t.inputDownR&&(this.panX+=t.inputDX/this.SCALE,this.panY+=t.inputDY/this.SCALE),0!=t.inputWheelDelta&&(this.zoom+=-t.inputWheelDelta/10,this.zoom<.4?this.zoom=.4:1<this.zoom&&(this.zoom=1),this.zoom=Math.round(10*this.zoom)/10,this.uiw=t._w,this.uih=t._h),this.SCALE=t.ops.scaleFactor*this.zoom;var r=t.SCALE;t.setScale(this.SCALE),t.elementsBaked=!0,t.g.set_font(t.ops.font),t.g.set_fontSize(t.fontSize);for(var s=0,a=e.links;s<a.length;){var o=a[s];++s;var l=this.getNode(e.nodes,o.from_id),u=this.getNode(e.nodes,o.to_id),h=null==l?t.inputX:n+this.NODE_X(l)+this.NODE_W(),_=null==l?t.inputY:i+this.NODE_Y(l)+this.SOCKET_Y(o.from_socket),c=null==u?t.inputX:n+this.NODE_X(u),d=null==u?t.inputY:i+this.NODE_Y(u)+this.SOCKET_Y(o.to_socket+u.outputs.length)+this.BUTTONS_H(u);if(this.linkDrag==o){-1!=this.snapFromId&&(h=this.snapX,_=this.snapY),-1!=this.snapToId&&(c=this.snapX,d=this.snapY),this.snapFromId=this.snapToId=-1;for(var p=0,g=e.nodes;p<g.length;){var f=g[p];++p;var m=f.inputs,v=f.outputs,y=this.NODE_H(f),w=n+this.NODE_X(f)-this.LINE_H()/2,b=i+this.NODE_Y(f)-this.LINE_H()/2,x=this.NODE_W()+this.LINE_H(),S=y+this.LINE_H();if(t.getInputInRect(w,b,x,S))if(null==l&&f.id!=u.id)for(var C=0,k=v.length;C<k;){var I=C++,T=n+this.NODE_X(f)+this.NODE_W(),N=i+this.NODE_Y(f)+this.SOCKET_Y(I),M=T-this.LINE_H()/2,O=N-this.LINE_H()/2;if(t.getInputInRect(M,O,this.LINE_H(),this.LINE_H())){this.snapX=T,this.snapY=N,this.snapFromId=f.id,this.snapSocket=I;break}}else if(null==u&&f.id!=l.id)for(var E=0,A=m.length;E<A;){var B=E++,L=n+this.NODE_X(f),F=i+this.NODE_Y(f)+this.SOCKET_Y(B+v.length)+this.BUTTONS_H(f),W=L-this.LINE_H()/2,R=F-this.LINE_H()/2;if(t.getInputInRect(W,R,this.LINE_H(),this.LINE_H())){this.snapX=L,this.snapY=F,this.snapToId=f.id,this.snapSocket=B;break}}}}var D=null!=this.nodeSelected&&(o.from_id==this.nodeSelected.id||o.to_id==this.nodeSelected.id);this.drawLink(t,h-n,_-i,c-n,d-i,D)}for(var G=0,V=e.nodes;G<V.length;){var H=V[G];++G;var P=H.inputs,z=H.outputs,Z=this.NODE_H(H);if(t.inputStarted&&t.getInputInRect(n+this.NODE_X(H)-this.LINE_H()/2,i+this.NODE_Y(H),this.NODE_W()+this.LINE_H(),this.LINE_H())&&(this.nodeDrag=H,this.nodeSelected=this.nodeDrag),t.inputStarted&&t.getInputInRect(n+this.NODE_X(H)-this.LINE_H()/2,i+this.NODE_Y(H)-this.LINE_H()/2,this.NODE_W()+this.LINE_H(),Z+this.LINE_H())){for(var X=0,j=z.length;X<j;){var Y=X++,U=n+this.NODE_X(H)+this.NODE_W(),K=i+this.NODE_Y(H)+this.SOCKET_Y(Y);if(t.getInputInRect(U-this.LINE_H()/2,K-this.LINE_H()/2,this.LINE_H(),this.LINE_H())){var Q={id:this.getLinkId(e.links),from_id:H.id,from_socket:Y,to_id:-1,to_socket:-1};e.links.push(Q),this.linkDrag=Q;break}}if(null==this.linkDrag)for(var J=0,q=P.length;J<q;){var $=J++,tt=n+this.NODE_X(H),et=i+this.NODE_Y(H)+this.SOCKET_Y($+z.length)+this.BUTTONS_H(H);if(t.getInputInRect(tt-this.LINE_H()/2,et-this.LINE_H()/2,this.LINE_H(),this.LINE_H())){for(var nt=0,it=e.links;nt<it.length;){var rt=it[nt];if(++nt,rt.to_id==H.id&&rt.to_socket==$){rt.to_id=rt.to_socket=-1,this.linkDrag=rt;break}}if(null!=this.linkDrag)break;var st={id:this.getLinkId(e.links),from_id:-1,from_socket:-1,to_id:H.id,to_socket:$};e.links.push(st),this.linkDrag=st;break}}}else if(t.inputReleased){if(-1!=this.snapToId){for(var at=0,ot=e.links;at<ot.length;){var lt=ot[at];if(++at,lt.to_id==this.snapToId&&lt.to_socket==this.snapSocket){ut.remove(e.links,lt);break}}this.linkDrag.to_id=this.snapToId,this.linkDrag.to_socket=this.snapSocket,t.changed=!0}else-1!=this.snapFromId?(this.linkDrag.from_id=this.snapFromId,this.linkDrag.from_socket=this.snapSocket,t.changed=!0):null!=this.linkDrag&&(ut.remove(e.links,this.linkDrag),t.changed=!0);this.snapToId=this.snapFromId=-1,this.linkDrag=null,this.nodeDrag=null}this.nodeDrag!=H||t.inputDownR||(H.x+=pt.int(t.inputDX/this.SCALE),H.y+=pt.int(t.inputDY/this.SCALE)),this.drawNode(t,H,e)}t.setScale(r),t.elementsBaked=!0},drawNode:function(t,e,n){t._windowX,t._windowY;var i=this.NODE_W(),r=t.g,s=this.NODE_H(e),a=this.NODE_X(e),o=this.NODE_Y(e),l=e.name,u=this.LINE_H();r.set_color(e==this.nodeSelected?-5592406:-14671840),r.fillRect(a-1,o-1,i+2,s+2),r.set_color(e.color),r.fillRect(a,o,i,u),r.set_color(-14671840),r.fillRect(a,o+u,i,s-u),r.set_color(-1579033);var h=r.get_font().width(t.fontSize,l);r.drawString(l,a+i/2-h/2,o+this.p(4)),o+=u;for(var _=0,c=e.outputs;_<c.length;){var d=c[_];++_,o+=u,r.set_color(d.color),r.drawScaledImage(Eo.socketImage,a+i-this.p(5),o-this.p(5),this.p(10),this.p(10))}o-=u*e.outputs.length,r.set_color(-1579033);for(var p=0,g=e.outputs;p<g.length;){var f=g[p];++p,o+=u;var m=t.ops.font.width(t.fontSize,f.name);r.drawString(f.name,a+i-m-this.p(12),o-this.p(7))}var v=this.handle.nest(e.id);o-=u/3;for(var y=0,w=e.buttons.length;y<w;){var b=y++,x=e.buttons[b];if("RGBA"==x.type){o+=u,t._x=a,t._y=o,t._w=i;var S=e.outputs[x.output].default_value;v.color=Cs.fromFloats(S[0],S[1],S[2]),Oo.colorWheel(t,v,!1),S[0]=.00392156862745098*((16711680&v.color)>>>16),S[1]=.00392156862745098*((65280&v.color)>>>8),S[2]=.00392156862745098*(255&v.color)}else if("VECTOR"==x.type){o+=u,t._x=a,t._y=o,t._w=i;var C=null!=x.min?x.min:0,k=null!=x.max?x.max:1,I=t.t.LABEL_COL,T=t.t.TEXT_OFFSET;t.t.LABEL_COL=-1,t.t.TEXT_OFFSET=6,t.text(x.name);var N=x.default_value[0];x.default_value[0]=t.slider(v.nest(b).nest(0,{value:N}),"X",C,k,!0,100,!0,0);var M=x.default_value[1];x.default_value[1]=t.slider(v.nest(b).nest(1,{value:M}),"Y",C,k,!0,100,!0,0);var O=x.default_value[2];x.default_value[2]=t.slider(v.nest(b).nest(2,{value:O}),"Z",C,k,!0,100,!0,0),t.t.LABEL_COL=I,t.t.TEXT_OFFSET=T,null!=x.output&&(e.outputs[x.output].default_value=x.default_value),o+=3*u}else if("VALUE"==x.type){o+=u,t._x=a,t._y=o,t._w=i;var E=e.outputs[x.output],A=null!=x.min?x.min:0,B=null!=x.max?x.max:1,L=t.t.LABEL_COL,F=t.t.TEXT_OFFSET;t.t.LABEL_COL=-1,t.t.TEXT_OFFSET=6,E.default_value=t.slider(v.nest(0,{value:E.default_value}),"Value",A,B,!0,100,!0,0),t.t.LABEL_COL=L,t.t.TEXT_OFFSET=F}else if("STRING"==x.type){o+=u,t._x=a,t._y=o,t._w=i;var W=null!=x.output?e.outputs[x.output]:null;x.default_value=t.textInput(v.nest(0,{text:null!=W?W.default_value:""}),x.name),null!=W&&(W.default_value=x.default_value)}else if("ENUM"==x.type){o+=u,t._x=a,t._y=o,t._w=i;var R=x.data instanceof Array&&null==x.data.__enum__,D=R?x.data:Eo.getEnumTexts();x.default_value=t.combo(v.nest(b,{position:x.default_value}),D,x.name),R||(x.data=Eo.mapEnum(D[x.default_value]))}else if("BOOL"==x.type)o+=u,t._x=a,t._y=o,t._w=i,t.check(v.nest(0,{selected:x.default_value}),x.name);else if("RAMP"==x.type){o+=u,t._x=a,t._y=o,t._w=i;for(var G=x.default_value,V=i/this.SCALE,H=0;H<G.length;){var P=G[H];++H;var z=P[4],Z=Cs.fromFloats(P[0],P[1],P[2]);t.fill(z*V,0,(1-z)*V,u-2*this.SCALE,Z)}t._y+=u;var X=v.nest(2);if(t.row([.25,.25,.5]),t.button("+")){var j=G[G.length-1];G.push([j[0],j[1],j[2],j[3],1]),X.value+=1}t.button("-")&&1<G.length&&(G.pop(),X.value-=1),x.data=t.combo(v.nest(1,{position:x.data}),["Linear","Constant"],"Interpolate"),t.row([.5,.5]);var Y=G[pt.int(t.slider(X,"Index",0,G.length-1,!1,1,!0,0))];v.nest(3).value=Y[4],Y[4]=t.slider(v.nest(3),"Pos",0,1,!0,100,!0,0);var U=v.nest(4);U.color=Cs.fromFloats(Y[0],Y[1],Y[2]),Oo.colorWheel(t,U,!1),Y[0]=.00392156862745098*((16711680&U.color)>>>16),Y[1]=.00392156862745098*((65280&U.color)>>>8),Y[2]=.00392156862745098*(255&U.color),o+=8*u+.5*u}else if("CURVES"==x.type){o+=u,t._x=a,t._y=o,t._w=i,t.row([.3333333333333333,.3333333333333333,.3333333333333333]),t.radio(v.nest(1),0,"X"),t.radio(v.nest(1),1,"Y"),t.radio(v.nest(1),2,"Z");var K=v.nest(1).position,Q=x.default_value[K],J=pt.int(Q.length/2);t._y+=5*u,t.row([.2,.2,.6]),t.button("+")&&(Q.push(0),Q.push(0)),t.button("-")&&4<Q.length&&(Q.pop(),Q.pop());var q=pt.int(t.slider(v.nest(2).nest(K,{position:0}),"Index",0,J-1,!1,1,!0,0));t.row([.5,.5]),v.nest(3).value=Q[2*q],v.nest(4).value=Q[2*q+1],Q[2*q]=t.slider(v.nest(3,{value:0}),"X",-1,1,!0,100,!0,0),Q[2*q+1]=t.slider(v.nest(4,{value:0}),"Y",-1,1,!0,100,!0,0),o+=7*u}}o+=u/3;for(var $=0,tt=e.inputs.length;$<tt;){var et=$++,nt=e.inputs[et];o+=u,r.set_color(nt.color),r.drawScaledImage(Eo.socketImage,a-this.p(5),o-this.p(5),this.p(10),this.p(10));for(var it=!1,rt=0,st=n.links;rt<st.length;){var at=st[rt];if(++rt,at.to_id==e.id&&at.to_socket==et){it=!0;break}}if(it||"VALUE"!=nt.type)r.set_color(-1579033),r.drawString(nt.name,a+this.p(12),o-this.p(7));else{t._x=a+this.p(6),t._y=o-this.p(9),t._w=pt.int(i-this.p(6));var ot=nt,lt=null!=ot.min?ot.min:0,ut=null!=ot.max?ot.max:1,ht=t.t.LABEL_COL,_t=t.t.TEXT_OFFSET;t.t.LABEL_COL=-1,t.t.TEXT_OFFSET=6,ot.default_value=t.slider(v.nest(et,{value:ot.default_value}),nt.name,lt,ut,!0,100,!0,0),t.t.LABEL_COL=ht,t.t.TEXT_OFFSET=_t}}},drawLink:function(t,e,n,i,r,s){null==s&&(s=!1);var a=t.g;a.set_color(s?-861033043:-864585865),a.drawLine(e,n,i,r,1),a.set_color(s?-1716671059:-1720223881),a.drawLine(e+.5,n,i+.5,r,1),a.drawLine(e-.5,n,i-.5,r,1),a.drawLine(e,n+.5,i,r+.5,1),a.drawLine(e,n-.5,i,r-.5,1)},removeNode:function(t,e){if(null!=t){for(var n=0;n<e.links.length;){var i=e.links[n];i.from_id==t.id||i.to_id==t.id?e.links.splice(n,1):++n}ut.remove(e.nodes,t)}},__class__:Eo};var Ao=function(){};(n["zui.Themes"]=Ao).__name__="zui.Themes";var Bo=function(t){this.restoreY=-1,this.restoreX=-1,this.checkSelectImage=null,this.elementsBaked=!1,this.tabScroll=0,this.tabHandle=null,this.tabNames=null,this.tooltipTime=0,this.tooltipShown=!1,this.tooltipY=0,this.tooltipX=0,this.tooltipInvertY=!1,this.tooltipImg=null,this.tooltipText="",this.comboToSubmit=0,this.submitComboHandle=null,this.comboSelectedWindow=null,this.comboSelectedHandle=null,this.tabPressedHandle=null,this.tabPressed=!1,this.textToSubmit="",this.submitTextHandle=null,this.textSelectedHandle=null,this.windowHeader=0,this.scrollingHandle=null,this.windowEnded=!0,this.imageScrollAlign=!0,this.scrollAlign=0,this.curRatio=-1,this.highlightAnchor=0,this.cursorY=0,this.cursorX=0,this.key=null,this.isAltDown=!1,this.isCtrlDown=!1,this.isShiftDown=!1,this.isKeyDown=!1,this.inputWheelDelta=0,this.inputEnabled=!0,this.inputRegistered=!1,this.scrollEnabled=!0,this.imageInvertY=!1,this.alwaysRedraw=!1,this.changed=!1,this.isReleased=!1,this.isHovered=!1,this.isPushed=!1,this.isStarted=!1,this.isTyping=!1,this.isScrolling=!1,null==t.theme&&(t.theme=Ao.dark),this.t=t.theme,null==t.khaWindowId&&(t.khaWindowId=0),null==t.scaleFactor&&(t.scaleFactor=1),null==t.scaleTexture&&(t.scaleTexture=1),null==t.autoNotifyInput&&(t.autoNotifyInput=!0),this.ops=t,this.setScale(t.scaleFactor),t.autoNotifyInput&&this.registerInput(),this.bakeElements()};(n["zui.Zui"]=Bo).__name__="zui.Zui",Bo.prototype={isScrolling:null,isTyping:null,isStarted:null,isPushed:null,isHovered:null,isReleased:null,changed:null,alwaysRedraw:null,imageInvertY:null,scrollEnabled:null,inputRegistered:null,inputEnabled:null,inputX:null,inputY:null,inputInitialX:null,inputInitialY:null,inputDX:null,inputDY:null,inputWheelDelta:null,inputStarted:null,inputStartedR:null,inputReleased:null,inputReleasedR:null,inputDown:null,inputDownR:null,isKeyDown:null,isShiftDown:null,isCtrlDown:null,isAltDown:null,key:null,char:null,cursorX:null,cursorY:null,highlightAnchor:null,ratios:null,curRatio:null,xBeforeSplit:null,wBeforeSplit:null,g:null,globalG:null,t:null,SCALE:null,ops:null,fontSize:null,fontOffsetY:null,arrowOffsetX:null,arrowOffsetY:null,titleOffsetX:null,buttonOffsetY:null,checkOffsetX:null,checkOffsetY:null,checkSelectOffsetX:null,checkSelectOffsetY:null,radioOffsetX:null,radioOffsetY:null,radioSelectOffsetX:null,radioSelectOffsetY:null,scrollAlign:null,imageScrollAlign:null,_x:null,_y:null,_w:null,_h:null,_windowX:null,_windowY:null,_windowW:null,_windowH:null,currentWindow:null,windowEnded:null,scrollingHandle:null,windowHeader:null,textSelectedHandle:null,textSelectedCurrentText:null,submitTextHandle:null,textToSubmit:null,tabPressed:null,tabPressedHandle:null,comboSelectedHandle:null,comboSelectedWindow:null,comboSelectedAlign:null,comboSelectedTexts:null,comboSelectedLabel:null,comboSelectedX:null,comboSelectedY:null,comboSelectedW:null,submitComboHandle:null,comboToSubmit:null,tooltipText:null,tooltipImg:null,tooltipInvertY:null,tooltipX:null,tooltipY:null,tooltipShown:null,tooltipTime:null,tabNames:null,tabHandle:null,tabScroll:null,elementsBaked:null,checkSelectImage:null,setScale:function(t){this.ops.scaleFactor=t,this.SCALE=this.ops.scaleFactor*this.ops.scaleTexture,this.fontSize=pt.int(this.t.FONT_SIZE*this.ops.scaleFactor);var e=this.ops.font.height(this.fontSize);this.fontOffsetY=(this.ELEMENT_H()-e)/2,this.arrowOffsetY=(this.ELEMENT_H()-this.ARROW_SIZE())/2,this.arrowOffsetX=this.arrowOffsetY,this.titleOffsetX=(2*this.arrowOffsetX+this.ARROW_SIZE())/this.SCALE,this.buttonOffsetY=(this.ELEMENT_H()-this.BUTTON_H())/2,this.checkOffsetY=(this.ELEMENT_H()-this.CHECK_SIZE())/2,this.checkOffsetX=this.checkOffsetY,this.checkSelectOffsetY=(this.CHECK_SIZE()-this.CHECK_SELECT_SIZE())/2,this.checkSelectOffsetX=this.checkSelectOffsetY,this.radioOffsetY=(this.ELEMENT_H()-this.CHECK_SIZE())/2,this.radioOffsetX=this.radioOffsetY,this.radioSelectOffsetY=(this.CHECK_SIZE()-this.CHECK_SELECT_SIZE())/2,this.radioSelectOffsetX=this.radioSelectOffsetY,this.elementsBaked=!1},bakeElements:function(){null!=this.checkSelectImage&&this.checkSelectImage.unload(),this.checkSelectImage=xs.createRenderTarget(pt.int(this.CHECK_SELECT_SIZE()),pt.int(this.CHECK_SELECT_SIZE()),null,0,1,this.ops.khaWindowId);var t=this.checkSelectImage.get_g2();t.begin(!0,0),t.set_color(this.t.ACCENT_SELECT_COL),t.drawLine(0,0,this.checkSelectImage.get_width(),this.checkSelectImage.get_height(),2*this.SCALE),t.drawLine(this.checkSelectImage.get_width(),0,0,this.checkSelectImage.get_height(),2*this.SCALE),t.end(),this.elementsBaked=!0},registerInput:function(){to.get().notifyWindowed(this.ops.khaWindowId,Fo(this,this.onMouseDown),Fo(this,this.onMouseUp),Fo(this,this.onMouseMove),Fo(this,this.onMouseWheel)),$a.get().notify(Fo(this,this.onKeyDown),Fo(this,this.onKeyUp),Fo(this,this.onKeyPress)),zs.notifyOnCutCopyPaste(Fo(this,this.onCut),Fo(this,this.onCopy),Fo(this,this.onPaste)),this.inputRegistered=!0},begin:function(t){this.elementsBaked||this.bakeElements(),this.changed=!1,this.globalG=t,this._x=0,this._y=0,this._w=0,this._h=0},end:function(t){null==t&&(t=!0),this.windowEnded||this.endWindow(),null!=this.comboSelectedHandle&&this.drawCombo(),t&&this.endInput(),null!=this.tabPressedHandle&&(this.tabPressedHandle=null)},endInput:function(){this.isKeyDown=!1,this.inputStarted=!1,this.inputStartedR=!1,this.inputReleased=!1,this.inputReleasedR=!1,this.inputDX=0,this.inputDY=0,this.inputWheelDelta=0,Bo.textToPaste="",Bo.isCut=!1},beginLayout:function(t,e,n,i){this.elementsBaked||this.bakeElements(),this.currentWindow=null,this.g=t,this._windowX=0,this._windowY=0,this._windowW=i,this._x=e,this._y=n,this._w=i},endLayout:function(t){null==t&&(t=!0),t&&this.endInput()},inputChanged:function(){return!!(0!=this.inputDX||0!=this.inputDY||0!=this.inputWheelDelta||this.inputStarted||this.inputStartedR||this.inputReleased||this.inputReleasedR||this.inputDown||this.inputDownR)||this.isKeyDown},windowDirty:function(t,e,n,i,r){var s=e+t.dragX,a=n+t.dragY,o=this.getInputInRect(s,a,i,r)&&this.inputChanged();return!!(this.alwaysRedraw||this.isScrolling||this.isTyping)||o},window:function(t,e,n,i,r,s){return null==s&&(s=!1),null!=t.texture&&i==t.texture.get_width()&&r==t.texture.get_height()||this.resize(t,i,r,this.ops.khaWindowId),this.windowEnded||this.endWindow(),this.windowEnded=!1,this.g=t.texture.get_g2(),this.currentWindow=t,this._windowX=e+t.dragX,this._windowY=n+t.dragY,this._windowW=i,this._windowH=r,this.windowHeader=0,this.windowDirty(t,e,n,i,r)&&(t.redraws=2),0!=t.redraws&&(this._x=0,this._y=t.scrollOffset,1==t.layout&&(i=pt.int(this.ELEMENT_W())),this._w=t.scrollEnabled?i-this.SCROLL_W():i,this._h=r,this.tooltipText="",this.tooltipImg=null,this.tabNames=null,this.t.FILL_WINDOW_BG?this.g.begin(!0,this.t.WINDOW_BG_COL):(this.g.begin(!0,0),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x,this._y-t.scrollOffset,t.lastMaxX,t.lastMaxY)),(t.dragEnabled=s)&&(this.inputStarted&&this.getInputInRect(this._windowX,this._windowY,this._windowW,15)?t.dragging=!0:this.inputReleased&&(t.dragging=!1),t.dragging&&(t.redraws=2,t.dragX+=pt.int(this.inputDX),t.dragY+=pt.int(this.inputDY)),this._y+=15,this.windowHeader+=15),!0)},endWindow:function(t){null==t&&(t=!0);var e=this.currentWindow;if(null!=e){if(0<e.redraws||this.isScrolling||this.isTyping){null!=this.tabNames&&this.drawTabs(),e.dragEnabled&&(this.g.set_color(this.t.SEPARATOR_COL),this.g.fillRect(0,0,this._windowW,15));var n=this._y-e.scrollOffset;if(n<this._windowH||1==e.layout||!this.scrollEnabled)e.scrollEnabled=!1,e.scrollOffset=0;else{e.scrollEnabled=!0,this.tabScroll<0&&(e.scrollOffset=this.tabScroll,this.tabScroll=0);var i=n-this._windowH,r=-e.scrollOffset/i,s=this._windowH*Math.abs(this._windowH/n);s=Math.max(s,this.ELEMENT_H());var a=this._windowH-s,o=i/a,l=a*r;this.inputStarted&&this.getInputInRect(this._windowX+this._windowW-this.SCROLL_W(),l+this._windowY,this.SCROLL_W(),s)&&(e.scrolling=!0,this.scrollingHandle=e,this.isScrolling=!0),e.scrolling?this.scroll(this.inputDY*o,n):0!=this.inputWheelDelta&&this.scroll(this.inputWheelDelta*this.ELEMENT_H(),n),0<e.scrollOffset?e.scrollOffset=0:n+e.scrollOffset<this._windowH&&(e.scrollOffset=this._windowH-n),this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._windowW-this.SCROLL_W(),this._windowY,this.SCROLL_W(),this._windowH),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this._windowW-this.SCROLL_W()-this.scrollAlign,l,this.SCROLL_W(),s)}e.lastMaxX=this._x,e.lastMaxY=this._y,0==e.layout?e.lastMaxX+=this._windowW:e.lastMaxY+=this._windowH,e.redraws--,this.g.end()}this.windowEnded=!0,t&&this.globalG.begin(!1),this.globalG.set_color(this.t.WINDOW_TINT_COL),this.globalG.drawScaledImage(e.texture,this._windowX,this._windowY,e.texture.get_width()/this.ops.scaleTexture,e.texture.get_height()/this.ops.scaleTexture),""!=this.tooltipText||null!=this.tooltipImg?(this.tooltipShown||(this.tooltipShown=!0,this.tooltipX=this.inputX,this.tooltipTime=Ws.time()),Ws.time()-this.tooltipTime>this.t.TOOLTIP_DELAY&&(""!=this.tooltipText?this.drawTooltip():this.drawTooltipImage())):this.tooltipShown=!1,t&&this.globalG.end()}},scroll:function(t,e){this.currentWindow.scrollOffset-=t},restoreX:null,restoreY:null,drawTabs:function(){if(this.inputX=this.restoreX,this.inputY=this.restoreY,null!=this.currentWindow){var t=0,e=this._y;this._y=this.currentWindow.dragEnabled?15:0,this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(0,this._y,this._windowW,this.buttonOffsetY+this.BUTTON_H()),this.g.set_color(this.t.ACCENT_COL),this.g.fillRect(this.buttonOffsetY,this._y+this.buttonOffsetY+this.BUTTON_H(),this._windowW-2*this.buttonOffsetY,this.LINE_STRENGTH());for(var n=0,i=this.tabNames.length;n<i;){var r=n++;this._x=t,this._w=pt.int(this.ops.font.width(this.fontSize,this.tabNames[r])+2*this.buttonOffsetY+14*this.SCALE);var s=this.getReleased(),a=this.getPushed(),o=this.getHover();if(s){var l=this.tabHandle.nest(this.tabHandle.position);l.scrollOffset=this.currentWindow.scrollOffset,l=this.tabHandle.nest(r),this.tabScroll=l.scrollOffset,this.tabHandle.position=r,this.currentWindow.redraws=3}var u=this.tabHandle.position==r;this.g.set_color(a?this.t.ACCENT_HOVER_COL:o?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),t+=this._w+5,this.drawRect(this.g,!u,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w,this.BUTTON_H()),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,this.tabNames[r],this.TEXT_OFFSET(),0,0),u&&(this.g.set_color(this.t.WINDOW_BG_COL),this.g.fillRect(this._x+this.buttonOffsetY+1,this._y+this.buttonOffsetY+this.BUTTON_H(),this._w-1,this.LINE_STRENGTH()))}this._x=0,this._y=e,this._w=pt.int(this.currentWindow.scrollEnabled?this._windowW-this.SCROLL_W():this._windowW)}},image:function(t,e,n){null==e&&(e=-1);var i=t.get_width()*this.SCALE,r=t.get_height()*this.SCALE,s=Math.min(i,this._w),a=this._x;if(this.imageScrollAlign&&(s=Math.min(i,this._w-2*this.buttonOffsetY),a+=this.buttonOffsetY,!(null!=this.currentWindow&&this.currentWindow.scrollEnabled))){var o=-1==this.curRatio?1:this.ratios[this.curRatio];s-=this.SCROLL_W()*o,a+=this.SCROLL_W()*o/2}var l=null==n?s/i:n/r;if(null==n?n=r*l:s=i*l,!this.isVisible(n))return this.endElement(n),0;var u=this.getStarted(n),h=this.getPushed(n),_=this.getReleased(n);this.getHover();this.g.set_color(e);var c=n;return this.imageInvertY?this.g.drawScaledImage(t,a,this._y+c,s,-c):this.g.drawScaledImage(t,a,this._y,s,c),this.endElement(n),u?1:_?3:h?2:0},text:function(t,e,n){null==n&&(n=0),null==e&&(e=0),this.isVisible(this.ELEMENT_H())&&(this.getReleased(),0!=n&&(this.g.set_color(n),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H())),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.TEXT_OFFSET(),0,e)),this.endElement()},startTextEdit:function(t){this.isTyping=!0,this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=t,this.textSelectedCurrentText=t.text,this.tabPressed=!1,this.tabPressedHandle=t,this.cursorX=t.text.length,this.cursorY=0,this.highlightAnchor=0,null!=$a.get()&&$a.get().show()},submitTextEdit:function(){this.submitTextHandle.text=this.textToSubmit,this.submitTextHandle.changed=this.changed=!0,this.submitTextHandle=null,this.textToSubmit="",this.textSelectedCurrentText=""},updateTextEdit:function(t){null==t&&(t=0);var e=this.textSelectedCurrentText;this.isKeyDown&&(37==this.key?0<this.cursorX&&this.cursorX--:39==this.key?this.cursorX<e.length&&this.cursorX++:8==this.key?0<this.cursorX&&this.highlightAnchor==this.cursorX?(e=ut.substr(e,0,this.cursorX-1)+ut.substr(e,this.cursorX,e.length),this.cursorX--):this.highlightAnchor<this.cursorX?(e=ut.substr(e,0,this.highlightAnchor)+ut.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=ut.substr(e,0,this.cursorX)+ut.substr(e,this.highlightAnchor,e.length):46==this.key?this.highlightAnchor==this.cursorX?e=ut.substr(e,0,this.cursorX)+ut.substr(e,this.cursorX+1,null):this.highlightAnchor<this.cursorX?(e=ut.substr(e,0,this.highlightAnchor)+ut.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=ut.substr(e,0,this.cursorX)+ut.substr(e,this.highlightAnchor,e.length):13==this.key?this.deselectText():27==this.key?(this.textSelectedCurrentText=this.textSelectedHandle.text,this.deselectText()):9==this.key?(this.tabPressed=!0,this.deselectText(),this.key=null):36==this.key?this.cursorX=0:35==this.key?this.cursorX=e.length:16!=this.key&&20!=this.key&&17!=this.key&&18!=this.key&&null!=this.char&&""!=this.char&&32<=ut.cca(this.char,0)&&127!=ut.cca(this.char,0)&&(e=ut.substr(e,0,this.highlightAnchor)+this.char+ut.substr(e,this.cursorX,null),this.cursorX++),this.isShiftDown&&(37==this.key||39==this.key)||this.isCtrlDown||(this.highlightAnchor=this.cursorX));""!=Bo.textToPaste&&(e=ut.substr(e,0,this.highlightAnchor)+Bo.textToPaste+ut.substr(e,this.cursorX,null),this.cursorX+=Bo.textToPaste.length,this.highlightAnchor=this.cursorX,Bo.textToPaste=""),this.highlightAnchor==this.cursorX?Bo.textToCopy=e:this.highlightAnchor<this.cursorX?Bo.textToCopy=e.substring(this.highlightAnchor,this.cursorX):Bo.textToCopy=e.substring(this.cursorX,this.highlightAnchor),Bo.isCut&&(this.highlightAnchor==this.cursorX?e="":this.highlightAnchor<this.cursorX?(e=ut.substr(e,0,this.highlightAnchor)+ut.substr(e,this.cursorX,e.length),this.cursorX=this.highlightAnchor):e=ut.substr(e,0,this.cursorX)+ut.substr(e,this.highlightAnchor,e.length));var n=this.TEXT_OFFSET(),i=this.ELEMENT_H(),r=i-3*this.buttonOffsetY;if(this.highlightAnchor!=this.cursorX){var s=this.cursorX,a=this.highlightAnchor;this.highlightAnchor<this.cursorX&&(s=this.highlightAnchor,a=this.cursorX);var o=ut.substr(e,s,a-s),l=this.g.get_font().width(this.g.get_fontSize(),o),u=this.g.get_font().width(this.g.get_fontSize(),ut.substr(e,0,s)),h=0==t?this._x+u+n:this._x+this._w-l-n;2==t&&(h-=this.g.get_font().width(this.g.get_fontSize(),ut.substr(e,a,e.length))),this.g.fillRect(h,this._y+this.cursorY*i+1.5*this.buttonOffsetY,l*this.SCALE,r)}if(Ws.time()%(2*this.t.FLASH_SPEED)<this.t.FLASH_SPEED){this.g.set_color(this.t.TEXT_COL);var _=0==t?ut.substr(e,0,this.cursorX):e.substring(this.cursorX,e.length),c=this.g.get_font().width(this.g.get_fontSize(),_),d=0==t?this._x+c+n:this._x+this._w-c-n;this.g.fillRect(d,this._y+this.cursorY*i+1.5*this.buttonOffsetY,this.SCALE,r)}this.textSelectedCurrentText=e},textInput:function(t,e,n){if(null==n&&(n=0),null==e&&(e=""),!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.text;var i=this.getHover();this.g.set_color(i?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H());var r=this.getReleased()||this.tabPressed;if(this.textSelectedHandle!=t&&r&&this.startTextEdit(t),this.textSelectedHandle==t&&this.updateTextEdit(n),this.submitTextHandle==t?this.submitTextEdit():t.changed=!1,""!=e){this.g.set_color(this.t.LABEL_COL);var s=2==n?0:2,a=0==s?7:0;this.drawString(this.g,e,a,0,s)}return this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.text,null,0,n):this.drawString(this.g,this.textSelectedCurrentText,null,0,n),this.endElement(),t.text},deselectText:function(){this.submitTextHandle=this.textSelectedHandle,this.textToSubmit=this.textSelectedCurrentText,this.textSelectedHandle=null,this.isTyping=!1,null!=this.currentWindow&&(this.currentWindow.redraws=2),null!=$a.get()&&$a.get().hide(),this.highlightAnchor=this.cursorX},button:function(t,e){if(null==e&&(e=1),!this.isVisible(this.ELEMENT_H()))return this.endElement(),!1;var n=this.getReleased(),i=this.getPushed(),r=this.getHover();return this.g.set_color(i?this.t.BUTTON_PRESSED_COL:r?this.t.BUTTON_HOVER_COL:this.t.BUTTON_COL),this.drawRect(this.g,this.t.FILL_BUTTON_BG,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H()),this.g.set_color(this.t.BUTTON_TEXT_COL),this.drawString(this.g,t,this.TEXT_OFFSET(),0,e),this.endElement(),n},check:function(t,e){if(!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.selected;this.getReleased()?(t.selected=!t.selected,t.changed=this.changed=!0):t.changed=!1;var n=this.getHover();return this.drawCheck(t.selected,n),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,e,this.titleOffsetX,0,0),this.endElement(),t.selected},radio:function(t,e,n){if(!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.position==e;this.getReleased()?(t.position=e,t.changed=this.changed=!0):t.changed=!1;var i=this.getHover();return this.drawRadio(t.position==e,i),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,n,this.titleOffsetX,0),this.endElement(),t.position==e},inlineRadio:function(t,e){if(!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.position;this.getReleased()?(++t.position>=e.length&&(t.position=0),t.changed=this.changed=!0):t.changed=!1;var n=this.getHover();return this.drawInlineRadio(e[t.position],n),this.endElement(),t.position},combo:function(t,e,n,i,r){if(null==r&&(r=0),null==i&&(i=!1),null==n&&(n=""),!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.position;this.getReleased()&&null==this.comboSelectedHandle&&(this.inputEnabled=!1,this.comboSelectedHandle=t,this.comboSelectedWindow=this.currentWindow,this.comboSelectedAlign=r,this.comboSelectedTexts=e,this.comboSelectedLabel=n,this.comboSelectedX=pt.int(this._x+this._windowX),this.comboSelectedY=pt.int(this._y+this._windowY+this.ELEMENT_H()+this.ELEMENT_OFFSET()),this.comboSelectedW=pt.int(this._w)),t==this.submitComboHandle?(t.position=this.comboToSubmit,this.submitComboHandle=null,t.changed=this.changed=!0):t.changed=!1,this.getHover()?this.g.set_color(this.t.ACCENT_HOVER_COL):this.g.set_color(this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H());var s=this._x+this._w-this.arrowOffsetX-8,a=this._y+this.arrowOffsetY+3;return this.g.fillTriangle(s,a,s+this.ARROW_SIZE(),a,s+this.ARROW_SIZE()/2,a+this.ARROW_SIZE()/2),this.g.set_color(this.t.TEXT_COL),i&&""!=n&&(0==r&&(this._x-=15),this.drawString(this.g,n,null,0,0==r?2:0),0==r&&(this._x+=15)),2==r&&(this._x-=15),this.drawString(this.g,e[t.position],null,0,r),2==r&&(this._x+=15),this.endElement(),t.position},slider:function(t,e,n,i,r,s,a,o,l){if(null==l&&(l=!0),null==o&&(o=2),null==a&&(a=!0),null==s&&(s=100),null==r&&(r=!1),null==i&&(i=1),null==n&&(n=0),!this.isVisible(this.ELEMENT_H()))return this.endElement(),t.value;if(this.getStarted()&&(t.scrolling=!0,this.scrollingHandle=t,this.isScrolling=!0),t.changed=!1,t.scrolling){var u=i-n,h=this._x+this._windowX+this.buttonOffsetY,_=u/(this._w-2*this.buttonOffsetY),c=n+(this.inputX-h)*_;t.value=Math.round(c*s)/s,t.value<n?t.value=n:t.value>i&&(t.value=i),t.changed=this.changed=!0}var d=this.getHover();this.drawSlider(t.value,n,i,r,d),(this.getReleased()||this.tabPressed)&&l&&(t.text=t.value+"",this.startTextEdit(t));var p=0==o?2:0;return this.textSelectedHandle==t&&this.updateTextEdit(p),this.submitTextHandle==t&&(this.submitTextEdit(),t.value=pt.parseFloat(t.text)),this.g.set_color(this.t.LABEL_COL),this.drawString(this.g,e,null,0,o),a&&(this.g.set_color(this.t.TEXT_COL),this.textSelectedHandle!=t?this.drawString(this.g,t.value+"",null,0,p):this.drawString(this.g,this.textSelectedCurrentText,null,0,p)),this.endElement(),t.value},drawCheck:function(t,e){var n=this._x+this.checkOffsetX,i=this._y+this.checkOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,n,i,this.CHECK_SIZE(),this.CHECK_SIZE()),t&&(this.g.set_color(-1),this.g.drawImage(this.checkSelectImage,n+this.checkSelectOffsetX,i+this.checkSelectOffsetY))},drawRadio:function(t,e){var n=this._x+this.radioOffsetX,i=this._y+this.radioOffsetY;this.g.set_color(e?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,n,i,this.CHECK_SIZE(),this.CHECK_SIZE()),t&&(this.g.set_color(this.t.ACCENT_SELECT_COL),this.g.fillRect(n+this.radioSelectOffsetX,i+this.radioSelectOffsetY,this.CHECK_SELECT_SIZE(),this.CHECK_SELECT_SIZE()))},drawInlineRadio:function(t,e){e?(this.g.set_color(this.t.ACCENT_HOVER_COL),this.g.fillRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H())):(this.g.set_color(this.t.ACCENT_COL),this.g.drawRect(this._x+this.buttonOffsetY,this._y+this.buttonOffsetY,this._w-2*this.buttonOffsetY,this.BUTTON_H())),this.g.set_color(this.t.TEXT_COL),this.drawString(this.g,t,this.titleOffsetX,0,1)},drawSlider:function(t,e,n,i,r){var s=this._x+this.buttonOffsetY,a=this._y+this.buttonOffsetY,o=this._w-2*this.buttonOffsetY;this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL),this.drawRect(this.g,this.t.FILL_ACCENT_BG,s,a,o,this.BUTTON_H()),this.g.set_color(r?this.t.ACCENT_HOVER_COL:this.t.ACCENT_COL);var l=(t-e)/(n-e),u=8*this.SCALE,h=i?s:s+(o-u)*l,_=i?o*l:u;_=Math.min(_,o),this.g.fillRect(h,a,_,this.BUTTON_H())},drawCombo:function(){var t=this.g;this.globalG.set_color(-14540254);var e=this.ELEMENT_H()+this.ELEMENT_OFFSET();this.globalG.begin(!1),this.globalG.fillRect(this.comboSelectedX,this.comboSelectedY,this.comboSelectedW,(this.comboSelectedTexts.length+1)*e),this.beginLayout(this.globalG,this.comboSelectedX,this.comboSelectedY,this.comboSelectedW),this.inputEnabled=!0;for(var n=0,i=this.comboSelectedTexts.length;n<i;){var r=n++;if(this.button(this.comboSelectedTexts[r],this.comboSelectedAlign)){this.comboToSubmit=r,this.submitComboHandle=this.comboSelectedHandle,null!=this.comboSelectedWindow&&(this.comboSelectedWindow.redraws=2);break}}this.text(this.comboSelectedLabel),this.inputReleased&&!Bo.comboFirst?(this.comboSelectedHandle=null,Bo.comboFirst=!0):Bo.comboFirst=!1,this.inputEnabled=null==this.comboSelectedHandle,this.endLayout(!1),this.globalG.end(),this.g=t},drawTooltip:function(){this.globalG.set_color(this.t.TEXT_COL);for(var t=this.tooltipText.split("\n"),e=0,n=0;n<t.length;){var i=t[n];++n;var r=this.ops.font.width(this.fontSize,i);e<r&&(e=r)}this.tooltipX=Math.min(this.tooltipX,zs.windowWidth()-e-20),this.globalG.fillRect(this.tooltipX,this.tooltipY,e+20,this.ELEMENT_H()*t.length*.6),this.globalG.set_font(this.ops.font),this.globalG.set_fontSize(this.fontSize),this.globalG.set_color(this.t.ACCENT_COL);for(var s=0,a=t.length;s<a;){var o=s++;this.globalG.drawString(t[o],this.tooltipX+5,this.tooltipY+o*this.fontSize)}},drawTooltipImage:function(){this.tooltipX=Math.min(this.tooltipX,zs.windowWidth()-this.tooltipImg.get_width()-20),this.globalG.set_color(-16777216),this.globalG.fillRect(this.tooltipX,this.tooltipY,this.tooltipImg.get_width(),this.tooltipImg.get_height()),this.globalG.set_color(-1),this.tooltipInvertY?this.globalG.drawScaledImage(this.tooltipImg,this.tooltipX,this.tooltipY+this.tooltipImg.get_height(),this.tooltipImg.get_width(),-this.tooltipImg.get_height()):this.globalG.drawImage(this.tooltipImg,this.tooltipX,this.tooltipY)},drawString:function(t,e,n,i,r){null==r&&(r=0),null==i&&(i=0);var s=pt.int(this._w/pt.int(this.fontSize/2));e.length>s&&(e=e.substring(0,s)+".."),null==n&&(n=this.t.TEXT_OFFSET),n*=this.SCALE,t.set_font(this.ops.font),t.set_fontSize(this.fontSize),1==r?n=this._w/2-this.ops.font.width(this.fontSize,e)/2:2==r&&(n=this._w-this.ops.font.width(this.fontSize,e)-this.TEXT_OFFSET()),t.drawString(e,this._x+n,this._y+this.fontOffsetY+i)},endElement:function(t){null!=this.currentWindow?0==this.currentWindow.layout?-1==this.curRatio||null!=this.ratios&&this.curRatio==this.ratios.length-1?(null==t&&(t=this.ELEMENT_H()+this.ELEMENT_OFFSET()),this._y+=t,null!=this.ratios&&this.curRatio==this.ratios.length-1&&(this.curRatio=-1,this.ratios=null,this._x=this.xBeforeSplit,this._w=this.wBeforeSplit)):(this.curRatio++,this._x+=this._w,this._w=pt.int(this.wBeforeSplit*this.ratios[this.curRatio])):this._x+=this._w+this.ELEMENT_OFFSET():this._y+=this.ELEMENT_H()+this.ELEMENT_OFFSET()},row:function(t){this.ratios=t,this.curRatio=0,this.xBeforeSplit=this._x,this.wBeforeSplit=this._w,this._w=pt.int(this._w*t[this.curRatio])},fill:function(t,e,n,i,r){this.g.set_color(r),this.g.fillRect(this._x+t*this.SCALE,this._y+e*this.SCALE,n*this.SCALE,i*this.SCALE),this.g.set_color(-1)},drawRect:function(t,e,n,i,r,s,a){null==a&&(a=0),0==a&&(a=this.LINE_STRENGTH()),e?t.fillRect(n,i,r,s):t.drawRect(n,i,r,s,a)},isVisible:function(t){return null==this.currentWindow||0<this._y+t&&this._y<this.currentWindow.texture.get_height()},getReleased:function(t){return null==t&&(t=-1),this.isReleased=this.inputEnabled&&this.inputReleased&&this.getHover(t)&&this.getInitialHover(t),this.isReleased},getPushed:function(t){return null==t&&(t=-1),this.isPushed=this.inputEnabled&&this.inputDown&&this.getHover(t)&&this.getInitialHover(t),this.isPushed},getStarted:function(t){return null==t&&(t=-1),this.isStarted=this.inputEnabled&&this.inputStarted&&this.getHover(t),this.isStarted},getInitialHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.ELEMENT_H()),!!(this.inputEnabled&&this.inputInitialX>=this._windowX+this._x&&this.inputInitialX<this._windowX+this._x+this._w&&this.inputInitialY>=this._windowY+this._y)&&this.inputInitialY<this._windowY+this._y+t},getHover:function(t){return null==t&&(t=-1),-1==t&&(t=this.ELEMENT_H()),this.isHovered=this.inputEnabled&&this.inputX>=this._windowX+this._x&&this.inputX<this._windowX+this._x+this._w&&this.inputY>=this._windowY+this._y&&this.inputY<this._windowY+this._y+t,this.isHovered},getInputInRect:function(t,e,n,i,r){return null==r&&(r=1),!!(this.inputEnabled&&this.inputX>=t*r&&this.inputX<(t+n)*r&&this.inputY>=e*r)&&this.inputY<(e+i)*r},onMouseDown:function(t,e,n){0==t?this.inputStarted=!0:this.inputStartedR=!0,0==t?this.inputDown=!0:this.inputDownR=!0;var i=pt.int(e*this.ops.scaleTexture),r=pt.int(n*this.ops.scaleTexture);this.setInputPosition(i,r),this.inputInitialX=i,this.inputInitialY=r},onMouseUp:function(t,e,n){0==t?this.isScrolling?(this.isScrolling=!1,null!=this.scrollingHandle&&(this.scrollingHandle.scrolling=!1),e==this.inputInitialX&&n==this.inputInitialY&&(this.inputReleased=!0)):this.inputReleased=!0:1==t&&(this.inputReleasedR=!0),0==t?this.inputDown=!1:this.inputDownR=!1,this.setInputPosition(pt.int(e*this.ops.scaleTexture),pt.int(n*this.ops.scaleTexture)),this.deselectText()},onMouseMove:function(t,e,n,i){this.setInputPosition(pt.int(t*this.ops.scaleTexture),pt.int(e*this.ops.scaleTexture))},onMouseWheel:function(t){this.inputWheelDelta=t},setInputPosition:function(t,e){this.inputDX+=t-this.inputX,this.inputDY+=e-this.inputY,this.inputX=t,this.inputY=e},onKeyDown:function(t){switch(this.key=t,this.isKeyDown=!0,t){case 16:this.isShiftDown=!0;break;case 17:this.isCtrlDown=!0;break;case 18:this.isAltDown=!0;break;case 32:this.char=" "}},onKeyUp:function(t){switch(t){case 16:this.isShiftDown=!1;break;case 17:this.isCtrlDown=!1;break;case 18:this.isAltDown=!1}},onKeyPress:function(t){this.char=t,this.isKeyDown=!0},onCut:function(){return Bo.isCut=!0,this.onCopy()},onCopy:function(){return Bo.textToCopy},onPaste:function(t){Bo.textToPaste=t},ELEMENT_W:function(){return this.t.ELEMENT_W*this.SCALE},ELEMENT_H:function(){return this.t.ELEMENT_H*this.SCALE},ELEMENT_OFFSET:function(){return this.t.ELEMENT_OFFSET*this.SCALE},ARROW_SIZE:function(){return this.t.ARROW_SIZE*this.SCALE},BUTTON_H:function(){return this.t.BUTTON_H*this.SCALE},CHECK_SIZE:function(){return this.t.CHECK_SIZE*this.SCALE},CHECK_SELECT_SIZE:function(){return this.t.CHECK_SELECT_SIZE*this.SCALE},SCROLL_W:function(){return pt.int(this.t.SCROLL_W*this.SCALE)},TEXT_OFFSET:function(){return this.t.TEXT_OFFSET},LINE_STRENGTH:function(){return this.t.LINE_STRENGTH*this.SCALE},resize:function(t,e,n,i){null==i&&(i=0),t.redraws=2,null!=t.texture&&t.texture.unload(),t.texture=xs.createRenderTarget(e,n,za.RGBA32,0,1,i),t.texture.get_g2().set_imageScaleQuality(oa.High)},__class__:Bo};var Lo=0;function Fo(t,e){return null==e?null:(null==e.__id__&&(e.__id__=Lo++),null==t.hx__closures__?t.hx__closures__={}:n=t.hx__closures__[e.__id__],null==n&&(n=e.bind(t),t.hx__closures__[e.__id__]=n),n);var n}n.Math=Math,null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),String.prototype.__class__=n.String=String,String.__name__="String",n.Array=Array,Array.__name__="Array",Date.prototype.__class__=n.Date=Date,Date.__name__="Date";var Wo={},Ro={},Do=Number,Go=Boolean,Vo={},Ho={};or.count=0;var Po={};Object.defineProperty(us.prototype,"message",{get:function(){return String(this.val)}}),null==ArrayBuffer.prototype.slice&&(ArrayBuffer.prototype.slice=ds.sliceImpl),_.lastW=-1,_.lastH=-1,wt.displayIndex=0,Dn.registered=!1,Dn.map=new ur,Vn.registered=!1,Vn.map=new ur,Vn.node="",Pn.registered=!1,Pn.map=new ur,bi.helpVec=new wi,bi.helpMat=bi.identity(),xi.helpVec0=new wi,xi.helpMat=bi.identity(),xi.xAxis=wi.xAxis(),xi.yAxis=wi.yAxis(),Si.q=new xi,Si.v1=new wi,Si.v2=new wi,Pi.drawMeshes=Hi.drawMeshes,zi.events=new ur,Zi.packageName="armory.logicnode",qi.USE_CACHE=!1,qi.USE_ENUM_INDEX=!1,qi.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",tr.DEFAULT_RESOLVER=new $i,tr.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",gr.helper=new DataView(new ArrayBuffer(8)),mr.traitInits=[],mr.traitUpdates=[],mr.traitLateUpdates=[],mr.traitRenders=[],mr.traitRenders2D=[],mr.pauseUpdates=!1,mr.lastw=-1,mr.lasth=-1,br.uidCounter=0,br.framePassed=!0,Cr.cachedSceneRaws=new ur,Cr.cachedMeshes=new ur,Cr.cachedLights=new ur,Cr.cachedCameras=new ur,Cr.cachedMaterials=new ur,Cr.cachedWorlds=new ur,Cr.cachedShaders=new ur,Cr.cachedBlobs=new ur,Cr.cachedImages=new ur,Cr.cachedFonts=new ur,Cr.dataPath="",Cr.loadingMeshes=new ur,Cr.loadingLights=new ur,Cr.loadingCameras=new ur,Cr.loadingMaterials=new ur,Cr.loadingWorlds=new ur,Cr.loadingShaders=new ur,Cr.loadingSceneRaws=new ur,Cr.assetsLoaded=0,Cr.loadingBlobs=new ur,Cr.loadingImages=new ur,Cr.loadingFonts=new ur,Tr.uidCounter=0,Nr.num=0,Wr.m1=bi.identity(),Wr.m2=bi.identity(),Wr.vpos=new wi,Wr.vpos2=new wi,Wr.vscl=new wi,Wr.vscl2=new wi,Wr.q1=new xi,Wr.q2=new xi,Wr.q3=new xi,Wr.vp=new wi,Wr.vs=new wi,Rr.uidCounter=0,Rr.seed=1,Dr.temp=new wi,Dr.sphereCenter=new wi,Dr.vcenter=new wi,Dr.vup=new wi,Hr.cascadeBounds=1,Hr.m=bi.identity(),Hr.eye=new wi,jr.temp=bi.identity(),Ur.biasMat=new bi(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),Ur.helpMat=bi.identity(),Ur.helpMat2=bi.identity(),Ur.helpMat3=Lr.identity(),Ur.helpVec=new wi,Ur.helpVec2=new wi,Ur.helpQuat=new xi,Jr.occupied=!1,Jr.gamepads=[],Jr.registered=!1,ts.buttons=["left","right","middle"],ns.keys=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9",".",",","space","backspace","tab","enter","shift","control","alt","escape","delete","back","up","right","left","down","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12"],rs.buttonsPS=["cross","circle","square","triangle","l1","r1","l2","r2","share","options","l3","r3","up","down","left","right","home","touchpad"],rs.buttons=rs.buttonsPS,os.scale=1,os.last=0,os.realDelta=0,ls.eases=[ls.easeLinear,ls.easeSineIn,ls.easeSineOut,ls.easeSineInOut,ls.easeQuadIn,ls.easeQuadOut,ls.easeQuadInOut,ls.easeCubicIn,ls.easeCubicOut,ls.easeCubicInOut,ls.easeQuartIn,ls.easeQuartOut,ls.easeQuartInOut,ls.easeQuintIn,ls.easeQuintOut,ls.easeQuintInOut,ls.easeExpoIn,ls.easeExpoOut,ls.easeExpoInOut,ls.easeCircIn,ls.easeCircOut,ls.easeCircInOut,ls.easeBackIn,ls.easeBackOut,ls.easeBackInOut],ls.anims=[],ls.registered=!1,hs.__toStr={}.toString,ys.images=new ps,ys.sounds=new gs,ys.blobs=new fs,ys.fonts=new ms,ys.videos=new vs,ks.canvas_id="khanvas",Is.instance=new Is,Ws.DIF_COUNT=3,Ws.maxframetime=.5,Ws.startTime=0,Rs.Material_mesh_vertData0="s402:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgVzsKdW5pZm9ybSBtYXQzIE47CnVuaWZvcm0gbWF0NCBXVlA7CgphdHRyaWJ1dGUgdmVjMyBwb3M7CnZhcnlpbmcgdmVjMyB3cG9zaXRpb247CnZhcnlpbmcgdmVjMyB3bm9ybWFsOwphdHRyaWJ1dGUgdmVjMyBub3I7Cgp2b2lkIG1haW4oKQp7CiAgICB2ZWM0IHNwb3MgPSB2ZWM0KHBvcywgMS4wKTsKICAgIHdwb3NpdGlvbiA9IHZlYzQoVyAqIHNwb3MpLnh5ejsKICAgIHdub3JtYWwgPSBub3JtYWxpemUoTiAqIG5vcik7CiAgICBnbF9Qb3NpdGlvbiA9IFdWUCAqIHNwb3M7Cn0KCg",Rs.Material_mesh_vertData1="s487:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXOwp1bmlmb3JtIG1lZGl1bXAgbWF0MyBOOwp1bmlmb3JtIG1lZGl1bXAgbWF0NCBXVlA7CgphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIHBvczsKdmFyeWluZyBtZWRpdW1wIHZlYzMgd3Bvc2l0aW9uOwp2YXJ5aW5nIG1lZGl1bXAgdmVjMyB3bm9ybWFsOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWMzIG5vcjsKCnZvaWQgbWFpbigpCnsKICAgIG1lZGl1bXAgdmVjNCBzcG9zID0gdmVjNChwb3MsIDEuMCk7CiAgICB3cG9zaXRpb24gPSB2ZWM0KFcgKiBzcG9zKS54eXo7CiAgICB3bm9ybWFsID0gbm9ybWFsaXplKE4gKiBub3IpOwogICAgZ2xfUG9zaXRpb24gPSBXVlAgKiBzcG9zOwp9Cgo",Rs.Material_mesh_vertData2="s376:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgVzsKdW5pZm9ybSBtYXQzIE47CnVuaWZvcm0gbWF0NCBXVlA7CgppbiB2ZWMzIHBvczsKb3V0IHZlYzMgd3Bvc2l0aW9uOwpvdXQgdmVjMyB3bm9ybWFsOwppbiB2ZWMzIG5vcjsKCnZvaWQgbWFpbigpCnsKICAgIHZlYzQgc3BvcyA9IHZlYzQocG9zLCAxLjApOwogICAgd3Bvc2l0aW9uID0gdmVjNChXICogc3BvcykueHl6OwogICAgd25vcm1hbCA9IG5vcm1hbGl6ZShOICogbm9yKTsKICAgIGdsX1Bvc2l0aW9uID0gV1ZQICogc3BvczsKfQoK",Rs.Material_mesh_fragData0="s1339:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0RGlyOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKdmFyeWluZyBoaWdocCB2ZWMzIHdub3JtYWw7CnZhcnlpbmcgaGlnaHAgdmVjMyB3cG9zaXRpb247CgpoaWdocCBmbG9hdCBhdHRlbnVhdGUoaGlnaHAgZmxvYXQgZGlzdCkKewogICAgcmV0dXJuIDEuMCAvIChkaXN0ICogZGlzdCk7Cn0KCnZvaWQgbWFpbigpCnsKICAgIGhpZ2hwIHZlYzMgbiA9IG5vcm1hbGl6ZSh3bm9ybWFsKTsKICAgIGhpZ2hwIHZlYzMgYmFzZWNvbCA9IHZlYzMoMC44MDAwMDAwMTE5MjA5Mjg5NTUwNzgxMjUpOwogICAgaGlnaHAgZmxvYXQgcm91Z2huZXNzID0gMC4wOwogICAgaGlnaHAgZmxvYXQgbWV0YWxsaWMgPSAwLjA7CiAgICBoaWdocCBmbG9hdCBvY2NsdXNpb24gPSAxLjA7CiAgICBoaWdocCBmbG9hdCBzcGVjdWxhciA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IHZpc2liaWxpdHkgPSAxLjA7CiAgICBoaWdocCBmbG9hdCBkb3ROTCA9IG1heChkb3QobiwgbGlnaHREaXIpLCAwLjApOwogICAgaGlnaHAgdmVjMyBkaXJlY3QgPSAoYmFzZWNvbCAqIGRvdE5MKSAqIGxpZ2h0Q29sb3I7CiAgICBkaXJlY3QgKj0gYXR0ZW51YXRlKGRpc3RhbmNlKHdwb3NpdGlvbiwgbGlnaHRQb3MpKTsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNCgoZGlyZWN0ICogdmlzaWJpbGl0eSkgKyAoKGJhc2Vjb2wgKiAwLjUpICogZW52bWFwU3RyZW5ndGgpLCAxLjApOwogICAgaGlnaHAgdmVjMyBfNzcgPSBwb3coZ2xfRnJhZ0RhdGFbMF0ueHl6LCB2ZWMzKDAuNDU0NTQ1NDY4MDkxOTY0NzIxNjc5Njg3NSkpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KF83Ny54LCBfNzcueSwgXzc3LnosIGdsX0ZyYWdEYXRhWzBdLncpOwp9Cgo",Rs.Material_mesh_fragData1="s1198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIHZlYzMgbGlnaHREaXI7CnVuaWZvcm0gdmVjMyBsaWdodENvbG9yOwp1bmlmb3JtIHZlYzMgbGlnaHRQb3M7CnVuaWZvcm0gZmxvYXQgZW52bWFwU3RyZW5ndGg7Cgp2YXJ5aW5nIHZlYzMgd25vcm1hbDsKdmFyeWluZyB2ZWMzIHdwb3NpdGlvbjsKCmZsb2F0IGF0dGVudWF0ZShmbG9hdCBkaXN0KQp7CiAgICByZXR1cm4gMS4wIC8gKGRpc3QgKiBkaXN0KTsKfQoKdm9pZCBtYWluKCkKewogICAgdmVjMyBuID0gbm9ybWFsaXplKHdub3JtYWwpOwogICAgdmVjMyBiYXNlY29sID0gdmVjMygwLjgwMDAwMDAxMTkyMDkyODk1NTA3ODEyNSk7CiAgICBmbG9hdCByb3VnaG5lc3MgPSAwLjA7CiAgICBmbG9hdCBtZXRhbGxpYyA9IDAuMDsKICAgIGZsb2F0IG9jY2x1c2lvbiA9IDEuMDsKICAgIGZsb2F0IHNwZWN1bGFyID0gMC4wOwogICAgZmxvYXQgdmlzaWJpbGl0eSA9IDEuMDsKICAgIGZsb2F0IGRvdE5MID0gbWF4KGRvdChuLCBsaWdodERpciksIDAuMCk7CiAgICB2ZWMzIGRpcmVjdCA9IChiYXNlY29sICogZG90TkwpICogbGlnaHRDb2xvcjsKICAgIGRpcmVjdCAqPSBhdHRlbnVhdGUoZGlzdGFuY2Uod3Bvc2l0aW9uLCBsaWdodFBvcykpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIDAuNSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7CiAgICB2ZWMzIF83NyA9IHBvdyhnbF9GcmFnRGF0YVswXS54eXosIHZlYzMoMC40NTQ1NDU0NjgwOTE5NjQ3MjE2Nzk2ODc1KSk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoXzc3LngsIF83Ny55LCBfNzcueiwgZ2xfRnJhZ0RhdGFbMF0udyk7Cn0KCg",Rs.Material_mesh_fragData2="s1338:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0RGlyOwp1bmlmb3JtIGhpZ2hwIHZlYzMgbGlnaHRDb2xvcjsKdW5pZm9ybSBoaWdocCB2ZWMzIGxpZ2h0UG9zOwp1bmlmb3JtIGhpZ2hwIGZsb2F0IGVudm1hcFN0cmVuZ3RoOwoKaW4gaGlnaHAgdmVjMyB3bm9ybWFsOwppbiBoaWdocCB2ZWMzIHdwb3NpdGlvbjsKb3V0IGhpZ2hwIHZlYzQgZnJhZ0NvbG9yOwoKaGlnaHAgZmxvYXQgYXR0ZW51YXRlKGhpZ2hwIGZsb2F0IGRpc3QpCnsKICAgIHJldHVybiAxLjAgLyAoZGlzdCAqIGRpc3QpOwp9Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWMzIG4gPSBub3JtYWxpemUod25vcm1hbCk7CiAgICBoaWdocCB2ZWMzIGJhc2Vjb2wgPSB2ZWMzKDAuODAwMDAwMDExOTIwOTI4OTU1MDc4MTI1KTsKICAgIGhpZ2hwIGZsb2F0IHJvdWdobmVzcyA9IDAuMDsKICAgIGhpZ2hwIGZsb2F0IG1ldGFsbGljID0gMC4wOwogICAgaGlnaHAgZmxvYXQgb2NjbHVzaW9uID0gMS4wOwogICAgaGlnaHAgZmxvYXQgc3BlY3VsYXIgPSAwLjA7CiAgICBoaWdocCBmbG9hdCB2aXNpYmlsaXR5ID0gMS4wOwogICAgaGlnaHAgZmxvYXQgZG90TkwgPSBtYXgoZG90KG4sIGxpZ2h0RGlyKSwgMC4wKTsKICAgIGhpZ2hwIHZlYzMgZGlyZWN0ID0gKGJhc2Vjb2wgKiBkb3ROTCkgKiBsaWdodENvbG9yOwogICAgZGlyZWN0ICo9IGF0dGVudWF0ZShkaXN0YW5jZSh3cG9zaXRpb24sIGxpZ2h0UG9zKSk7CiAgICBmcmFnQ29sb3IgPSB2ZWM0KChkaXJlY3QgKiB2aXNpYmlsaXR5KSArICgoYmFzZWNvbCAqIDAuNSkgKiBlbnZtYXBTdHJlbmd0aCksIDEuMCk7CiAgICBoaWdocCB2ZWMzIF83NyA9IHBvdyhmcmFnQ29sb3IueHl6LCB2ZWMzKDAuNDU0NTQ1NDY4MDkxOTY0NzIxNjc5Njg3NSkpOwogICAgZnJhZ0NvbG9yID0gdmVjNChfNzcueCwgXzc3LnksIF83Ny56LCBmcmFnQ29sb3Iudyk7Cn0KCg",Rs.painter_image_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",Rs.painter_image_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",Rs.painter_image_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",Rs.painter_colored_vertData0="s331:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",Rs.painter_colored_vertData1="s374:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIG1lZGl1bXAgdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",Rs.painter_colored_vertData2="s311:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgZnJhZ21lbnRDb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",Rs.painter_image_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",Rs.painter_image_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",Rs.painter_image_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",Rs.painter_colored_fragData0="s198:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IGZyYWdtZW50Q29sb3I7Cn0KCg",Rs.painter_colored_fragData1="s192:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gZnJhZ21lbnRDb2xvcjsKfQoK",Rs.painter_colored_fragData2="s223:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSBmcmFnbWVudENvbG9yOwp9Cgo",Rs.painter_text_vertData0="s436:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgZnJhZ21lbnRDb2xvcjsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",Rs.painter_text_vertData1="s500:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGZyYWdtZW50Q29sb3I7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzQgdmVydGV4Q29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGV4Q29vcmQgPSB0ZXhQb3NpdGlvbjsKICAgIGZyYWdtZW50Q29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",Rs.painter_text_vertData2="s402:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBmcmFnbWVudENvbG9yOwppbiB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBmcmFnbWVudENvbG9yID0gdmVydGV4Q29sb3I7Cn0KCg",Rs.painter_text_fragData0="s351:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CnZhcnlpbmcgaGlnaHAgdmVjMiB0ZXhDb29yZDsKCnZvaWQgbWFpbigpCnsKICAgIGdsX0ZyYWdEYXRhWzBdID0gdmVjNChmcmFnbWVudENvbG9yLnh5eiwgdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",Rs.painter_text_fragData1="s340:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjNCBmcmFnbWVudENvbG9yOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBnbF9GcmFnRGF0YVswXSA9IHZlYzQoZnJhZ21lbnRDb2xvci54eXosIHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKS54ICogZnJhZ21lbnRDb2xvci53KTsKfQoK",Rs.painter_text_fragData2="s367:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwppbiBoaWdocCB2ZWM0IGZyYWdtZW50Q29sb3I7CmluIGhpZ2hwIHZlYzIgdGV4Q29vcmQ7Cgp2b2lkIG1haW4oKQp7CiAgICBGcmFnQ29sb3IgPSB2ZWM0KGZyYWdtZW50Q29sb3IueHl6LCB0ZXh0dXJlKHRleCwgdGV4Q29vcmQpLnggKiBmcmFnbWVudENvbG9yLncpOwp9Cgo",Rs.painter_video_fragData0="s471:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKdmFyeWluZyBoaWdocCB2ZWMyIHRleENvb3JkOwp2YXJ5aW5nIGhpZ2hwIHZlYzQgY29sb3I7Cgp2b2lkIG1haW4oKQp7CiAgICBoaWdocCB2ZWM0IHRleGNvbG9yID0gdGV4dHVyZTJEKHRleCwgdGV4Q29vcmQpICogY29sb3I7CiAgICBoaWdocCB2ZWMzIF8zMiA9IHRleGNvbG9yLnh5eiAqIGNvbG9yLnc7CiAgICB0ZXhjb2xvciA9IHZlYzQoXzMyLngsIF8zMi55LCBfMzIueiwgdGV4Y29sb3Iudyk7CiAgICBnbF9GcmFnRGF0YVswXSA9IHRleGNvbG9yOwp9Cgo",Rs.painter_video_fragData1="s444:I3ZlcnNpb24gMTAwCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gbWVkaXVtcCBpbnQ7Cgp1bmlmb3JtIG1lZGl1bXAgc2FtcGxlcjJEIHRleDsKCnZhcnlpbmcgdmVjMiB0ZXhDb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkKewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgsIHRleENvb3JkKSAqIGNvbG9yOwogICAgdmVjMyBfMzIgPSB0ZXhjb2xvci54eXogKiBjb2xvci53OwogICAgdGV4Y29sb3IgPSB2ZWM0KF8zMi54LCBfMzIueSwgXzMyLnosIHRleGNvbG9yLncpOwogICAgZ2xfRnJhZ0RhdGFbMF0gPSB0ZXhjb2xvcjsKfQoK",Rs.painter_video_fragData2="s487:I3ZlcnNpb24gMzAwIGVzCnByZWNpc2lvbiBtZWRpdW1wIGZsb2F0OwpwcmVjaXNpb24gaGlnaHAgaW50OwoKdW5pZm9ybSBoaWdocCBzYW1wbGVyMkQgdGV4OwoKaW4gaGlnaHAgdmVjMiB0ZXhDb29yZDsKaW4gaGlnaHAgdmVjNCBjb2xvcjsKb3V0IGhpZ2hwIHZlYzQgRnJhZ0NvbG9yOwoKdm9pZCBtYWluKCkKewogICAgaGlnaHAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUodGV4LCB0ZXhDb29yZCkgKiBjb2xvcjsKICAgIGhpZ2hwIHZlYzMgXzMyID0gdGV4Y29sb3IueHl6ICogY29sb3IudzsKICAgIHRleGNvbG9yID0gdmVjNChfMzIueCwgXzMyLnksIF8zMi56LCB0ZXhjb2xvci53KTsKICAgIEZyYWdDb2xvciA9IHRleGNvbG9yOwp9Cgo",Rs.painter_video_vertData0="s415:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmF0dHJpYnV0ZSB2ZWMzIHZlcnRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSB2ZWMyIHRleFBvc2l0aW9uOwp2YXJ5aW5nIHZlYzQgY29sb3I7CmF0dHJpYnV0ZSB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",Rs.painter_video_vertData1="s479:I3ZlcnNpb24gMTAwCgp1bmlmb3JtIG1lZGl1bXAgbWF0NCBwcm9qZWN0aW9uTWF0cml4OwoKYXR0cmlidXRlIG1lZGl1bXAgdmVjMyB2ZXJ0ZXhQb3NpdGlvbjsKdmFyeWluZyBtZWRpdW1wIHZlYzIgdGV4Q29vcmQ7CmF0dHJpYnV0ZSBtZWRpdW1wIHZlYzIgdGV4UG9zaXRpb247CnZhcnlpbmcgbWVkaXVtcCB2ZWM0IGNvbG9yOwphdHRyaWJ1dGUgbWVkaXVtcCB2ZWM0IHZlcnRleENvbG9yOwoKdm9pZCBtYWluKCkKewogICAgZ2xfUG9zaXRpb24gPSBwcm9qZWN0aW9uTWF0cml4ICogdmVjNCh2ZXJ0ZXhQb3NpdGlvbiwgMS4wKTsKICAgIHRleENvb3JkID0gdGV4UG9zaXRpb247CiAgICBjb2xvciA9IHZlcnRleENvbG9yOwp9Cgo",Rs.painter_video_vertData2="s380:I3ZlcnNpb24gMzAwIGVzCgp1bmlmb3JtIG1hdDQgcHJvamVjdGlvbk1hdHJpeDsKCmluIHZlYzMgdmVydGV4UG9zaXRpb247Cm91dCB2ZWMyIHRleENvb3JkOwppbiB2ZWMyIHRleFBvc2l0aW9uOwpvdXQgdmVjNCBjb2xvcjsKaW4gdmVjNCB2ZXJ0ZXhDb2xvcjsKCnZvaWQgbWFpbigpCnsKICAgIGdsX1Bvc2l0aW9uID0gcHJvamVjdGlvbk1hdHJpeCAqIHZlYzQodmVydGV4UG9zaXRpb24sIDEuMCk7CiAgICB0ZXhDb29yZCA9IHRleFBvc2l0aW9uOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKfQoK",zs.renderListeners=[],zs.foregroundListeners=[],zs.backgroundListeners=[],zs.shutdownListeners=[],Xs.mobile=!1,Xs.ios=!1,Xs.mobileAudioPlaying=!1,Xs.chrome=!1,Xs.firefox=!1,Xs.ie=!1,Xs.insideInputEvent=!1,Xs.leftMouseCtrlDown=!1,Xs.minimumScroll=999,Xs.lastFirstTouchX=0,Xs.lastFirstTouchY=0,Xs.iosSoundEnabled=!1,Xs.soundEnabled=!1,Xs.iosTouchs=[],Us.windows=[],ra.fontGlyphs=function(t){for(var e=[],n=32;n<256;){var i=n++;e.push(i)}return e}(),Ja.__meta__={statics:{sendConnectEvent:{input:null},sendDisconnectEvent:{input:null}},fields:{sendAxisEvent:{input:null},sendButtonEvent:{input:null}}},Ja.instances=[],Ja.connectListeners=[],Ja.disconnectListeners=[],$a.__meta__={fields:{sendDownEvent:{input:null},sendUpEvent:{input:null},sendPressEvent:{input:null}}},to.__meta__={fields:{sendLeaveEvent:{input:null},sendDownEvent:{input:null},sendUpEvent:{input:null},sendMoveEvent:{input:null},sendWheelEvent:{input:null}}},io.accelerometer=new io,io.gyroscope=new io,ao.bufferSize=2e3,oo.exposurePattern=new s("EXPOSURE=\\s*([0-9]*[.][0-9]*)","i"),oo.formatPattern=new s("FORMAT=32-bit_rle_rgbe","i"),oo.widthHeightPattern=new s("-Y ([0-9]+) \\+X ([0-9]+)","i"),lo.todo=[],fo.loading=[],Io.nextId=0,No.global=new No,Mo.assetMap=new ir,Mo.events=[],Mo.screenW=-1,Mo.screenH=-1,Mo.h=new No,Oo.ar=[0,0,0],Eo.elementsBaked=!1,Ao.dark={FONT_SIZE:13,ELEMENT_W:100,ELEMENT_H:22,ELEMENT_OFFSET:2,ARROW_SIZE:5,BUTTON_H:17,CHECK_SIZE:15,CHECK_SELECT_SIZE:8,SCROLL_W:8,TEXT_OFFSET:8,TAB_W:12,LINE_STRENGTH:1,FLASH_SPEED:.5,TOOLTIP_DELAY:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-14671840,WINDOW_TINT_COL:-1,ACCENT_COL:-12566464,ACCENT_HOVER_COL:-11513776,ACCENT_SELECT_COL:-10066330,PANEL_BG_COL:-16777216,PANEL_TEXT_COL:-1118482,BUTTON_COL:-13948117,BUTTON_TEXT_COL:-3487289,BUTTON_HOVER_COL:-12895429,BUTTON_PRESSED_COL:-15000805,TEXT_COL:-3487289,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-14277082},Ao.light={FONT_SIZE:26,ELEMENT_W:200,ELEMENT_H:44,ELEMENT_OFFSET:4,ARROW_SIZE:10,BUTTON_H:34,CHECK_SIZE:30,CHECK_SELECT_SIZE:16,SCROLL_W:16,TEXT_OFFSET:16,TAB_W:24,LINE_STRENGTH:2,FLASH_SPEED:.5,TOOLTIP_DELAY:1,FILL_WINDOW_BG:!1,FILL_BUTTON_BG:!0,FILL_ACCENT_BG:!1,WINDOW_BG_COL:-1052689,WINDOW_TINT_COL:-14540254,ACCENT_COL:-1118482,ACCENT_HOVER_COL:-4473925,ACCENT_SELECT_COL:-5592406,PANEL_BG_COL:-1,PANEL_TEXT_COL:-14540254,BUTTON_COL:-3355444,BUTTON_TEXT_COL:-14540254,BUTTON_HOVER_COL:-5000269,BUTTON_PRESSED_COL:-5131855,TEXT_COL:-6710887,LABEL_COL:-5592406,ARROW_COL:-3487289,SEPARATOR_COL:-6710887},Bo.textToPaste="",Bo.textToCopy="",Bo.isCut=!1,Bo.comboFirst=!0,a.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);